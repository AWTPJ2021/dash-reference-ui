import{r as t,h as n,H as e,g as i}from"./p-5461f3be.js";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t,n,e){return t(e={path:n,exports:{},require:function(){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},e.exports),e.exports}function u(t){if(t.__esModule)return t;var n=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})})),n}var f=o((function(t,n){!function(t){var n={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},e=function(t){var e=t;return n.hasOwnProperty(t)&&(e=n[t]),String.fromCharCode(e)},i=15,r=32,o={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},a={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},s={25:2,26:4,29:6,30:8,31:10,27:13,28:15},f=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(t){this.time=t},log:function(t,n){this.verboseLevel>=this.verboseFilter[t]&&console.log(this.time+" ["+t+"] "+n)}},l=function(t){for(var n=[],e=0;e<t.length;e++)n.push(t[e].toString(16));return n},d=function(t,n,e,i,r){this.foreground=t||"white",this.underline=n||!1,this.italics=e||!1,this.background=i||"black",this.flash=r||!1};d.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(t){for(var n=["foreground","underline","italics","background","flash"],e=0;e<n.length;e++){var i=n[e];t.hasOwnProperty(i)&&(this[i]=t[i])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},copy:function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var h=function(t,n,e,i,r,o){this.uchar=t||" ",this.penState=new d(n,e,i,r,o)};h.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(t,n){this.uchar=t,this.penState.copy(n)},setPenState:function(t){this.penState.copy(t)},equals:function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},copy:function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var v=function(){this.chars=[];for(var t=0;t<r;t++)this.chars.push(new h);this.pos=0,this.currPenState=new d};v.prototype={equals:function(t){for(var n=!0,e=0;e<r;e++)if(!this.chars[e].equals(t.chars[e])){n=!1;break}return n},copy:function(t){for(var n=0;n<r;n++)this.chars[n].copy(t.chars[n])},isEmpty:function(){for(var t=!0,n=0;n<r;n++)if(!this.chars[n].isEmpty()){t=!1;break}return t},setCursor:function(t){this.pos!==t&&(this.pos=t),this.pos<0?(c.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>r&&(c.log("ERROR","Too large cursor position "+this.pos),this.pos=r)},moveCursor:function(t){var n=this.pos+t;if(t>1)for(var e=this.pos+1;e<n+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(n)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(t){t>=144&&this.backSpace();var n=e(t);this.pos>=r?c.log("ERROR","Cannot insert "+t.toString(16)+" ("+n+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(n,this.currPenState),this.moveCursor(1))},clearFromPos:function(t){var n;for(n=t;n<r;n++)this.chars[n].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var t=[],n=!0,e=0;e<r;e++){var i=this.chars[e].uchar;" "!==i&&(n=!1),t.push(i)}return n?"":t.join("")},setPenStyles:function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}};var p=function(){this.rows=[];for(var t=0;t<i;t++)this.rows.push(new v);this.currRow=14,this.nrRollUpRows=null,this.reset()};p.prototype={reset:function(){for(var t=0;t<i;t++)this.rows[t].clear();this.currRow=14},equals:function(t){for(var n=!0,e=0;e<i;e++)if(!this.rows[e].equals(t.rows[e])){n=!1;break}return n},copy:function(t){for(var n=0;n<i;n++)this.rows[n].copy(t.rows[n])},isEmpty:function(){for(var t=!0,n=0;n<i;n++)if(!this.rows[n].isEmpty()){t=!1;break}return t},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(t){this.rows[this.currRow].insertChar(t)},setPen:function(t){this.rows[this.currRow].setPenStyles(t)},moveCursor:function(t){this.rows[this.currRow].moveCursor(t)},setCursor:function(t){c.log("INFO","setCursor: "+t),this.rows[this.currRow].setCursor(t)},setPAC:function(t){c.log("INFO","pacData = "+JSON.stringify(t));var n=t.row-1;this.nrRollUpRows&&n<this.nrRollUpRows-1&&(n=this.nrRollUpRows-1),this.currRow=n;var e=this.rows[this.currRow];if(null!==t.indent){var i=Math.max(t.indent-1,0);e.setCursor(t.indent),t.color=e.chars[i].penState.foreground}this.setPen({foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1})},setBkgData:function(t){c.log("INFO","bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},setRollUpRows:function(t){this.nrRollUpRows=t},rollUp:function(){if(null!==this.nrRollUpRows){c.log("TEXT",this.getDisplayText());var t=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),c.log("INFO","Rolling up")}else c.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(t){t=t||!1;for(var n=[],e="",r=0;r<i;r++){var o=this.rows[r].getTextString();o&&n.push(t?"Row "+(r+1)+': "'+o+'"':o.trim())}return n.length>0&&(e=t?"["+n.join(" | ")+"]":n.join("\n")),e},getTextAndFormat:function(){return this.rows}};var g=function(t,n){this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new p,this.nonDisplayedMemory=new p,this.lastOutputScreen=new p,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};g.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(t){this.outputFilter=t},setPAC:function(t){this.writeScreen.setPAC(t)},setBkgData:function(t){this.writeScreen.setBkgData(t)},setMode:function(t){t!==this.mode&&(this.mode=t,c.log("INFO","MODE="+t),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},insertChars:function(t){for(var n=0;n<t.length;n++)this.writeScreen.insertChar(t[n]);c.log("INFO",(this.writeScreen===this.displayedMemory?"DISP":"NON_DISP")+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(c.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){c.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){c.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){c.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(t){c.log("INFO","RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},cc_FON:function(){c.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){c.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){c.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){c.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){c.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){c.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){c.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(c.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,c.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(t){c.log("INFO","TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},cc_MIDROW:function(t){var n={flash:!1};if(n.underline=t%2==1,n.italics=t>=46,n.italics)n.foreground="white";else{var e=Math.floor(t/2)-16;n.foreground=["white","green","blue","cyan","red","yellow","magenta"][e]}c.log("INFO","MIDROW: "+JSON.stringify(n)),this.writeScreen.setPen(n)},outputDataUpdate:function(){var t=c.time;null!==t&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(t,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}};var m=function(t,n,e){this.field=t||1,this.outputs=[n,e],this.channels=[new g(1,n),new g(2,e)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};m.prototype={getHandler:function(t){return this.channels[t].getHandler()},setHandler:function(t,n){this.channels[t].setHandler(n)},addData:function(t,n){var e,i,r,o=!1;this.lastTime=t,c.setTime(t);for(var u=0;u<n.length;u+=2)r=127&n[u+1],(i=127&n[u])>=16&&i<=31&&i===this.lastCmdA&&r===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,c.log("DEBUG","Repeated command ("+l([i,r])+") is dropped")):0!==i||0!==r?(c.log("DATA","["+l([n[u],n[u+1]])+"] -> ("+l([i,r])+")"),(e=this.parseCmd(i,r))||(e=this.parseMidrow(i,r)),e||(e=this.parsePAC(i,r)),e||(e=this.parseBackgroundAttributes(i,r)),e||(o=this.parseChars(i,r))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(o):c.log("WARNING","No channel found yet. TEXT-MODE?")),e?this.dataCounters.cmd+=2:o?this.dataCounters.char+=2:(this.dataCounters.other+=2,c.log("WARNING","Couldn't parse cleaned data "+l([i,r])+" orig: "+l([n[u],n[u+1]])))):this.dataCounters.padding+=2},parseCmd:function(t,n){var e;if(!((20===t||21===t||28===t||29===t)&&32<=n&&n<=47||(23===t||31===t)&&33<=n&&n<=35))return!1;var i=this.channels[(e=20===t||21===t||23===t?1:2)-1];return 20===t||21===t||28===t||29===t?32===n?i.cc_RCL():33===n?i.cc_BS():34===n?i.cc_AOF():35===n?i.cc_AON():36===n?i.cc_DER():37===n?i.cc_RU(2):38===n?i.cc_RU(3):39===n?i.cc_RU(4):40===n?i.cc_FON():41===n?i.cc_RDC():42===n?i.cc_TR():43===n?i.cc_RTD():44===n?i.cc_EDM():45===n?i.cc_CR():46===n?i.cc_ENM():47===n&&i.cc_EOC():i.cc_TO(n-32),this.lastCmdA=t,this.lastCmdB=n,this.currChNr=e,!0},parseMidrow:function(t,n){var e=null;if((17===t||25===t)&&32<=n&&n<=47){if((e=17===t?1:2)!==this.currChNr)return c.log("ERROR","Mismatch channel in midrow parsing"),!1;var i=this.channels[e-1];return i.insertChars([32]),i.cc_MIDROW(n),c.log("DEBUG","MIDROW ("+l([t,n])+")"),this.lastCmdA=t,this.lastCmdB=n,!0}return!1},parsePAC:function(t,n){var e;if(!((17<=t&&t<=23||25<=t&&t<=31)&&64<=n&&n<=127||(16===t||24===t)&&64<=n&&n<=95))return!1;e=t<=23?1:2;var i=this.interpretPAC(64<=n&&n<=95?1===e?o[t]:a[t]:1===e?u[t]:s[t],n);return this.channels[e-1].setPAC(i),this.lastCmdA=t,this.lastCmdB=n,this.currChNr=e,!0},interpretPAC:function(t,n){var e,i={color:null,italics:!1,indent:null,underline:!1,row:t};return i.underline=1==(1&(e=n>95?n-96:n-64)),e<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(e/2)]:e<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((e-16)/2),i},parseChars:function(t,n){var i=null,r=null,o=null;if(t>=25?(i=2,o=t-8):(i=1,o=t),17<=o&&o<=19){var u;c.log("INFO","Special char '"+e(u=17===o?n+80:18===o?n+112:n+144)+"' in channel "+i),r=[u],this.lastCmdA=t,this.lastCmdB=n}else 32<=t&&t<=127&&(r=0===n?[t]:[t,n],this.lastCmdA=null,this.lastCmdB=null);if(r){var a=l(r);c.log("DEBUG","Char codes =  "+a.join(","))}return r},parseBackgroundAttributes:function(t,n){var e,i;return((16===t||24===t)&&32<=n&&n<=47||(23===t||31===t)&&45<=n&&n<=47)&&(e={},16===t||24===t?(i=Math.floor((n-32)/2),e.background=f[i],n%2==1&&(e.background=e.background+"_semi")):45===n?e.background="transparent":(e.foreground="black",47===n&&(e.underline=!0)),this.channels[(t<24?1:2)-1].setBkgData(e),this.lastCmdA=t,this.lastCmdB=n,!0)},reset:function(){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(t){for(var n=0;n<this.channels.length;n++)this.channels[n]&&this.channels[n].cueSplitAtTime(t)}},t.logger=c,t.PenState=d,t.CaptionScreen=p,t.Cea608Parser=m,t.findCea608Nalus=function(t,n,e){for(var i=0,r=n,o=[],u=function(t,n,e,i){if(4!==t||n<8)return null;var r=e.getUint8(i),o=e.getUint16(i+1),u=e.getUint32(i+3),a=e.getUint8(i+7);return 181==r&&49==o&&1195456820==u&&3==a};r<n+e;){if(i=t.getUint32(r),6==(31&t.getUint8(r+4)))for(var a=r+5,s=-1;a<r+4+i-1;){s=0;for(var f=255;255===f;)s+=f=t.getUint8(a),a++;var c=0;for(f=255;255===f;)c+=f=t.getUint8(a),a++;u(s,c,t,a)&&o.push([a,c]),a+=c}r+=i+4}return o},t.extractCea608DataFromRange=function(t,n){var e=n[0],i=[[],[]],r=31&t.getUint8(e+=8);e+=2;for(var o=0;o<r;o++){var u=t.getUint8(e),a=4&u,s=3&u;e++;var f=t.getUint8(e);e++;var c=t.getUint8(e);e++,a&&(127&f)+(127&c)!=0&&(0===s?(i[0].push(f),i[0].push(c)):1===s&&(i[1].push(f),i[1].push(c)))}return i}}(n)})),c=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=new(function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()}return e(t,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer"}}]),t}());n.default=i})),l=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=new(function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()}return e(t,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate"}}]),t}());n.default=i})),d=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=new(function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()}return e(t,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),t}());n.default=i})),h=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){var t=void 0,n=[],e={},i={};function r(t,e){for(var i in n){var r=n[i];if(r.context===t&&r.name===e)return r.instance}return null}function o(t,n){return n[t]}function u(t,n,e){t in e&&(e[t]=n)}function a(n,e,i){var r=void 0,o=n.__dashjs_factory_name,u=e[o];if(u){var a=u.instance;if(!u.override)return a.apply({context:e,factory:t},i);for(var s in r=n.apply({context:e},i),a=a.apply({context:e,factory:t,parent:r},i))r.hasOwnProperty(s)&&(r[s]=a[s])}else r=n.apply({context:e},i);return r.getClassName=function(){return o},r}return t={extend:function(t,n,e,i){!i[t]&&n&&(i[t]={instance:n,override:e})},getSingletonInstance:r,setSingletonInstance:function(t,e,i){for(var r in n){var o=n[r];if(o.context===t&&o.name===e)return void(n[r].instance=i)}n.push({name:e,context:t,instance:i})},getSingletonFactory:function(t){var i=o(t.__dashjs_factory_name,e);return i||(e[t.__dashjs_factory_name]=i=function(e){var i=void 0;return void 0===e&&(e={}),{getInstance:function(){return i||(i=r(e,t.__dashjs_factory_name)),i||(i=a(t,e,arguments),n.push({name:t.__dashjs_factory_name,context:e,instance:i})),i}}}),i},getSingletonFactoryByName:function(t){return o(t,e)},updateSingletonFactory:function(t,n){u(t,n,e)},getClassFactory:function(t){var n=o(t.__dashjs_factory_name,i);return n||(i[t.__dashjs_factory_name]=n=function(n){return void 0===n&&(n={}),{create:function(){return a(t,n,arguments)}}}),n},getClassFactoryByName:function(t){return o(t,i)},updateClassFactory:function(t,n){u(t,n,i)}}}();n.default=e})),v=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(){var t={};function n(n,e,i){var r=-1;return t[n]?(t[n].some((function(t,n){if(t&&t.callback===e&&(!i||i===t.scope))return r=n,!0})),r):r}return{on:function(e,i,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!e)throw new Error("event type cannot be null or undefined");if(!i||"function"!=typeof i)throw new Error("listener must be a function: "+i);if(!(n(e,i,r)>=0)){t[e]=t[e]||[];var u={callback:i,scope:r,priority:o},a=t[e].some((function(n,i){if(n&&o>n.priority)return t[e].splice(i,0,u),!0}));a||t[e].push(u)}},off:function(e,i,r){if(e&&i&&t[e]){var o=n(e,i,r);o<0||(t[e][o]=null)}},trigger:function(n,e){if(n&&t[n]){if((e=e||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");e.type=n,t[n]=t[n].filter((function(t){return t})),t[n].forEach((function(t){return t&&t.callback.call(t.scope,e)}))}},reset:function(){t={}}}}r.__dashjs_factory_name="EventBus";var o=i.default.getSingletonFactory(r);o.EVENT_PRIORITY_LOW=0,o.EVENT_PRIORITY_HIGH=5e3,i.default.updateSingletonFactory(r.__dashjs_factory_name,o),n.default=o})),p=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,[{key:"extend",value:function(t,n){if(t){var e=!!n&&n.override,i=!!n&&n.publicOnly;for(var r in t)!t.hasOwnProperty(r)||this[r]&&!e||i&&-1===t[r].indexOf("public_")||(this[r]=t[r])}}}]),t}();n.default=i})),g=o((function(t,n){var e;Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function n(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.BUFFERING_COMPLETED="bufferingCompleted",t.BUFFER_CLEARED="bufferCleared",t.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",t.BYTES_APPENDED="bytesAppended",t.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",t.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",t.CURRENT_TRACK_CHANGED="currentTrackChanged",t.DATA_UPDATE_COMPLETED="dataUpdateCompleted",t.DATA_UPDATE_STARTED="dataUpdateStarted",t.INBAND_EVENTS="inbandEvents",t.INITIALIZATION_LOADED="initializationLoaded",t.INIT_FRAGMENT_LOADED="initFragmentLoaded",t.INIT_FRAGMENT_NEEDED="initFragmentNeeded",t.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",t.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",t.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",t.LOADING_COMPLETED="loadingCompleted",t.LOADING_PROGRESS="loadingProgress",t.LOADING_DATA_PROGRESS="loadingDataProgress",t.LOADING_ABANDONED="loadingAborted",t.MANIFEST_UPDATED="manifestUpdated",t.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",t.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",t.QUOTA_EXCEEDED="quotaExceeded",t.REPRESENTATION_UPDATE_STARTED="representationUpdateStarted",t.REPRESENTATION_UPDATE_COMPLETED="representationUpdateCompleted",t.SEGMENTS_LOADED="segmentsLoaded",t.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",t.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",t.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",t.STREAMS_COMPOSED="streamsComposed",t.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",t.STREAM_COMPLETED="streamCompleted",t.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",t.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",t.URL_RESOLUTION_FAILED="urlResolutionFailed",t.VIDEO_CHUNK_RECEIVED="videoChunkReceived",t.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",t.XLINK_ELEMENT_LOADED="xlinkElementLoaded",t.XLINK_READY="xlinkReady",t.SEGMENTBASE_INIT_REQUEST_NEEDED="segmentBaseInitRequestNeeded",t.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED="segmentBaseSegmentsListRequestNeeded",t.SEEK_TARGET="seekTarget",t.DYNAMIC_STREAM_COMPLETED="dynamicStreamCompleted",t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(((e=p)&&e.__esModule?e:{default:e}).default);n.default=i})),m=o((function(t,n){var e;function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}Object.defineProperty(n,"__esModule",{value:!0});var o=new(function(t){function n(){return i(this,n),r(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(((e=g)&&e.__esModule?e:{default:e}).default));n.default=o})),y=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(v),i=o(m),r=o(h);function o(t){return t&&t.__esModule?t:{default:t}}var u=1,a=2,s=3,f=4,c=5;function l(t){t=t||{};var n,r=(0,e.default)(this.context).getInstance(),o=t.settings,l=[],d=void 0,h=void 0,v=void 0;function p(t){return t&&t.bind?t.bind(window.console):window.console.log.bind(window.console)}function g(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];M.apply(void 0,[u,this].concat(n))}function m(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];M.apply(void 0,[a,this].concat(n))}function y(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];M.apply(void 0,[s,this].concat(n))}function w(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];M.apply(void 0,[f,this].concat(n))}function b(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];M.apply(void 0,[c,this].concat(n))}function M(t,n){var e="",u=null;d&&(u=(new Date).getTime(),e+="["+(u-v)+"]"),h&&n&&n.getClassName&&(e+="["+n.getClassName()+"]",n.getType&&(e+="["+n.getType()+"]")),e.length>0&&(e+=" ");for(var a=arguments.length,s=Array(a>2?a-2:0),f=2;f<a;f++)s[f-2]=arguments[f];Array.apply(null,s).forEach((function(t){e+=t+" "})),l[t]&&o.get().debug.logLevel>=t&&l[t](e),r.trigger(i.default.LOG,{message:e,level:t})}return n={getLogger:function(t){return{fatal:g.bind(t),error:m.bind(t),warn:y.bind(t),info:w.bind(t),debug:b.bind(t)}},setLogTimestampVisible:function(t){d=t},setCalleeNameVisible:function(t){h=t}},d=!0,h=!0,v=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(l[u]=p(window.console.error),l[a]=p(window.console.error),l[s]=p(window.console.warn),l[f]=p(window.console.info),l[c]=p(window.console.debug)),n}l.__dashjs_factory_name="Debug";var d=r.default.getSingletonFactory(l);d.LOG_LEVEL_NONE=0,d.LOG_LEVEL_FATAL=u,d.LOG_LEVEL_ERROR=a,d.LOG_LEVEL_WARNING=s,d.LOG_LEVEL_INFO=f,d.LOG_LEVEL_DEBUG=c,r.default.updateSingletonFactory(l.__dashjs_factory_name,d),n.default=d})),w=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=s(c),i=s(d),r=s(v),o=s(m),u=s(h),a=s(y);function s(t){return t&&t.__esModule?t:{default:t}}function f(){var t,n=this.context,u=(0,r.default)(n).getInstance(),s=void 0,f=void 0,c=void 0,l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0,b=void 0,M=void 0,T=void 0,N=void 0,_=void 0,S=void 0,C=void 0,E=void 0,k=void 0,O=void 0;function R(t){if(!v||!isNaN(p)){var n=p;if(isNaN(n))if(w){n=t.liveStartTime;var e=c.getCurrentDVRInfo(),i=e?e.range:null;if(i){var r=V(y.start,!0);isNaN(r)||(s.info("Start time from URI parameters: "+r),n=Math.max(Math.min(n,r),i.start))}}else{n=y.start;var a=V(y.start,!1);!isNaN(a)&&a<n+y.duration&&(s.info("Start time from URI parameters: "+a),n=Math.max(n,a))}isNaN(n)||n===d.getTime()||(u.trigger(o.default.PLAYBACK_SEEKING,{seekTime:n}),P(n,!1,!0))}}function I(){return parseFloat((D()-B()).toFixed(5))}function D(){return y.start+y.duration}function x(){y&&d&&d.getElement()?d.play():M=!0}function A(){return y&&d?d.isPaused():null}function j(){y&&d&&d.pause()}function F(){return y&&d?d.isSeeking():null}function P(t,n,e){y&&d&&t!==(isNaN(_)?d.getTime():_)&&(!0===e?(d.removeEventListener("seeking",nt),s.info("Requesting internal seek to time: "+t),d.setCurrentTime(t,n)):(_=t,u.trigger(o.default.PLAYBACK_SEEK_ASKED),s.info("Requesting seek to time: "+t),d.setCurrentTime(t,n)))}function B(){return y&&d?d.getTime():null}function L(){var t=B();if(w&&!isNaN(N)){var n=N/1e3;t>n&&(t-=n)}return t}function U(){return y&&d?d.getPlaybackRate():null}function q(){return y&&d?d.getEnded():null}function z(){return w}function H(){if(!w||isNaN(N))return NaN;var t=L();if(isNaN(t)||0===t)return 0;var n=(new Date).getTime()+1e3*h.getClientTimeOffset();return Math.max(((n-N-1e3*t)/1e3).toFixed(3),0)}function K(){M=!1,v=!1,p=NaN,m=0,N=0,_=NaN,d&&(u.off(o.default.STREAM_INITIALIZED,R,this),u.off(o.default.DATA_UPDATE_COMPLETED,X,this),u.off(o.default.BUFFER_LEVEL_STATE_CHANGED,ht,this),u.off(o.default.LOADING_PROGRESS,dt,this),u.off(o.default.PLAYBACK_PROGRESS,ct,this),u.off(o.default.PLAYBACK_TIME_UPDATED,ct,this),u.off(o.default.PLAYBACK_ENDED,st,this),u.off(o.default.STREAM_INITIALIZING,pt,this),G(),d.removeEventListener("canplay",Q),d.removeEventListener("play",J),d.removeEventListener("waiting",Y),d.removeEventListener("playing",Z),d.removeEventListener("pause",tt),d.removeEventListener("error",ft),d.removeEventListener("seeking",nt),d.removeEventListener("seeked",et),d.removeEventListener("timeupdate",it),d.removeEventListener("progress",rt),d.removeEventListener("ratechange",ot),d.removeEventListener("loadedmetadata",ut),d.removeEventListener("stalled",vt),d.removeEventListener("ended",at)),g=null,d=null,y=null,w=null}function V(t,n){var e=k.getURIFragmentData();return e&&e.t?(e.t=e.t.split(",")[0],n&&-1!==e.t.indexOf("posix:")?parseInt(e.t.substring(6)):t+parseInt(e.t)):NaN}function W(){null===g&&(g=setInterval((function(){var t;u.trigger(o.default.WALLCLOCK_TIME_UPDATED,{isDynamic:w,time:new Date}),z()&&A()&&(t=Date.now(),(!T||t>T+500)&&(T=t,it()))}),O.get().streaming.wallclockTimeUpdateInterval))}function G(){clearInterval(g),g=null}function $(){if(!A()&&w&&0!==d.getReadyState()){var t=L(),n=function(t){var n=c.getCurrentDVRInfo(),e=n?n.range:null;return e?(s.debug("Checking DVR window for at "+t+" with DVR window range "+e.start+" - "+e.end),t>e.end?Math.max(e.end-m,e.start):t>0&&t+.25<e.start&&Math.abs(t-e.start)<31536e4?e.start:t):NaN}(t);!isNaN(n)&&n!==t&&(s.debug("UpdateCurrentTime: Seek to actual time: "+n+" from currentTime: "+t),P(n))}}function X(t){if(!t.error){var n=l.convertDataToRepresentationInfo(t.currentRepresentation),e=n?n.mediaInfo.streamInfo:null;null!==e&&y.id===e.id&&(y=e,$())}}function Q(){u.trigger(o.default.CAN_PLAY)}function J(){s.info("Native video element event: play"),$(),W(),u.trigger(o.default.PLAYBACK_STARTED,{startTime:B()})}function Y(){s.info("Native video element event: waiting"),u.trigger(o.default.PLAYBACK_WAITING,{playingTime:B()})}function Z(){s.info("Native video element event: playing"),u.trigger(o.default.PLAYBACK_PLAYING,{playingTime:B()})}function tt(){s.info("Native video element event: pause"),u.trigger(o.default.PLAYBACK_PAUSED,{ended:q()})}function nt(){var t=B();isNaN(_)||_===t||(t=_),_=NaN,s.info("Seeking to: "+t),W(),u.trigger(o.default.PLAYBACK_SEEKING,{seekTime:t})}function et(){s.info("Native video element event: seeked"),u.trigger(o.default.PLAYBACK_SEEKED),d.addEventListener("seeking",nt)}function it(){y&&u.trigger(o.default.PLAYBACK_TIME_UPDATED,{timeToEnd:I(),time:B()})}function rt(){u.trigger(o.default.PLAYBACK_PROGRESS)}function ot(){var t=U();s.info("Native video element event: ratechange: ",t),u.trigger(o.default.PLAYBACK_RATE_CHANGED,{playbackRate:t})}function ut(){s.info("Native video element event: loadedmetadata"),u.trigger(o.default.PLAYBACK_METADATA_LOADED),W()}function at(){s.info("Native video element event: ended"),j(),G(),u.trigger(o.default.PLAYBACK_ENDED,{isLast:f.getActiveStreamInfo().isLast})}function st(t){if(g&&t.isLast){s.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var n=t.seekTime?t.seekTime:D();d.setCurrentTime(n),j(),G()}}function ft(t){u.trigger(o.default.PLAYBACK_ERROR,{error:(t.target||t.srcElement).error})}function ct(){var t,n,e;w&&O.get().streaming.lowLatencyEnabled&&O.get().streaming.liveCatchUpPlaybackRate>0&&!A()&&!F()&&(t=H(),n=Math.abs(t-b.getLiveDelay()),e=b.getLiveCatchupLatencyThreshold(),O.get().streaming.lowLatencyEnabled&&O.get().streaming.liveCatchUpPlaybackRate>0&&B()>0&&n>O.get().streaming.liveCatchUpMinDrift&&(isNaN(e)||t<=e)?function(){if(d){var t=O.get().streaming.liveCatchUpPlaybackRate,n=b.getLiveDelay(),e=H()-n,i=1-t+2*t/(1+Math.pow(Math.E,-5*e));C&&(r=null,f.getActiveStreamProcessors().forEach((function(t){var n=t.getBufferLevel();r=null===r?n:Math.min(r,n)})),r>n/2?C=!1:e>0&&(i=1)),Math.abs(d.getPlaybackRate()-i)>E&&d.setPlaybackRate(i),O.get().streaming.liveCatchUpMaxDrift>0&&!S&&e>O.get().streaming.liveCatchUpMaxDrift?(s.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),S=!0,P(((o=c.getCurrentDVRInfo())?o.range:null).end-b.getLiveDelay(),!0,!1)):S=!1}var r,o}():lt())}function lt(){d&&d.setPlaybackRate(1)}function dt(t){if(!1===t.stream&&O.get().streaming.lowLatencyEnabled&&!isNaN(t.request.duration)){var n=1.2*t.request.duration;n>b.getLiveDelay()&&(s.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",n.toFixed(2)),O.update({streaming:{liveDelay:n}}))}}function ht(t){t.streamId===y.id&&(O.get().streaming.lowLatencyEnabled?t.state!==i.default.BUFFER_EMPTY||F()||C||(C=!0,lt()):d.setStallState(t.mediaType,t.state===i.default.BUFFER_EMPTY))}function vt(t){u.trigger(o.default.PLAYBACK_STALLED,{e:t})}function pt(t){!function(t,n){if(t&&t.manifestInfo&&t.manifestInfo.serviceDescriptions){for(var i=void 0,r=0;r<t.manifestInfo.serviceDescriptions.length;r++){var o=t.manifestInfo.serviceDescriptions[r];if(o.schemeIdUri===e.default.SERVICE_DESCRIPTION_LL_SCHEME){i=o;break}}i&&n&&n.supplementalProperties&&"true"===n.supplementalProperties[e.default.SUPPLEMENTAL_PROPERTY_LL_SCHEME]&&(i.latency&&i.latency.target>0&&(s.debug("Apply LL properties coming from service description. Target Latency (ms):",i.latency.target),O.update({streaming:{lowLatencyEnabled:!0,liveDelay:i.latency.target/1e3,liveCatchUpMinDrift:i.latency.max>i.latency.target?(i.latency.max-i.latency.target)/1e3:void 0}})),i.playbackRate&&i.playbackRate.max>1&&(s.debug("Apply LL properties coming from service description. Max PlaybackRate:",i.playbackRate.max),O.update({streaming:{lowLatencyEnabled:!0,liveCatchUpPlaybackRate:i.playbackRate.max-1}})))}}(t.streamInfo,t.mediaInfo)}return t={initialize:function(t,n,e){y=t,d.addEventListener("canplay",Q),d.addEventListener("play",J),d.addEventListener("waiting",Y),d.addEventListener("playing",Z),d.addEventListener("pause",tt),d.addEventListener("error",ft),d.addEventListener("seeking",nt),d.addEventListener("seeked",et),d.addEventListener("timeupdate",it),d.addEventListener("progress",rt),d.addEventListener("ratechange",ot),d.addEventListener("loadedmetadata",ut),d.addEventListener("stalled",vt),d.addEventListener("ended",at),w=y.manifestInfo.isDynamic,S=!1,C=!1,v=!0===n,p=e;var i="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",r=/safari/.test(i)&&!/chrome/.test(i);E=r?.25:.02,u.on(o.default.STREAM_INITIALIZED,R,this),u.on(o.default.DATA_UPDATE_COMPLETED,X,this),u.on(o.default.LOADING_PROGRESS,dt,this),u.on(o.default.BUFFER_LEVEL_STATE_CHANGED,ht,this),u.on(o.default.PLAYBACK_PROGRESS,ct,this),u.on(o.default.PLAYBACK_TIME_UPDATED,ct,this),u.on(o.default.PLAYBACK_ENDED,st,this),u.on(o.default.STREAM_INITIALIZING,pt,this),M&&(M=!1,x())},setConfig:function(t){t&&(t.streamController&&(f=t.streamController),t.dashMetrics&&(c=t.dashMetrics),t.mediaPlayerModel&&(b=t.mediaPlayerModel),t.adapter&&(l=t.adapter),t.videoModel&&(d=t.videoModel),t.timelineConverter&&(h=t.timelineConverter),t.uriFragmentModel&&(k=t.uriFragmentModel),t.settings&&(O=t.settings))},getStartTimeFromUriParameters:V,getTimeToStreamEnd:I,getTime:B,getNormalizedTime:L,getPlaybackRate:U,getPlayedRanges:function(){return y&&d?d.getPlayedRanges():null},getEnded:q,getIsDynamic:z,getStreamController:function(){return f},computeAndSetLiveDelay:function(t,n,e){var i,r,o=void 0,u=!isNaN(t)&&isFinite(t)?t:NaN,a=l.getSuggestedPresentationDelay();if(r=O.get().streaming.lowLatencyEnabled?0:b.getLiveDelay()?b.getLiveDelay():null===O.get().streaming.liveDelayFragmentCount||isNaN(O.get().streaming.liveDelayFragmentCount)||isNaN(u)?!0===O.get().streaming.useSuggestedPresentationDelay&&null!==a&&!isNaN(a)&&a>0?a:isNaN(u)?isNaN(e)?4*y.manifestInfo.minBufferTime:4*e:4*u:u*O.get().streaming.liveDelayFragmentCount,null!==(i=l.getAvailabilityStartTime())&&(N=i),n>0){var s=Math.max(n-10,n/2);o=Math.min(r,s)}else o=r;return m=o,o},getLiveDelay:function(){return m},setLiveDelay:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n&&t<m||(m=t)},getCurrentLiveLatency:H,play:x,isPaused:A,pause:j,isSeeking:F,getStreamEndTime:D,seek:P,reset:K},s=(0,a.default)(n).getInstance().getLogger(t),K(),t}f.__dashjs_factory_name="PlaybackController",n.default=u.default.getSingletonFactory(f)})),b=o((function(t,n){function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function t(){e(this,t),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null};i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.OTHER_TYPE="other",n.HTTPRequest=i,n.HTTPRequestTrace=function t(){e(this,t),this.s=null,this.d=null,this.b=[]}})),M=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.action=t.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=n||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return e(t,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===b.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(t){this.type=t&&t.init?b.HTTPRequest.INIT_SEGMENT_TYPE:b.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=t&&t.url?t.url:null,this.range=t&&t.range?t.range.start+"-"+t.range.end:null,this.mediaType=t&&t.mediaType?t.mediaType:null}}]),t}();i.ACTION_DOWNLOAD="download",i.ACTION_COMPLETE="complete",n.default=i})),T=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(M);function r(t){return t&&t.__esModule?t:{default:t}}var o="loading",u="executed",a="failed";function s(t){var n,e=(t=t||{}).eventBus,r=t.events,s=t.dashMetrics,f=t.fragmentLoader,c=t.streamId,l=void 0,d=void 0,h=void 0;function v(t){var n;return!!t&&(n=!1,d.some((function(e){if(r=t,o=e,!isNaN(r.index)&&r.startTime===o.startTime&&r.adaptationIndex===o.adaptationIndex&&r.type===o.type||function(t,n){return isNaN(t.index)&&isNaN(n.index)&&t.quality===n.quality}(t,e)||function(t,n){return t.action===i.default.ACTION_COMPLETE&&t.action===n.action}(t,e))return n=!0;var r,o})),n)}function p(t){return isNaN(t.duration)?.25:Math.min(t.duration/8,.5)}function g(t){d=d.filter((function(n){var e=p(n);return isNaN(n.startTime)||void 0!==t&&n.startTime>=t-e}))}function m(t,n){n<=t+.5||(d=d.filter((function(e){var i=p(e);return isNaN(e.startTime)||e.startTime>=n-i||isNaN(e.duration)||e.startTime+e.duration<=t+i})))}function y(t,n,e){for(var i=t.length-1;i>=0;i--){var r=t[i],o=r.startTime,u=o+r.duration;if(e=isNaN(e)?p(r):e,!isNaN(o)&&!isNaN(u)&&n+e>=o&&n-e<u||isNaN(o)&&isNaN(n))return r}return null}function w(t,n){s.addSchedulingInfo(t,n),s.addRequestsQueue(t.mediaType,h,d)}function b(t){t.sender===f&&(h.splice(h.indexOf(t.request),1),t.response&&!t.error&&d.push(t.request),w(t.request,t.error?a:u),e.trigger(r.FRAGMENT_LOADING_COMPLETED,{request:t.request,response:t.response,error:t.error,sender:this}))}function M(t){t.sender===f&&e.trigger(r.FRAGMENT_LOADING_PROGRESS,{request:t.request,response:t.response,error:t.error,sender:this})}function T(t){t.sender===f&&e.trigger(r.FRAGMENT_LOADING_ABANDONED,{streamId:c,request:t.request,mediaType:t.mediaType})}function N(){d=[],h=[]}return n={getRequests:function(t){var n=[];return(t?t.state instanceof Array?t.state:[t.state]:[]).forEach((function(e){var i=function(t){var n=void 0;switch(t){case o:n=h;break;case u:n=d;break;default:n=[]}return n}(e);n=n.concat(function(t,n){return n.hasOwnProperty("time")?[y(t,n.time,n.threshold)]:t.filter((function(t){for(var e in n)if("state"!==e&&n.hasOwnProperty(e)&&t[e]!=n[e])return!1;return!0}))}(i,t))})),n},isFragmentLoaded:v,isFragmentLoadedOrPending:function(t){var n=!1,e=0,i=void 0;if(!(n=v(t)))for(e=0;e<h.length;e++)t.url===(i=h[e]).url&&t.startTime===i.startTime&&(n=!0);return n},removeExecutedRequestsBeforeTime:g,removeExecutedRequestsAfterTime:function(t){d=d.filter((function(n){return isNaN(n.startTime)||void 0!==t&&n.startTime<t}))},syncExecutedRequestsWithBufferedRange:function(t,n){if(t&&0!==t.length){for(var e=0,i=0,r=t.length;i<r;i++)m(e,t.start(i)),e=t.end(i);n>0&&m(e,n)}else g()},abortRequests:function(){l.debug("abort requests"),f.abort(),h=[]},executeRequest:function(t){switch(t.action){case i.default.ACTION_COMPLETE:d.push(t),w(t,u),l.debug("STREAM_COMPLETED"),e.trigger(r.STREAM_COMPLETED,{request:t});break;case i.default.ACTION_DOWNLOAD:w(t,o),h.push(t),function(t){e.trigger(r.FRAGMENT_LOADING_STARTED,{streamId:c,request:t}),f.load(t)}(t);break;default:l.warn("Unknown request action.")}},reset:function(){e.off(r.LOADING_COMPLETED,b,this),e.off(r.LOADING_DATA_PROGRESS,M,this),e.off(r.LOADING_ABANDONED,T,this),f&&f.reset(),N()},addExecutedRequest:function(t){d.push(t)}},l=t.debug.getLogger(n),N(),e.on(r.LOADING_COMPLETED,b,n),e.on(r.LOADING_DATA_PROGRESS,M,n),e.on(r.LOADING_ABANDONED,T,n),n}s.__dashjs_factory_name="FragmentModel";var f=e.default.getClassFactory(s);f.FRAGMENT_MODEL_LOADING=o,f.FRAGMENT_MODEL_EXECUTED=u,f.FRAGMENT_MODEL_CANCELED="canceled",f.FRAGMENT_MODEL_FAILED=a,e.default.updateClassFactory(s.__dashjs_factory_name,f),n.default=f})),N=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(n,e,i){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.code=n||null,this.message=e||null,this.data=i||null}})),_=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1}})),S=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(n){if(function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.offset=n._offset,this.type=n.type,this.size=n.size,this.boxes=[],n.boxes)for(var e=0;e<n.boxes.length;e++)this.boxes.push(new t(n.boxes[e]));switch(this.isComplete=!0,n.type){case"sidx":if(this.timescale=n.timescale,this.earliest_presentation_time=n.earliest_presentation_time,this.first_offset=n.first_offset,this.references=n.references,n.references){this.references=[];for(var i=0;i<n.references.length;i++)this.references.push({reference_type:n.references[i].reference_type,referenced_size:n.references[i].referenced_size,subsegment_duration:n.references[i].subsegment_duration})}break;case"emsg":this.id=n.id,this.version=1===n.version?1:0,this.value=n.value,this.timescale=n.timescale,this.scheme_id_uri=n.scheme_id_uri,this.presentation_time_delta=1===n.version?n.presentation_time:n.presentation_time_delta,this.event_duration=n.event_duration,this.message_data=n.message_data;break;case"mdhd":this.timescale=n.timescale;break;case"mfhd":this.sequence_number=n.sequence_number;break;case"subs":this.entry_count=n.entry_count,this.entries=n.entries;break;case"tfhd":this.base_data_offset=n.base_data_offset,this.sample_description_index=n.sample_description_index,this.default_sample_duration=n.default_sample_duration,this.default_sample_size=n.default_sample_size,this.default_sample_flags=n.default_sample_flags,this.flags=n.flags;break;case"tfdt":this.version=n.version,this.baseMediaDecodeTime=n.baseMediaDecodeTime,this.flags=n.flags;break;case"trun":if(this.sample_count=n.sample_count,this.first_sample_flags=n.first_sample_flags,this.data_offset=n.data_offset,this.flags=n.flags,this.samples=n.samples,n.samples){this.samples=[];for(var r=0,o=n.samples.length;r<o;r++)this.samples.push({sample_size:n.samples[r].sample_size,sample_duration:n.samples[r].sample_duration,sample_composition_time_offset:n.samples[r].sample_composition_time_offset})}}}return e(t,[{key:"getChildBox",value:function(t){for(var n=0;n<this.boxes.length;n++)if(this.boxes[n].type===t)return this.boxes[n]}},{key:"getChildBoxes",value:function(t){for(var n=[],e=0;e<this.boxes.length;e++)this.boxes[e].type===t&&n.push(this.boxes[e]);return n}}]),t}();n.default=i})),C=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(S),i=r(h);function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t=void 0;function n(n){var e=[];if(!n||!t||"function"!=typeof t.fetchAll)return e;for(var r=t.fetchAll(n),o=void 0,u=0,a=r.length;u<a;u++)(o=i(r[u]))&&e.push(o);return e}function i(t){if(!t)return null;var n=new e.default(t);return t.hasOwnProperty("_incomplete")&&(n.isComplete=!t._incomplete),n}return{getBox:function(n){return n&&t&&t.boxes&&0!==t.boxes.length&&"function"==typeof t.fetch?i(t.fetch(n)):null},getBoxes:n,setData:function(n){t=n},getLastBox:function(){if(!t||!t.boxes||!t.boxes.length)return null;var e=n(t.boxes[t.boxes.length-1].type);return e.length>0?e[e.length-1]:null}}}o.__dashjs_factory_name="IsoFile",n.default=i.default.getClassFactory(o)})),E=o((function(t,n){
/*! codem-isoboxer v0.3.6 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */
var e={parseBuffer:function(t){return new i(t).parse()},addBoxProcessor:function(t,n){"string"==typeof t&&"function"==typeof n&&(r.prototype._boxProcessors[t]=n)},createFile:function(){return new i},createBox:function(t,n,e){var i=r.create(t);return n&&n.append(i,e),i},createFullBox:function(t,n,i){var r=e.createBox(t,n,i);return r.version=0,r.flags=0,r},Utils:{}};e.Utils.dataViewToString=function(t,n){var e=n||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(e).decode(t);var i=[],r=0;if("utf-8"===e)for(;r<t.byteLength;){var o=t.getUint8(r++);o<128||(o<224?(o=(31&o)<<6,o|=63&t.getUint8(r++)):o<240?(o=(15&o)<<12,o|=(63&t.getUint8(r++))<<6,o|=63&t.getUint8(r++)):(o=(7&o)<<18,o|=(63&t.getUint8(r++))<<12,o|=(63&t.getUint8(r++))<<6,o|=63&t.getUint8(r++))),i.push(String.fromCharCode(o))}else for(;r<t.byteLength;)i.push(String.fromCharCode(t.getUint8(r++)));return i.join("")},e.Utils.utf8ToByteArray=function(t){var n,e;if("undefined"!=typeof TextEncoder)n=(new TextEncoder).encode(t);else for(n=[],e=0;e<t.length;++e){var i=t.charCodeAt(e);i<128?n.push(i):i<2048?(n.push(192|i>>6),n.push(128|63&i)):i<65536?(n.push(224|i>>12),n.push(128|63&i>>6),n.push(128|63&i)):(n.push(240|i>>18),n.push(128|63&i>>12),n.push(128|63&i>>6),n.push(128|63&i))}return n},e.Utils.appendBox=function(t,n,e){if(n._offset=t._cursor.offset,n._root=t._root?t._root:t,n._raw=t._raw,n._parent=t,-1!==e)if(null!=e){var i,r=-1;if("number"==typeof e)r=e;else{if("string"==typeof e)i=e;else{if("object"!=typeof e||!e.type)return void t.boxes.push(n);i=e.type}for(var o=0;o<t.boxes.length;o++)if(i===t.boxes[o].type){r=o+1;break}}t.boxes.splice(r,0,n)}else t.boxes.push(n)},n.parseBuffer=e.parseBuffer,n.addBoxProcessor=e.addBoxProcessor,n.createFile=e.createFile,n.createBox=e.createBox,n.createFullBox=e.createFullBox,n.Utils=e.Utils,e.Cursor=function(t){this.offset=void 0===t?0:t};var i=function(t){this._cursor=new e.Cursor,this.boxes=[],t&&(this._raw=new DataView(t))};i.prototype.fetch=function(t){var n=this.fetchAll(t,!0);return n.length?n[0]:null},i.prototype.fetchAll=function(t,n){var e=[];return i._sweep.call(this,t,e,n),e},i.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var t=r.parse(this);if(void 0===t.type)break;this.boxes.push(t)}return this},i._sweep=function(t,n,e){for(var r in this.type&&this.type==t&&n.push(this),this.boxes){if(n.length&&e)return;i._sweep.call(this.boxes[r],t,n,e)}},i.prototype.write=function(){var t,n=0;for(t=0;t<this.boxes.length;t++)n+=this.boxes[t].getLength(!1);var e=new Uint8Array(n);for(this._rawo=new DataView(e.buffer),this.bytes=e,this._cursor.offset=0,t=0;t<this.boxes.length;t++)this.boxes[t].write();return e.buffer},i.prototype.append=function(t,n){e.Utils.appendBox(this,t,n)};var r=function(){this._cursor=new e.Cursor};r.parse=function(t){var n=new r;return n._offset=t._cursor.offset,n._root=t._root?t._root:t,n._raw=t._raw,n._parent=t,n._parseBox(),t._cursor.offset=n._raw.byteOffset+n._raw.byteLength,n},r.create=function(t){var n=new r;return n.type=t,n.boxes=[],n},r.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],r.prototype._boxProcessors={},r.prototype._procField=function(t,n,e){this._parsing?this[t]=this._readField(n,e):this._writeField(n,e,this[t])},r.prototype._procFieldArray=function(t,n,e,i){var r;if(this._parsing)for(this[t]=[],r=0;r<n;r++)this[t][r]=this._readField(e,i);else for(r=0;r<this[t].length;r++)this._writeField(e,i,this[t][r])},r.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},r.prototype._procEntries=function(t,n,e){var i;if(this._parsing)for(this[t]=[],i=0;i<n;i++)this[t].push({}),e.call(this,this[t][i]);else for(i=0;i<n;i++)e.call(this,this[t][i])},r.prototype._procSubEntries=function(t,n,e,i){var r;if(this._parsing)for(t[n]=[],r=0;r<e;r++)t[n].push({}),i.call(this,t[n][r]);else for(r=0;r<e;r++)i.call(this,t[n][r])},r.prototype._procEntryField=function(t,n,e,i){this._parsing?t[n]=this._readField(e,i):this._writeField(e,i,t[n])},r.prototype._procSubBoxes=function(t,n){var e;if(this._parsing)for(this[t]=[],e=0;e<n;e++)this[t].push(r.parse(this));else for(e=0;e<n;e++)this._rawo?this[t][e].write():this.size+=this[t][e].getLength()},r.prototype._readField=function(t,n){switch(t){case"uint":return this._readUint(n);case"int":return this._readInt(n);case"template":return this._readTemplate(n);case"string":return-1===n?this._readTerminatedString():this._readString(n);case"data":return this._readData(n);case"utf8":return this._readUTF8String();default:return-1}},r.prototype._readInt=function(t){var n=null,e=this._cursor.offset-this._raw.byteOffset;switch(t){case 8:n=this._raw.getInt8(e);break;case 16:n=this._raw.getInt16(e);break;case 32:n=this._raw.getInt32(e);break;case 64:var i=this._raw.getInt32(e),r=this._raw.getInt32(e+4);n=i*Math.pow(2,32)+r}return this._cursor.offset+=t>>3,n},r.prototype._readUint=function(t){var n,e,i=null,r=this._cursor.offset-this._raw.byteOffset;switch(t){case 8:i=this._raw.getUint8(r);break;case 16:i=this._raw.getUint16(r);break;case 24:i=((n=this._raw.getUint16(r))<<8)+(e=this._raw.getUint8(r+2));break;case 32:i=this._raw.getUint32(r);break;case 64:n=this._raw.getUint32(r),e=this._raw.getUint32(r+4),i=n*Math.pow(2,32)+e}return this._cursor.offset+=t>>3,i},r.prototype._readString=function(t){for(var n="",e=0;e<t;e++){var i=this._readUint(8);n+=String.fromCharCode(i)}return n},r.prototype._readTemplate=function(t){return this._readUint(t/2)+this._readUint(t/2)/Math.pow(2,t/2)},r.prototype._readTerminatedString=function(){for(var t="";this._cursor.offset-this._offset<this._raw.byteLength;){var n=this._readUint(8);if(0===n)break;t+=String.fromCharCode(n)}return t},r.prototype._readData=function(t){var n=t>0?t:this._raw.byteLength-(this._cursor.offset-this._offset);if(n>0){var e=new Uint8Array(this._raw.buffer,this._cursor.offset,n);return this._cursor.offset+=n,e}return null},r.prototype._readUTF8String=function(){var t=this._raw.byteLength-(this._cursor.offset-this._offset),n=null;return t>0&&(n=new DataView(this._raw.buffer,this._cursor.offset,t),this._cursor.offset+=t),n?e.Utils.dataViewToString(n):n},r.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},r.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},r.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(r.parse(this))},r.prototype.append=function(t,n){e.Utils.appendBox(this,t,n)},r.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var t=0;t<this.boxes.length;t++)this.size+=this.boxes[t].getLength();return this._data&&this._writeData(this._data),this.size},r.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var t=0;t<this.boxes.length;t++)this.boxes[t].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},r.prototype._writeInt=function(t,n){if(this._rawo){var e=this._cursor.offset-this._rawo.byteOffset;switch(t){case 8:this._rawo.setInt8(e,n);break;case 16:this._rawo.setInt16(e,n);break;case 32:this._rawo.setInt32(e,n);break;case 64:var i=Math.floor(n/Math.pow(2,32)),r=n-i*Math.pow(2,32);this._rawo.setUint32(e,i),this._rawo.setUint32(e+4,r)}this._cursor.offset+=t>>3}else this.size+=t>>3},r.prototype._writeUint=function(t,n){if(this._rawo){var e,i,r=this._cursor.offset-this._rawo.byteOffset;switch(t){case 8:this._rawo.setUint8(r,n);break;case 16:this._rawo.setUint16(r,n);break;case 24:i=255&n,this._rawo.setUint16(r,e=(16776960&n)>>8),this._rawo.setUint8(r+2,i);break;case 32:this._rawo.setUint32(r,n);break;case 64:i=n-(e=Math.floor(n/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(r,e),this._rawo.setUint32(r+4,i)}this._cursor.offset+=t>>3}else this.size+=t>>3},r.prototype._writeString=function(t,n){for(var e=0;e<t;e++)this._writeUint(8,n.charCodeAt(e))},r.prototype._writeTerminatedString=function(t){if(0!==t.length){for(var n=0;n<t.length;n++)this._writeUint(8,t.charCodeAt(n));this._writeUint(8,0)}},r.prototype._writeTemplate=function(t,n){var e=Math.floor(n),i=(n-e)*Math.pow(2,t/2);this._writeUint(t/2,e),this._writeUint(t/2,i)},r.prototype._writeData=function(t){if(t)if(this._rawo){if(t instanceof Array){for(var n=this._cursor.offset-this._rawo.byteOffset,e=0;e<t.length;e++)this._rawo.setInt8(n+e,t[e]);this._cursor.offset+=t.length}t instanceof Uint8Array&&(this._root.bytes.set(t,this._cursor.offset),this._cursor.offset+=t.length)}else this.size+=t.length},r.prototype._writeUTF8String=function(t){var n=e.Utils.utf8ToByteArray(t);if(this._rawo)for(var i=new DataView(this._rawo.buffer,this._cursor.offset,n.length),r=0;r<n.length;r++)i.setUint8(r,n[r]);else this.size+=n.length},r.prototype._writeField=function(t,n,e){switch(t){case"uint":this._writeUint(n,e);break;case"int":this._writeInt(n,e);break;case"template":this._writeTemplate(n,e);break;case"string":-1==n?this._writeTerminatedString(e):this._writeString(n,e);break;case"data":this._writeData(e);break;case"utf8":this._writeUTF8String(e)}},r.prototype._boxProcessors.avc1=r.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},r.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},r.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(t){this._procEntryField(t,"segment_duration","uint",1===this.version?64:32),this._procEntryField(t,"media_time","int",1===this.version?64:32),this._procEntryField(t,"media_rate_integer","int",16),this._procEntryField(t,"media_rate_fraction","int",16)}))},r.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},r.prototype._boxProcessors.free=r.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},r.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},r.prototype._boxProcessors.ftyp=r.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var t=-1;this._parsing&&(t=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",t,"string",4)},r.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},r.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},r.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},r.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},r.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},r.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},r.prototype._boxProcessors.mp4a=r.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},r.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},r.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},r.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},r.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},r.prototype._boxProcessors.sdtp=function(){this._procFullBox();var t=-1;this._parsing&&(t=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",t,"uint",8)},r.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,(function(t){this._parsing||(t.reference=(1&t.reference_type)<<31,t.reference|=2147483647&t.referenced_size,t.sap=(1&t.starts_with_SAP)<<31,t.sap|=(3&t.SAP_type)<<28,t.sap|=268435455&t.SAP_delta_time),this._procEntryField(t,"reference","uint",32),this._procEntryField(t,"subsegment_duration","uint",32),this._procEntryField(t,"sap","uint",32),this._parsing&&(t.reference_type=t.reference>>31&1,t.referenced_size=2147483647&t.reference,t.starts_with_SAP=t.sap>>31&1,t.SAP_type=t.sap>>28&7,t.SAP_delta_time=268435455&t.sap)}))},r.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},r.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,(function(t){this._procEntryField(t,"ranges_count","uint",32),this._procSubEntries(t,"ranges",t.ranges_count,(function(t){this._procEntryField(t,"level","uint",8),this._procEntryField(t,"range_size","uint",24)}))}))},r.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},r.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(t){this._procEntryField(t,"sample_delta","uint",32),this._procEntryField(t,"subsample_count","uint",16),this._procSubEntries(t,"subsamples",t.subsample_count,(function(t){this._procEntryField(t,"subsample_size","uint",1===this.version?32:16),this._procEntryField(t,"subsample_priority","uint",8),this._procEntryField(t,"discardable","uint",8),this._procEntryField(t,"codec_specific_parameters","uint",32)}))}))},r.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},r.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},r.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},r.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,(function(t){this._procEntryField(t,"time","uint",1===this.version?64:32),this._procEntryField(t,"moof_offset","uint",1===this.version?64:32),this._procEntryField(t,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(t,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(t,"sample_number","uint",8*(this.length_size_of_sample_num+1))}))},r.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},r.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},r.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,(function(t){256&this.flags&&this._procEntryField(t,"sample_duration","uint",32),512&this.flags&&this._procEntryField(t,"sample_size","uint",32),1024&this.flags&&this._procEntryField(t,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(t,"sample_composition_time_offset",1===this.version?"int":"uint",32)}))},r.prototype._boxProcessors["url "]=r.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},r.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},r.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},r.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},r.prototype._boxProcessors.vtte=function(){}})),k=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(n,e,i){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.lastCompletedOffset=n,this.found=e,this.size=i}})),O=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(y),i=a(C),r=a(h),o=a(E),u=a(k);function a(t){return t&&t.__esModule?t:{default:t}}function s(){var t,n=void 0,r=this.context;function a(t){if(!t)return null;void 0===t.fileStart&&(t.fileStart=0);var n=o.default.parseBuffer(t),e=(0,i.default)(r).create();return e.setData(n),e}function s(t,n){return t[n+3]>>>0|t[n+2]<<8>>>0|t[n+1]<<16>>>0|t[n]<<24>>>0}function f(t,n){return String.fromCharCode(t[n++])+String.fromCharCode(t[n++])+String.fromCharCode(t[n++])+String.fromCharCode(t[n])}return t={parse:a,findLastTopIsoBoxCompleted:function(t,n,e){if(void 0===e&&(e=0),!n||e+8>=n.byteLength)return new u.default(0,!1);for(var i=n instanceof ArrayBuffer?new Uint8Array(n):n,r=void 0,o=0;e<i.byteLength;){var a=s(i,e),c=f(i,e+4);if(0===a)break;e+a<=i.byteLength&&(t.indexOf(c)>=0?r=new u.default(e,!0,a):o=e+a),e+=a}return r||new u.default(o,!1)},getMediaTimescaleFromMoov:function(t){var n=a(t),e=n?n.getBox("mdhd"):void 0;return e?e.timescale:NaN},getSamplesInfo:function(t){if(!t||0===t.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var n,e,i=a(t),r=i.getBoxes("moof"),o=i.getBoxes("mfhd"),u=void 0,s=void 0,f=void 0,c=void 0,l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0,b=void 0;e=i.getBoxes("moof").length,n=o[o.length-1].sequence_number,s=0,l=[];var M=-1,T=-1;for(g=0;g<r.length;g++){var N=r[g],_=N.getChildBoxes("traf");for(v=0;v<_.length;v++){var S=_[v],C=S.getChildBox("tfhd"),E=S.getChildBox("tfdt");c=E.baseMediaDecodeTime;var k=S.getChildBoxes("trun"),O=S.getChildBoxes("subs");for(p=0;p<k.length;p++){var R=k[p];for(s=R.sample_count,w=(C.base_data_offset||0)+(R.data_offset||0),h=0;h<s;h++){var I={dts:c,cts:c+(void 0!==(d=R.samples[h]).sample_composition_time_offset?d.sample_composition_time_offset:0),duration:u=void 0!==d.sample_duration?d.sample_duration:C.default_sample_duration,offset:N.offset+w,size:f=void 0!==d.sample_size?d.sample_size:C.default_sample_size,subSizes:[f]};if(O)for(m=0;m<O.length;m++){var D=O[m];if(M<D.entry_count-1&&h>T&&(M++,T+=D.entries[M].sample_delta),h==T){I.subSizes=[];var x=D.entries[M];for(y=0;y<x.subsample_count;y++)I.subSizes.push(x.subsamples[y].subsample_size)}}l.push(I),w+=f,c+=u}}b=c-E.baseMediaDecodeTime}}return{sampleList:l,lastSequenceNumber:n,totalDuration:b,numSequences:e}},findInitRange:function(t){var e=null,i=a(t);if(!i)return e;var r=i.getBox("ftyp"),o=i.getBox("moov");return n.debug("Searching for initialization."),o&&o.isComplete&&n.debug("Found the initialization.  Range: "+(e=(r?r.offset:o.offset)+"-"+(o.offset+o.size-1))),e}},n=(0,e.default)(r).getInstance().getLogger(t),t}s.__dashjs_factory_name="BoxParser",n.default=r.default.getSingletonFactory(s)})),R=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.checkParameterType=function(t,n){if((void 0===t?"undefined":e(t))!==n)throw r.default.BAD_ARGUMENT_ERROR},n.checkInteger=function(t){if(null===t||isNaN(t)||t%1!=0)throw r.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"},n.checkRange=function(t,n,e){if(t<n||t>e)throw r.default.BAD_ARGUMENT_ERROR+" : argument out of range"},n.checkIsVideoOrAudioType=function(t){if("string"!=typeof t||t!==r.default.AUDIO&&t!==r.default.VIDEO)throw r.default.BAD_ARGUMENT_ERROR};var i,r=(i=c)&&i.__esModule?i:{default:i}})),I=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(){return{customTimeRangeArray:[],length:0,add:function(t,n){var e=0;for(e=0;e<this.customTimeRangeArray.length&&t>this.customTimeRangeArray[e].start;e++);for(this.customTimeRangeArray.splice(e,0,{start:t,end:n}),e=0;e<this.customTimeRangeArray.length-1;e++)this.mergeRanges(e,e+1)&&e--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(t,n){for(var e=0;e<this.customTimeRangeArray.length;e++)if(t<=this.customTimeRangeArray[e].start&&n>=this.customTimeRangeArray[e].end)this.customTimeRangeArray.splice(e,1),e--;else{if(t>this.customTimeRangeArray[e].start&&n<this.customTimeRangeArray[e].end){this.customTimeRangeArray.splice(e+1,0,{start:n,end:this.customTimeRangeArray[e].end}),this.customTimeRangeArray[e].end=t;break}t>this.customTimeRangeArray[e].start&&t<this.customTimeRangeArray[e].end?this.customTimeRangeArray[e].end=t:n>this.customTimeRangeArray[e].start&&n<this.customTimeRangeArray[e].end&&(this.customTimeRangeArray[e].start=n)}this.length=this.customTimeRangeArray.length},mergeRanges:function(t,n){var e=this.customTimeRangeArray[t],i=this.customTimeRangeArray[n];return e.start<=i.start&&i.start<=e.end&&e.end<=i.end?(e.end=i.end,this.customTimeRangeArray.splice(n,1),!0):i.start<=e.start&&e.start<=i.end&&i.end<=e.end?(e.start=i.start,this.customTimeRangeArray.splice(n,1),!0):i.start<=e.start&&e.start<=i.end&&e.end<=i.end?(this.customTimeRangeArray.splice(t,1),!0):e.start<=i.start&&i.start<=e.end&&i.end<=e.end&&(this.customTimeRangeArray.splice(n,1),!0)},start:function(t){return(0,R.checkInteger)(t),t>=this.customTimeRangeArray.length||t<0?NaN:this.customTimeRangeArray[t].start},end:function(t){return(0,R.checkInteger)(t),t>=this.customTimeRangeArray.length||t<0?NaN:this.customTimeRangeArray[t].end}}}r.__dashjs_factory_name="CustomTimeRanges",n.default=i.default.getClassFactory(r)})),D=o((function(t,n){!function(t){t.ns_tt="http://www.w3.org/ns/ttml",t.ns_tts="http://www.w3.org/ns/ttml#styling",t.ns_ttp="http://www.w3.org/ns/ttml#parameter",t.ns_xml="http://www.w3.org/XML/1998/namespace",t.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",t.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",t.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",t.ns_ebutts="urn:ebu:tt:style"}(n)})),x=o((function(t,n){!function(t){var n=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,e=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};t.parseColor=function(t){var o,u=null,a=r[t.toLowerCase()];return void 0!==a?u=a:null!==(o=n.exec(t))?u=[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16),void 0!==o[4]?parseInt(o[4],16):255]:null!==(o=e.exec(t))?u=[parseInt(o[1]),parseInt(o[2]),parseInt(o[3]),255]:null!==(o=i.exec(t))&&(u=[parseInt(o[1]),parseInt(o[2]),parseInt(o[3]),parseInt(o[4])]),u};var o=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;t.parseLength=function(t){var n,e=null;return null!==(n=o.exec(t))&&(e={value:parseFloat(n[1]),unit:n[2]}),e},t.parseTextShadow=function(n){var e=n.split(","),i=[];for(var r in e){var o=e[r].split(" ");if(1===o.length&&"none"===o[0])return"none";if(o.length>1&&o.length<5){var u=[null,null,null,null],a=t.parseLength(o.shift());if(null===a)return null;if(u[0]=a,null===(a=t.parseLength(o.shift())))return null;if(u[1]=a,0===o.length){i.push(u);continue}if(null!==(a=t.parseLength(o[0]))&&(u[2]=a,o.shift()),0===o.length){i.push(u);continue}var s=t.parseColor(o[0]);if(null===s)return null;u[3]=s,i.push(u)}}return i},t.parsePosition=function(n){var e=n.split(" "),i=function(t){return"center"===t||"left"===t||"top"===t||"bottom"===t||"right"===t};if(e.length>4)return null;for(var r in e)if(!i(e[r])){var o=t.parseLength(e[r]);if(null===o)return null;e[r]=o}for(var u={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},a=0;a<e.length;){var s=e[a++];if(i(s)){var f={value:0,unit:"%"};2!==e.length&&a<e.length&&!i(e[a])&&(f=e[a++]),"right"===s?(u.h.edge=s,u.h.offset=f):"bottom"===s?(u.v.edge=s,u.v.offset=f):"left"===s?u.h.offset=f:"top"===s&&(u.v.offset=f)}else{if(1!==e.length&&2!==e.length)return null;1===a?u.h.offset=s:u.v.offset=s}}return u},t.ComputedLength=function(t,n){this.rw=t,this.rh=n},t.ComputedLength.prototype.toUsedLength=function(t,n){return t*this.rw+n*this.rh},t.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh},t.toComputedLength=function(n,e,i,r,o,u){return"%"===e&&r?new t.ComputedLength(r.rw*n/100,r.rh*n/100):"em"===e&&i?new t.ComputedLength(i.rw*n,i.rh*n):"c"===e&&o?new t.ComputedLength(n*o.rw,n*o.rh):"px"===e&&u?new t.ComputedLength(n*u.rw,n*u.rh):"rh"===e?new t.ComputedLength(0,n/100):"rw"===e?new t.ComputedLength(n/100,0):null}}(n)})),A=o((function(t,n){!function(t,n,e){function i(t,n,e,i,r,o,u,a){this.name=n,this.ns=t,this.qname=t+" "+n,this.inherit=r,this.animatable=o,this.initial=e,this.applies=i,this.parse=u,this.compute=a}for(var r in t.all=[new i(n.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,e.parseColor,null),new i(n.ns_tts,"color","white",["span"],!0,!0,e.parseColor,null),new i(n.ns_tts,"direction","ltr",["p","span"],!0,!0,(function(t){return t}),null),new i(n.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,(function(t){return t}),null),new i(n.ns_tts,"displayAlign","before",["region"],!1,!0,(function(t){return t}),null),new i(n.ns_tts,"extent","auto",["tt","region"],!1,!0,(function(t){if("auto"===t)return t;var n=t.split(" ");if(2!==n.length)return null;var i=e.parseLength(n[0]),r=e.parseLength(n[1]);return r&&i?{h:r,w:i}:null}),(function(t,n,i,r){var o,u;if("auto"===r)o=new e.ComputedLength(0,1);else if(null===(o=e.toComputedLength(r.h.value,r.h.unit,null,t.dimensions.h,null,t.pxLength.h)))return null;if("auto"===r)u=new e.ComputedLength(1,0);else if(null===(u=e.toComputedLength(r.w.value,r.w.unit,null,t.dimensions.w,null,t.pxLength.w)))return null;return{h:o,w:u}})),new i(n.ns_tts,"fontFamily","default",["span"],!0,!0,(function(t){var n=t.split(","),e=[];for(var i in n)"'"!==n[i].charAt(0)&&'"'!==n[i].charAt(0)?e.push("default"===n[i]?"monospaceSerif":n[i]):e.push(n[i]);return e}),null),new i(n.ns_tts,"shear","0%",["p"],!0,!0,e.parseLength,(function(t,n,e,i){return"%"!==i.unit?null:Math.abs(i.value)>100?100*Math.sign(i.value):i.value})),new i(n.ns_tts,"fontSize","1c",["span"],!0,!0,e.parseLength,(function(n,i,r,o){return e.toComputedLength(o.value,o.unit,null!==i?i.styleAttrs[t.byName.fontSize.qname]:n.cellLength.h,null!==i?i.styleAttrs[t.byName.fontSize.qname]:n.cellLength.h,n.cellLength.h,n.pxLength.h)})),new i(n.ns_tts,"fontStyle","normal",["span"],!0,!0,(function(t){return t}),null),new i(n.ns_tts,"fontWeight","normal",["span"],!0,!0,(function(t){return t}),null),new i(n.ns_tts,"lineHeight","normal",["p"],!0,!0,(function(t){return"normal"===t?t:e.parseLength(t)}),(function(n,i,r,o){var u;if("normal"===o)u=o;else if(null===(u=e.toComputedLength(o.value,o.unit,r.styleAttrs[t.byName.fontSize.qname],r.styleAttrs[t.byName.fontSize.qname],n.cellLength.h,n.pxLength.h)))return null;return u})),new i(n.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new i(n.ns_tts,"origin","auto",["region"],!1,!0,(function(t){if("auto"===t)return t;var n=t.split(" ");if(2!==n.length)return null;var i=e.parseLength(n[0]),r=e.parseLength(n[1]);return r&&i?{h:r,w:i}:null}),(function(t,n,i,r){var o,u;if("auto"===r)o=new e.ComputedLength(0,0);else if(null===(o=e.toComputedLength(r.h.value,r.h.unit,null,t.dimensions.h,null,t.pxLength.h)))return null;if("auto"===r)u=new e.ComputedLength(0,0);else if(null===(u=e.toComputedLength(r.w.value,r.w.unit,null,t.dimensions.w,null,t.pxLength.w)))return null;return{h:o,w:u}})),new i(n.ns_tts,"overflow","hidden",["region"],!1,!0,(function(t){return t}),null),new i(n.ns_tts,"padding","0px",["region"],!1,!0,(function(t){var n=t.split(" ");if(n.length>4)return null;var i=[];for(var r in n){var o=e.parseLength(n[r]);if(!o)return null;i.push(o)}return i}),(function(n,i,r,o){var u;if(1===o.length)u=[o[0],o[0],o[0],o[0]];else if(2===o.length)u=[o[0],o[1],o[0],o[1]];else if(3===o.length)u=[o[0],o[1],o[2],o[1]];else{if(4!==o.length)return null;u=[o[0],o[1],o[2],o[3]]}var a=r.styleAttrs[t.byName.writingMode.qname];if("lrtb"===a||"lr"===a)u=[u[0],u[3],u[2],u[1]];else if("rltb"===a||"rl"===a)u=[u[0],u[1],u[2],u[3]];else if("tblr"===a)u=[u[3],u[0],u[1],u[2]];else{if("tbrl"!==a&&"tb"!==a)return null;u=[u[3],u[2],u[1],u[0]]}var s=[];for(var f in u)if(0===u[f].value)s[f]=new e.ComputedLength(0,0);else if(s[f]=e.toComputedLength(u[f].value,u[f].unit,r.styleAttrs[t.byName.fontSize.qname],"0"===f||"2"===f?r.styleAttrs[t.byName.extent.qname].h:r.styleAttrs[t.byName.extent.qname].w,"0"===f||"2"===f?n.cellLength.h:n.cellLength.w,"0"===f||"2"===f?n.pxLength.h:n.pxLength.w),null===s[f])return null;return s})),new i(n.ns_tts,"position","top left",["region"],!1,!0,(function(t){return e.parsePosition(t)}),(function(n,i,r,o){var u,a;return null===(u=e.toComputedLength(o.v.offset.value,o.v.offset.unit,null,new e.ComputedLength(-r.styleAttrs[t.byName.extent.qname].h.rw,n.dimensions.h.rh-r.styleAttrs[t.byName.extent.qname].h.rh),null,n.pxLength.h))?null:("bottom"===o.v.edge&&(u=new e.ComputedLength(-u.rw-r.styleAttrs[t.byName.extent.qname].h.rw,n.dimensions.h.rh-u.rh-r.styleAttrs[t.byName.extent.qname].h.rh)),a=e.toComputedLength(o.h.offset.value,o.h.offset.unit,null,new e.ComputedLength(n.dimensions.w.rw-r.styleAttrs[t.byName.extent.qname].w.rw,-r.styleAttrs[t.byName.extent.qname].w.rh),null,n.pxLength.w),null===u?null:("right"===o.h.edge&&(a=new e.ComputedLength(n.dimensions.w.rw-a.rw-r.styleAttrs[t.byName.extent.qname].w.rw,-a.rh-r.styleAttrs[t.byName.extent.qname].w.rh)),{h:u,w:a}))})),new i(n.ns_tts,"ruby","none",["span"],!1,!0,(function(t){return t}),null),new i(n.ns_tts,"rubyAlign","center",["span"],!0,!0,(function(t){return"center"!==t&&"spaceAround"!==t?null:t}),null),new i(n.ns_tts,"rubyPosition","outside",["span"],!0,!0,(function(t){return t}),null),new i(n.ns_tts,"rubyReserve","none",["p"],!0,!0,(function(t){var n=t.split(" "),i=[null,null];if(0===n.length||n.length>2)return null;if("none"!==n[0]&&"both"!==n[0]&&"after"!==n[0]&&"before"!==n[0]&&"outside"!==n[0])return null;if(i[0]=n[0],2===n.length&&"none"!==n[0]){var r=e.parseLength(n[1]);if(!r)return null;i[1]=r}return i}),(function(n,i,r,o){if("none"===o[0])return o;var u;return null===(u=null===o[1]?new e.ComputedLength(.5*r.styleAttrs[t.byName.fontSize.qname].rw,.5*r.styleAttrs[t.byName.fontSize.qname].rh):e.toComputedLength(o[1].value,o[1].unit,r.styleAttrs[t.byName.fontSize.qname],r.styleAttrs[t.byName.fontSize.qname],n.cellLength.h,n.pxLength.h))?null:[o[0],u]})),new i(n.ns_tts,"showBackground","always",["region"],!1,!0,(function(t){return t}),null),new i(n.ns_tts,"textAlign","start",["p"],!0,!0,(function(t){return t}),(function(t,n,e,i){return"left"===i?"start":"right"===i?"end":i})),new i(n.ns_tts,"textCombine","none",["span"],!0,!0,(function(t){var n=t.split(" ");return 1!==n.length||"none"!==n[0]&&"all"!==n[0]?null:[n[0]]}),null),new i(n.ns_tts,"textDecoration","none",["span"],!0,!0,(function(t){return t.split(" ")}),null),new i(n.ns_tts,"textEmphasis","none",["span"],!0,!0,(function(t){var n=t.split(" "),i={style:null,symbol:null,color:null,position:null};for(var r in n)if("none"===n[r]||"auto"===n[r])i.style=n[r];else if("filled"===n[r]||"open"===n[r])i.style=n[r];else if("circle"===n[r]||"dot"===n[r]||"sesame"===n[r])i.symbol=n[r];else if("current"===n[r])i.color=n[r];else if("outside"===n[r]||"before"===n[r]||"after"===n[r])i.position=n[r];else if(i.color=e.parseColor(n[r]),null===i.color)return null;return null==i.style&&null==i.symbol?i.style="auto":(i.symbol=i.symbol||"circle",i.style=i.style||"filled"),i.position=i.position||"outside",i.color=i.color||"current",i}),null),new i(n.ns_tts,"textOutline","none",["span"],!0,!0,(function(t){if("none"===t)return t;var n={},i=t.split(" ");if(0===i.length||i.length>2)return null;var r=e.parseColor(i[0]);if(n.color=r,null!==r&&i.shift(),1!==i.length)return null;var o=e.parseLength(i[0]);return o?(n.thickness=o,n):null}),(function(n,i,r,o){if("none"===o)return o;var u={};return u.color=null===o.color?r.styleAttrs[t.byName.color.qname]:o.color,u.thickness=e.toComputedLength(o.thickness.value,o.thickness.unit,r.styleAttrs[t.byName.fontSize.qname],r.styleAttrs[t.byName.fontSize.qname],n.cellLength.h,n.pxLength.h),null===u.thickness?null:u})),new i(n.ns_tts,"textShadow","none",["span"],!0,!0,e.parseTextShadow,(function(n,i,r,o){if("none"===o)return o;var u=[];for(var a in o){var s={};if(s.x_off=e.toComputedLength(o[a][0].value,o[a][0].unit,null,r.styleAttrs[t.byName.fontSize.qname],null,n.pxLength.w),null===s.x_off)return null;if(s.y_off=e.toComputedLength(o[a][1].value,o[a][1].unit,null,r.styleAttrs[t.byName.fontSize.qname],null,n.pxLength.h),null===s.y_off)return null;if(null===o[a][2])s.b_radius=0;else if(s.b_radius=e.toComputedLength(o[a][2].value,o[a][2].unit,null,r.styleAttrs[t.byName.fontSize.qname],null,n.pxLength.h),null===s.b_radius)return null;s.color=null===o[a][3]?r.styleAttrs[t.byName.color.qname]:o[a][3],u.push(s)}return u})),new i(n.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,(function(t){return t}),null),new i(n.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,(function(t){return t}),null),new i(n.ns_tts,"wrapOption","wrap",["span"],!0,!0,(function(t){return t}),null),new i(n.ns_tts,"writingMode","lrtb",["region"],!1,!0,(function(t){return t}),null),new i(n.ns_tts,"zIndex","auto",["region"],!1,!0,(function(t){var n;return"auto"===t?n=t:(n=parseInt(t),isNaN(n)&&(n=null)),n}),null),new i(n.ns_ebutts,"linePadding","0c",["p"],!0,!1,e.parseLength,(function(t,n,i,r){return e.toComputedLength(r.value,r.unit,null,null,t.cellLength.w,null)})),new i(n.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,(function(t){return t}),null),new i(n.ns_smpte,"backgroundImage",null,["div"],!1,!1,(function(t){return t}),null),new i(n.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,(function(t){return"true"===t}),null),new i(n.ns_itts,"fillLineGap","false",["p"],!0,!0,(function(t){return"true"===t}),null)],t.byQName={},t.all)t.byQName[t.all[r].qname]=t.all[r];for(var o in t.byName={},t.all)t.byName[t.all[o].name]=t.all[o]}(n,"undefined"==typeof imscNames?D:imscNames,"undefined"==typeof imscUtils?x:imscUtils)})),j=o((function(t,n){!function(t,n,e,i){t.generateISD=function(t,n,e){var i=new s(t),r={};for(var u in t.head.layout.regions){var a=o(t,n,t.head.layout.regions[u],t.body,null,"",t.head.layout.regions[u],e,r);null!==a&&i.contents.push(a.element)}return i};var r=[e.byName.color.qname,e.byName.textCombine.qname,e.byName.textDecoration.qname,e.byName.textEmphasis.qname,e.byName.textOutline.qname,e.byName.textShadow.qname];function o(t,n,s,l,d,h,v,p,g){if(n<v.begin||n>=v.end)return null;var m="regionID"in v&&""!==v.regionID?v.regionID:h;if(null!==d&&m!==s.id&&(!("contents"in v)||"contents"in v&&0===v.contents.length||""!==m))return null;var y=new f(v);for(var w in v.sets)n<v.sets[w].begin||n>=v.sets[w].end||(y.styleAttrs[v.sets[w].qname]=v.sets[w].value);var b,M={};for(var T in y.styleAttrs)if(M[T]=!0,T===e.byName.writingMode.qname&&!(e.byName.direction.qname in y.styleAttrs)){var N=y.styleAttrs[T];"lrtb"===N||"lr"===N?y.styleAttrs[e.byName.direction.qname]="ltr":"rltb"!==N&&"rl"!==N||(y.styleAttrs[e.byName.direction.qname]="rtl")}if(null!==d)for(var _ in e.all){var S=e.all[_];if(S.qname===e.byName.textDecoration.qname){var C=d.styleAttrs[S.qname],E=y.styleAttrs[S.qname],k=[];void 0===E?k=C:-1===E.indexOf("none")?((-1===E.indexOf("noUnderline")&&-1!==C.indexOf("underline")||-1!==E.indexOf("underline"))&&k.push("underline"),(-1===E.indexOf("noLineThrough")&&-1!==C.indexOf("lineThrough")||-1!==E.indexOf("lineThrough"))&&k.push("lineThrough"),(-1===E.indexOf("noOverline")&&-1!==C.indexOf("overline")||-1!==E.indexOf("overline"))&&k.push("overline")):k.push("none"),y.styleAttrs[S.qname]=k}else if(S.qname!==e.byName.fontSize.qname||S.qname in y.styleAttrs||"span"!==y.kind||"textContainer"!==y.styleAttrs[e.byName.ruby.qname])if(S.qname!==e.byName.fontSize.qname||S.qname in y.styleAttrs||"span"!==y.kind||"text"!==y.styleAttrs[e.byName.ruby.qname])S.inherit&&S.qname in d.styleAttrs&&!(S.qname in y.styleAttrs)&&(y.styleAttrs[S.qname]=d.styleAttrs[S.qname]);else{var O=d.styleAttrs[e.byName.fontSize.qname];y.styleAttrs[S.qname]="textContainer"===d.styleAttrs[e.byName.ruby.qname]?O:new i.ComputedLength(.5*O.rw,.5*O.rh)}else{var R=d.styleAttrs[e.byName.fontSize.qname];y.styleAttrs[S.qname]=new i.ComputedLength(.5*R.rw,.5*R.rh)}}for(var I in e.all){var D=e.all[I];if(!(D.qname in y.styleAttrs)&&!(D.qname===e.byName.position.qname&&e.byName.origin.qname in y.styleAttrs||D.qname===e.byName.origin.qname&&e.byName.position.qname in y.styleAttrs)){var x=t.head.styling.initials[D.qname]||D.initial;("region"===y.kind||!1===D.inherit&&null!==x)&&(y.styleAttrs[D.qname]=D.parse(x),M[D.qname]=!0)}}for(var A in e.all){var j=e.all[A];if(j.qname in M&&null!==j.compute){var F=j.compute(t,d,y,y.styleAttrs[j.qname],g);null!==F?y.styleAttrs[j.qname]=F:(y.styleAttrs[j.qname]=j.compute(t,d,y,j.parse(j.initial),g),c(p,"Style '"+j.qname+"' on element '"+y.kind+"' cannot be computed"))}}if("none"===y.styleAttrs[e.byName.display.qname])return null;for(var P in null===d?b=null===l?[]:[l]:"contents"in v&&(b=v.contents),b){var B=o(t,n,s,l,y,m,b[P],p,g);null!==B&&y.contents.push(B.element)}for(var L in y.styleAttrs){var U=!1;if("span"===y.kind){var q=y.styleAttrs[e.byName.ruby.qname];(U=("container"===q||"textContainer"===q||"baseContainer"===q)&&-1!==r.indexOf(L))||(U="container"!==q&&L===e.byName.rubyAlign.qname),U||(U=!("textContainer"===q||"text"===q)&&L===e.byName.rubyPosition.qname)}U||(U=-1===e.byQName[L].applies.indexOf(y.kind)),U&&delete y.styleAttrs[L]}if("span"===y.kind&&y.text&&"default"===y.space){var z=y.text.replace(/[\t\r\n ]+/g," ");y.text=z}if("p"===y.kind){var H=[];u(y,H);for(var K=0,V="after_br",W=0;;)if("after_br"===V)K>=H.length||"br"===H[K].kind?(V="before_br",W=K,K--):("preserve"!==H[K].space&&(H[K].text=H[K].text.replace(/^[\t\r\n ]+/g,"")),H[K].text.length>0?(V="looking_br",K++):H.splice(K,1));else if("before_br"===V)if(K<0||"br"===H[K].kind){if(V="after_br",(K=W+1)>=H.length)break}else if("preserve"!==H[K].space&&(H[K].text=H[K].text.replace(/[\t\r\n ]+$/g,"")),H[K].text.length>0){if(V="after_br",(K=W+1)>=H.length)break}else H.splice(K,1),K--;else K>=H.length||"br"===H[K].kind?(V="before_br",W=K,K--):K++;a(y)}return"div"===y.kind&&e.byName.backgroundImage.qname in y.styleAttrs||"br"===y.kind||"image"===y.kind||"contents"in y&&y.contents.length>0||"span"===y.kind&&null!==y.text||"region"===y.kind&&"always"===y.styleAttrs[e.byName.showBackground.qname]?{region_id:m,element:y}:null}function u(t,n){if("contents"in t)for(var e in t.contents)u(t.contents[e],n);else"span"!==t.kind&&"br"!==t.kind||n.push(t)}function a(t){if("br"===t.kind)return!1;if("text"in t)return 0===t.text.length;if("contents"in t){for(var n=t.contents.length;n--;)a(t.contents[n])&&t.contents.splice(n,1);return 0===t.contents.length}}function s(t){this.contents=[],this.aspectRatio=t.aspectRatio}function f(t){for(var n in this.kind=t.kind||"region",t.id&&(this.id=t.id),this.styleAttrs={},t.styleAttrs)this.styleAttrs[n]=t.styleAttrs[n];"src"in t&&(this.src=t.src),"type"in t&&(this.type=t.type),"text"in t?this.text=t.text:("region"===this.kind||"contents"in t)&&(this.contents=[]),"space"in t&&(this.space=t.space)}function c(t,n){if(t&&t.error&&t.error(n))throw n}}(n,"undefined"==typeof imscNames||imscNames,"undefined"==typeof imscStyles?A:imscStyles,"undefined"==typeof imscUtils?x:imscUtils)}));const F="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};var P=[],B=[],L="undefined"!=typeof Uint8Array?Uint8Array:Array,U=!1;function q(){U=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,e=t.length;n<e;++n)P[n]=t[n],B[t.charCodeAt(n)]=n;B["-".charCodeAt(0)]=62,B["_".charCodeAt(0)]=63}function z(t,n,e){for(var i,r=[],o=n;o<e;o+=3)r.push(P[(i=(t[o]<<16)+(t[o+1]<<8)+t[o+2])>>18&63]+P[i>>12&63]+P[i>>6&63]+P[63&i]);return r.join("")}function H(t,n,e,i,r){var o,u,a=8*r-i-1,s=(1<<a)-1,f=s>>1,c=-7,l=e?r-1:0,d=e?-1:1,h=t[n+l];for(l+=d,o=h&(1<<-c)-1,h>>=-c,c+=a;c>0;o=256*o+t[n+l],l+=d,c-=8);for(u=o&(1<<-c)-1,o>>=-c,c+=i;c>0;u=256*u+t[n+l],l+=d,c-=8);if(0===o)o=1-f;else{if(o===s)return u?NaN:1/0*(h?-1:1);u+=Math.pow(2,i),o-=f}return(h?-1:1)*u*Math.pow(2,o-i)}function K(t,n,e,i,r,o){var u,a,s,f=8*o-r-1,c=(1<<f)-1,l=c>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,h=i?0:o-1,v=i?1:-1,p=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(a=isNaN(n)?1:0,u=c):(u=Math.floor(Math.log(n)/Math.LN2),n*(s=Math.pow(2,-u))<1&&(u--,s*=2),(n+=u+l>=1?d/s:d*Math.pow(2,1-l))*s>=2&&(u++,s/=2),u+l>=c?(a=0,u=c):u+l>=1?(a=(n*s-1)*Math.pow(2,r),u+=l):(a=n*Math.pow(2,l-1)*Math.pow(2,r),u=0));r>=8;t[e+h]=255&a,h+=v,a/=256,r-=8);for(u=u<<r|a,f+=r;f>0;t[e+h]=255&u,h+=v,u/=256,f-=8);t[e+h-v]|=128*p}var V={}.toString,W=Array.isArray||function(t){return"[object Array]"==V.call(t)};function G(){return X.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function $(t,n){if(G()<n)throw new RangeError("Invalid typed array length");return X.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n)).__proto__=X.prototype:(null===t&&(t=new X(n)),t.length=n),t}function X(t,n,e){if(!(X.TYPED_ARRAY_SUPPORT||this instanceof X))return new X(t,n,e);if("number"==typeof t){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return Y(this,t)}return Q(this,t,n,e)}function Q(t,n,e,i){if("number"==typeof n)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer?function(t,n,e,i){if(e<0||n.byteLength<e)throw new RangeError("'offset' is out of bounds");if(n.byteLength<e+(i||0))throw new RangeError("'length' is out of bounds");return n=void 0===e&&void 0===i?new Uint8Array(n):void 0===i?new Uint8Array(n,e):new Uint8Array(n,e,i),X.TYPED_ARRAY_SUPPORT?(t=n).__proto__=X.prototype:t=Z(t,n),t}(t,n,e,i):"string"==typeof n?function(t,n,e){if("string"==typeof e&&""!==e||(e="utf8"),!X.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var i=0|et(n,e),r=(t=$(t,i)).write(n,e);return r!==i&&(t=t.slice(0,r)),t}(t,n,e):function(t,n){if(nt(n)){var e=0|tt(n.length);return 0===(t=$(t,e)).length||n.copy(t,0,0,e),t}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||(i=n.length)!=i?$(t,0):Z(t,n);if("Buffer"===n.type&&W(n.data))return Z(t,n.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,n)}function J(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function Y(t,n){if(J(n),t=$(t,n<0?0:0|tt(n)),!X.TYPED_ARRAY_SUPPORT)for(var e=0;e<n;++e)t[e]=0;return t}function Z(t,n){var e=n.length<0?0:0|tt(n.length);t=$(t,e);for(var i=0;i<e;i+=1)t[i]=255&n[i];return t}function tt(t){if(t>=G())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+G().toString(16)+" bytes");return 0|t}function nt(t){return!(null==t||!t._isBuffer)}function et(t,n){if(nt(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var i=!1;;)switch(n){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return Et(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return kt(t).length;default:if(i)return Et(t).length;n=(""+n).toLowerCase(),i=!0}}function it(t,n,e){var i=!1;if((void 0===n||n<0)&&(n=0),n>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(n>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return mt(this,n,e);case"utf8":case"utf-8":return vt(this,n,e);case"ascii":return pt(this,n,e);case"latin1":case"binary":return gt(this,n,e);case"base64":return ht(this,n,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return yt(this,n,e);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function rt(t,n,e){var i=t[n];t[n]=t[e],t[e]=i}function ot(t,n,e,i,r){if(0===t.length)return-1;if("string"==typeof e?(i=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=r?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(r)return-1;e=t.length-1}else if(e<0){if(!r)return-1;e=0}if("string"==typeof n&&(n=X.from(n,i)),nt(n))return 0===n.length?-1:ut(t,n,e,i,r);if("number"==typeof n)return n&=255,X.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,n,e):Uint8Array.prototype.lastIndexOf.call(t,n,e):ut(t,[n],e,i,r);throw new TypeError("val must be string, number or Buffer")}function ut(t,n,e,i,r){var o,u=1,a=t.length,s=n.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||n.length<2)return-1;u=2,a/=2,s/=2,e/=2}function f(t,n){return 1===u?t[n]:t.readUInt16BE(n*u)}if(r){var c=-1;for(o=e;o<a;o++)if(f(t,o)===f(n,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===s)return c*u}else-1!==c&&(o-=o-c),c=-1}else for(e+s>a&&(e=a-s),o=e;o>=0;o--){for(var l=!0,d=0;d<s;d++)if(f(t,o+d)!==f(n,d)){l=!1;break}if(l)return o}return-1}function at(t,n,e,i){e=Number(e)||0;var r=t.length-e;i?(i=Number(i))>r&&(i=r):i=r;var o=n.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var u=0;u<i;++u){var a=parseInt(n.substr(2*u,2),16);if(isNaN(a))return u;t[e+u]=a}return u}function st(t,n,e,i){return Ot(Et(n,t.length-e),t,e,i)}function ft(t,n,e,i){return Ot(function(t){for(var n=[],e=0;e<t.length;++e)n.push(255&t.charCodeAt(e));return n}(n),t,e,i)}function ct(t,n,e,i){return ft(t,n,e,i)}function lt(t,n,e,i){return Ot(kt(n),t,e,i)}function dt(t,n,e,i){return Ot(function(t,n){for(var e,i,r=[],o=0;o<t.length&&!((n-=2)<0);++o)i=(e=t.charCodeAt(o))>>8,r.push(e%256),r.push(i);return r}(n,t.length-e),t,e,i)}function ht(t,n,e){return function(t){var n;U||q();for(var e=t.length,i=e%3,r="",o=[],u=16383,a=0,s=e-i;a<s;a+=u)o.push(z(t,a,a+u>s?s:a+u));return 1===i?(r+=P[(n=t[e-1])>>2],r+=P[n<<4&63],r+="=="):2===i&&(r+=P[(n=(t[e-2]<<8)+t[e-1])>>10],r+=P[n>>4&63],r+=P[n<<2&63],r+="="),o.push(r),o.join("")}(0===n&&e===t.length?t:t.slice(n,e))}function vt(t,n,e){e=Math.min(t.length,e);for(var i=[],r=n;r<e;){var o,u,a,s,f=t[r],c=null,l=f>239?4:f>223?3:f>191?2:1;if(r+l<=e)switch(l){case 1:f<128&&(c=f);break;case 2:128==(192&(o=t[r+1]))&&(s=(31&f)<<6|63&o)>127&&(c=s);break;case 3:u=t[r+2],128==(192&(o=t[r+1]))&&128==(192&u)&&(s=(15&f)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(c=s);break;case 4:u=t[r+2],a=t[r+3],128==(192&(o=t[r+1]))&&128==(192&u)&&128==(192&a)&&(s=(15&f)<<18|(63&o)<<12|(63&u)<<6|63&a)>65535&&s<1114112&&(c=s)}null===c?(c=65533,l=1):c>65535&&(i.push((c-=65536)>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=l}return function(t){var n=t.length;if(n<=4096)return String.fromCharCode.apply(String,t);for(var e="",i=0;i<n;)e+=String.fromCharCode.apply(String,t.slice(i,i+=4096));return e}(i)}function pt(t,n,e){var i="";e=Math.min(t.length,e);for(var r=n;r<e;++r)i+=String.fromCharCode(127&t[r]);return i}function gt(t,n,e){var i="";e=Math.min(t.length,e);for(var r=n;r<e;++r)i+=String.fromCharCode(t[r]);return i}function mt(t,n,e){var i,r=t.length;(!n||n<0)&&(n=0),(!e||e<0||e>r)&&(e=r);for(var o="",u=n;u<e;++u)o+=(i=t[u])<16?"0"+i.toString(16):i.toString(16);return o}function yt(t,n,e){for(var i=t.slice(n,e),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function wt(t,n,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+n>e)throw new RangeError("Trying to access beyond buffer length")}function bt(t,n,e,i,r,o){if(!nt(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>r||n<o)throw new RangeError('"value" argument is out of bounds');if(e+i>t.length)throw new RangeError("Index out of range")}function Mt(t,n,e,i){n<0&&(n=65535+n+1);for(var r=0,o=Math.min(t.length-e,2);r<o;++r)t[e+r]=(n&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function Tt(t,n,e,i){n<0&&(n=4294967295+n+1);for(var r=0,o=Math.min(t.length-e,4);r<o;++r)t[e+r]=n>>>8*(i?r:3-r)&255}function Nt(t,n,e,i){if(e+i>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function _t(t,n,e,i,r){return r||Nt(t,0,e,4),K(t,n,e,i,23,4),e+4}function St(t,n,e,i,r){return r||Nt(t,0,e,8),K(t,n,e,i,52,8),e+8}X.TYPED_ARRAY_SUPPORT=void 0===F.TYPED_ARRAY_SUPPORT||F.TYPED_ARRAY_SUPPORT,X.poolSize=8192,X._augment=function(t){return t.__proto__=X.prototype,t},X.from=function(t,n,e){return Q(null,t,n,e)},X.TYPED_ARRAY_SUPPORT&&(X.prototype.__proto__=Uint8Array.prototype,X.__proto__=Uint8Array),X.alloc=function(t,n,e){return function(t,n,e,i){return J(n),n<=0?$(t,n):void 0!==e?"string"==typeof i?$(t,n).fill(e,i):$(t,n).fill(e):$(t,n)}(null,t,n,e)},X.allocUnsafe=function(t){return Y(null,t)},X.allocUnsafeSlow=function(t){return Y(null,t)},X.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Rt(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Rt(t.slice(0,0))}(t))},X.compare=function(t,n){if(!nt(t)||!nt(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var e=t.length,i=n.length,r=0,o=Math.min(e,i);r<o;++r)if(t[r]!==n[r]){e=t[r],i=n[r];break}return e<i?-1:i<e?1:0},X.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},X.concat=function(t,n){if(!W(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return X.alloc(0);var e;if(void 0===n)for(n=0,e=0;e<t.length;++e)n+=t[e].length;var i=X.allocUnsafe(n),r=0;for(e=0;e<t.length;++e){var o=t[e];if(!nt(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},X.byteLength=et,X.prototype._isBuffer=!0,X.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)rt(this,n,n+1);return this},X.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)rt(this,n,n+3),rt(this,n+1,n+2);return this},X.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)rt(this,n,n+7),rt(this,n+1,n+6),rt(this,n+2,n+5),rt(this,n+3,n+4);return this},X.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?vt(this,0,t):it.apply(this,arguments)},X.prototype.equals=function(t){if(!nt(t))throw new TypeError("Argument must be a Buffer");return this===t||0===X.compare(this,t)},X.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},X.prototype.compare=function(t,n,e,i,r){if(!nt(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===e&&(e=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),n<0||e>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&n>=e)return 0;if(i>=r)return-1;if(n>=e)return 1;if(this===t)return 0;for(var o=(r>>>=0)-(i>>>=0),u=(e>>>=0)-(n>>>=0),a=Math.min(o,u),s=this.slice(i,r),f=t.slice(n,e),c=0;c<a;++c)if(s[c]!==f[c]){o=s[c],u=f[c];break}return o<u?-1:u<o?1:0},X.prototype.includes=function(t,n,e){return-1!==this.indexOf(t,n,e)},X.prototype.indexOf=function(t,n,e){return ot(this,t,n,e,!0)},X.prototype.lastIndexOf=function(t,n,e){return ot(this,t,n,e,!1)},X.prototype.write=function(t,n,e,i){if(void 0===n)i="utf8",e=this.length,n=0;else if(void 0===e&&"string"==typeof n)i=n,e=this.length,n=0;else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n|=0,isFinite(e)?(e|=0,void 0===i&&(i="utf8")):(i=e,e=void 0)}var r=this.length-n;if((void 0===e||e>r)&&(e=r),t.length>0&&(e<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return at(this,t,n,e);case"utf8":case"utf-8":return st(this,t,n,e);case"ascii":return ft(this,t,n,e);case"latin1":case"binary":return ct(this,t,n,e);case"base64":return lt(this,t,n,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return dt(this,t,n,e);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},X.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},X.prototype.slice=function(t,n){var e,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(n=void 0===n?i:~~n)<0?(n+=i)<0&&(n=0):n>i&&(n=i),n<t&&(n=t),X.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,n)).__proto__=X.prototype;else{var r=n-t;e=new X(r,void 0);for(var o=0;o<r;++o)e[o]=this[o+t]}return e},X.prototype.readUIntLE=function(t,n,e){t|=0,n|=0,e||wt(t,n,this.length);for(var i=this[t],r=1,o=0;++o<n&&(r*=256);)i+=this[t+o]*r;return i},X.prototype.readUIntBE=function(t,n,e){t|=0,n|=0,e||wt(t,n,this.length);for(var i=this[t+--n],r=1;n>0&&(r*=256);)i+=this[t+--n]*r;return i},X.prototype.readUInt8=function(t,n){return n||wt(t,1,this.length),this[t]},X.prototype.readUInt16LE=function(t,n){return n||wt(t,2,this.length),this[t]|this[t+1]<<8},X.prototype.readUInt16BE=function(t,n){return n||wt(t,2,this.length),this[t]<<8|this[t+1]},X.prototype.readUInt32LE=function(t,n){return n||wt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},X.prototype.readUInt32BE=function(t,n){return n||wt(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},X.prototype.readIntLE=function(t,n,e){t|=0,n|=0,e||wt(t,n,this.length);for(var i=this[t],r=1,o=0;++o<n&&(r*=256);)i+=this[t+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*n)),i},X.prototype.readIntBE=function(t,n,e){t|=0,n|=0,e||wt(t,n,this.length);for(var i=n,r=1,o=this[t+--i];i>0&&(r*=256);)o+=this[t+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*n)),o},X.prototype.readInt8=function(t,n){return n||wt(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},X.prototype.readInt16LE=function(t,n){n||wt(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},X.prototype.readInt16BE=function(t,n){n||wt(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},X.prototype.readInt32LE=function(t,n){return n||wt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},X.prototype.readInt32BE=function(t,n){return n||wt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},X.prototype.readFloatLE=function(t,n){return n||wt(t,4,this.length),H(this,t,!0,23,4)},X.prototype.readFloatBE=function(t,n){return n||wt(t,4,this.length),H(this,t,!1,23,4)},X.prototype.readDoubleLE=function(t,n){return n||wt(t,8,this.length),H(this,t,!0,52,8)},X.prototype.readDoubleBE=function(t,n){return n||wt(t,8,this.length),H(this,t,!1,52,8)},X.prototype.writeUIntLE=function(t,n,e,i){t=+t,n|=0,e|=0,i||bt(this,t,n,e,Math.pow(2,8*e)-1,0);var r=1,o=0;for(this[n]=255&t;++o<e&&(r*=256);)this[n+o]=t/r&255;return n+e},X.prototype.writeUIntBE=function(t,n,e,i){t=+t,n|=0,e|=0,i||bt(this,t,n,e,Math.pow(2,8*e)-1,0);var r=e-1,o=1;for(this[n+r]=255&t;--r>=0&&(o*=256);)this[n+r]=t/o&255;return n+e},X.prototype.writeUInt8=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,1,255,0),X.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},X.prototype.writeUInt16LE=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,2,65535,0),X.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):Mt(this,t,n,!0),n+2},X.prototype.writeUInt16BE=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,2,65535,0),X.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):Mt(this,t,n,!1),n+2},X.prototype.writeUInt32LE=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,4,4294967295,0),X.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):Tt(this,t,n,!0),n+4},X.prototype.writeUInt32BE=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,4,4294967295,0),X.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):Tt(this,t,n,!1),n+4},X.prototype.writeIntLE=function(t,n,e,i){if(t=+t,n|=0,!i){var r=Math.pow(2,8*e-1);bt(this,t,n,e,r-1,-r)}var o=0,u=1,a=0;for(this[n]=255&t;++o<e&&(u*=256);)t<0&&0===a&&0!==this[n+o-1]&&(a=1),this[n+o]=(t/u>>0)-a&255;return n+e},X.prototype.writeIntBE=function(t,n,e,i){if(t=+t,n|=0,!i){var r=Math.pow(2,8*e-1);bt(this,t,n,e,r-1,-r)}var o=e-1,u=1,a=0;for(this[n+o]=255&t;--o>=0&&(u*=256);)t<0&&0===a&&0!==this[n+o+1]&&(a=1),this[n+o]=(t/u>>0)-a&255;return n+e},X.prototype.writeInt8=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,1,127,-128),X.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},X.prototype.writeInt16LE=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,2,32767,-32768),X.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):Mt(this,t,n,!0),n+2},X.prototype.writeInt16BE=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,2,32767,-32768),X.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):Mt(this,t,n,!1),n+2},X.prototype.writeInt32LE=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,4,2147483647,-2147483648),X.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):Tt(this,t,n,!0),n+4},X.prototype.writeInt32BE=function(t,n,e){return t=+t,n|=0,e||bt(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),X.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):Tt(this,t,n,!1),n+4},X.prototype.writeFloatLE=function(t,n,e){return _t(this,t,n,!0,e)},X.prototype.writeFloatBE=function(t,n,e){return _t(this,t,n,!1,e)},X.prototype.writeDoubleLE=function(t,n,e){return St(this,t,n,!0,e)},X.prototype.writeDoubleBE=function(t,n,e){return St(this,t,n,!1,e)},X.prototype.copy=function(t,n,e,i){if(e||(e=0),i||0===i||(i=this.length),n>=t.length&&(n=t.length),n||(n=0),i>0&&i<e&&(i=e),i===e)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-n<i-e&&(i=t.length-n+e);var r,o=i-e;if(this===t&&e<n&&n<i)for(r=o-1;r>=0;--r)t[r+n]=this[r+e];else if(o<1e3||!X.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+n]=this[r+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),n);return o},X.prototype.fill=function(t,n,e,i){if("string"==typeof t){if("string"==typeof n?(i=n,n=0,e=this.length):"string"==typeof e&&(i=e,e=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!X.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<e)throw new RangeError("Out of range index");if(e<=n)return this;var o;if(n>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=n;o<e;++o)this[o]=t;else{var u=nt(t)?t:Et(new X(t,i).toString()),a=u.length;for(o=0;o<e-n;++o)this[o+n]=u[o%a]}return this};var Ct=/[^+\/0-9A-Za-z-_]/g;function Et(t,n){var e;n=n||1/0;for(var i=t.length,r=null,o=[],u=0;u<i;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!r){if(e>56319){(n-=3)>-1&&o.push(239,191,189);continue}if(u+1===i){(n-=3)>-1&&o.push(239,191,189);continue}r=e;continue}if(e<56320){(n-=3)>-1&&o.push(239,191,189),r=e;continue}e=65536+(r-55296<<10|e-56320)}else r&&(n-=3)>-1&&o.push(239,191,189);if(r=null,e<128){if((n-=1)<0)break;o.push(e)}else if(e<2048){if((n-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((n-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((n-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function kt(t){return function(t){var n,e,i,r,o,u;U||q();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");u=new L(3*a/4-(o="="===t[a-2]?2:"="===t[a-1]?1:0)),i=o>0?a-4:a;var s=0;for(n=0,e=0;n<i;n+=4,e+=3)r=B[t.charCodeAt(n)]<<18|B[t.charCodeAt(n+1)]<<12|B[t.charCodeAt(n+2)]<<6|B[t.charCodeAt(n+3)],u[s++]=r>>16&255,u[s++]=r>>8&255,u[s++]=255&r;return 2===o?(r=B[t.charCodeAt(n)]<<2|B[t.charCodeAt(n+1)]>>4,u[s++]=255&r):1===o&&(r=B[t.charCodeAt(n)]<<10|B[t.charCodeAt(n+1)]<<4|B[t.charCodeAt(n+2)]>>2,u[s++]=r>>8&255,u[s++]=255&r),u}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Ct,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Ot(t,n,e,i){for(var r=0;r<i&&!(r+e>=n.length||r>=t.length);++r)n[r+e]=t[r];return r}function Rt(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function It(){}function Dt(){Dt.init.call(this)}function xt(t){return void 0===t._maxListeners?Dt.defaultMaxListeners:t._maxListeners}function At(t,n,e){if(n)t.call(e);else for(var i=t.length,r=zt(t,i),o=0;o<i;++o)r[o].call(e)}function jt(t,n,e,i){if(n)t.call(e,i);else for(var r=t.length,o=zt(t,r),u=0;u<r;++u)o[u].call(e,i)}function Ft(t,n,e,i,r){if(n)t.call(e,i,r);else for(var o=t.length,u=zt(t,o),a=0;a<o;++a)u[a].call(e,i,r)}function Pt(t,n,e,i,r,o){if(n)t.call(e,i,r,o);else for(var u=t.length,a=zt(t,u),s=0;s<u;++s)a[s].call(e,i,r,o)}function Bt(t,n,e,i){if(n)t.apply(e,i);else for(var r=t.length,o=zt(t,r),u=0;u<r;++u)o[u].apply(e,i)}function Lt(t,n,e,i){var r,o,u,a;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if((o=t._events)?(o.newListener&&(t.emit("newListener",n,e.listener?e.listener:e),o=t._events),u=o[n]):(o=t._events=new It,t._eventsCount=0),u){if("function"==typeof u?u=o[n]=i?[e,u]:[u,e]:i?u.unshift(e):u.push(e),!u.warned&&(r=xt(t))&&r>0&&u.length>r){u.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+n+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=n,s.count=u.length,a=s,"function"==typeof console.warn?console.warn(a):console.log(a)}}else u=o[n]=e,++t._eventsCount;return t}function Ut(t,n,e){var i=!1;function r(){t.removeListener(n,r),i||(i=!0,e.apply(t,arguments))}return r.listener=e,r}function qt(t){var n=this._events;if(n){var e=n[t];if("function"==typeof e)return 1;if(e)return e.length}return 0}function zt(t,n){for(var e=new Array(n);n--;)e[n]=t[n];return e}function Ht(){throw new Error("setTimeout has not been defined")}function Kt(){throw new Error("clearTimeout has not been defined")}It.prototype=Object.create(null),Dt.EventEmitter=Dt,Dt.usingDomains=!1,Dt.prototype.domain=void 0,Dt.prototype._events=void 0,Dt.prototype._maxListeners=void 0,Dt.defaultMaxListeners=10,Dt.init=function(){this.domain=null,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new It,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Dt.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},Dt.prototype.getMaxListeners=function(){return xt(this)},Dt.prototype.emit=function(t){var n,e,i,r,o,u,a,s="error"===t;if(u=this._events)s=s&&null==u.error;else if(!s)return!1;if(a=this.domain,s){if(n=arguments[1],!a){if(n instanceof Error)throw n;var f=new Error('Uncaught, unspecified "error" event. ('+n+")");throw f.context=n,f}return n||(n=new Error('Uncaught, unspecified "error" event')),n.domainEmitter=this,n.domain=a,n.domainThrown=!1,a.emit("error",n),!1}if(!(e=u[t]))return!1;var c="function"==typeof e;switch(i=arguments.length){case 1:At(e,c,this);break;case 2:jt(e,c,this,arguments[1]);break;case 3:Ft(e,c,this,arguments[1],arguments[2]);break;case 4:Pt(e,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(i-1),o=1;o<i;o++)r[o-1]=arguments[o];Bt(e,c,this,r)}return!0},Dt.prototype.on=Dt.prototype.addListener=function(t,n){return Lt(this,t,n,!1)},Dt.prototype.prependListener=function(t,n){return Lt(this,t,n,!0)},Dt.prototype.once=function(t,n){if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return this.on(t,Ut(this,t,n)),this},Dt.prototype.prependOnceListener=function(t,n){if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,Ut(this,t,n)),this},Dt.prototype.removeListener=function(t,n){var e,i,r,o,u;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(e=i[t]))return this;if(e===n||e.listener&&e.listener===n)0==--this._eventsCount?this._events=new It:(delete i[t],i.removeListener&&this.emit("removeListener",t,e.listener||n));else if("function"!=typeof e){for(r=-1,o=e.length;o-- >0;)if(e[o]===n||e[o].listener&&e[o].listener===n){u=e[o].listener,r=o;break}if(r<0)return this;if(1===e.length){if(e[0]=void 0,0==--this._eventsCount)return this._events=new It,this;delete i[t]}else!function(t,n){for(var e=n,i=e+1,r=t.length;i<r;e+=1,i+=1)t[e]=t[i];t.pop()}(e,r);i.removeListener&&this.emit("removeListener",t,u||n)}return this},Dt.prototype.removeAllListeners=function(t){var n,e;if(!(e=this._events))return this;if(!e.removeListener)return 0===arguments.length?(this._events=new It,this._eventsCount=0):e[t]&&(0==--this._eventsCount?this._events=new It:delete e[t]),this;if(0===arguments.length){for(var i,r=Object.keys(e),o=0;o<r.length;++o)"removeListener"!==(i=r[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new It,this._eventsCount=0,this}if("function"==typeof(n=e[t]))this.removeListener(t,n);else if(n)do{this.removeListener(t,n[n.length-1])}while(n[0]);return this},Dt.prototype.listeners=function(t){var n,e=this._events;return e&&(n=e[t])?"function"==typeof n?[n.listener||n]:function(t){for(var n=new Array(t.length),e=0;e<n.length;++e)n[e]=t[e].listener||t[e];return n}(n):[]},Dt.listenerCount=function(t,n){return"function"==typeof t.listenerCount?t.listenerCount(n):qt.call(t,n)},Dt.prototype.listenerCount=qt,Dt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Vt=Ht,Wt=Kt;function Gt(t){if(Vt===setTimeout)return setTimeout(t,0);if((Vt===Ht||!Vt)&&setTimeout)return Vt=setTimeout,setTimeout(t,0);try{return Vt(t,0)}catch(n){try{return Vt.call(null,t,0)}catch(n){return Vt.call(this,t,0)}}}"function"==typeof F.setTimeout&&(Vt=setTimeout),"function"==typeof F.clearTimeout&&(Wt=clearTimeout);var $t,Xt=[],Qt=!1,Jt=-1;function Yt(){Qt&&$t&&(Qt=!1,$t.length?Xt=$t.concat(Xt):Jt=-1,Xt.length&&Zt())}function Zt(){if(!Qt){var t=Gt(Yt);Qt=!0;for(var n=Xt.length;n;){for($t=Xt,Xt=[];++Jt<n;)$t&&$t[Jt].run();Jt=-1,n=Xt.length}$t=null,Qt=!1,function(t){if(Wt===clearTimeout)return clearTimeout(t);if((Wt===Kt||!Wt)&&clearTimeout)return Wt=clearTimeout,clearTimeout(t);try{Wt(t)}catch(n){try{return Wt.call(null,t)}catch(n){return Wt.call(this,t)}}}(t)}}function tn(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];Xt.push(new nn(t,n)),1!==Xt.length||Qt||Gt(Zt)}function nn(t,n){this.fun=t,this.array=n}nn.prototype.run=function(){this.fun.apply(null,this.array)};const en="function"==typeof Object.create?function(t,n){t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,n){t.super_=n;var e=function(){};e.prototype=n.prototype,t.prototype=new e,t.prototype.constructor=t};var rn=/%[sdj%]/g;function on(t){if(!mn(t)){for(var n=[],e=0;e<arguments.length;e++)n.push(fn(arguments[e]));return n.join(" ")}e=1;for(var i=arguments,r=i.length,o=String(t).replace(rn,(function(t){if("%%"===t)return"%";if(e>=r)return t;switch(t){case"%s":return String(i[e++]);case"%d":return Number(i[e++]);case"%j":try{return JSON.stringify(i[e++])}catch(t){return"[Circular]"}default:return t}})),u=i[e];e<r;u=i[++e])gn(u)||!bn(u)?o+=" "+u:o+=" "+fn(u);return o}function un(t,n){if(yn(F.process))return function(){return un(t,n).apply(this,arguments)};var e=!1;return function(){return e||(console.error(n),e=!0),t.apply(this,arguments)}}var an,sn={};function fn(t,n){var e={seen:[],stylize:ln};return arguments.length>=3&&(e.depth=arguments[2]),arguments.length>=4&&(e.colors=arguments[3]),pn(n)?e.showHidden=n:n&&Sn(e,n),yn(e.showHidden)&&(e.showHidden=!1),yn(e.depth)&&(e.depth=2),yn(e.colors)&&(e.colors=!1),yn(e.customInspect)&&(e.customInspect=!0),e.colors&&(e.stylize=cn),dn(e,t,e.depth)}function cn(t,n){var e=fn.styles[n];return e?"["+fn.colors[e][0]+"m"+t+"["+fn.colors[e][1]+"m":t}function ln(t){return t}function dn(t,n,e){if(t.customInspect&&n&&Nn(n.inspect)&&n.inspect!==fn&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(e,t);return mn(i)||(i=dn(t,i,e)),i}var r=function(t,n){if(yn(n))return t.stylize("undefined","undefined");if(mn(n)){var e="'"+JSON.stringify(n).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(e,"string")}return"number"==typeof n?t.stylize(""+n,"number"):pn(n)?t.stylize(""+n,"boolean"):gn(n)?t.stylize("null","null"):void 0}(t,n);if(r)return r;var o=Object.keys(n),u=function(t){var n={};return t.forEach((function(t){n[t]=!0})),n}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(n)),Tn(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return hn(n);if(0===o.length){if(Nn(n))return t.stylize("[Function"+(n.name?": "+n.name:"")+"]","special");if(wn(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(Mn(n))return t.stylize(Date.prototype.toString.call(n),"date");if(Tn(n))return hn(n)}var a,s="",f=!1,c=["{","}"];return Array.isArray(n)&&(f=!0,c=["[","]"]),Nn(n)&&(s=" [Function"+(n.name?": "+n.name:"")+"]"),wn(n)&&(s=" "+RegExp.prototype.toString.call(n)),Mn(n)&&(s=" "+Date.prototype.toUTCString.call(n)),Tn(n)&&(s=" "+hn(n)),0!==o.length||f&&0!=n.length?e<0?wn(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),a=f?function(t,n,e,i,r){for(var o=[],u=0,a=n.length;u<a;++u)Cn(n,String(u))?o.push(vn(t,n,e,i,String(u),!0)):o.push("");return r.forEach((function(r){r.match(/^\d+$/)||o.push(vn(t,n,e,i,r,!0))})),o}(t,n,e,u,o):o.map((function(i){return vn(t,n,e,u,i,f)})),t.seen.pop(),function(t,n,e){return t.reduce((function(t,n){return n.indexOf("\n"),t+n.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?e[0]+(""===n?"":n+"\n ")+" "+t.join(",\n  ")+" "+e[1]:e[0]+n+" "+t.join(", ")+" "+e[1]}(a,s,c)):c[0]+s+c[1]}function hn(t){return"["+Error.prototype.toString.call(t)+"]"}function vn(t,n,e,i,r,o){var u,a,s;if((s=Object.getOwnPropertyDescriptor(n,r)||{value:n[r]}).get?a=t.stylize(s.set?"[Getter/Setter]":"[Getter]","special"):s.set&&(a=t.stylize("[Setter]","special")),Cn(i,r)||(u="["+r+"]"),a||(t.seen.indexOf(s.value)<0?(a=gn(e)?dn(t,s.value,null):dn(t,s.value,e-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),yn(u)){if(o&&r.match(/^\d+$/))return a;(u=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=t.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=t.stylize(u,"string"))}return u+": "+a}function pn(t){return"boolean"==typeof t}function gn(t){return null===t}function mn(t){return"string"==typeof t}function yn(t){return void 0===t}function wn(t){return bn(t)&&"[object RegExp]"===_n(t)}function bn(t){return"object"==typeof t&&null!==t}function Mn(t){return bn(t)&&"[object Date]"===_n(t)}function Tn(t){return bn(t)&&("[object Error]"===_n(t)||t instanceof Error)}function Nn(t){return"function"==typeof t}function _n(t){return Object.prototype.toString.call(t)}function Sn(t,n){if(!n||!bn(n))return t;for(var e=Object.keys(n),i=e.length;i--;)t[e[i]]=n[e[i]];return t}function Cn(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function En(){this.head=null,this.tail=null,this.length=0}fn.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},fn.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},En.prototype.push=function(t){var n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length},En.prototype.unshift=function(t){var n={data:t,next:this.head};0===this.length&&(this.tail=n),this.head=n,++this.length},En.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,t}},En.prototype.clear=function(){this.head=this.tail=null,this.length=0},En.prototype.join=function(t){if(0===this.length)return"";for(var n=this.head,e=""+n.data;n=n.next;)e+=t+n.data;return e},En.prototype.concat=function(t){if(0===this.length)return X.alloc(0);if(1===this.length)return this.head.data;for(var n=X.allocUnsafe(t>>>0),e=this.head,i=0;e;)e.data.copy(n,i),i+=e.data.length,e=e.next;return n};var kn=X.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function On(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!kn(t))throw new Error("Unknown encoding: "+t)}(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=In;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Dn;break;default:return void(this.write=Rn)}this.charBuffer=new X(6),this.charReceived=0,this.charLength=0}function Rn(t){return t.toString(this.encoding)}function In(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function Dn(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}On.prototype.write=function(t){for(var n="";this.charLength;){var e=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,e),this.charReceived+=e,this.charReceived<this.charLength)return"";if(t=t.slice(e,t.length),!((i=(n=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(n.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===t.length)return n;break}this.charLength+=this.surrogateSize,n=""}this.detectIncompleteChar(t);var i,r=t.length;if(this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,r),r-=this.charReceived),(i=(n+=t.toString(this.encoding,0,r)).charCodeAt(r=n.length-1))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),n.substring(0,r)}return n},On.prototype.detectIncompleteChar=function(t){for(var n=t.length>=3?3:t.length;n>0;n--){var e=t[t.length-n];if(1==n&&e>>5==6){this.charLength=2;break}if(n<=2&&e>>4==14){this.charLength=3;break}if(n<=3&&e>>3==30){this.charLength=4;break}}this.charReceived=n},On.prototype.end=function(t){var n="";if(t&&t.length&&(n=this.write(t)),this.charReceived){var e=this.encoding;n+=this.charBuffer.slice(0,this.charReceived).toString(e)}return n};const xn=Object.freeze({__proto__:null,StringDecoder:On});Pn.ReadableState=Fn;var An,jn=(An="stream",yn(an)&&(an=""),An=An.toUpperCase(),sn[An]||(sn[An]=new RegExp("\\b"+An+"\\b","i").test(an)?function(){var t=on.apply(null,arguments);console.error("%s %d: %s",An,0,t)}:function(){}),sn[An]);function Fn(t,n){this.objectMode=!!(t=t||{}).objectMode,n instanceof ce&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var e=t.highWaterMark;this.highWaterMark=e||0===e?e:this.objectMode?16:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=new En,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(this.decoder=new On(t.encoding),this.encoding=t.encoding)}function Pn(t){if(!(this instanceof Pn))return new Pn(t);this._readableState=new Fn(t,this),this.readable=!0,t&&"function"==typeof t.read&&(this._read=t.read),Dt.call(this)}function Bn(t,n,e,i,r){var o=function(t,n){var e=null;return X.isBuffer(n)||"string"==typeof n||null==n||t.objectMode||(e=new TypeError("Invalid non-string/buffer chunk")),e}(n,e);if(o)t.emit("error",o);else if(null===e)n.reading=!1,function(t,n){if(!n.ended){if(n.decoder){var e=n.decoder.end();e&&e.length&&(n.buffer.push(e),n.length+=n.objectMode?1:e.length)}n.ended=!0,Un(t)}}(t,n);else if(n.objectMode||e&&e.length>0)if(n.ended&&!r){var u=new Error("stream.push() after EOF");t.emit("error",u)}else if(n.endEmitted&&r){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else{var s;!n.decoder||r||i||(e=n.decoder.write(e),s=!n.objectMode&&0===e.length),r||(n.reading=!1),s||(n.flowing&&0===n.length&&!n.sync?(t.emit("data",e),t.read(0)):(n.length+=n.objectMode?1:e.length,r?n.buffer.unshift(e):n.buffer.push(e),n.needReadable&&Un(t))),function(t,n){n.readingMore||(n.readingMore=!0,tn(zn,t,n))}(t,n)}else r||(n.reading=!1);return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(n)}function Ln(t,n){return t<=0||0===n.length&&n.ended?0:n.objectMode?1:t!=t?n.flowing&&n.length?n.buffer.head.data.length:n.length:(t>n.highWaterMark&&(n.highWaterMark=function(t){return t>=8388608?t=8388608:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=n.length?t:n.ended?n.length:(n.needReadable=!0,0))}function Un(t){var n=t._readableState;n.needReadable=!1,n.emittedReadable||(jn("emitReadable",n.flowing),n.emittedReadable=!0,n.sync?tn(qn,t):qn(t))}function qn(t){jn("emit readable"),t.emit("readable"),Vn(t)}function zn(t,n){for(var e=n.length;!n.reading&&!n.flowing&&!n.ended&&n.length<n.highWaterMark&&(jn("maybeReadMore read 0"),t.read(0),e!==n.length);)e=n.length;n.readingMore=!1}function Hn(t){jn("readable nexttick read 0"),t.read(0)}function Kn(t,n){n.reading||(jn("resume read 0"),t.read(0)),n.resumeScheduled=!1,n.awaitDrain=0,t.emit("resume"),Vn(t),n.flowing&&!n.reading&&t.read(0)}function Vn(t){var n=t._readableState;for(jn("flow",n.flowing);n.flowing&&null!==t.read(););}function Wn(t,n){return 0===n.length?null:(n.objectMode?e=n.buffer.shift():!t||t>=n.length?(e=n.decoder?n.buffer.join(""):1===n.buffer.length?n.buffer.head.data:n.buffer.concat(n.length),n.buffer.clear()):e=function(t,n,e){var i;return t<n.head.data.length?(i=n.head.data.slice(0,t),n.head.data=n.head.data.slice(t)):i=t===n.head.data.length?n.shift():e?function(t,n){var e=n.head,i=1,r=e.data;for(t-=r.length;e=e.next;){var o=e.data,u=t>o.length?o.length:t;if(r+=u===o.length?o:o.slice(0,t),0==(t-=u)){u===o.length?(++i,n.head=e.next?e.next:n.tail=null):(n.head=e,e.data=o.slice(u));break}++i}return n.length-=i,r}(t,n):function(t,n){var e=X.allocUnsafe(t),i=n.head,r=1;for(i.data.copy(e),t-=i.data.length;i=i.next;){var o=i.data,u=t>o.length?o.length:t;if(o.copy(e,e.length-t,0,u),0==(t-=u)){u===o.length?(++r,n.head=i.next?i.next:n.tail=null):(n.head=i,i.data=o.slice(u));break}++r}return n.length-=r,e}(t,n),i}(t,n.buffer,n.decoder),e);var e}function Gn(t){var n=t._readableState;if(n.length>0)throw new Error('"endReadable()" called on non-empty stream');n.endEmitted||(n.ended=!0,tn($n,n,t))}function $n(t,n){t.endEmitted||0!==t.length||(t.endEmitted=!0,n.readable=!1,n.emit("end"))}function Xn(t,n){for(var e=0,i=t.length;e<i;e++)if(t[e]===n)return e;return-1}function Qn(){}function Jn(t,n,e){this.chunk=t,this.encoding=n,this.callback=e,this.next=null}function Yn(t,n){Object.defineProperty(this,"buffer",{get:un((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),this.objectMode=!!(t=t||{}).objectMode,n instanceof ce&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var e=t.highWaterMark;this.highWaterMark=e||0===e?e:this.objectMode?16:16384,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.decodeStrings=!(!1===t.decodeStrings),this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,n){var e=t._writableState,i=e.sync,r=e.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(e),n)!function(t,n,e,i,r){--n.pendingcb,e?tn(r,i):r(i),t._writableState.errorEmitted=!0,t.emit("error",i)}(t,e,i,n,r);else{var o=ie(e);o||e.corked||e.bufferProcessing||!e.bufferedRequest||ee(t,e),i?tn(ne,t,e,o,r):ne(t,e,o,r)}}(n,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new ue(this)}function Zn(t){if(!(this instanceof Zn||this instanceof ce))return new Zn(t);this._writableState=new Yn(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev)),Dt.call(this)}function te(t,n,e,i,r,o,u){n.writelen=i,n.writecb=u,n.writing=!0,n.sync=!0,e?t._writev(r,n.onwrite):t._write(r,o,n.onwrite),n.sync=!1}function ne(t,n,e,i){e||function(t,n){0===n.length&&n.needDrain&&(n.needDrain=!1,t.emit("drain"))}(t,n),n.pendingcb--,i(),oe(t,n)}function ee(t,n){n.bufferProcessing=!0;var e=n.bufferedRequest;if(t._writev&&e&&e.next){var i=new Array(n.bufferedRequestCount),r=n.corkedRequestsFree;r.entry=e;for(var o=0;e;)i[o]=e,e=e.next,o+=1;te(t,n,!0,n.length,i,"",r.finish),n.pendingcb++,n.lastBufferedRequest=null,r.next?(n.corkedRequestsFree=r.next,r.next=null):n.corkedRequestsFree=new ue(n)}else{for(;e;){var u=e.chunk;if(te(t,n,!1,n.objectMode?1:u.length,u,e.encoding,e.callback),e=e.next,n.writing)break}null===e&&(n.lastBufferedRequest=null)}n.bufferedRequestCount=0,n.bufferedRequest=e,n.bufferProcessing=!1}function ie(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function re(t,n){n.prefinished||(n.prefinished=!0,t.emit("prefinish"))}function oe(t,n){var e=ie(n);return e&&(0===n.pendingcb?(re(t,n),n.finished=!0,t.emit("finish")):re(t,n)),e}function ue(t){var n=this;this.next=null,this.entry=null,this.finish=function(e){var i=n.entry;for(n.entry=null;i;){var r=i.callback;t.pendingcb--,r(e),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=n:t.corkedRequestsFree=n}}en(Pn,Dt),Pn.prototype.push=function(t,n){var e=this._readableState;return e.objectMode||"string"!=typeof t||(n=n||e.defaultEncoding)!==e.encoding&&(t=X.from(t,n),n=""),Bn(this,e,t,n,!1)},Pn.prototype.unshift=function(t){return Bn(this,this._readableState,t,"",!0)},Pn.prototype.isPaused=function(){return!1===this._readableState.flowing},Pn.prototype.setEncoding=function(t){return this._readableState.decoder=new On(t),this._readableState.encoding=t,this},Pn.prototype.read=function(t){jn("read",t),t=parseInt(t,10);var n=this._readableState,e=t;if(0!==t&&(n.emittedReadable=!1),0===t&&n.needReadable&&(n.length>=n.highWaterMark||n.ended))return jn("read: emitReadable",n.length,n.ended),0===n.length&&n.ended?Gn(this):Un(this),null;if(0===(t=Ln(t,n))&&n.ended)return 0===n.length&&Gn(this),null;var i,r=n.needReadable;return jn("need readable",r),(0===n.length||n.length-t<n.highWaterMark)&&jn("length less than watermark",r=!0),n.ended||n.reading?jn("reading or ended",r=!1):r&&(jn("do read"),n.reading=!0,n.sync=!0,0===n.length&&(n.needReadable=!0),this._read(n.highWaterMark),n.sync=!1,n.reading||(t=Ln(e,n))),null===(i=t>0?Wn(t,n):null)?(n.needReadable=!0,t=0):n.length-=t,0===n.length&&(n.ended||(n.needReadable=!0),e!==t&&n.ended&&Gn(this)),null!==i&&this.emit("data",i),i},Pn.prototype._read=function(){this.emit("error",new Error("not implemented"))},Pn.prototype.pipe=function(t,n){var e=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t)}i.pipesCount+=1,jn("pipe count=%d opts=%j",i.pipesCount,n);var r=n&&!1===n.end?f:u;function o(t){jn("onunpipe"),t===e&&f()}function u(){jn("onend"),t.end()}i.endEmitted?tn(r):e.once("end",r),t.on("unpipe",o);var a=function(t){return function(){var n=t._readableState;jn("pipeOnDrain",n.awaitDrain),n.awaitDrain&&n.awaitDrain--,0===n.awaitDrain&&t.listeners("data").length&&(n.flowing=!0,Vn(t))}}(e);t.on("drain",a);var s=!1;function f(){jn("cleanup"),t.removeListener("close",h),t.removeListener("finish",v),t.removeListener("drain",a),t.removeListener("error",d),t.removeListener("unpipe",o),e.removeListener("end",u),e.removeListener("end",f),e.removeListener("data",l),s=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||a()}var c=!1;function l(n){jn("ondata"),c=!1,!1!==t.write(n)||c||((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==Xn(i.pipes,t))&&!s&&(jn("false write response, pause",e._readableState.awaitDrain),e._readableState.awaitDrain++,c=!0),e.pause())}function d(n){jn("onerror",n),p(),t.removeListener("error",d),0===t.listeners("error").length&&t.emit("error",n)}function h(){t.removeListener("finish",v),p()}function v(){jn("onfinish"),t.removeListener("close",h),p()}function p(){jn("unpipe"),e.unpipe(t)}return e.on("data",l),function(t,n,e){if("function"==typeof t.prependListener)return t.prependListener(n,e);t._events&&t._events.error?Array.isArray(t._events.error)?t._events.error.unshift(e):t._events.error=[e,t._events.error]:t.on(n,e)}(t,"error",d),t.once("close",h),t.once("finish",v),t.emit("pipe",e),i.flowing||(jn("pipe resume"),e.resume()),t},Pn.prototype.unpipe=function(t){var n=this._readableState;if(0===n.pipesCount)return this;if(1===n.pipesCount)return t&&t!==n.pipes||(t||(t=n.pipes),n.pipes=null,n.pipesCount=0,n.flowing=!1,t&&t.emit("unpipe",this)),this;if(!t){var e=n.pipes,i=n.pipesCount;n.pipes=null,n.pipesCount=0,n.flowing=!1;for(var r=0;r<i;r++)e[r].emit("unpipe",this);return this}var o=Xn(n.pipes,t);return-1===o||(n.pipes.splice(o,1),n.pipesCount-=1,1===n.pipesCount&&(n.pipes=n.pipes[0]),t.emit("unpipe",this)),this},Pn.prototype.addListener=Pn.prototype.on=function(t,n){var e=Dt.prototype.on.call(this,t,n);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&Un(this):tn(Hn,this))}return e},Pn.prototype.resume=function(){var t=this._readableState;return t.flowing||(jn("resume"),t.flowing=!0,function(t,n){n.resumeScheduled||(n.resumeScheduled=!0,tn(Kn,t,n))}(this,t)),this},Pn.prototype.pause=function(){return jn("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(jn("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Pn.prototype.wrap=function(t){var n=this._readableState,e=!1,i=this;for(var r in t.on("end",(function(){if(jn("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&i.push(t)}i.push(null)})),t.on("data",(function(r){jn("wrapped data"),n.decoder&&(r=n.decoder.write(r)),n.objectMode&&null==r||(n.objectMode||r&&r.length)&&(i.push(r)||(e=!0,t.pause()))})),t)void 0===this[r]&&"function"==typeof t[r]&&(this[r]=function(n){return function(){return t[n].apply(t,arguments)}}(r));return function(n){for(var e=0,r=n.length;e<r;e++)t.on(o=n[e],i.emit.bind(i,o));var o}(["error","close","destroy","pause","resume"]),i._read=function(n){jn("wrapped _read",n),e&&(e=!1,t.resume())},i},Pn._fromList=Wn,Zn.WritableState=Yn,en(Zn,Dt),Yn.prototype.getBuffer=function(){for(var t=this.bufferedRequest,n=[];t;)n.push(t),t=t.next;return n},Zn.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Zn.prototype.write=function(t,n,e){var i=this._writableState,r=!1;return"function"==typeof n&&(e=n,n=null),X.isBuffer(t)?n="buffer":n||(n=i.defaultEncoding),"function"!=typeof e&&(e=Qn),i.ended?function(t,n){var e=new Error("write after end");t.emit("error",e),tn(n,e)}(this,e):function(t,n,e,i){var r=!0,o=!1;return null===e?o=new TypeError("May not write null values to stream"):X.isBuffer(e)||"string"==typeof e||void 0===e||n.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),tn(i,o),r=!1),r}(this,i,t,e)&&(i.pendingcb++,r=function(t,n,e,i,r){e=function(t,n,e){return t.objectMode||!1===t.decodeStrings||"string"!=typeof n||(n=X.from(n,e)),n}(n,e,i),X.isBuffer(e)&&(i="buffer");var o=n.objectMode?1:e.length;n.length+=o;var u=n.length<n.highWaterMark;if(u||(n.needDrain=!0),n.writing||n.corked){var a=n.lastBufferedRequest;n.lastBufferedRequest=new Jn(e,i,r),a?a.next=n.lastBufferedRequest:n.bufferedRequest=n.lastBufferedRequest,n.bufferedRequestCount+=1}else te(t,n,!1,o,e,i,r);return u}(this,i,t,n,e)),r},Zn.prototype.cork=function(){this._writableState.corked++},Zn.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||ee(this,t))},Zn.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Zn.prototype._write=function(t,n,e){e(new Error("not implemented"))},Zn.prototype._writev=null,Zn.prototype.end=function(t,n,e){var i=this._writableState;"function"==typeof t?(e=t,t=null,n=null):"function"==typeof n&&(e=n,n=null),null!=t&&this.write(t,n),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(t,n,e){n.ending=!0,oe(t,n),e&&(n.finished?tn(e):t.once("finish",e)),n.ended=!0,t.writable=!1}(this,i,e)},en(ce,Pn);for(var ae=Object.keys(Zn.prototype),se=0;se<ae.length;se++){var fe=ae[se];ce.prototype[fe]||(ce.prototype[fe]=Zn.prototype[fe])}function ce(t){if(!(this instanceof ce))return new ce(t);Pn.call(this,t),Zn.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",le)}function le(){this.allowHalfOpen||this._writableState.ended||tn(de,this)}function de(t){t.end()}function he(t){this.afterTransform=function(n,e){return function(t,n,e){var i=t._transformState;i.transforming=!1;var r=i.writecb;if(!r)return t.emit("error",new Error("no writecb in Transform class"));i.writechunk=null,i.writecb=null,null!=e&&t.push(e),r(n);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}(t,n,e)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function ve(t){if(!(this instanceof ve))return new ve(t);ce.call(this,t),this._transformState=new he(this);var n=this;this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(t){pe(n,t)})):pe(n)}))}function pe(t,n){if(n)return t.emit("error",n);var e=t._transformState;if(t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}function ge(t){if(!(this instanceof ge))return new ge(t);ve.call(this,t)}function me(){Dt.call(this)}en(ve,ce),ve.prototype.push=function(t,n){return this._transformState.needTransform=!1,ce.prototype.push.call(this,t,n)},ve.prototype._transform=function(){throw new Error("Not implemented")},ve.prototype._write=function(t,n,e){var i=this._transformState;if(i.writecb=e,i.writechunk=t,i.writeencoding=n,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},ve.prototype._read=function(){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},en(ge,ve),ge.prototype._transform=function(t,n,e){e(null,t)},en(me,Dt),me.Readable=Pn,me.Writable=Zn,me.Duplex=ce,me.Transform=ve,me.PassThrough=ge,me.Stream=me,me.prototype.pipe=function(t,n){var e=this;function i(n){t.writable&&!1===t.write(n)&&e.pause&&e.pause()}function r(){e.readable&&e.resume&&e.resume()}e.on("data",i),t.on("drain",r),t._isStdio||n&&!1===n.end||(e.on("end",u),e.on("close",a));var o=!1;function u(){o||(o=!0,t.end())}function a(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function s(t){if(f(),0===Dt.listenerCount(this,"error"))throw t}function f(){e.removeListener("data",i),t.removeListener("drain",r),e.removeListener("end",u),e.removeListener("close",a),e.removeListener("error",s),t.removeListener("error",s),e.removeListener("end",f),e.removeListener("close",f),t.removeListener("close",f)}return e.on("error",s),t.on("error",s),e.on("end",f),e.on("close",f),t.on("close",f),t.emit("pipe",e),t};const ye=u(Object.freeze({__proto__:null,default:me,Readable:Pn,Writable:Zn,Duplex:ce,Transform:ve,PassThrough:ge,Stream:me})),we=u(xn);var be=o((function(t,n){!function(t){t.parser=function(t,n){return new i(t,n)},t.SAXParser=i,t.SAXStream=o,t.createStream=function(t,n){return new o(t,n)},t.MAX_BUFFER_LENGTH=65536;var n,e=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(n,r){if(!(this instanceof i))return new i(n,r);var o=this;!function(t){for(var n=0,i=e.length;n<i;n++)t[e[n]]=""}(o),o.q=o.c="",o.bufferCheckPosition=t.MAX_BUFFER_LENGTH,o.opt=r||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!n,o.noscript=!(!n&&!o.opt.noscript),o.state=_.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=Object.create(o.strictEntities?t.XML_ENTITIES:t.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(h)),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),C(o,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function n(){}return n.prototype=t,new n}),Object.keys||(Object.keys=function(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e);return n}),i.prototype={end:function(){I(this)},write:function(n){var i=this;if(this.error)throw this.error;if(i.closed)return R(i,"Cannot write after close. Assign an onready handler.");if(null===n)return I(i);"object"==typeof n&&(n=n.toString());for(var r=0,o="";o=U(n,r++),i.c=o,o;)switch(i.trackPosition&&(i.position++,"\n"===o?(i.line++,i.column=0):i.column++),i.state){case _.BEGIN:if(i.state=_.BEGIN_WHITESPACE,"\ufeff"===o)continue;L(i,o);continue;case _.BEGIN_WHITESPACE:L(i,o);continue;case _.TEXT:if(i.sawRoot&&!i.closedRoot){for(var a=r-1;o&&"<"!==o&&"&"!==o;)(o=U(n,r++))&&i.trackPosition&&(i.position++,"\n"===o?(i.line++,i.column=0):i.column++);i.textNode+=n.substring(a,r-1)}"<"!==o||i.sawRoot&&i.closedRoot&&!i.strict?(!b(u,o)||i.sawRoot&&!i.closedRoot||D(i,"Text data outside of root node."),"&"===o?i.state=_.TEXT_ENTITY:i.textNode+=o):(i.state=_.OPEN_WAKA,i.startTagPosition=i.position);continue;case _.SCRIPT:"<"===o?i.state=_.SCRIPT_ENDING:i.script+=o;continue;case _.SCRIPT_ENDING:"/"===o?i.state=_.CLOSE_TAG:(i.script+="<"+o,i.state=_.SCRIPT);continue;case _.OPEN_WAKA:"!"===o?(i.state=_.SGML_DECL,i.sgmlDecl=""):w(u,o)||(w(v,o)?(i.state=_.OPEN_TAG,i.tagName=o):"/"===o?(i.state=_.CLOSE_TAG,i.tagName=""):"?"===o?(i.state=_.PROC_INST,i.procInstName=i.procInstBody=""):(D(i,"Unencoded <"),i.startTagPosition+1<i.position&&(o=new Array(i.position-i.startTagPosition).join(" ")+o),i.textNode+="<"+o,i.state=_.TEXT));continue;case _.SGML_DECL:"[CDATA["===(i.sgmlDecl+o).toUpperCase()?(E(i,"onopencdata"),i.state=_.CDATA,i.sgmlDecl="",i.cdata=""):i.sgmlDecl+o==="--"?(i.state=_.COMMENT,i.comment="",i.sgmlDecl=""):"DOCTYPE"===(i.sgmlDecl+o).toUpperCase()?(i.state=_.DOCTYPE,(i.doctype||i.sawRoot)&&D(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):">"===o?(E(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=_.TEXT):w(f,o)?(i.state=_.SGML_DECL_QUOTED,i.sgmlDecl+=o):i.sgmlDecl+=o;continue;case _.SGML_DECL_QUOTED:o===i.q&&(i.state=_.SGML_DECL,i.q=""),i.sgmlDecl+=o;continue;case _.DOCTYPE:">"===o?(i.state=_.TEXT,E(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=o,"["===o?i.state=_.DOCTYPE_DTD:w(f,o)&&(i.state=_.DOCTYPE_QUOTED,i.q=o));continue;case _.DOCTYPE_QUOTED:i.doctype+=o,o===i.q&&(i.q="",i.state=_.DOCTYPE);continue;case _.DOCTYPE_DTD:i.doctype+=o,"]"===o?i.state=_.DOCTYPE:w(f,o)&&(i.state=_.DOCTYPE_DTD_QUOTED,i.q=o);continue;case _.DOCTYPE_DTD_QUOTED:i.doctype+=o,o===i.q&&(i.state=_.DOCTYPE_DTD,i.q="");continue;case _.COMMENT:"-"===o?i.state=_.COMMENT_ENDING:i.comment+=o;continue;case _.COMMENT_ENDING:"-"===o?(i.state=_.COMMENT_ENDED,i.comment=O(i.opt,i.comment),i.comment&&E(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+o,i.state=_.COMMENT);continue;case _.COMMENT_ENDED:">"!==o?(D(i,"Malformed comment"),i.comment+="--"+o,i.state=_.COMMENT):i.state=_.TEXT;continue;case _.CDATA:"]"===o?i.state=_.CDATA_ENDING:i.cdata+=o;continue;case _.CDATA_ENDING:"]"===o?i.state=_.CDATA_ENDING_2:(i.cdata+="]"+o,i.state=_.CDATA);continue;case _.CDATA_ENDING_2:">"===o?(i.cdata&&E(i,"oncdata",i.cdata),E(i,"onclosecdata"),i.cdata="",i.state=_.TEXT):"]"===o?i.cdata+="]":(i.cdata+="]]"+o,i.state=_.CDATA);continue;case _.PROC_INST:"?"===o?i.state=_.PROC_INST_ENDING:w(u,o)?i.state=_.PROC_INST_BODY:i.procInstName+=o;continue;case _.PROC_INST_BODY:if(!i.procInstBody&&w(u,o))continue;"?"===o?i.state=_.PROC_INST_ENDING:i.procInstBody+=o;continue;case _.PROC_INST_ENDING:">"===o?(E(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=_.TEXT):(i.procInstBody+="?"+o,i.state=_.PROC_INST_BODY);continue;case _.OPEN_TAG:w(p,o)?i.tagName+=o:(x(i),">"===o?F(i):"/"===o?i.state=_.OPEN_TAG_SLASH:(b(u,o)&&D(i,"Invalid character in tag name"),i.state=_.ATTRIB));continue;case _.OPEN_TAG_SLASH:">"===o?(F(i,!0),P(i)):(D(i,"Forward-slash in opening tag not followed by >"),i.state=_.ATTRIB);continue;case _.ATTRIB:if(w(u,o))continue;">"===o?F(i):"/"===o?i.state=_.OPEN_TAG_SLASH:w(v,o)?(i.attribName=o,i.attribValue="",i.state=_.ATTRIB_NAME):D(i,"Invalid attribute name");continue;case _.ATTRIB_NAME:"="===o?i.state=_.ATTRIB_VALUE:">"===o?(D(i,"Attribute without value"),i.attribValue=i.attribName,j(i),F(i)):w(u,o)?i.state=_.ATTRIB_NAME_SAW_WHITE:w(p,o)?i.attribName+=o:D(i,"Invalid attribute name");continue;case _.ATTRIB_NAME_SAW_WHITE:if("="===o)i.state=_.ATTRIB_VALUE;else{if(w(u,o))continue;D(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",E(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",">"===o?F(i):w(v,o)?(i.attribName=o,i.state=_.ATTRIB_NAME):(D(i,"Invalid attribute name"),i.state=_.ATTRIB)}continue;case _.ATTRIB_VALUE:if(w(u,o))continue;w(f,o)?(i.q=o,i.state=_.ATTRIB_VALUE_QUOTED):(D(i,"Unquoted attribute value"),i.state=_.ATTRIB_VALUE_UNQUOTED,i.attribValue=o);continue;case _.ATTRIB_VALUE_QUOTED:if(o!==i.q){"&"===o?i.state=_.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=o;continue}j(i),i.q="",i.state=_.ATTRIB_VALUE_CLOSED;continue;case _.ATTRIB_VALUE_CLOSED:w(u,o)?i.state=_.ATTRIB:">"===o?F(i):"/"===o?i.state=_.OPEN_TAG_SLASH:w(v,o)?(D(i,"No whitespace between attributes"),i.attribName=o,i.attribValue="",i.state=_.ATTRIB_NAME):D(i,"Invalid attribute name");continue;case _.ATTRIB_VALUE_UNQUOTED:if(b(c,o)){"&"===o?i.state=_.ATTRIB_VALUE_ENTITY_U:i.attribValue+=o;continue}j(i),">"===o?F(i):i.state=_.ATTRIB;continue;case _.CLOSE_TAG:if(i.tagName)">"===o?P(i):w(p,o)?i.tagName+=o:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=_.SCRIPT):(b(u,o)&&D(i,"Invalid tagname in closing tag"),i.state=_.CLOSE_TAG_SAW_WHITE);else{if(w(u,o))continue;b(v,o)?i.script?(i.script+="</"+o,i.state=_.SCRIPT):D(i,"Invalid tagname in closing tag."):i.tagName=o}continue;case _.CLOSE_TAG_SAW_WHITE:if(w(u,o))continue;">"===o?P(i):D(i,"Invalid characters in closing tag");continue;case _.TEXT_ENTITY:case _.ATTRIB_VALUE_ENTITY_Q:case _.ATTRIB_VALUE_ENTITY_U:var s,l;switch(i.state){case _.TEXT_ENTITY:s=_.TEXT,l="textNode";break;case _.ATTRIB_VALUE_ENTITY_Q:s=_.ATTRIB_VALUE_QUOTED,l="attribValue";break;case _.ATTRIB_VALUE_ENTITY_U:s=_.ATTRIB_VALUE_UNQUOTED,l="attribValue"}";"===o?(i[l]+=B(i),i.entity="",i.state=s):w(i.entity.length?m:g,o)?i.entity+=o:(D(i,"Invalid character in entity name"),i[l]+="&"+i.entity+o,i.entity="",i.state=s);continue;default:throw new Error(i,"Unknown state: "+i.state)}return i.position>=i.bufferCheckPosition&&function(n){for(var i=Math.max(t.MAX_BUFFER_LENGTH,10),r=0,o=0,u=e.length;o<u;o++){var a=n[e[o]].length;if(a>i)switch(e[o]){case"textNode":k(n);break;case"cdata":E(n,"oncdata",n.cdata),n.cdata="";break;case"script":E(n,"onscript",n.script),n.script="";break;default:R(n,"Max buffer length exceeded: "+e[o])}r=Math.max(r,a)}n.bufferCheckPosition=t.MAX_BUFFER_LENGTH-r+n.position}(i),i}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;k(t=this),""!==t.cdata&&(E(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(E(t,"onscript",t.script),t.script="")}};try{n=ye.Stream}catch(t){n=function(){}}var r=t.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function o(t,e){if(!(this instanceof o))return new o(t,e);n.apply(this),this._parser=new i(t,e),this.writable=!0,this.readable=!0;var u=this;this._parser.onend=function(){u.emit("end")},this._parser.onerror=function(t){u.emit("error",t),u._parser.error=null},this._decoder=null,r.forEach((function(t){Object.defineProperty(u,"on"+t,{get:function(){return u._parser["on"+t]},set:function(n){if(!n)return u.removeAllListeners(t),u._parser["on"+t]=n,n;u.on(t,n)},enumerable:!0,configurable:!1})}))}(o.prototype=Object.create(n.prototype,{constructor:{value:o}})).write=function(t){return"function"==typeof X.isBuffer&&X.isBuffer(t)&&(this._decoder||(this._decoder=new(0,we.StringDecoder)("utf8")),t=this._decoder.write(t)),this._parser.write(t.toString()),this.emit("data",t),!0},o.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},o.prototype.on=function(t,e){var i=this;return i._parser["on"+t]||-1===r.indexOf(t)||(i._parser["on"+t]=function(){var n=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);n.splice(0,0,t),i.emit.apply(i,n)}),n.prototype.on.call(i,t,e)};var u="\r\n\t ",a="0124356789",s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",f="'\"",c=u+">",l="http://www.w3.org/XML/1998/namespace",d="http://www.w3.org/2000/xmlns/",h={xml:l,xmlns:d};u=y(u),a=y(a),s=y(s);var v=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,g=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function y(t){return t.split("").reduce((function(t,n){return t[n]=!0,t}),{})}function w(t,n){return function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}(t)?!!n.match(t):t[n]}function b(t,n){return!w(t,n)}f=y(f),c=y(c);var M,T,N,_=0;for(var S in t.STATE={BEGIN:_++,BEGIN_WHITESPACE:_++,TEXT:_++,TEXT_ENTITY:_++,OPEN_WAKA:_++,SGML_DECL:_++,SGML_DECL_QUOTED:_++,DOCTYPE:_++,DOCTYPE_QUOTED:_++,DOCTYPE_DTD:_++,DOCTYPE_DTD_QUOTED:_++,COMMENT_STARTING:_++,COMMENT:_++,COMMENT_ENDING:_++,COMMENT_ENDED:_++,CDATA:_++,CDATA_ENDING:_++,CDATA_ENDING_2:_++,PROC_INST:_++,PROC_INST_BODY:_++,PROC_INST_ENDING:_++,OPEN_TAG:_++,OPEN_TAG_SLASH:_++,ATTRIB:_++,ATTRIB_NAME:_++,ATTRIB_NAME_SAW_WHITE:_++,ATTRIB_VALUE:_++,ATTRIB_VALUE_QUOTED:_++,ATTRIB_VALUE_CLOSED:_++,ATTRIB_VALUE_UNQUOTED:_++,ATTRIB_VALUE_ENTITY_Q:_++,ATTRIB_VALUE_ENTITY_U:_++,CLOSE_TAG:_++,CLOSE_TAG_SAW_WHITE:_++,SCRIPT:_++,SCRIPT_ENDING:_++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(n){var e=t.ENTITIES[n],i="number"==typeof e?String.fromCharCode(e):e;t.ENTITIES[n]=i})),t.STATE)t.STATE[t.STATE[S]]=S;function C(t,n,e){t[n]&&t[n](e)}function E(t,n,e){t.textNode&&k(t),C(t,n,e)}function k(t){t.textNode=O(t.opt,t.textNode),t.textNode&&C(t,"ontext",t.textNode),t.textNode=""}function O(t,n){return t.trim&&(n=n.trim()),t.normalize&&(n=n.replace(/\s+/g," ")),n}function R(t,n){return k(t),t.trackPosition&&(n+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),n=new Error(n),t.error=n,C(t,"onerror",n),t}function I(t){return t.sawRoot&&!t.closedRoot&&D(t,"Unclosed root tag"),t.state!==_.BEGIN&&t.state!==_.BEGIN_WHITESPACE&&t.state!==_.TEXT&&R(t,"Unexpected end"),k(t),t.c="",t.closed=!0,C(t,"onend"),i.call(t,t.strict,t.opt),t}function D(t,n){if("object"!=typeof t||!(t instanceof i))throw new Error("bad call to strictFail");t.strict&&R(t,n)}function x(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var n=t.tags[t.tags.length-1]||t,e=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(e.ns=n.ns),t.attribList.length=0,E(t,"onopentagstart",e)}function A(t,n){var e=t.indexOf(":")<0?["",t]:t.split(":"),i=e[0],r=e[1];return n&&"xmlns"===t&&(i="xmlns",r=""),{prefix:i,local:r}}function j(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var n=A(t.attribName,!0),e=n.local;if("xmlns"===n.prefix)if("xml"===e&&t.attribValue!==l)D(t,"xml: prefix must be bound to "+l+"\nActual: "+t.attribValue);else if("xmlns"===e&&t.attribValue!==d)D(t,"xmlns: prefix must be bound to "+d+"\nActual: "+t.attribValue);else{var i=t.tag,r=t.tags[t.tags.length-1]||t;i.ns===r.ns&&(i.ns=Object.create(r.ns)),i.ns[e]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,E(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function F(t,n){if(t.opt.xmlns){var e=t.tag,i=A(t.tagName);e.prefix=i.prefix,e.local=i.local,e.uri=e.ns[i.prefix]||"",e.prefix&&!e.uri&&(D(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),e.uri=i.prefix),e.ns&&(t.tags[t.tags.length-1]||t).ns!==e.ns&&Object.keys(e.ns).forEach((function(n){E(t,"onopennamespace",{prefix:n,uri:e.ns[n]})}));for(var r=0,o=t.attribList.length;r<o;r++){var u=t.attribList[r],a=u[0],s=u[1],f=A(a,!0),c=f.prefix,l=""===c?"":e.ns[c]||"",d={name:a,value:s,prefix:c,local:f.local,uri:l};c&&"xmlns"!==c&&!l&&(D(t,"Unbound namespace prefix: "+JSON.stringify(c)),d.uri=c),t.tag.attributes[a]=d,E(t,"onattribute",d)}t.attribList.length=0}t.tag.isSelfClosing=!!n,t.sawRoot=!0,t.tags.push(t.tag),E(t,"onopentag",t.tag),n||(t.state=t.noscript||"script"!==t.tagName.toLowerCase()?_.TEXT:_.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function P(t){if(!t.tagName)return D(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=_.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=_.SCRIPT);E(t,"onscript",t.script),t.script=""}var n=t.tags.length,e=t.tagName;t.strict||(e=e[t.looseCase]());for(var i=e;n--&&t.tags[n].name!==i;)D(t,"Unexpected close tag");if(n<0)return D(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=_.TEXT);t.tagName=e;for(var r=t.tags.length;r-- >n;){var o=t.tag=t.tags.pop();t.tagName=t.tag.name,E(t,"onclosetag",t.tagName);var u={};for(var a in o.ns)u[a]=o.ns[a];t.opt.xmlns&&o.ns!==(t.tags[t.tags.length-1]||t).ns&&Object.keys(o.ns).forEach((function(n){E(t,"onclosenamespace",{prefix:n,uri:o.ns[n]})}))}0===n&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=_.TEXT}function B(t){var n,e=t.entity,i=e.toLowerCase(),r="";return t.ENTITIES[e]?t.ENTITIES[e]:t.ENTITIES[i]?t.ENTITIES[i]:("#"===(e=i).charAt(0)&&("x"===e.charAt(1)?(e=e.slice(2),r=(n=parseInt(e,16)).toString(16)):(e=e.slice(1),r=(n=parseInt(e,10)).toString(10))),e=e.replace(/^0+/,""),r.toLowerCase()!==e?(D(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(n))}function L(t,n){"<"===n?(t.state=_.OPEN_WAKA,t.startTagPosition=t.position):b(u,n)&&(D(t,"Non-whitespace before first tag."),t.textNode=n,t.state=_.TEXT)}function U(t,n){var e="";return n<t.length&&(e=t.charAt(n)),e}_=t.STATE,String.fromCodePoint||(M=String.fromCharCode,T=Math.floor,N=function(){var t=16384,n=[],e=-1,i=arguments.length;if(!i)return"";for(var r="";++e<i;){var o=Number(arguments[e]);if(!isFinite(o)||o<0||o>1114111||T(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?n.push(o):n.push(55296+((o-=65536)>>10),o%1024+56320),(e+1===i||n.length>t)&&(r+=M.apply(null,n),n.length=0)}return r},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:N,configurable:!0,writable:!0}):String.fromCodePoint=N)}(n)})),Me=o((function(t,n){!function(t,n,e,i,r){function o(t){if("contents"in t)for(var n=("styleAttrs"in t?t.styleAttrs[i.byName.ruby.qname]:null),e="span"===t.kind&&("container"===n||"textContainer"===n||"baseContainer"===n),r=t.contents.length-1;r>=0;r--)!e||"styleAttrs"in t.contents[r]&&i.byName.ruby.qname in t.contents[r].styleAttrs?o(t.contents[r]):delete t.contents[r]}function u(t,n,e,i){var r=i&&"seq"===i.timeContainer,o=0;i&&(o=r&&e?e.end:i.begin),n.begin=n.explicit_begin?n.explicit_begin+o:o;var a=n.begin,s=null;for(var f in n.sets)u(t,n.sets[f],s,n),a="seq"===n.timeContainer?n.sets[f].end:Math.max(a,n.sets[f].end),s=n.sets[f];if("contents"in n)for(var c in n.contents)u(t,n.contents[c],s,n),a="seq"===n.timeContainer?n.contents[c].end:Math.max(a,n.contents[c].end),s=n.contents[c];else a=r?n.begin:Number.POSITIVE_INFINITY;n.end=null!==n.explicit_end&&null!==n.explicit_dur?Math.min(n.begin+n.explicit_dur,o+n.explicit_end):null===n.explicit_end&&null!==n.explicit_dur?n.begin+n.explicit_dur:null!==n.explicit_end&&null===n.explicit_dur?o+n.explicit_end:a,delete n.explicit_begin,delete n.explicit_dur,delete n.explicit_end,t._registerEvent(n)}function a(t){this.node=t}function s(){this.events=[],this.head=new f,this.body=null}function f(){this.styling=new c,this.layout=new h}function c(){this.styles={},this.initials={}}function l(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function d(){this.styleAttrs=null}function h(){this.regions={}}function v(t,n){p.call(this,"image"),this.src=t,this.type=n}function p(t){this.kind=t}function g(t){this.id=t}function m(t){this.regionID=t}function y(t){this.styleAttrs=t}function w(t){this.sets=t}function b(t){this.contents=t}function M(t,n,e){this.explicit_begin=t,this.explicit_end=n,this.explicit_dur=e}function T(){p.call(this,"body")}function N(){p.call(this,"div")}function _(){p.call(this,"p")}function S(){p.call(this,"span")}function C(){p.call(this,"span")}function E(){p.call(this,"br")}function k(){}function O(){}function R(t){return t&&"xml:id"in t.attributes&&t.attributes["xml:id"].value||null}function I(t){return t&&"style"in t.attributes?t.attributes.style.value.split(" "):[]}function D(t,n){var e={};if(null!==t)for(var r in t.attributes){var o=t.attributes[r].uri+" "+t.attributes[r].local,u=i.byQName[o];if(void 0!==u){var a=u.parse(t.attributes[r].value);null!==a?(e[o]=a,u===i.byName.zIndex&&B(n,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):L(n,"Cannot parse styling attribute "+o+" --\x3e "+t.attributes[r].value)}}return e}function x(t,n,e){for(var i in t.attributes)if(t.attributes[i].uri===n&&t.attributes[i].local===e)return t.attributes[i].value;return null}function A(t,n,e){var i,r=null;return null!==(i=/^(\d+(?:\.\d+)?)f$/.exec(e))?null!==n&&(r=parseFloat(i[1])/n):null!==(i=/^(\d+(?:\.\d+)?)t$/.exec(e))?null!==t&&(r=parseFloat(i[1])/t):null!==(i=/^(\d+(?:\.\d+)?)ms$/.exec(e))?r=parseFloat(i[1])/1e3:null!==(i=/^(\d+(?:\.\d+)?)s$/.exec(e))?r=parseFloat(i[1]):null!==(i=/^(\d+(?:\.\d+)?)h$/.exec(e))?r=3600*parseFloat(i[1]):null!==(i=/^(\d+(?:\.\d+)?)m$/.exec(e))?r=60*parseFloat(i[1]):null!==(i=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(e))?r=3600*parseInt(i[1])+60*parseInt(i[2])+parseFloat(i[3]):null!==(i=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(e))&&null!==n&&(r=3600*parseInt(i[1])+60*parseInt(i[2])+parseInt(i[3])+(null===i[4]?0:parseInt(i[4])/n)),r}function j(t,n,e){for(;n.styleRefs.length>0;){var i=n.styleRefs.pop();i in t.styles?(j(t,t.styles[i],e),P(t.styles[i].styleAttrs,n.styleAttrs)):L(e,"Non-existant style id referenced")}}function F(t,n,e,i){for(var r=n.length-1;r>=0;r--){var o=n[r];o in t.styles?P(t.styles[o].styleAttrs,e):L(i,"Non-existant style id referenced")}}function P(t,n){for(var e in t)e in n||(n[e]=t[e])}function B(t,n){if(t&&t.warn&&t.warn(n))throw n}function L(t,n){if(t&&t.error&&t.error(n))throw n}function U(t,n){throw t&&t.fatal&&t.fatal(n),n}function q(t,n){for(var e,i=0,r=t.length-1;i<=r;){var o=t[e=Math.floor((i+r)/2)];if(o<n)i=e+1;else{if(!(o>n))return{found:!0,index:e};r=e-1}}return{found:!1,index:i}}t.fromXML=function(t,r,p){var g=n.parser(!0,{xmlns:!0}),m=[],y=[],w=0,b=null;g.onclosetag=function(){if(m[0]instanceof c)for(var t in m[0].styles)j(m[0],m[0].styles[t],r);else if(m[0]instanceof _||m[0]instanceof S){if(m[0].contents.length>1){var n,i=[m[0].contents[0]];for(n=1;n<m[0].contents.length;n++)m[0].contents[n]instanceof C&&i[i.length-1]instanceof C?i[i.length-1].text+=m[0].contents[n].text:i.push(m[0].contents[n]);m[0].contents=i}m[0]instanceof S&&1===m[0].contents.length&&m[0].contents[0]instanceof C&&(m[0].text=m[0].contents[0].text,delete m[0].contents)}else m[0]instanceof a&&(m[0].node.uri===e.ns_tt&&"metadata"===m[0].node.local?w--:w>0&&p&&"onCloseTag"in p&&p.onCloseTag());y.shift(),m.shift()},g.ontext=function(t){if(void 0===m[0]);else if(m[0]instanceof S||m[0]instanceof _){if(m[0]instanceof S){var n=m[0].styleAttrs[i.byName.ruby.qname];if("container"===n||"textContainer"===n||"baseContainer"===n)return}var e=new C;e.initFromText(b,m[0],t,y[0],r),m[0].contents.push(e)}else m[0]instanceof a&&w>0&&p&&"onText"in p&&p.onText(t)},g.onopentag=function(t){var n=t.attributes["xml:space"];if(y.unshift(n?n.value:0===y.length?"default":y[0]),t.uri===e.ns_tt)if("tt"===t.local)null!==b&&U(r,"Two <tt> elements at ("+this.line+","+this.column+")"),(b=new s).initFromNode(t,r),m.unshift(b);else if("head"===t.local)m[0]instanceof s||U(r,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),m.unshift(b.head);else if("styling"===t.local)m[0]instanceof f||U(r,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),m.unshift(b.head.styling);else if("style"===t.local){var o;m[0]instanceof c?((o=new l).initFromNode(t,r),o.id?b.head.styling.styles[o.id]=o:L(r,"<style> element missing @id attribute"),m.unshift(o)):m[0]instanceof k?((o=new l).initFromNode(t,r),P(o.styleAttrs,m[0].styleAttrs),m.unshift(o)):U(r,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("initial"===t.local){var u;if(m[0]instanceof c){for(var g in(u=new d).initFromNode(t,r),u.styleAttrs)b.head.styling.initials[g]=u.styleAttrs[g];m.unshift(u)}else U(r,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if("layout"===t.local)m[0]instanceof f||U(r,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),m.unshift(b.head.layout);else if("region"===t.local){m[0]instanceof h||U(r,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var M=new k;M.initFromNode(b,t,r),!M.id||M.id in b.head.layout.regions?L(r,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):b.head.layout.regions[M.id]=M,m.unshift(M)}else if("body"===t.local){m[0]instanceof s||U(r,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==b.body&&U(r,"Second <body> element at "+this.line+","+this.column+")");var C=new T;C.initFromNode(b,t,r),b.body=C,m.unshift(C)}else if("div"===t.local){m[0]instanceof N||m[0]instanceof T||U(r,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var R=new N;R.initFromNode(b,m[0],t,r);var I=R.styleAttrs[i.byName.backgroundImage.qname];I&&(R.contents.push(new v(I)),delete R.styleAttrs[i.byName.backgroundImage.qname]),m[0].contents.push(R),m.unshift(R)}else if("image"===t.local){m[0]instanceof N||U(r,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var D=new v;D.initFromNode(b,m[0],t,r),m[0].contents.push(D),m.unshift(D)}else if("p"===t.local){m[0]instanceof N||U(r,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var x=new _;x.initFromNode(b,m[0],t,r),m[0].contents.push(x),m.unshift(x)}else if("span"===t.local){m[0]instanceof S||m[0]instanceof _||U(r,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var A=new S;A.initFromNode(b,m[0],t,y[0],r),m[0].contents.push(A),m.unshift(A)}else if("br"===t.local){m[0]instanceof S||m[0]instanceof _||U(r,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var j=new E;j.initFromNode(b,m[0],t,r),m[0].contents.push(j),m.unshift(j)}else if("set"===t.local){m[0]instanceof S||m[0]instanceof _||m[0]instanceof N||m[0]instanceof T||m[0]instanceof k||m[0]instanceof E||U(r,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var F=new O;F.initFromNode(b,m[0],t,r),m[0].sets.push(F),m.unshift(F)}else m.unshift(new a(t));else m.unshift(new a(t));if(m[0]instanceof a)if(t.uri===e.ns_tt&&"metadata"===t.local)w++;else if(w>0&&p&&"onOpenTag"in p){var B=[];for(var q in t.attributes)B[t.attributes[q].uri+" "+t.attributes[q].local]={uri:t.attributes[q].uri,local:t.attributes[q].local,value:t.attributes[q].value};p.onOpenTag(t.uri,t.local,B)}},g.write(t).close(),delete b.head.styling.styles;var M=!1;for(var R in b.head.layout.regions){M=!0;break}if(!M){var I=k.prototype.createDefaultRegion();b.head.layout.regions[I.id]=I}for(var D in b.head.layout.regions)u(b,b.head.layout.regions[D],null,null);return b.body&&u(b,b.body,null,null),b.body&&o(b.body),b},s.prototype.initFromNode=function(t,n){var i=function(t,n){var i=x(t,e.ns_ttp,"cellResolution"),r=15,o=32;if(null!==i){var u=/(\d+) (\d+)/.exec(i);null!==u?(o=parseInt(u[1]),r=parseInt(u[2])):B(n,"Malformed cellResolution value (using initial value instead)")}return{w:o,h:r}}(t,n);this.cellLength={h:new r.ComputedLength(0,1/i.h),w:new r.ComputedLength(1/i.w,0)};var o=function(t,n){var i,r=x(t,e.ns_ttp,"frameRate"),o=30;null!==r&&(null!==(i=/(\d+)/.exec(r))?o=parseInt(i[1]):B(n,"Malformed frame rate attribute (using initial value instead)"));var u=x(t,e.ns_ttp,"frameRateMultiplier"),a=1;null!==u&&(null!==(i=/(\d+) (\d+)/.exec(u))?a=parseInt(i[1])/parseInt(i[2]):B(n,"Malformed frame rate multiplier attribute (using initial value instead)"));var s=a*o,f=1,c=x(t,e.ns_ttp,"tickRate");return null===c?null!==r&&(f=s):null!==(i=/(\d+)/.exec(c))?f=parseInt(i[1]):B(n,"Malformed tick rate attribute (using initial value instead)"),{effectiveFrameRate:s,tickRate:f}}(t,n);this.effectiveFrameRate=o.effectiveFrameRate,this.tickRate=o.tickRate,this.aspectRatio=function(t,n){var i=x(t,e.ns_ittp,"aspectRatio");null===i&&(i=x(t,e.ns_ttp,"displayAspectRatio"));var r=null;if(null!==i){var o=/(\d+)\s+(\d+)/.exec(i);if(null!==o){var u=parseInt(o[1]),a=parseInt(o[2]);0!==u&&0!==a?r=u/a:L(n,"Illegal aspectRatio values (ignoring)")}else L(n,"Malformed aspectRatio attribute (ignoring)")}return r}(t,n);var u=x(t,e.ns_ttp,"timeBase");null!==u&&"media"!==u&&U(n,"Unsupported time base");var a=function(t,n){var i=x(t,e.ns_tts,"extent");if(null===i)return null;var o=i.split(" ");if(2!==o.length)return B(n,"Malformed extent (ignoring)"),null;var u=r.parseLength(o[0]),a=r.parseLength(o[1]);return a&&u?{h:a,w:u}:(B(n,"Malformed extent values (ignoring)"),null)}(t,n);null===a?this.pxLength={h:null,w:null}:("px"===a.h.unit&&"px"===a.w.unit||U(n,"Extent on TT must be in px or absent"),this.pxLength={h:new r.ComputedLength(0,1/a.h.value),w:new r.ComputedLength(1/a.w.value,0)}),this.dimensions={h:new r.ComputedLength(0,1),w:new r.ComputedLength(1,0)}},s.prototype._registerEvent=function(t){if(!(t.end<=t.begin)){var n=q(this.events,t.begin);if(n.found||this.events.splice(n.index,0,t.begin),t.end!==Number.POSITIVE_INFINITY){var e=q(this.events,t.end);e.found||this.events.splice(e.index,0,t.end)}}},s.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},s.prototype.getMediaTimeEvents=function(){return this.events},l.prototype.initFromNode=function(t,n){this.id=R(t),this.styleAttrs=D(t,n),this.styleRefs=I(t)},d.prototype.initFromNode=function(t){for(var n in this.styleAttrs={},t.attributes)t.attributes[n].uri!==e.ns_itts&&t.attributes[n].uri!==e.ns_ebutts&&t.attributes[n].uri!==e.ns_tts||(this.styleAttrs[t.attributes[n].uri+" "+t.attributes[n].local]=t.attributes[n].value)},v.prototype.initFromNode=function(t,n,e,i){this.src="src"in e.attributes?e.attributes.src.value:null,this.src||L(i,"Invalid image@src attribute"),this.type="type"in e.attributes?e.attributes.type.value:null,this.type||L(i,"Invalid image@type attribute"),y.prototype.initFromNode.call(this,t,n,e,i),M.prototype.initFromNode.call(this,t,n,e,i),w.prototype.initFromNode.call(this,t,n,e,i),m.prototype.initFromNode.call(this,t,n,e,i)},g.prototype.initFromNode=function(t,n,e){this.id=R(e)},m.prototype.initFromNode=function(t,n,e){this.regionID=function(t){return t&&"region"in t.attributes?t.attributes.region.value:""}(e)},y.prototype.initFromNode=function(t,n,e,i){this.styleAttrs=D(e,i),null!==t.head&&null!==t.head.styling&&F(t.head.styling,I(e),this.styleAttrs,i)},w.prototype.initFromNode=function(){this.sets=[]},b.prototype.initFromNode=function(){this.contents=[]},M.prototype.initFromNode=function(t,n,e,i){var r=function(t,n,e,i){var r=null;e&&"begin"in e.attributes&&null===(r=A(t.tickRate,t.effectiveFrameRate,e.attributes.begin.value))&&B(i,"Malformed begin value "+e.attributes.begin.value+" (using 0)");var o=null;e&&"dur"in e.attributes&&null===(o=A(t.tickRate,t.effectiveFrameRate,e.attributes.dur.value))&&B(i,"Malformed dur value "+e.attributes.dur.value+" (ignoring)");var u=null;return e&&"end"in e.attributes&&null===(u=A(t.tickRate,t.effectiveFrameRate,e.attributes.end.value))&&B(i,"Malformed end value (ignoring)"),{explicit_begin:r,explicit_end:u,explicit_dur:o}}(t,0,e,i);this.explicit_begin=r.explicit_begin,this.explicit_end=r.explicit_end,this.explicit_dur=r.explicit_dur,this.timeContainer=function(t,n){var e=t&&"timeContainer"in t.attributes?t.attributes.timeContainer.value:null;return e&&"par"!==e?"seq"===e?"seq":(L(n,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(e,i)},T.prototype.initFromNode=function(t,n,e){y.prototype.initFromNode.call(this,t,null,n,e),M.prototype.initFromNode.call(this,t,null,n,e),w.prototype.initFromNode.call(this,t,null,n,e),m.prototype.initFromNode.call(this,t,null,n,e),b.prototype.initFromNode.call(this,t,null,n,e)},N.prototype.initFromNode=function(t,n,e,i){y.prototype.initFromNode.call(this,t,n,e,i),M.prototype.initFromNode.call(this,t,n,e,i),w.prototype.initFromNode.call(this,t,n,e,i),m.prototype.initFromNode.call(this,t,n,e,i),b.prototype.initFromNode.call(this,t,n,e,i)},_.prototype.initFromNode=function(t,n,e,i){y.prototype.initFromNode.call(this,t,n,e,i),M.prototype.initFromNode.call(this,t,n,e,i),w.prototype.initFromNode.call(this,t,n,e,i),m.prototype.initFromNode.call(this,t,n,e,i),b.prototype.initFromNode.call(this,t,n,e,i)},S.prototype.initFromNode=function(t,n,e,i,r){y.prototype.initFromNode.call(this,t,n,e,r),M.prototype.initFromNode.call(this,t,n,e,r),w.prototype.initFromNode.call(this,t,n,e,r),m.prototype.initFromNode.call(this,t,n,e,r),b.prototype.initFromNode.call(this,t,n,e,r),this.space=i},C.prototype.initFromText=function(t,n,e,i,r){M.prototype.initFromNode.call(this,t,n,null,r),this.text=e,this.space=i},E.prototype.initFromNode=function(t,n,e,i){m.prototype.initFromNode.call(this,t,n,e,i),M.prototype.initFromNode.call(this,t,n,e,i)},k.prototype.createDefaultRegion=function(){var t=new k;return g.call(t,""),y.call(t,{}),w.call(t,[]),M.call(t,0,Number.POSITIVE_INFINITY,null),t},k.prototype.initFromNode=function(t,n,e){g.prototype.initFromNode.call(this,t,null,n,e),y.prototype.initFromNode.call(this,t,null,n,e),M.prototype.initFromNode.call(this,t,null,n,e),w.prototype.initFromNode.call(this,t,null,n,e),null!==t.head&&null!==t.head.styling&&F(t.head.styling,I(n),this.styleAttrs,e)},O.prototype.initFromNode=function(t,n,e,i){M.prototype.initFromNode.call(this,t,n,e,i);var r=D(e,i);for(var o in this.qname=null,this.value=null,r){if(this.qname){L(i,"More than one style specified on set");break}this.qname=o,this.value=r[o]}}}(n,"undefined"==typeof sax?be:sax,"undefined"==typeof imscNames?D:imscNames,"undefined"==typeof imscStyles?A:imscStyles,"undefined"==typeof imscUtils?x:imscUtils)})),Te=o((function(t,n){!function(t,n,e){function i(t,n,a){var f;if("region"===a.kind)(f=document.createElement("div")).style.position="absolute";else if("body"===a.kind)f=document.createElement("div");else if("div"===a.kind)f=document.createElement("div");else if("image"===a.kind){if(f=document.createElement("img"),null!==t.imgResolver&&null!==a.src){var c=t.imgResolver(a.src,f);c&&(f.src=c),f.height=t.regionH,f.width=t.regionW}}else if("p"===a.kind)f=document.createElement("p");else if("span"===a.kind){if("container"===a.styleAttrs[e.byName.ruby.qname])f=document.createElement("ruby"),t.ruby=!0;else if("base"===a.styleAttrs[e.byName.ruby.qname])f=document.createElement("rb");else if("text"===a.styleAttrs[e.byName.ruby.qname])f=document.createElement("rt");else if("baseContainer"===a.styleAttrs[e.byName.ruby.qname])f=document.createElement("rbc");else if("textContainer"===a.styleAttrs[e.byName.ruby.qname])f=document.createElement("rtc");else{if("delimiter"===a.styleAttrs[e.byName.ruby.qname])return;f=document.createElement("span")}var l=a.styleAttrs[e.byName.textEmphasis.qname];l&&"none"!==l.style&&(t.textEmphasis=!0)}else"br"===a.kind&&(f=document.createElement("br"));if(f){for(var d in n.appendChild(f),f.style.margin="0",s){var h=s[d],v=a.styleAttrs[h.qname];void 0!==v&&null!==h.map&&h.map(t,f,a,v)}var p=f;if("region"===a.kind){var g=a.styleAttrs[e.byName.writingMode.qname];"lrtb"===g||"lr"===g?(t.ipd="lr",t.bpd="tb"):"rltb"===g||"rl"===g?(t.ipd="rl",t.bpd="tb"):"tblr"===g?(t.ipd="tb",t.bpd="lr"):"tbrl"!==g&&"tb"!==g||(t.ipd="tb",t.bpd="rl")}var m=a.styleAttrs[e.byName.linePadding.qname];if(m&&!m.isZero()){var y=m.toUsedLength(t.w,t.h);if(y>0){var w=Math.ceil(y)+"px";"tb"===t.bpd?(p.style.paddingLeft=w,p.style.paddingRight=w):(p.style.paddingTop=w,p.style.paddingBottom=w),t.lp=m}}var b=a.styleAttrs[e.byName.multiRowAlign.qname];if(b&&"auto"!==b){var M=document.createElement("span");M.style.display="inline-block",M.style.textAlign=b,f.appendChild(M),p=M,t.mra=b}var T=a.styleAttrs[e.byName.rubyReserve.qname];if(T&&"none"!==T[0]&&(t.rubyReserve=T),a.styleAttrs[e.byName.fillLineGap.qname]&&(t.flg=!0),"span"===a.kind&&a.text)if(e.byName.textCombine.qname in a.styleAttrs&&"all"===a.styleAttrs[e.byName.textCombine.qname][0])f.textContent=a.text;else for(var N="",_=0;_<a.text.length;_++){N+=a.text.charAt(_);var S=a.text.charCodeAt(_);if(S<55296||S>56319||_===a.text.length){var C=document.createElement("span");C.textContent=N,f.appendChild(C),N=""}}for(var E in a.contents)i(t,p,a.contents[E]);var k=[];if((t.lp||t.mra||t.flg||t.ruby||t.textEmphasis||t.rubyReserve)&&"p"===a.kind&&(u(t,p,k,null),t.rubyReserve&&(function(t,n){for(var e=0;e<t.length;e++){var i,r,o=document.createElement("ruby"),u=document.createElement("rb");u.textContent="",o.appendChild(u);var a=n.rubyReserve[1].toUsedLength(n.w,n.h)+"px";"both"===n.rubyReserve[0]?((i=document.createElement("rtc")).style.rubyPosition="under",i.textContent="",i.style.fontSize=a,(r=document.createElement("rtc")).style.rubyPosition="over",r.textContent="",r.style.fontSize=a,o.appendChild(i),o.appendChild(r)):((i=document.createElement("rtc")).textContent="",i.style.fontSize=a,i.style.rubyPosition="after"===n.rubyReserve[0]||"outside"===n.rubyReserve[0]&&e>0?"tb"===n.bpd||"rl"===n.bpd?"under":"over":"tb"===n.bpd||"rl"===n.bpd?"over":"under",o.appendChild(i)),t[e].elements[0].node.parentElement.insertBefore(o,t[e].elements[0].node)}}(k,t),t.rubyReserve=null),(t.ruby||t.rubyReserve)&&(function(t,n){for(var e=0;e<t.length;e++)for(var i=0;i<t[e].rbc.length;i++)t[e].rbc[i].style.rubyPosition||(t[e].rbc[i].style.rubyPosition="tb"===n.bpd||"rl"===n.bpd?0===e?"over":"under":0===e?"under":"over")}(k,t),t.ruby=null),t.textEmphasis&&(function(t,n){for(var e=0;e<t.length;e++)for(var i=0;i<t[e].te.length;i++)t[e].te[i].style.textEmphasisPosition&&"none"!==t[e].te[i].style.textEmphasisPosition||(t[e].te[i].style.textEmphasisPosition="tb"===n.bpd?0===e?"left over":"left under":"rl"===n.bpd?0===e?"right under":"left under":0===e?"left under":"right under")}(k,t),t.textEmphasis=null),t.mra&&(function(t){for(var n=0;n<t.length-1;n++){var e=t[n].elements.length;if(0!==e&&!1===t[n].br){var i=document.createElement("br"),r=t[n].elements[e-1].node;r.parentElement.insertBefore(i,r.nextSibling)}}}(k),t.mra=null),t.lp&&(function(t,n,e){for(var i in t){var r=t[i].elements.length,o=t[i].elements[t[i].start_elem],u=t[i].elements[t[i].end_elem],a=Math.ceil(n)+"px",s="-"+Math.ceil(n)+"px";0!==r&&("lr"===e.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=a,o.node.style.marginLeft=s):"rl"===e.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=a,o.node.style.marginRight=s):"tb"===e.ipd&&(o.node.style.borderTopColor=o.bgcolor||"#00000000",o.node.style.borderTopStyle="solid",o.node.style.borderTopWidth=a,o.node.style.marginTop=s),"lr"===e.ipd?(u.node.style.borderRightColor=u.bgcolor||"#00000000",u.node.style.borderRightStyle="solid",u.node.style.borderRightWidth=a,u.node.style.marginRight=s):"rl"===e.ipd?(u.node.style.borderLeftColor=u.bgcolor||"#00000000",u.node.style.borderLeftStyle="solid",u.node.style.borderLeftWidth=a,u.node.style.marginLeft=s):"tb"===e.ipd&&(u.node.style.borderBottomColor=u.bgcolor||"#00000000",u.node.style.borderBottomStyle="solid",u.node.style.borderBottomWidth=a,u.node.style.marginBottom=s))}}(k,t.lp.toUsedLength(t.w,t.h),t),t.lp=null),t.flg)){var O=o(p.getBoundingClientRect(),t);!function(t,n,e,i){for(var r=Math.sign(e-n),o=0;o<=t.length;o++){var u,a,s;if(u=0===o?n:o===t.length?e:(t[o].before+t[o-1].after)/2,o>0)for(var f=0;f<t[o-1].elements.length;f++)null!==t[o-1].elements[f].bgcolor&&r*((s=t[o-1].elements[f]).after-u)<0&&(a=Math.ceil(Math.abs(u-s.after))+"px",s.node.style.backgroundColor=s.bgcolor,"lr"===i.bpd?s.node.style.paddingRight=a:"rl"===i.bpd?s.node.style.paddingLeft=a:"tb"===i.bpd&&(s.node.style.paddingBottom=a));if(o<t.length)for(var c=0;c<t[o].elements.length;c++)null!==(s=t[o].elements[c]).bgcolor&&r*(s.before-u)>0&&(a=Math.ceil(Math.abs(s.before-u))+"px",s.node.style.backgroundColor=s.bgcolor,"lr"===i.bpd?s.node.style.paddingLeft=a:"rl"===i.bpd?s.node.style.paddingRight=a:"tb"===i.bpd&&(s.node.style.paddingTop=a))}}(k,O.before,O.after,t),t.flg=null}if("region"===a.kind&&(u(t,p,k),"tb"===t.bpd&&t.enableRollUp&&a.contents.length>0&&"after"===a.styleAttrs[e.byName.displayAlign.qname])){var R=new r(""===a.id?"_":a.id,k);if(t.currentISDState[R.id]=R,t.previousISDState&&R.id in t.previousISDState&&t.previousISDState[R.id].plist.length>0&&R.plist.length>1&&R.plist[R.plist.length-2].text===t.previousISDState[R.id].plist[t.previousISDState[R.id].plist.length-1].text){var I=f.firstElementChild,D=R.plist[R.plist.length-1].after-R.plist[R.plist.length-1].before;I.style.bottom="-"+D+"px",I.style.transition="transform 0.4s",I.style.position="relative",I.style.transform="translateY(-"+D+"px)"}}}else!function(t,n){if(t&&t.error&&t.error(n))throw n}(t.errorHandler,"Error processing ISD element kind: "+a.kind)}function r(t,n){this.id=t,this.plist=n}function o(t,n){var e={before:null,after:null,start:null,end:null};return"tb"===n.bpd?(e.before=t.top,e.after=t.bottom,"lr"===n.ipd?(e.start=t.left,e.end=t.right):(e.start=t.right,e.end=t.left)):"lr"===n.bpd?(e.before=t.left,e.after=t.right,e.start=t.top,e.end=t.bottom):"rl"===n.bpd&&(e.before=t.right,e.after=t.left,e.start=t.top,e.end=t.bottom),e}function u(t,n,e,i){if("rt"!==n.localName&&"rtc"!==n.localName){var r,a,s,f,c=n.style.backgroundColor||i;if(0===n.childElementCount)if("span"===n.localName||"rb"===n.localName){var l=n.getBoundingClientRect();if(0===l.height||0===l.width)return;var d=o(l,t);if(0!==e.length&&(r=d.before,s=e[e.length-1].before,(a=d.after)<(f=e[e.length-1].after)&&r>s||f<=a&&s>=r)){var h=Math.sign(d.after-d.before),v=Math.sign(d.end-d.start);h*(d.before-e[e.length-1].before)<0&&(e[e.length-1].before=d.before),h*(d.after-e[e.length-1].after)>0&&(e[e.length-1].after=d.after),v*(d.start-e[e.length-1].start)<0&&(e[e.length-1].start=d.start,e[e.length-1].start_elem=e[e.length-1].elements.length),v*(d.end-e[e.length-1].end)>0&&(e[e.length-1].end=d.end,e[e.length-1].end_elem=e[e.length-1].elements.length)}else e.push({before:d.before,after:d.after,start:d.start,end:d.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});e[e.length-1].text+=n.textContent,e[e.length-1].elements.push({node:n,bgcolor:c,before:d.before,after:d.after})}else"br"===n.localName&&0!==e.length&&(e[e.length-1].br=!0);else for(var p=n.firstChild;p;)p.nodeType===Node.ELEMENT_NODE&&(u(t,p,e,c),"ruby"===p.localName||"rtc"===p.localName?e.length>0&&e[e.length-1].rbc.push(p):"span"===p.localName&&p.style.textEmphasisStyle&&"none"!==p.style.textEmphasisStyle&&e.length>0&&e[e.length-1].te.push(p)),p=p.nextSibling}}function a(t,n){this.qname=t,this.map=n}t.render=function(t,n,e,r,o,u,a,s,f){var c=r||n.clientHeight,l=o||n.clientWidth;if(null!==t.aspectRatio){var d=c*t.aspectRatio;d>l?c=Math.round(l/t.aspectRatio):l=d}var h=document.createElement("div");h.style.position="relative",h.style.width=l+"px",h.style.height=c+"px",h.style.margin="auto",h.style.top=0,h.style.bottom=0,h.style.left=0,h.style.right=0,h.style.zIndex=0;var v={h:c,w:l,regionH:null,regionW:null,imgResolver:e,displayForcedOnlyMode:u||!1,isd:t,errorHandler:a,previousISDState:s,enableRollUp:f||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};for(var p in n.appendChild(h),t.contents)i(v,h,t.contents[p]);return v.currentISDState};var s=[new a("http://www.w3.org/ns/ttml#styling backgroundColor",(function(t,n,e,i){0!==i[3]&&(n.style.backgroundColor="rgba("+i[0].toString()+","+i[1].toString()+","+i[2].toString()+","+(i[3]/255).toString()+")")})),new a("http://www.w3.org/ns/ttml#styling color",(function(t,n,e,i){n.style.color="rgba("+i[0].toString()+","+i[1].toString()+","+i[2].toString()+","+(i[3]/255).toString()+")"})),new a("http://www.w3.org/ns/ttml#styling direction",(function(t,n,e,i){n.style.direction=i})),new a("http://www.w3.org/ns/ttml#styling display",(function(){})),new a("http://www.w3.org/ns/ttml#styling displayAlign",(function(t,n,e,i){n.style.display="flex",n.style.flexDirection="column","before"===i?n.style.justifyContent="flex-start":"center"===i?n.style.justifyContent="center":"after"===i&&(n.style.justifyContent="flex-end")})),new a("http://www.w3.org/ns/ttml#styling extent",(function(t,n,e,i){t.regionH=i.h.toUsedLength(t.w,t.h),t.regionW=i.w.toUsedLength(t.w,t.h);var r=0,o=0,u=e.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];u&&(r=u[0].toUsedLength(t.w,t.h)+u[2].toUsedLength(t.w,t.h),o=u[1].toUsedLength(t.w,t.h)+u[3].toUsedLength(t.w,t.h)),n.style.height=t.regionH-r+"px",n.style.width=t.regionW-o+"px"})),new a("http://www.w3.org/ns/ttml#styling fontFamily",(function(t,n,e,i){var r=[];for(var o in i)"monospaceSerif"===i[o]?(r.push("Courier New"),r.push('"Liberation Mono"'),r.push("Courier"),r.push("monospace")):"proportionalSansSerif"===i[o]?(r.push("Arial"),r.push("Helvetica"),r.push('"Liberation Sans"'),r.push("sans-serif")):"monospace"===i[o]?r.push("monospace"):"sansSerif"===i[o]?r.push("sans-serif"):"serif"===i[o]?r.push("serif"):"monospaceSansSerif"===i[o]?(r.push("Consolas"),r.push("monospace")):r.push("proportionalSerif"===i[o]?"serif":i[o]);n.style.fontFamily=r.join(",")})),new a("http://www.w3.org/ns/ttml#styling shear",(function(t,n,e,i){if(0!==i){var r=-.9*i;n.style.transform="tb"===t.bpd?"skewX("+r+"deg)":"skewY("+r+"deg)"}})),new a("http://www.w3.org/ns/ttml#styling fontSize",(function(t,n,e,i){n.style.fontSize=i.toUsedLength(t.w,t.h)+"px"})),new a("http://www.w3.org/ns/ttml#styling fontStyle",(function(t,n,e,i){n.style.fontStyle=i})),new a("http://www.w3.org/ns/ttml#styling fontWeight",(function(t,n,e,i){n.style.fontWeight=i})),new a("http://www.w3.org/ns/ttml#styling lineHeight",(function(t,n,e,i){n.style.lineHeight="normal"===i?"normal":i.toUsedLength(t.w,t.h)+"px"})),new a("http://www.w3.org/ns/ttml#styling opacity",(function(t,n,e,i){n.style.opacity=i})),new a("http://www.w3.org/ns/ttml#styling origin",(function(t,n,e,i){n.style.top=i.h.toUsedLength(t.w,t.h)+"px",n.style.left=i.w.toUsedLength(t.w,t.h)+"px"})),new a("http://www.w3.org/ns/ttml#styling overflow",(function(t,n,e,i){n.style.overflow=i})),new a("http://www.w3.org/ns/ttml#styling padding",(function(t,n,e,i){var r=[];r[0]=i[0].toUsedLength(t.w,t.h)+"px",r[1]=i[3].toUsedLength(t.w,t.h)+"px",r[2]=i[2].toUsedLength(t.w,t.h)+"px",r[3]=i[1].toUsedLength(t.w,t.h)+"px",n.style.padding=r.join(" ")})),new a("http://www.w3.org/ns/ttml#styling position",(function(t,n,e,i){n.style.top=i.h.toUsedLength(t.w,t.h)+"px",n.style.left=i.w.toUsedLength(t.w,t.h)+"px"})),new a("http://www.w3.org/ns/ttml#styling rubyAlign",(function(t,n,e,i){n.style.rubyAlign=i})),new a("http://www.w3.org/ns/ttml#styling rubyPosition",(function(t,n,e,i){"before"!==i&&"after"!==i||(n.parentElement.style.rubyPosition="tb"===t.bpd||"rl"===t.bpd?"before"===i?"over":"under":"before"===i?"under":"over")})),new a("http://www.w3.org/ns/ttml#styling showBackground",null),new a("http://www.w3.org/ns/ttml#styling textAlign",(function(t,n,i,r){var o=i.styleAttrs[e.byName.direction.qname];n.style.textAlign="start"===r?"rtl"===o?"right":"left":"end"===r?"rtl"===o?"left":"right":r})),new a("http://www.w3.org/ns/ttml#styling textDecoration",(function(t,n,e,i){n.style.textDecoration=i.join(" ").replace("lineThrough","line-through")})),new a("http://www.w3.org/ns/ttml#styling textOutline",(function(){})),new a("http://www.w3.org/ns/ttml#styling textShadow",(function(t,n,i,r){var o=i.styleAttrs[e.byName.textOutline.qname];if("none"===r&&"none"===o)n.style.textShadow="";else{var u=[];if("none"!==o&&u.push("rgba("+o.color[0].toString()+","+o.color[1].toString()+","+o.color[2].toString()+","+(o.color[3]/255).toString()+") 0px 0px "+o.thickness.toUsedLength(t.w,t.h)+"px"),"none"!==r)for(var a in r)u.push(r[a].x_off.toUsedLength(t.w,t.h)+"px "+r[a].y_off.toUsedLength(t.w,t.h)+"px "+r[a].b_radius.toUsedLength(t.w,t.h)+"px rgba("+r[a].color[0].toString()+","+r[a].color[1].toString()+","+r[a].color[2].toString()+","+(r[a].color[3]/255).toString()+")");n.style.textShadow=u.join(",")}})),new a("http://www.w3.org/ns/ttml#styling textCombine",(function(t,n,e,i){n.style.textCombineUpright=i.join(" ")})),new a("http://www.w3.org/ns/ttml#styling textEmphasis",(function(t,n,e,i){"none"!==i.style?(n.style.textEmphasisStyle="auto"===i.style?"filled":i.style+" "+i.symbol,("before"===i.position||"after"===i.position)&&(n.style.textEmphasisPosition="tb"===t.bpd?"before"===i.position?"left over":"left under":"rl"===t.bpd?"before"===i.position?"right under":"left under":"before"===i.position?"left under":"right under")):n.style.textEmphasisStyle="none"})),new a("http://www.w3.org/ns/ttml#styling unicodeBidi",(function(t,n,e,i){n.style.unicodeBidi="bidiOverride"===i?"bidi-override":i})),new a("http://www.w3.org/ns/ttml#styling visibility",(function(t,n,e,i){n.style.visibility=i})),new a("http://www.w3.org/ns/ttml#styling wrapOption",(function(t,n,e,i){n.style.whiteSpace="wrap"===i?"preserve"===e.space?"pre-wrap":"normal":"preserve"===e.space?"pre":"noWrap"})),new a("http://www.w3.org/ns/ttml#styling writingMode",(function(t,n,e,i){"lrtb"===i||"lr"===i||"rltb"===i||"rl"===i?t.writingMode="horizontal-tb":"tblr"===i?t.writingMode="vertical-lr":"tbrl"!==i&&"tb"!==i||(t.writingMode="vertical-rl"),n.style.writingMode=t.writingMode})),new a("http://www.w3.org/ns/ttml#styling zIndex",(function(t,n,e,i){n.style.zIndex=i})),new a("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",(function(t,n,e,i){t.displayForcedOnlyMode&&!1===i&&(n.style.visibility="hidden")}))]}(n,"undefined"==typeof imscNames||imscNames,"undefined"==typeof imscStyles?A:imscStyles,"undefined"==typeof imscUtils||imscUtils)})),Ne=j.generateISD,_e=Me.fromXML,Se=Te.render,Ce=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(c),i=a(v),r=a(m),o=a(h),u=a(y);function a(t){return t&&t.__esModule?t:{default:t}}function s(){var t,n=this.context,o=(0,i.default)(n).getInstance(),a=void 0,s=void 0,f=void 0,c=void 0,l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0,b=void 0,M=void 0,T=void 0;function N(t){return f.addTextTrack(c[t].kind,void 0!==c[t].id?c[t].id:c[t].lang,c[t].lang,c[t].isTTML,c[t].isEmbedded)}function _(t,n,e,i,r,o){var u=0,a=0;t/n>e/i?u=(a=n)/i*e:a=(u=t)/e*i;var s,f,c=0,l=0;return u/a>r?(l=a,c=a*r):(c=u,l=u/r),s=(t-c)/2,f=(n-l)/2,o?{x:s+.1*c,y:f+.1*l,w:.8*c,h:.8*l}:{x:s,y:f,w:c,h:l}}function S(t,n){var e=f.getClientWidth(),i=f.getClientHeight(),u=f.getVideoWidth(),a=f.getVideoHeight(),s=f.getVideoRelativeOffsetTop(),c=f.getVideoRelativeOffsetLeft();if(0!==u&&0!==a){var l=u/a,d=!1;t.isFromCEA608&&(l=3.5/3,d=!0);var y=_.call(this,e,i,u,a,l,d),M=y.w,N=y.h,S=y.x,C=y.y;if(M!=p||N!=g||S!=h||C!=v||n){if(h=S+c,v=C+s,p=M,g=N,m){var E=m.style;E&&(E.left=h+"px",E.top=v+"px",E.width=p+"px",E.height=g+"px",E.zIndex=w&&document[w]||b?T:null,o.trigger(r.default.CAPTION_CONTAINER_RESIZE,{}))}var k=t.activeCues;if(k)for(var O=k.length,R=0;R<O;++R){var I=k[R];I.scaleCue(I)}}}}function C(t){var n=void 0,e=void 0,i=void 0,r=void 0,o=void 0;if(t.cellResolution){var u=[p/t.cellResolution[0],g/t.cellResolution[1]];if(t.linePadding)for(n in t.linePadding)if(t.linePadding.hasOwnProperty(n)){e=(t.linePadding[n]*u[0]).toString();for(var a=document.getElementsByClassName("spanPadding"),s=0;s<a.length;s++)a[s].style.cssText=a[s].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+e),a[s].style.cssText=a[s].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+e)}if(t.fontSize){for(n in t.fontSize)if(t.fontSize.hasOwnProperty(n)){"%"===t.fontSize[n][0]?i=t.fontSize[n][1]/100:"c"===t.fontSize[n][0]&&(i=t.fontSize[n][1]),e=(i*u[1]).toString(),o="defaultFontSize"!==n?document.getElementsByClassName(n):document.getElementsByClassName("paragraph");for(var f=0;f<o.length;f++)o[f].style.cssText=o[f].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+e)}if(t.lineHeight)for(n in t.lineHeight)if(t.lineHeight.hasOwnProperty(n)){"%"===t.lineHeight[n][0]?r=t.lineHeight[n][1]/100:"c"===t.fontSize[n][0]&&(r=t.lineHeight[n][1]),e=(r*u[1]).toString(),o=document.getElementsByClassName(n);for(var c=0;c<o.length;c++)o[c].style.cssText=o[c].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+e)}}}if(t.isd){var l=document.getElementById(t.cueID);l&&m.removeChild(l),E(t)}}function E(t){if(m){var n=document.createElement("div");m.appendChild(n),M=Se(t.isd,n,(function(n){var e=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,i=/^#(.*)$/;if(e.test(n)){var r=e.exec(n),o=parseInt(r[4],10)-1;return"data:image/png;base64,"+btoa(t.images[o])}if(i.test(n)){var u=i.exec(n);return"data:image/png;base64,"+t.embeddedImages[u[1]]}return null}),m.clientHeight,m.clientWidth,!1,(function(t){a.info("renderCaption :",t)}),M,!0),n.id=t.cueID,o.trigger(r.default.CAPTION_RENDERED,{captionDiv:n,currentTrackIdx:d})}}function k(t){return t>=0&&c[t]?f.getTextTrack(c[t].kind,c[t].id,c[t].lang,c[t].isTTML,c[t].isEmbedded):null}function O(t){if(t!==d){var n=k(d=t);I.call(this,n),y&&(clearInterval(y),y=null),n&&"html"===n.renderingType&&(S.call(this,n,!0),y=setInterval(S.bind(this,n),500))}}function I(t){F.call(this),t&&"html"===t.renderingType?A.call(this):j.call(this)}function D(t,n,e){return(isNaN(n)||t.startTime>=n)&&(isNaN(e)||t.endTime<=e)}function x(t,n,e){if(t.cues)for(var i=t.cues,r=i.length-1;r>=0;r--)D(i[r],n,e)&&t.removeCue(i[r])}function A(){var t=document.getElementById("native-cue-style");if(!t){(t=document.createElement("style")).id="native-cue-style",document.head.appendChild(t);var n=t.sheet,e=f.getElement();try{e&&n.insertRule(e.id?"#"+e.id+"::cue {background: transparent}":0!==e.classList.length?"."+e.className+"::cue {background: transparent}":"video::cue {background: transparent}",0)}catch(t){a.info(""+t.message)}}}function j(){var t=document.getElementById("native-cue-style");t&&document.head.removeChild(t)}function F(){if(m)for(;m.firstChild;)m.removeChild(m.firstChild)}return t={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(s=window.VTTCue||window.TextTrackCue,c=[],l=[],d=-1,h=0,v=0,p=0,g=0,m=null,y=null,b=!1,T=2147483647,M=null,void 0!==document.fullscreenElement?w="fullscreenElement":void 0!==document.webkitIsFullScreen?w="webkitIsFullScreen":document.msFullscreenElement?w="msFullscreenElement":document.mozFullScreen&&(w="mozFullScreen"))},setDisplayCConTop:function(t){(0,R.checkParameterType)(t,"boolean"),b=t,m&&!document[w]&&(m.style.zIndex=t?T:null)},addTextTrack:function(t,n){if(c.length!==n){if(c.push(t),c.length===n){c.sort((function(t,n){return t.index-n.index})),m=f.getTTMLRenderingDiv();for(var i=-1,u=0;u<c.length;u++){var s=N.call(this,u);l.push(s),c[u].defaultTrack&&(s.default=!0,i=u);var h=k(u);h&&(h.mode=e.default.TEXT_SHOWING,h.renderingType=m&&(c[u].isTTML||c[u].isEmbedded)?"html":"default"),this.addCaptions(u,0,c[u].captionData),o.trigger(r.default.TEXT_TRACK_ADDED)}if(O.call(this,i),i>=0){o.on(r.default.PLAYBACK_METADATA_LOADED,(function t(){var n=k(i);n&&S.call(this,n,!0),o.off(r.default.PLAYBACK_METADATA_LOADED,t,this)}),this);for(var v=0;v<c.length;v++){var p=k(v);p&&(p.mode=v===i?e.default.TEXT_SHOWING:e.default.TEXT_HIDDEN)}}o.trigger(r.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:d,tracks:c})}}else a.error("Trying to add too many tracks.")},addCaptions:function(t,n,i){var u=k(t),f=this;if(u&&Array.isArray(i)&&0!==i.length)for(var c=0;c<i.length;c++){var l=void 0,y=i[c];u.cellResolution=y.cellResolution,u.isFromCEA608=y.isFromCEA608,"html"===y.type&&m?((l=new s(y.start-n,y.end-n,"")).cueHTMLElement=y.cueHTMLElement,l.isd=y.isd,l.images=y.images,l.embeddedImages=y.embeddedImages,l.cueID=y.cueID,l.scaleCue=C.bind(f),l.cellResolution=y.cellResolution,l.lineHeight=y.lineHeight,l.linePadding=y.linePadding,l.fontSize=y.fontSize,m.style.left=h+"px",m.style.top=v+"px",m.style.width=p+"px",m.style.height=g+"px",l.onenter=function(){u.mode===e.default.TEXT_SHOWING&&(this.isd?(E(this),a.debug("Cue enter id:"+this.cueID)):(m.appendChild(this.cueHTMLElement),C.call(f,this),o.trigger(r.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:d})))},l.onexit=function(){if(m)for(var t=m.childNodes,n=0;n<t.length;++n)t[n].id===this.cueID&&(a.debug("Cue exit id:"+t[n].id),m.removeChild(t[n]),--n)}):y.data&&(l=new s(y.start-n,y.end-n,y.data),y.styles&&(void 0!==y.styles.align&&"align"in l&&(l.align=y.styles.align),void 0!==y.styles.line&&"line"in l&&(l.line=y.styles.line),void 0!==y.styles.position&&"position"in l&&(l.position=y.styles.position),void 0!==y.styles.size&&"size"in l&&(l.size=y.styles.size)),l.onenter=function(){u.mode===e.default.TEXT_SHOWING&&o.trigger(r.default.CAPTION_RENDERED,{currentTrackIdx:d})});try{l?u.addCue(l):a.error("impossible to display subtitles.")}catch(t){throw x(u),u.addCue(l),t}}},getCurrentTrackIdx:function(){return d},setCurrentTrackIdx:O,getTrackIdxForId:function(t){for(var n=-1,e=0;e<c.length;e++)if(c[e].id===t){n=e;break}return n},getCurrentTrackInfo:function(){return c[d]},setModeForTrackIdx:function(t,n){var e=k(t);e&&e.mode!==n&&(e.mode=n)},deleteCuesFromTrackIdx:function(t,n,e){var i=k(t);i&&x(i,n,e)},deleteAllTextTracks:function(){for(var t=l?l.length:0,n=0;n<t;n++){var e=k(n);e&&(x.call(this,e),e.mode="disabled")}l=[],c=[],y&&(clearInterval(y),y=null),d=-1,F.call(this)},deleteTextTrack:function(t){f.removeChild(l[t]),l.splice(t,1)},setConfig:function(t){t&&t.videoModel&&(f=t.videoModel)}},a=(0,u.default)(n).getInstance().getLogger(t),t}s.__dashjs_factory_name="TextTracks",n.default=o.default.getSingletonFactory(s)})),Ee=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(){var t=0;function n(t){for(var n="",e=0;e<t.length;++e)n+=t[e].uchar;return n.length-n.replace(/^\s+/,"").length}function e(t){return"left: "+3.125*t.x+"%; top: "+6.66*t.y1+"%; width: "+(100-3.125*t.x)+"%; height: "+6.66*Math.max(t.y2-1-t.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function i(t){return"red"===t?"rgb(255, 0, 0)":"green"===t?"rgb(0, 255, 0)":"blue"===t?"rgb(0, 0, 255)":"cyan"===t?"rgb(0, 255, 255)":"magenta"===t?"rgb(255, 0, 255)":"yellow"===t?"rgb(255, 255, 0)":"white"===t?"rgb(255, 255, 255)":"black"===t?"rgb(0, 0, 0)":t}function r(t,n){var e=t.videoHeight/15;return n?"font-size: "+e+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(n.foreground?i(n.foreground):"rgb(255, 255, 255)")+"; font-style: "+(n.italics?"italic":"normal")+"; text-decoration: "+(n.underline?"underline":"none")+"; white-space: pre; background-color: "+(n.background?i(n.background):"transparent")+";":"font-size: "+e+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function o(t){return t.replace(/^\s+/g,"")}function u(t){return t.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(i,a,s,f){var c=null,l=!1,d=-1,h={start:a,end:s,spans:[]},v="style_cea608_white_black",p={},g={},m=[],y=void 0,w=void 0;for(y=0;y<15;++y){var b=f.rows[y],M="",T=null;if(!1===b.isEmpty()){var N=n(b.chars);null===c&&(c={x:N,y1:y,y2:y+1,p:[]}),N!==d&&l&&(c.p.push(h),h={start:a,end:s,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===p.hasOwnProperty(c.name)?(m.push(c),p[c.name]=c):p[c.name].p.contat(c.p),c={x:N,y1:y,y2:y+1,p:[]});for(var _=0;_<b.chars.length;++_){var S=b.chars[_],C=S.penState;if(null===T||!C.equals(T)){M.trim().length>0&&(h.spans.push({name:v,line:M,row:y}),M="");var E="style_cea608_"+C.foreground+"_"+C.background;C.underline&&(E+="_underline"),C.italics&&(E+="_italics"),g.hasOwnProperty(E)||(g[E]=JSON.parse(JSON.stringify(C))),T=C,v=E}M+=S.uchar}M.trim().length>0&&h.spans.push({name:v,line:M,row:y}),l=!0,d=N}else l=!1,d=-1,c&&(c.p.push(h),h={start:a,end:s,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===p.hasOwnProperty(c.name)?(m.push(c),p[c.name]=c):p[c.name].p.contat(c.p),c=null)}c&&(c.p.push(h),c.y2=y+1,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===p.hasOwnProperty(c.name)?(m.push(c),p[c.name]=c):p[c.name].p.contat(c.p),c=null);var k=[];for(y=0;y<m.length;++y){var O=m[y],R="sub_cea608_"+t++,I=document.createElement("div");I.id=R;var D=e(O);I.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+D;var x=document.createElement("div");x.className="paragraph bodyStyle",x.style.cssText=r(i);var A=document.createElement("div");A.className="cueUniWrapper",A.style.cssText="unicode-bidi: normal; direction: ltr;";for(var j=0;j<O.p.length;++j){var F=O.p[j],P=0;for(w=0;w<F.spans.length;++w){var B=F.spans[w];if(B.line.length>0){if(0!==w&&P!=B.row){var L=document.createElement("br");L.className="lineBreak",A.appendChild(L)}var U=!1;P===B.row&&(U=!0),P=B.row;var q=g[B.name],z=document.createElement("span");z.className="spanPadding "+B.name+" customSpanColor",z.style.cssText=r(i,q),z.textContent=0!==w&&U?w===F.spans.length-1?u(B.line):B.line:F.spans.length>1&&w<F.spans.length-1&&B.row===F.spans[w+1].row?o(B.line):B.line.trim(),A.appendChild(z)}}}x.appendChild(A),I.appendChild(x);var H={bodyStyle:["%",90]};for(var K in g)g.hasOwnProperty(K)&&(H[K]=["%",90]);k.push({type:"html",start:a,end:s,cueHTMLElement:I,cueID:R,cellResolution:[32,15],isFromCEA608:!0,fontSize:H,lineHeight:{},linePadding:{}})}return k}}}r.__dashjs_factory_name="EmbeddedTextHtmlRender",n.default=i.default.getSingletonFactory(r)})),ke=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,[{key:"extend",value:function(t,n){if(t){var e=!!n&&n.override,i=!!n&&n.publicOnly;for(var r in t)!t.hasOwnProperty(r)||this[r]&&!e||i&&-1===t[r].indexOf("public_")||(this[r]=t[r])}}}]),t}();n.default=i})),Oe=o((function(t,n){var e;Object.defineProperty(n,"__esModule",{value:!0});var i=new(function(t){function n(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,t.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,t.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,t.SEGMENTS_UPDATE_FAILED_ERROR_CODE=13,t.SEGMENTS_UNAVAILABLE_ERROR_CODE=14,t.SEGMENT_BASE_LOADER_ERROR_CODE=15,t.TIME_SYNC_FAILED_ERROR_CODE=16,t.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,t.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,t.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,t.APPEND_ERROR_CODE=20,t.REMOVE_ERROR_CODE=21,t.DATA_UPDATE_FAILED_ERROR_CODE=22,t.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,t.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,t.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,t.DOWNLOAD_ERROR_ID_SIDX_CODE=26,t.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,t.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,t.DOWNLOAD_ERROR_ID_XLINK_CODE=29,t.MANIFEST_ERROR_ID_CODEC_CODE=30,t.MANIFEST_ERROR_ID_PARSE_CODE=31,t.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,t.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,t.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,t.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,t.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",t.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",t.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",t.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",t.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",t.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segments",t.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize time",t.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",t.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",t.APPEND_ERROR_MESSAGE="chunk is not defined",t.REMOVE_ERROR_MESSAGE="buffer is not defined",t.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",t.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",t.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",t.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",t.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(((e=ke)&&e.__esModule?e:{default:e}).default));n.default=i})),Re=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=S(c),i=S(_),r=S(O),o=S(I),u=S(h),a=S(y),s=S(Ce),l=S(Ee),d=S(E),p=S(f),g=S(v),w=S(m),M=S(N),T=S(Oe);function S(t){return t&&t.__esModule?t:{default:t}}function C(){var t=this.context,n=(0,g.default)(t).getInstance(),u=!1,f=void 0,c=void 0,h=void 0,v=void 0,m=void 0,y=void 0,N=void 0,_=void 0,S=void 0,C=void 0,E=void 0,k=void 0,O=void 0,R=void 0,I=void 0,D=void 0,x=void 0,A=void 0,j=void 0,F=void 0,P=void 0,B=void 0,L=void 0,U=void 0,q=void 0,z=void 0;function H(){O=null,I=NaN,D=[],j=null,R=!1}function K(){H(),E=[],_=null}function V(t){var n=t.chunk;n.mediaInfo.embeddedCaptions&&X(n.bytes,n)}function W(){P=[],(k=(0,s.default)(t).getInstance()).setConfig({videoModel:x}),k.initialize(),h=(0,r.default)(t).getInstance(),F=null,B=0,U=[],L=null,u=!0,q=(0,l.default)(t).getInstance();var e=A.getActiveStreamProcessors();for(var i in e)if("video"===e[i].getType()){z=e[i].getRepresentationInfo().MSETimeOffset;break}n.on(w.default.VIDEO_CHUNK_RECEIVED,V,this),n.on(w.default.BUFFER_CLEARED,J,this)}function G(t){F=t}function $(t,n){var r,o,u=new i.default,a={subtitle:"subtitles",caption:"captions"};u.captionData=t,u.lang=n.lang,u.labels=n.labels,u.id=n.id?n.id:n.index,u.index=n.index,u.isTTML=(r=!1,n.codec&&n.codec.search(e.default.STPP)>=0&&(r=!0),n.mimeType&&n.mimeType.search(e.default.TTML)>=0&&(r=!0),r),u.defaultTrack=function(t){var n=!1;return P.length>1&&t.isEmbedded?n=t.id&&t.id===e.default.CC1:1===P.length?t.id&&"string"==typeof t.id&&"CC"===t.id.substring(0,2)&&(n=!0):0===P.length&&(n=t.index===E[0].index),n}(n),u.isFragmented=!m.getIsTextTrack(n.mimeType),u.isEmbedded=!!n.isEmbedded,u.kind=o=(o=n.roles.length>0?a[n.roles[0]]:a.caption)===a.caption||o===a.subtitle?o:a.caption,u.roles=n.roles,u.accessibility=n.accessibility,k.addTextTrack(u,(E?E.length:0)+P.length)}function X(t,n){var i=void 0,r=void 0,o=void 0,u=void 0,a=void 0,s=void 0,f=void 0,l=n.mediaInfo,g=l.type,m=l.codec||l.mimeType;if(m){if(g===e.default.FRAGMENTED_TEXT)if(R||"InitializationSegment"!==n.segmentType){if(!R)return;if(r=(s=h.getSamplesInfo(t)).sampleList,null===j&&r.length>0&&(j=r[0].cts-n.start*I),m.search(e.default.STPP)>=0)for(_=null!==_?_:Q(m),o=0;o<r.length;o++){var w=r[o],N=w.cts,S=N-j;this.buffered.add(S/I,(S+w.duration)/I);var C=new DataView(t,w.offset,w.subSizes[0]);f=d.default.Utils.dataViewToString(C,e.default.UTF8);var E=[],D=w.offset+w.subSizes[0];for(u=1;u<w.subSizes.length;u++){var A=new Uint8Array(t,D,w.subSizes[u]),H=String.fromCharCode.apply(null,A);E.push(H),D+=w.subSizes[u]}try{var K=y.getValue();i=_.parse(f,K.ttmlTimeIsRelative?N/I:0,N/I,(N+w.duration)/I,E),k.addCaptions(F,j/I,i)}catch(t){O.removeExecutedRequestsBeforeTime(),this.remove(),c.error("TTML parser error: "+t.message)}}else{var V=[];for(o=0;o<r.length;o++){var W=r[o];W.cts-=j,this.buffered.add(W.cts/I,(W.cts+W.duration)/I);var G=t.slice(W.offset,W.offset+W.size),X=d.default.parseBuffer(G);for(u=0;u<X.boxes.length;u++){var J=X.boxes[u];if(c.debug("VTT box1: "+J.type),"vtte"!==J.type&&"vttc"===J.type)for(c.debug("VTT vttc boxes.length = "+J.boxes.length),a=0;a<J.boxes.length;a++){var Y=J.boxes[a];if(c.debug("VTT box2: "+Y.type),"payl"===Y.type){var Z=Y.cue_text;c.debug("VTT cue_text = "+Z);var tt=W.cts/I,nt=(W.cts+W.duration)/I;V.push({start:tt,end:nt,data:Z,styles:{}}),c.debug("VTT "+tt+"-"+nt+" : "+Z)}}}}V.length>0&&k.addCaptions(F,0,V)}}else R=!0,I=h.getMediaTimescaleFromMoov(t);else if(g===e.default.TEXT){var et=new DataView(t,0,t.byteLength);f=d.default.Utils.dataViewToString(et,e.default.UTF8);try{i=Q(m).parse(f,0),k.addCaptions(k.getCurrentTrackIdx(),0,i)}catch(t){v.error(new M.default(T.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,T.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+t.message,f))}}else if(g===e.default.VIDEO)if(n.segmentType===b.HTTPRequest.INIT_SEGMENT_TYPE){if(0===B)for(B=h.getMediaTimescaleFromMoov(t),o=0;o<P.length;o++)$(null,P[o])}else{if(0===B)return void c.warn("CEA-608: No timescale for embeddedTextTrack yet");var it=function(t,n){return function(t,e,i){var r;(r=x.getTTMLRenderingDiv()?q.createHTMLCaptionsFromScreen(x.getElement(),t,e,i):[{start:t,end:e,data:i.getDisplayText(),styles:{}}])&&k.addCaptions(n,0,r)}},rt=(s=h.getSamplesInfo(t)).lastSequenceNumber;if(!U[0]&&!U[1]){var ot=void 0,ut=void 0;for(o=0;o<P.length;o++){if(P[o].id===e.default.CC1?ut=k.getTrackIdxForId(e.default.CC1):P[o].id===e.default.CC3&&(ut=k.getTrackIdxForId(e.default.CC3)),-1===ut)return void c.warn("CEA-608: data before track is ready.");ot=it(0,ut),U[o]=new p.default.Cea608Parser(o+1,{newCue:ot},null)}}if(B){if(null!==L&&rt!==L+s.numSequences)for(o=0;o<U.length;o++)U[o]&&U[o].reset();for(var at=function(t,n){if(0===n.length)return null;for(var e={splits:[],fields:[[],[]]},i=new DataView(t),r=0;r<n.length;r++)for(var o=n[r],u=p.default.findCea608Nalus(i,o.offset,o.size),a=null,s=0,f=0;f<u.length;f++)for(var c=p.default.extractCea608DataFromRange(i,u[f]),l=0;l<2;l++)c[l].length>0&&(o.cts!==a?s=0:s+=1,e.fields[l].push([o.cts+z*B,c[l],s]),a=o.cts);return e.fields.forEach((function(t){t.sort((function(t,n){return t[0]===n[0]?t[2]-n[2]:t[0]-n[0]}))})),e}(t,s.sampleList),st=0;st<U.length;st++){var ft=at.fields[st],ct=U[st];if(ct)for(o=0;o<ft.length;o++)ct.addData(ft[o][0]/B,ft[o][1])}L=rt}}}else c.error("No text type defined")}function Q(t){var n=void 0;return t.search(e.default.VTT)>=0?n=S:(t.search(e.default.TTML)>=0||t.search(e.default.STPP)>=0)&&(n=C),n}function J(t){P.forEach((function(n){var e=k.getTrackIdxForId(n.id);e>=0&&k.deleteCuesFromTrackIdx(e,t.from,t.to)}))}return f={initialize:function(n,i,a,s){u||W(),k.setConfig({videoModel:x}),k.initialize(),h||(h=(0,r.default)(t).getInstance()),function(n,i,r,u){var a=!m.getIsTextTrack(n);if(E=E.concat(r),a){O=u,f.buffered=(0,o.default)(t).create(),D=N.getTracksFor(e.default.FRAGMENTED_TEXT,i);for(var s=N.getCurrentTrackFor(e.default.FRAGMENTED_TEXT,i),c=0;c<D.length;c++)if(D[c]===s){G(c);break}}for(var l=0;l<E.length;l++)$(null,E[l])}(n,i,a,s)},append:X,abort:function(){k.deleteAllTextTracks(),H(),h=null,E=[]},addEmbeddedTrack:function(t){if(u||W(),t)if(t.id===e.default.CC1||t.id===e.default.CC3){for(var n=0;n<P.length;n++)if(P[n].id===t.id)return;P.push(t)}else c.warn("Embedded track "+t.id+" not supported!")},resetEmbedded:function(){n.off(w.default.VIDEO_CHUNK_RECEIVED,V,this),n.off(w.default.BUFFER_CLEARED,J,this),k&&k.deleteAllTextTracks(),u=!1,P=[],U=[null,null],L=null},setConfig:function(t){t&&(t.errHandler&&(v=t.errHandler),t.adapter&&(m=t.adapter),t.manifestModel&&(y=t.manifestModel),t.mediaController&&(N=t.mediaController),t.videoModel&&(x=t.videoModel),t.streamController&&(A=t.streamController),t.textTracks&&(k=t.textTracks),t.vttParser&&(S=t.vttParser),t.ttmlParser&&(C=t.ttmlParser))},getConfig:function(){return{fragmentModel:O,fragmentedTracks:D,videoModel:x}},setCurrentFragmentedTrackIdx:G,remove:function(t,n){void 0===t&&t===n&&(t=this.buffered.start(0),n=this.buffered.end(this.buffered.length-1)),this.buffered.remove(t,n)},reset:function(){K(),A=null,x=null,k=null}},c=(0,a.default)(t).getInstance().getLogger(f),K(),f}C.__dashjs_factory_name="TextSourceBuffer",n.default=u.default.getSingletonFactory(C)})),Ie=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(y);function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t,n=void 0,e=void 0,r=void 0,o=void 0,u=void 0;function a(t){var n=t.split(":"),e=n.length-1;return t=60*parseInt(n[e-1],10)+parseFloat(n[e]),2===e&&(t+=3600*parseInt(n[0],10)),t}function s(t){var n=t.split(r),e=n[1].split(u);return e.shift(),n[1]=e[0],e.shift(),{cuePoints:n,styles:f(e)}}function f(t){var n={};return t.forEach((function(t){if(t.split(/:/).length>1){var e=t.split(/:/)[1];e&&-1!=e.search(/%/)&&(e=parseInt(e.replace(/%/,""),10)),(t.match(/align/)||t.match(/A/))&&(n.align=e),(t.match(/line/)||t.match(/L/))&&(n.line=e),(t.match(/position/)||t.match(/P/))&&(n.position=e),(t.match(/size/)||t.match(/S/))&&(n.size=e)}})),n}function c(t,n){for(var e,i=n,o="",u="";""!==t[i]&&i<t.length;)i++;if((e=i-n)>1)for(var a=0;a<e;a++){if((u=t[n+a]).match(r)){o="";break}o+=u,a!==e-1&&(o+="\n")}else(u=t[n]).match(r)||(o=u);return o}return t={parse:function(t){var i,u=[],f=void 0;if(!t)return u;i=(t=t.split(e)).length,f=-1;for(var l=0;l<i;l++){var d=t[l];if(d.length>0&&"WEBVTT"!==d&&d.match(r)){var h=s(d),v=h.cuePoints,p=h.styles,g=c(t,l+1),m=a(v[0].replace(o,"")),y=a(v[1].replace(o,""));!isNaN(m)&&!isNaN(y)&&m>=f&&y>m?""!==g?(f=m,u.push({start:m,end:y,data:g,styles:p})):n.error("Skipping cue due to empty/malformed cue text"):n.error("Skipping cue due to incorrect cue timing")}}return u}},n=(0,i.default)(this.context).getInstance().getLogger(t),e=/(?:\r\n|\r|\n)/gm,r=/-->/,o=/(^[\s]+|[\s]+$)/g,u=/\s\b/g,t}o.__dashjs_factory_name="VTTParser",n.default=e.default.getSingletonFactory(o)})),De=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=u(h),i=u(y),r=u(v),o=u(m);function u(t){return t&&t.__esModule?t:{default:t}}function a(){var t,n=this.context,e=(0,r.default)(n).getInstance(),u=void 0,a=0;return t={parse:function(t,n,i,r,s){var f="",c=[],l=void 0,d=void 0,h=void 0,v={},p={},g="",m="",y={onOpenTag:function(t,n,e){if("image"===n&&("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===t||"http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"===t)){if(!e[" imageType"]||"PNG"!==e[" imageType"].value)return void u.warn("smpte-tt imageType != PNG. Discarded");g=e["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){g&&(p[g]=m.trim()),m="",g=""},onText:function(t){g&&(m+=t)}};if(!t)throw f="no ttml data to parse",new Error(f);v.data=t,e.trigger(o.default.TTML_TO_PARSE,v);var w=_e(v.data,(function(t){f=t}),y);e.trigger(o.default.TTML_PARSED,{ttmlString:v.data,ttmlDoc:w});var b,M=w.getMediaTimeEvents();for(h=0;h<M.length;h++){var T=Ne(w,M[h],(function(t){f=t}));T.contents.some((function(t){return t.contents.length}))&&(l=M[h]+n<i?i:M[h]+n)<(d=M[h+1]+n>r?r:M[h+1]+n)&&c.push({start:l,end:d,type:"html",cueID:(void 0,b="cue_TTML_"+a,a++,b),isd:T,images:s,embeddedImages:p})}if(""!==f)throw u.error(f),new Error(f);return c}},u=(0,i.default)(n).getInstance().getLogger(t),t}a.__dashjs_factory_name="TTMLParser",n.default=e.default.getSingletonFactory(a)})),xe=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=l(c),i=l(h),r=l(Re),o=l(Ce),u=l(Ie),a=l(De),s=l(v),f=l(m);function l(t){return t&&t.__esModule?t:{default:t}}function d(){var t,n=this.context,i=void 0,c=void 0,l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0,b=void 0,M=void 0,T=void 0,N=void 0,_=void 0,S=void 0,C=void 0,E=void 0,k=void 0;function O(){var t=!0;return _&&!S&&(t=!1),t}function I(){_=!0,C=!1,E=!1}return t={setConfig:function(t){t&&(t.errHandler&&(c=t.errHandler),t.adapter&&(l=t.adapter),t.manifestModel&&(d=t.manifestModel),t.mediaController&&(h=t.mediaController),t.videoModel&&(v=t.videoModel),t.streamController&&(p=t.streamController),t.textTracks&&(g=t.textTracks),t.vttParser&&(m=t.vttParser),t.ttmlParser&&(y=t.ttmlParser),i.setConfig({errHandler:c,adapter:l,manifestModel:d,mediaController:h,videoModel:v,streamController:p,textTracks:g,vttParser:m,ttmlParser:y}))},getTextSourceBuffer:function(){return i},getAllTracksAreDisabled:function(){return _},addEmbeddedTrack:function(t){i.addEmbeddedTrack(t)},getTextDefaultLanguage:function(){return b&&b.lang||""},setTextDefaultLanguage:function(t){(0,R.checkParameterType)(t,"string"),b||(b={}),b.lang=t,M=!0},setTextDefaultEnabled:function(t){(0,R.checkParameterType)(t,"boolean"),(N=t)?_=!1:this.setTextTrack(-1)},getTextDefaultEnabled:function(){return void 0!==N&&N},setInitialSettings:function(t){b=t,M=!0},enableText:function(t){(0,R.checkParameterType)(t,"boolean"),!N&&t&&(N=!0),O()!==t&&(t&&this.setTextTrack(T),t||(T=this.getCurrentTrackIdx(),C?this.setTextTrack(-1):E=!0))},isTextEnabled:O,setTextTrack:function(t){var n=i.getConfig(),r=n.fragmentModel,o=n.fragmentedTracks,u=n.videoModel,a=void 0,s=void 0;_=-1===t;var f=g.getCurrentTrackIdx();if(f!==t){_&&h&&h.saveTextSettingsDisabled(),g.setModeForTrackIdx(f,e.default.TEXT_HIDDEN),g.setCurrentTrackIdx(t),g.setModeForTrackIdx(t,e.default.TEXT_SHOWING);var c=g.getCurrentTrackInfo();if(c&&c.isFragmented&&!c.isEmbedded)for(var l=0;l<o.length;l++){var d=o[l];if(c.lang===d.lang&&c.index===d.index&&(d.id?c.id===d.id:c.id===d.index))if(d!==h.getCurrentTrackFor(e.default.FRAGMENTED_TEXT,p.getActiveStreamInfo()))r.abortRequests(),r.removeExecutedRequestsBeforeTime(),i.remove(),g.deleteCuesFromTrackIdx(f),h.setTrack(d),i.setCurrentFragmentedTrackIdx(l);else if(-1===f){for(var v=p.getActiveStreamProcessors(),m=0;m<v.length;m++)if(v[m].getType()===e.default.FRAGMENTED_TEXT){s=v[m];break}s.setBufferingTime(u.getTime()),s.getScheduleController().start()}}else if(c&&!c.isFragmented){for(var y=p.getActiveStreamProcessors(),w=0;w<y.length;w++)if(y[w].getType()===e.default.TEXT){a=(s=y[w]).getMediaInfoArr();break}if(s&&a)for(var b=0;b<a.length;b++)if(a[b].index===c.index&&a[b].lang===c.lang){s.selectMediaInfo(a[b]);break}}}},getCurrentTrackIdx:function(){return g.getCurrentTrackIdx()},enableForcedTextStreaming:function(t){(0,R.checkParameterType)(t,"boolean"),S=t},reset:function(){I(),i.resetEmbedded(),i.reset()}},b=null,T=-1,S=!1,C=!1,M=!1,E=!1,g=(0,o.default)(n).getInstance(),m=(0,u.default)(n).getInstance(),y=(0,a.default)(n).getInstance(),i=(0,r.default)(n).getInstance(),w=(0,s.default)(n).getInstance(),g.initialize(),w.on(f.default.TEXT_TRACKS_QUEUE_INITIALIZED,(function(t){var n=this,e=t.tracks,i=t.index;b&&e.some((function(t,e){if(h.matchSettings(b,t))return n.setTextTrack(e),i=e,!0})),(!1===N||void 0===N&&!b||E)&&this.setTextTrack(-1),T=i,w.trigger(f.default.TEXT_TRACKS_ADDED,{enabled:O(),index:i,tracks:e}),C=!0}),t),w.on(f.default.CURRENT_TRACK_CHANGED,(function(t){if(!M&&t&&t.newMediaInfo){var n=t.newMediaInfo;n.type===e.default.FRAGMENTED_TEXT&&(b={lang:n.lang,role:n.roles[0],accessibility:n.accessibility[0]})}}),t),w.on(f.default.PERIOD_SWITCH_STARTED,(function(t){void 0===k&&null!==t.fromStreamInfo&&(k=this.getCurrentTrackIdx())}),t),w.on(f.default.STREAM_COMPLETED,(function(){void 0===k&&(k=this.getCurrentTrackIdx())}),t),w.on(f.default.PERIOD_SWITCH_COMPLETED,(function(){void 0!==k&&(this.setTextTrack(k),k=void 0)}),t),I(),t}d.__dashjs_factory_name="TextController",n.default=i.default.getSingletonFactory(d)})),Ae=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(y),i=f(N),r=f(v),o=f(m),u=f(h),a=f(xe),s=f(Oe);function f(t){return t&&t.__esModule?t:{default:t}}function c(t,n,u,f){var c,l=this.context,d=(0,r.default)(l).getInstance(),h=void 0,v=void 0,p=void 0,g=void 0,m=[],y=[],w=u;function b(){try{return v.buffered}catch(t){return h.error("getAllBufferRanges exception: "+t.message),null}}function M(e){v&&E((function(){try{var i=t.duration,r=0;e&&!isNaN(e.start)&&!isNaN(e.duration)&&isFinite(e.duration)&&(i=e.start+e.duration),e&&!isNaN(e.start)&&(r=e.start),v.appendWindowStart=0,v.appendWindowEnd=i,v.appendWindowStart=r,h.debug("Updated append window for "+n.type+". Set start to "+v.appendWindowStart+" and end to "+v.appendWindowEnd)}catch(t){h.warn("Failed to set append window")}}))}function T(){var t=this;if(y.length>0){p=!0;var n=y[0];y.splice(0,1);var e=[],r=function(){var i=b();!function(t,n,e,i){n&&n.length>0&&n.length<e.length&&function(t,n){for(var e=0;e<t.length;e++){var i=Math.round(t.start(e)),r=Math.round(t.end(e));if(r===n.start||i===n.end||n.start>=i&&n.end<=r)return!0}return!1}(n,i)&&d.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:t,from:e.end(e.length-2),to:e.start(e.length-1),unintended:!0})}(t,e,i,n),y.length>0?T.call(this):(p=!1,w&&w({chunk:n}))};try{0===n.bytes.length?r.call(this):(e=b(),v.appendBuffer?v.appendBuffer(n.bytes):v.append(n.bytes,n),E(r.bind(this)))}catch(t){h.fatal('SourceBuffer append failed "'+t+'"'),y.length>0?T():p=!1,w&&w({chunk:n,error:new i.default(t.code,t.message)})}}}function N(){if(m.length>0){var t=m.shift();v.updating?E(t):(t(),N())}}function _(){v.updating||N()}function S(){v.updating||N()}function C(){h.error("SourceBufferSink error",n.type)}function E(t){m.push(t),v.updating||N()}return c={getAllBufferRanges:b,getBuffer:function(){return v},append:function(t){t?(y.push(t),p||E(T.bind(this))):w({chunk:t,error:new i.default(s.default.APPEND_ERROR_CODE,s.default.APPEND_ERROR_MESSAGE)})},remove:function(n,e,r){var u=this;E((function(){try{n>=0&&e>n&&(r||"ended"!==t.readyState)&&v.remove(n,e),E((function(){d.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:u,from:n,to:e,unintended:!1})}))}catch(t){d.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:u,from:n,to:e,unintended:!1,error:new i.default(t.code,t.message)})}}))},abort:function(){try{("open"===t.readyState||v.setTextTrack&&"ended"===t.readyState)&&v.abort()}catch(t){h.error('SourceBuffer append abort failed: "'+t+'"')}y=[]},reset:function(n){if(v){if("function"==typeof v.removeEventListener&&(v.removeEventListener("updateend",S,!1),v.removeEventListener("error",C,!1),v.removeEventListener("abort",C,!1)),clearInterval(g),m=[],!n){try{v.getClassName&&"TextSourceBuffer"===v.getClassName()||(h.debug("Removing sourcebuffer from media source"),t.removeSourceBuffer(v))}catch(t){h.error("Failed to remove source buffer from media source.")}v=null}p=!1}y=[],w=null},updateTimestampOffset:function(t){v.timestampOffset===t||isNaN(t)||E((function(){t<0&&(t+=.001),v.timestampOffset=t}))},hasDiscontinuitiesAfter:function(t){try{var n=b();if(n&&n.length>1)for(var e=0,i=n.length;e<i;e++)if(e>0&&t<n.start(e)&&n.start(e)>n.end(e-1)+.1)return!0}catch(t){h.error("hasDiscontinuities exception: "+t.message)}return!1},waitForUpdateEnd:E,updateAppendWindow:M},function(){h=(0,e.default)(l).getInstance().getLogger(c),p=!1;var i=n.codec;try{if(i.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new Error("not really supported");if((v=f||t.addSourceBuffer(i)).changeType&&f&&(h.debug("Doing period transition with changeType"),v.changeType(i)),M(),"function"==typeof v.addEventListener)try{v.addEventListener("updateend",S,!1),v.addEventListener("error",C,!1),v.addEventListener("abort",C,!1)}catch(t){g=setInterval(_,50)}else g=setInterval(_,50)}catch(t){if(!n.isText&&-1===i.indexOf('codecs="stpp')&&-1===i.indexOf('codecs="wvtt'))throw t;var r=(0,a.default)(l).getInstance();v=r.getTextSourceBuffer()}}(),c}c.__dashjs_factory_name="SourceBufferSink";var l=u.default.getClassFactory(c);n.default=l})),je=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(y),i=r(h);function r(t){return t&&t.__esModule?t:{default:t}}function o(t){var n,i=void 0,r=void 0,o=[],u=t;function a(t,n){o=o.filter((function(e){return!((isNaN(n)||e.start<n)&&(isNaN(t)||e.end>t))}))}return n={getAllBufferRanges:function(){for(var t=[],n=0;n<o.length;n++){var e=o[n];0===t.length||e.start>t[t.length-1].end?t.push({start:e.start,end:e.end}):t[t.length-1].end=e.end}var i={start:function(n){return t[n].start},end:function(n){return t[n].end}};return Object.defineProperty(i,"length",{get:function(){return t.length}}),i},append:function(t){"InitializationSegment"!==t.segmentType?(o.push(t),o.sort((function(t,n){return t.start-n.start})),r=null):r=t,i.debug("PreBufferSink appended chunk s: "+t.start+"; e: "+t.end),u&&u({chunk:t})},remove:a,abort:function(){},discharge:function(t,n){var e=function(t,n){return o.filter((function(e){return(isNaN(n)||e.start<n)&&(isNaN(t)||e.end>t)}))}(t,n);return r&&(e.push(r),r=null),a(t,n),e},reset:function(){o=[],r=null,u=null},updateTimestampOffset:function(){},hasDiscontinuitiesAfter:function(){return!1},waitForUpdateEnd:function(t){t()},getBuffer:function(){return this}},i=(0,e.default)(this.context).getInstance().getLogger(n),n}o.__dashjs_factory_name="PreBufferSink";var u=i.default.getClassFactory(o);n.default=u})),Fe=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e},r={DEFAULT:.5,STRONG:1,WEAK:0};function o(t,n,e){return{quality:void 0===t?-1:t,reason:void 0===n?null:n,priority:function(t){var n=r.DEFAULT;return t!==r.DEFAULT&&t!==r.STRONG&&t!==r.WEAK||(n=t),n}(e)}}o.__dashjs_factory_name="SwitchRequest";var u=i.default.getClassFactory(o);u.NO_CHANGE=-1,u.PRIORITY=r,i.default.updateClassFactory(o.__dashjs_factory_name,u),n.default=u})),Pe=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(h),i=a(y),r=a(Fe),o=a(c),u=a(d);function a(t){return t&&t.__esModule?t:{default:t}}function s(t){var n,e=this.context,a=(t=t||{}).dashMetrics,s=void 0;return n={getMaxIndex:function(t){var n=(0,r.default)(e).create();if(!(t&&t.hasOwnProperty("getMediaInfo")&&t.hasOwnProperty("getMediaType")&&t.hasOwnProperty("useBufferOccupancyABR")&&t.hasOwnProperty("getAbrController")&&t.hasOwnProperty("getScheduleController")))return n;!function(){if(!a||!a.hasOwnProperty("getCurrentBufferState"))throw new Error(o.default.MISSING_CONFIG_ERROR)}();var i=t.getMediaInfo(),f=t.getMediaType(),c=a.getCurrentBufferState(f),l=t.getScheduleController(),d=t.getAbrController(),h=t.getStreamInfo(),v=h&&h.manifestInfo?h.manifestInfo.isDynamic:null,p=d.getThroughputHistory(),g=p.getSafeAverageThroughput(f,v),m=p.getAverageLatency(f),y=t.useBufferOccupancyABR();return isNaN(g)||!c||y||d.getAbandonmentStateFor(f)!==u.default.ABANDON_LOAD&&(c.state===u.default.BUFFER_LOADED||v)&&(n.quality=d.getQualityForBitrate(i,g,m),l.setTimeToLoadDelay(0),s.debug("["+f+"] requesting switch to index: ",n.quality,"Average throughput",Math.round(g),"kbps"),n.reason={throughput:g,latency:m}),n},reset:function(){}},s=(0,i.default)(e).getInstance().getLogger(n),n}s.__dashjs_factory_name="ThroughputRule",n.default=e.default.getClassFactory(s)})),Be=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(v),i=f(m),r=f(h),o=f(y),u=f(Fe),a=f(c),s=f(d);function f(t){return t&&t.__esModule?t:{default:t}}function l(t){t=t||{};var n=this.context,r=(0,e.default)(n).getInstance(),f=t.dashMetrics,c=void 0,l=void 0,d=void 0;function h(){(d={})[a.default.VIDEO]={ignoreCount:2},d[a.default.AUDIO]={ignoreCount:2}}function v(){h()}function p(t){isNaN(t.startTime)||t.mediaType!==a.default.AUDIO&&t.mediaType!==a.default.VIDEO||d[t.mediaType].ignoreCount>0&&d[t.mediaType].ignoreCount--}return c={getMaxIndex:function(t){var e=(0,u.default)(n).create();if(!t||!t.hasOwnProperty("getMediaType"))return e;!function(){if(!f||!f.hasOwnProperty("getCurrentBufferLevel")||!f.hasOwnProperty("getCurrentBufferState"))throw new Error(a.default.MISSING_CONFIG_ERROR)}();var i=t.getMediaType(),r=f.getCurrentBufferState(i),o=t.getRepresentationInfo().fragmentDuration;if(function(t){return d[t].ignoreCount>0}(i)||!o)return e;if(r&&r.state===s.default.BUFFER_EMPTY)l.debug("["+i+"] Switch to index 0; buffer is empty."),e.quality=0,e.reason="InsufficientBufferRule: Buffer is empty";else{var c=t.getMediaInfo(),h=t.getAbrController(),v=h.getThroughputHistory(),p=f.getCurrentBufferLevel(i),g=v.getAverageThroughput(i),m=v.getAverageLatency(i);e.quality=h.getQualityForBitrate(c,g*(p/o)*.5,m),e.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return e},reset:function(){h(),r.off(i.default.PLAYBACK_SEEKING,v,c),r.off(i.default.BYTES_APPENDED_END_FRAGMENT,p,c)}},l=(0,o.default)(n).getInstance().getLogger(c),h(),r.on(i.default.PLAYBACK_SEEKING,v,c),r.on(i.default.BYTES_APPENDED_END_FRAGMENT,p,c),c}l.__dashjs_factory_name="InsufficientBufferRule",n.default=r.default.getClassFactory(l)})),Le=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(Fe),i=o(h),r=o(y);function o(t){return t&&t.__esModule?t:{default:t}}function u(t){var n,i=this.context,o=(t=t||{}).mediaPlayerModel,a=t.dashMetrics,s=t.settings,f=void 0,c=void 0,l=void 0,d=void 0;function h(){c={},l={},d=[]}return n={shouldAbandon:function(t){var n=(0,e.default)(i).create(e.default.NO_CHANGE,{name:u.__dashjs_factory_name});if(!(t&&t.hasOwnProperty("getMediaInfo")&&t.hasOwnProperty("getMediaType")&&t.hasOwnProperty("getCurrentRequest")&&t.hasOwnProperty("getRepresentationInfo")&&t.hasOwnProperty("getAbrController")))return n;var r,h,v=t.getMediaInfo(),p=t.getMediaType(),g=t.getCurrentRequest();if(!isNaN(g.index)){h=g.index,c[r=p]=c[r]||{},c[r][h]=c[r][h]||{};var m=o.getStableBufferTime();if(a.getCurrentBufferLevel(p)>m)return n;var y=c[p][g.index];if(null===y||null===g.firstByteDate||l.hasOwnProperty(y.id))return n;if(void 0===y.firstByteTime&&(d[p]=[],y.firstByteTime=g.firstByteDate.getTime(),y.segmentDuration=g.duration,y.bytesTotal=g.bytesTotal,y.id=g.index),y.bytesLoaded=g.bytesLoaded,y.elapsedTime=(new Date).getTime()-y.firstByteTime,y.bytesLoaded>0&&y.elapsedTime>0&&function(t,n){d[t]=d[t]||[],d[t].push(n)}(p,Math.round(8*y.bytesLoaded/y.elapsedTime)),d[p].length>=5&&y.elapsedTime>500&&y.bytesLoaded<y.bytesTotal){var w=d[p].reduce((function(t,n){return t+n}),0);if(y.measuredBandwidthInKbps=Math.round(w/d[p].length),y.estimatedTimeOfDownload=+(8*y.bytesTotal/y.measuredBandwidthInKbps/1e3).toFixed(2),y.estimatedTimeOfDownload<1.8*y.segmentDuration||0===t.getRepresentationInfo().quality)return n;if(!l.hasOwnProperty(y.id)){var b=t.getAbrController(),M=y.bytesTotal-y.bytesLoaded,T=b.getBitrateList(v),N=b.getQualityForBitrate(v,y.measuredBandwidthInKbps*s.get().streaming.abr.bandwidthSafetyFactor),_=b.getMinAllowedIndexFor(p),S=void 0!==_?Math.max(_,N):N;M>y.bytesTotal*T[S].bitrate/T[b.getQualityFor(p)].bitrate&&(n.quality=S,n.reason.throughput=y.measuredBandwidthInKbps,n.reason.fragmentID=y.id,l[y.id]=y,f.debug("["+p+"] frag id",y.id," is asking to abandon and switch to quality to ",S," measured bandwidth was",y.measuredBandwidthInKbps),delete c[p][y.id])}}else y.bytesLoaded===y.bytesTotal&&delete c[p][y.id]}return n},reset:h},f=(0,r.default)(i).getInstance().getLogger(n),h(),n}u.__dashjs_factory_name="AbandonRequestsRule",n.default=i.default.getClassFactory(u)})),Ue=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(h),i=o(Fe),r=o(y);function o(t){return t&&t.__esModule?t:{default:t}}function u(){var t,n=this.context,e=void 0;return t={getMaxIndex:function(t){var r=(0,i.default)(n).create();if(!t||!t.hasOwnProperty("getDroppedFramesHistory"))return r;var o=t.getDroppedFramesHistory();if(o){for(var u=o.getFrameHistory(),a=0,s=0,f=i.default.NO_CHANGE,c=1;c<u.length;c++)if(u[c]&&(a=u[c].droppedVideoFrames,(s=u[c].totalVideoFrames)>375&&a/s>.15)){e.debug("index: "+(f=c-1)+" Dropped Frames: "+a+" Total Frames: "+s);break}return(0,i.default)(n).create(f,{droppedFrames:a})}return r}},e=(0,r.default)(n).getInstance().getLogger(t),t}u.__dashjs_factory_name="DroppedFramesRule",n.default=e.default.getClassFactory(u)})),qe=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(h),i=o(y),r=o(Fe);function o(t){return t&&t.__esModule?t:{default:t}}function u(){var t,n=this.context,e=void 0;return t={getMaxIndex:function(t){for(var i=t?t.getSwitchHistory():null,o=i?i.getSwitchRequests():[],u=0,a=0,s=0,f=(0,r.default)(n).create(),c=0;c<o.length;c++)if(void 0!==o[c]&&(s+=o[c].dropSize,(u+=o[c].drops)+(a+=o[c].noDrops)>=6&&u/a>.075)){f.quality=c>0&&o[c].drops>0?c-1:c,f.reason={index:f.quality,drops:u,noDrops:a,dropSize:s},e.debug("Switch history rule index: "+f.quality+" samples: "+(u+a)+" drops: "+u);break}return f}},e=(0,i.default)(n).getInstance().getLogger(t),t}u.__dashjs_factory_name="SwitchHistoryRule",n.default=e.default.getClassFactory(u)})),ze=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=s(d),i=s(Fe),r=s(h),o=s(v),u=s(m),a=s(y);function s(t){return t&&t.__esModule?t:{default:t}}var f=10;function c(t){var n=this.context,r=(t=t||{}).dashMetrics,s=t.mediaPlayerModel,c=(0,o.default)(n).getInstance(),l=void 0,d=void 0,h=void 0;function v(t,n,e){var i=e.reduce((function(t,n,i){return n>e[t]?i:t}),0);if(0===i)return null;var r=Math.max(t,f+2*n.length),o=(e[i]-1)/(r/f-1);return{gp:o,Vp:f/o}}function p(t){t.placeholderBuffer=0,t.mostAdvancedSegmentStart=NaN,t.lastSegmentWasReplacement=!1,t.lastSegmentStart=NaN,t.lastSegmentDurationS=NaN,t.lastSegmentRequestTimeMs=NaN,t.lastSegmentFinishTimeMs=NaN}function g(t,n){var e=s.getStableBufferTime();if(t.stableBufferTime!==e){var i=v(e,t.bitrates,t.utilities);if(i.Vp!==t.Vp||i.gp!==t.gp){var o=r.getCurrentBufferLevel(n),u=o+t.placeholderBuffer;u-=f,u*=i.Vp/t.Vp,u+=f,t.stableBufferTime=e,t.Vp=i.Vp,t.gp=i.gp,t.placeholderBuffer=Math.max(0,u-o)}}}function m(t,n){return t.Vp*(t.utilities[n]+t.gp)}function y(t,n){for(var e=t.bitrates[n],i=t.utilities[n],r=0,o=n-1;o>=0;--o)if(t.utilities[o]<t.utilities[n]){var u=t.bitrates[o];r=Math.max(r,t.Vp*(t.gp+(e*t.utilities[o]-u*i)/(e-u)))}return r}function w(){for(var t in h)h.hasOwnProperty(t)&&2===h[t].state&&(h[t].placeholderBuffer=0)}function M(){for(var t in h)if(h.hasOwnProperty(t)){var n=h[t];0!==n.state&&(n.state=1,p(n))}}function T(t){if(t&&t.chunk&&t.chunk.mediaInfo){var n=h[t.chunk.mediaInfo.type];if(n&&0!==n.state){var e=t.chunk.start;isNaN(n.mostAdvancedSegmentStart)||e>n.mostAdvancedSegmentStart?(n.mostAdvancedSegmentStart=e,n.lastSegmentWasReplacement=!1):n.lastSegmentWasReplacement=!0,n.lastSegmentStart=e,n.lastSegmentDurationS=t.chunk.duration,n.lastQuality=t.chunk.quality,_(n,t.chunk.mediaInfo.type)}}}function N(t){if(t&&t.metric===e.default.HTTP_REQUEST&&t.value&&t.value.type===b.HTTPRequest.MEDIA_SEGMENT_TYPE&&t.value.trace&&t.value.trace.length){var n=h[t.mediaType];n&&0!==n.state&&(n.lastSegmentRequestTimeMs=t.value.trequest.getTime(),n.lastSegmentFinishTimeMs=t.value._tfinish.getTime(),_(n,t.mediaType))}}function _(t,n){if(!isNaN(t.lastSegmentStart)&&!isNaN(t.lastSegmentRequestTimeMs)&&!isNaN(t.placeholderBuffer)){if(t.placeholderBuffer*=.99,!isNaN(t.lastSegmentFinishTimeMs)){var e=r.getCurrentBufferLevel(n)+.001*(t.lastSegmentFinishTimeMs-t.lastSegmentRequestTimeMs),i=m(t,t.lastQuality),o=Math.max(0,i-e);t.placeholderBuffer=Math.min(o,t.placeholderBuffer)}t.lastSegmentWasReplacement&&!isNaN(t.lastSegmentDurationS)&&(t.placeholderBuffer+=t.lastSegmentDurationS),t.lastSegmentStart=NaN,t.lastSegmentRequestTimeMs=NaN}}function S(t){if(t){var n=h[t.mediaType];n&&0!==n.state&&(n.abrQuality=t.newQuality)}}function C(t){if(t){var n=h[t.mediaType];if(n&&0!==n.state){var e,i=r.getCurrentBufferLevel(t.mediaType);e=n.abrQuality>0?y(n,n.abrQuality):f;var o=Math.max(0,e-i);n.placeholderBuffer=Math.min(n.placeholderBuffer,o)}}}function E(){h={}}return l={getMaxIndex:function(t){var e=(0,i.default)(n).create();if(!(t&&t.hasOwnProperty("getMediaInfo")&&t.hasOwnProperty("getMediaType")&&t.hasOwnProperty("getScheduleController")&&t.hasOwnProperty("getStreamInfo")&&t.hasOwnProperty("getAbrController")&&t.hasOwnProperty("useBufferOccupancyABR")))return e;var o=t.getMediaInfo(),u=t.getMediaType(),a=t.getScheduleController(),f=t.getStreamInfo(),c=t.getAbrController(),l=c.getThroughputHistory(),w=f?f.id:null,b=f&&f.manifestInfo&&f.manifestInfo.isDynamic,M=t.useBufferOccupancyABR();if(e.reason=e.reason||{},!M)return e;a.setTimeToLoadDelay(0);var T=function(t){var n=t.getMediaType(),e=h[n];return e?0!==e.state&&g(e,n):(e=function(t){var n={},e=t.getMediaInfo().bitrateList.map((function(t){return t.bandwidth})),i=function(t){return t.map((function(t){return Math.log(t)}))}(e);i=i.map((function(t){return t-i[0]+1}));var r=s.getStableBufferTime(),o=v(r,e,i);return o?(n.state=1,n.bitrates=e,n.utilities=i,n.stableBufferTime=r,n.Vp=o.Vp,n.gp=o.gp,n.lastQuality=0,p(n)):n.state=0,n}(t),h[n]=e),e}(t);if(0===T.state)return e;var N=r.getCurrentBufferLevel(u),_=l.getAverageThroughput(u,b),S=l.getSafeAverageThroughput(u,b),C=l.getAverageLatency(u),E=void 0;if(e.reason.state=T.state,e.reason.throughput=_,e.reason.latency=C,isNaN(_))return e;switch(T.state){case 1:E=c.getQualityForBitrate(o,S,C),e.quality=E,e.reason.throughput=S,T.placeholderBuffer=Math.max(0,y(T,E)-N),T.lastQuality=E,!isNaN(T.lastSegmentDurationS)&&N>=T.lastSegmentDurationS&&(T.state=2);break;case 2:!function(t,n){var e=Date.now();isNaN(t.lastSegmentFinishTimeMs)?isNaN(t.lastCallTimeMs)||(t.placeholderBuffer+=Math.max(0,.001*(e-t.lastCallTimeMs))):t.placeholderBuffer+=Math.max(0,.001*(e-t.lastSegmentFinishTimeMs)),t.lastCallTimeMs=e,t.lastSegmentStart=NaN,t.lastSegmentRequestTimeMs=NaN,t.lastSegmentFinishTimeMs=NaN,g(t,n)}(T,u),E=function(t,n){for(var e=t.bitrates.length,i=NaN,r=NaN,o=0;o<e;++o){var u=(t.Vp*(t.utilities[o]+t.gp)-n)/t.bitrates[o];(isNaN(r)||u>=r)&&(r=u,i=o)}return i}(T,N+T.placeholderBuffer);var k=c.getQualityForBitrate(o,S,C);E>T.lastQuality&&E>k&&(E=Math.max(k,T.lastQuality));var O=Math.max(0,N+T.placeholderBuffer-m(T,E));O<=T.placeholderBuffer?(T.placeholderBuffer-=O,O=0):(O-=T.placeholderBuffer,T.placeholderBuffer=0,E<c.getTopQualityIndexFor(u,w)?a.setTimeToLoadDelay(1e3*O):O=0),e.quality=E,e.reason.throughput=_,e.reason.latency=C,e.reason.bufferLevel=N,e.reason.placeholderBuffer=T.placeholderBuffer,e.reason.delay=O,T.lastQuality=E;break;default:d.debug("BOLA ABR rule invoked in bad state."),e.quality=c.getQualityForBitrate(o,S,C),e.reason.state=T.state,e.reason.throughput=S,e.reason.latency=C,T.state=1,p(T)}return e},reset:function(){E(),c.off(u.default.BUFFER_EMPTY,w,l),c.off(u.default.PLAYBACK_SEEKING,M,l),c.off(u.default.MEDIA_FRAGMENT_LOADED,T,l),c.off(u.default.METRIC_ADDED,N,l),c.off(u.default.QUALITY_CHANGE_REQUESTED,S,l),c.off(u.default.FRAGMENT_LOADING_ABANDONED,C,l)}},d=(0,a.default)(n).getInstance().getLogger(l),E(),c.on(u.default.BUFFER_EMPTY,w,l),c.on(u.default.PLAYBACK_SEEKING,M,l),c.on(u.default.MEDIA_FRAGMENT_LOADED,T,l),c.on(u.default.METRIC_ADDED,N,l),c.on(u.default.QUALITY_CHANGE_REQUESTED,S,l),c.on(u.default.FRAGMENT_LOADING_ABANDONED,C,l),l}c.__dashjs_factory_name="BolaRule",n.default=r.default.getClassFactory(c)})),He=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=c(Pe),i=c(Be),r=c(Le),o=c(Ue),u=c(qe),a=c(ze),s=c(h),f=c(Fe);function c(t){return t&&t.__esModule?t:{default:t}}var l="qualitySwitchRules",d="abandonFragmentRules";function v(t){var n=this.context,s=(t=t||{}).mediaPlayerModel,c=t.dashMetrics,h=t.settings,v=void 0,p=void 0;function g(t){return t.filter((function(t){return t.quality>f.default.NO_CHANGE}))}function m(t){var e,i={},r=void 0,o=void 0,u=void 0,a=void 0;if(0!==t.length){for(i[f.default.PRIORITY.STRONG]=f.default.NO_CHANGE,i[f.default.PRIORITY.WEAK]=f.default.NO_CHANGE,i[f.default.PRIORITY.DEFAULT]=f.default.NO_CHANGE,r=0,e=t.length;r<e;r+=1)(o=t[r]).quality!==f.default.NO_CHANGE&&(i[o.priority]=i[o.priority]>f.default.NO_CHANGE?Math.min(i[o.priority],o.quality):o.quality);return i[f.default.PRIORITY.WEAK]!==f.default.NO_CHANGE&&(u=i[f.default.PRIORITY.WEAK]),i[f.default.PRIORITY.DEFAULT]!==f.default.NO_CHANGE&&(u=i[f.default.PRIORITY.DEFAULT]),i[f.default.PRIORITY.STRONG]!==f.default.NO_CHANGE&&(u=i[f.default.PRIORITY.STRONG]),u!==f.default.NO_CHANGE&&(a=u),(0,f.default)(n).create(a)}}return{initialize:function(){v=[],p=[],h.get().streaming.abr.useDefaultABRRules&&(v.push((0,a.default)(n).create({dashMetrics:c,mediaPlayerModel:s,settings:h})),v.push((0,e.default)(n).create({dashMetrics:c})),v.push((0,i.default)(n).create({dashMetrics:c})),v.push((0,u.default)(n).create()),v.push((0,o.default)(n).create()),p.push((0,r.default)(n).create({dashMetrics:c,mediaPlayerModel:s,settings:h}))),s.getABRCustomRules().forEach((function(t){t.type===l&&v.push(t.rule(n).create()),t.type===d&&p.push(t.rule(n).create())}))},reset:function(){[v,p].forEach((function(t){t&&t.length&&t.forEach((function(t){return t.reset&&t.reset()}))})),v=[],p=[]},getMaxQuality:function(t){return m(g(v.map((function(n){return n.getMaxIndex(t)}))))||(0,f.default)(n).create()},shouldAbandonFragment:function(t){return m(g(p.map((function(n){return n.shouldAbandon(t)}))))||(0,f.default)(n).create()}}}v.__dashjs_factory_name="ABRRulesCollection";var p=s.default.getClassFactory(v);p.QUALITY_SWITCH_RULES=l,p.ABANDON_FRAGMENT_RULES=d,s.default.updateSingletonFactory(v.__dashjs_factory_name,p),n.default=p})),Ke=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN}})),Ve=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(t){var n=(t=t||{}).abrController,e=t.switchHistory,i=t.droppedFramesHistory,r=t.currentRequest,o=t.useBufferOccupancyABR,u=t.streamProcessor?t.streamProcessor.getScheduleController():null,a=t.streamProcessor?t.streamProcessor.getRepresentationInfo():null;function s(){return a?a.mediaInfo:null}return{getMediaType:function(){var t=s();return t?t.type:null},getMediaInfo:s,getDroppedFramesHistory:function(){return i},getCurrentRequest:function(){return r},getSwitchHistory:function(){return e},getStreamInfo:function(){var t=s();return t?t.streamInfo:null},getScheduleController:function(){return u},getAbrController:function(){return n},getRepresentationInfo:function(){return a},useBufferOccupancyABR:function(){return o}}}r.__dashjs_factory_name="RulesContext",n.default=i.default.getClassFactory(r)})),We=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(Fe);function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t=[],n=[];return{push:function(e){e.newValue===i.default.NO_CHANGE&&(e.newValue=e.oldValue),t[e.oldValue]||(t[e.oldValue]={noDrops:0,drops:0,dropSize:0});var r=e.newValue-e.oldValue,o=r<0?1:0,u=o?-r:0,a=o?0:1;if(t[e.oldValue].drops+=o,t[e.oldValue].dropSize+=u,t[e.oldValue].noDrops+=a,n.push({idx:e.oldValue,noDrop:a,drop:o,dropSize:u}),n.length>8){var s=n.shift();t[s.idx].drops-=s.drop,t[s.idx].dropSize-=s.dropSize,t[s.idx].noDrops-=s.noDrop}},getSwitchRequests:function(){return t},reset:function(){t=[],n=[]}}}o.__dashjs_factory_name="SwitchRequestHistory";var u=e.default.getClassFactory(o);n.default=u})),Ge=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(){var t=[],n=0,e=0;return{push:function(i,r){var o=r&&r.droppedVideoFrames?r.droppedVideoFrames:0,u=r&&r.totalVideoFrames?r.totalVideoFrames:0,a=o-n;n=o;var s=u-e;e=u,isNaN(i)||(t[i]?(t[i].droppedVideoFrames+=a,t[i].totalVideoFrames+=s):t[i]={droppedVideoFrames:a,totalVideoFrames:s})},getFrameHistory:function(){return t},reset:function(i){t=[],n=i.droppedVideoFrames,e=i.totalVideoFrames}}}r.__dashjs_factory_name="DroppedFramesHistory";var o=i.default.getClassFactory(r);n.default=o})),$e=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(c),i=r(h);function r(t){return t&&t.__esModule?t:{default:t}}function o(t){var n=(t=t||{}).settings,i=void 0,r=void 0,o=void 0,u=void 0,a=void 0;function s(t,n,e,i){var r=Math.pow(.5,e/i.fast);t.fastEstimate=(1-r)*n+r*t.fastEstimate;var o=Math.pow(.5,e/i.slow);t.slowEstimate=(1-o)*n+o*t.slowEstimate,t.totalWeight+=e}function f(t,s,f){return n.get().streaming.abr.movingAverageMethod!==e.default.MOVING_AVERAGE_SLIDING_WINDOW?function(t,n){var e=t?a.throughputHalfLife:a.latencyHalfLife,i=t?o[n]:u[n];if(!i||i.totalWeight<=0)return NaN;var r=i.fastEstimate/(1-Math.pow(.5,i.totalWeight/e.fast)),s=i.slowEstimate/(1-Math.pow(.5,i.totalWeight/e.slow));return t?Math.min(r,s):Math.max(r,s)}(t,s):function(t,n,e){var o=function(t,n,e){var o=void 0,u=void 0;if(t?(o=i[n],u=e?3:4):(o=r[n],u=4),o){if(u>=o.length)u=o.length;else if(t)for(var a=1;a<u;++a){var s=o[o.length-a]/o[o.length-a-1];if((s>=1.3||s<=1/1.3)&&(u+=1)===o.length)break}}else u=0;return u}(t,n,e),u=(t?i:r)[n];return 0!==o&&u&&0!==u.length?(u=u.slice(-o)).reduce((function(t,n){return t+n}))/u.length:NaN}(t,s,f)}function c(t,n){return f(!0,t,n)}function l(t){i[t]=i[t]||[],r[t]=r[t]||[],o[t]=o[t]||{fastEstimate:0,slowEstimate:0,totalWeight:0},u[t]=u[t]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function d(){i={},r={},o={},u={}}var h={push:function(t,f,c){if(f.trace&&f.trace.length){var d,h=f.tresponse.getTime()-f.trequest.getTime()||1,v=f._tfinish.getTime()-f.tresponse.getTime()||1,p=f.trace.reduce((function(t,n){return t+n.b[0]}),0);d=n.get().streaming.lowLatencyEnabled?f.trace.reduce((function(t,n){return t+n.d}),0):c?v:h+v;var g=Math.round(8*p/d);if(l(t),function(t,i,r){return t===e.default.VIDEO?r<n.get().streaming.cacheLoadThresholds[e.default.VIDEO]:t===e.default.AUDIO?r<n.get().streaming.cacheLoadThresholds[e.default.AUDIO]:void 0}(t,0,v)){if(i[t].length>0&&!i[t].hasCachedEntries)return;i[t].hasCachedEntries=!0}else i[t]&&i[t].hasCachedEntries&&function(t){delete i[t],delete r[t],delete o[t],delete u[t],l(t)}(t);i[t].push(g),i[t].length>20&&i[t].shift(),r[t].push(h),r[t].length>20&&r[t].shift(),s(o[t],g,.001*v,a.throughputHalfLife),s(u[t],h,1,a.latencyHalfLife)}},getAverageThroughput:c,getSafeAverageThroughput:function(t,e){var i=c(t,e);return isNaN(i)||(i*=n.get().streaming.abr.bandwidthSafetyFactor),i},getAverageLatency:function(t){return f(!1,t)},reset:d};return a={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},d(),h}o.__dashjs_factory_name="ThroughputHistory",n.default=i.default.getClassFactory(o)})),Xe=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=_(He),i=_(c),r=_(d),o=_(Ke),u=_(T),a=_(v),s=_(m),f=_(h),l=_(Ve),p=_(Fe),g=_(We),w=_(Ge),M=_($e),N=_(y);function _(t){return t&&t.__esModule?t:{default:t}}function S(){var t=this.context,n=(0,N.default)(t).getInstance(),f=(0,a.default)(t).getInstance(),c=void 0,d=void 0,h=void 0,v=void 0,m=void 0,y=void 0,T=void 0,_=void 0,S=void 0,C=void 0,E=void 0,k=void 0,O=void 0,I=void 0,D=void 0,x=void 0,A=void 0,j=void 0,F=void 0,P=void 0,B=void 0,L=void 0,U=void 0;function q(){(h=(0,e.default)(t).create({dashMetrics:L,mediaPlayerModel:D,settings:U})).initialize()}function z(){m={},y={},_={},T={},j={},B={},void 0===C&&(C=!1),A=void 0,F=void 0,P=void 0,clearTimeout(S),S=null}function H(t){t.mediaType===i.default.VIDEO&&F.push(A=t.oldQuality,I.getPlaybackQuality())}function K(t){t.metric!==r.default.HTTP_REQUEST||!t.value||t.value.type!==b.HTTPRequest.MEDIA_SEGMENT_TYPE||t.mediaType!==i.default.AUDIO&&t.mediaType!==i.default.VIDEO||P.push(t.mediaType,t.value,U.get().streaming.abr.useDeadTimeLatency),t.metric!==r.default.BUFFER_LEVEL||t.mediaType!==i.default.AUDIO&&t.mediaType!==i.default.VIDEO||function(t,n){var e=U.get().streaming.abr.ABRStrategy;if(e!==i.default.ABR_STRATEGY_BOLA)if(e!==i.default.ABR_STRATEGY_THROUGHPUT){var r=D.getStableBufferTime(),o=B[t],u=n>(o?.5*r:r);B[t]=u,u!==o&&d.info(u?"["+t+"] switching from throughput to buffer occupancy ABR rule (buffer: "+n.toFixed(3)+").":"["+t+"] switching from buffer occupancy to throughput ABR rule (buffer: "+n.toFixed(3)+").")}else B[t]=!1;else B[t]=!0}(t.mediaType,.001*t.value.level)}function V(t,n){return m[n]=m[n]||{},m[n].hasOwnProperty(t)||(m[n][t]=0),function(t,n){if(n!==i.default.VIDEO||!U.get().streaming.abr.limitBitrateByPortal||!T[n])return t;C||nt();var e=O.getAdaptationForType(0,n).Representation,r=t;if(E>0&&k>0){for(;r>0&&e[r]&&E<e[r].width&&E-e[r-1].width<e[r].width-E;)r-=1;for(;r<e.length-1&&e[r].width===e[r+1].width;)r+=1}return r}(function(t,n,e){var i=U.get().streaming.abr.maxRepresentationRatio[n];return isNaN(i)||i>=1||i<0?t:Math.min(t,Math.round(e*i))}(function(t,n){var e=t;if(!T[n])return e;var i=G(n);void 0!==i&&(e=Math.max(t,i));var r=W(n);return void 0!==r&&(e=Math.min(e,r)),e}(m[n][t],t),t,m[n][t]),t)}function W(t){var n=function(t){return U.get().streaming.abr.maxBitrate[t]}(t);return n>-1?J(T[t].getMediaInfo(),n):void 0}function G(t){var n=function(t){return U.get().streaming.abr.minBitrate[t]}(t);if(n>-1){var e=T[t].getMediaInfo(),i=Y(e),r=J(e,n);return i[r]&&r<i.length-1&&i[r].bitrate<1e3*n&&r++,r}}function $(t,n,e,i){var r=n.id,o=tt(t);(0,R.checkInteger)(e);var u=V(t,r);e!==o&&e>=0&&e<=u&&X(t,o,e,u,i)}function X(t,n,e,i,r){if(t&&T[t]){var o=T[t].getStreamInfo(),u=o?o.id:null;if(U.get().debug.logLevel===N.default.LOG_LEVEL_DEBUG){var a=L.getCurrentBufferLevel(t);d.info("["+t+"] switch from "+n+" to "+e+"/"+i+" (buffer: "+a+") "+(r?JSON.stringify(r):"."))}!function(t,n,e){y[n]=y[n]||{},y[n][t]=e}(t,u,e),f.trigger(s.default.QUALITY_CHANGE_REQUESTED,{mediaType:t,streamInfo:o,oldQuality:n,newQuality:e,reason:r});var c=P.getAverageThroughput(t);isNaN(c)||x.setSavedBitrateSettings(t,c)}}function Q(t,n){_[t].state=n}function J(t,n,e){var i=t&&t.type?T[t.type].getRepresentationInfo():null;if(U.get().streaming.abr.useDeadTimeLatency&&e&&i&&i.fragmentDuration){var r=i.fragmentDuration;if((e/=1e3)>r)return 0;n*=1-e/r}for(var o=Y(t),u=o.length-1;u>=0;u--)if(1e3*n>=o[u].bitrate)return u;return 0}function Y(t){var n=[];if(!t||!t.bitrateList)return n;for(var e=t.bitrateList,i=t.type,r=void 0,u=0,a=e.length;u<a;u++)(r=new o.default).mediaType=i,r.qualityIndex=u,r.bitrate=e[u].bandwidth,r.width=e[u].width,r.height=e[u].height,r.scanType=e[u].scanType,n.push(r);return n}function Z(t){return B[t]}function tt(t){if(t&&T[t]){var n=T[t].getStreamInfo(),e=n?n.id:null;if(e)return y[e]=y[e]||{},y[e].hasOwnProperty(t)||(y[e][t]=0),y[e][t]}return 0}function nt(){if(I){var t=U.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;E=I.getClientWidth()*t,k=I.getClientHeight()*t}}function et(n){var e=n.request.mediaType;if(U.get().streaming.abr.autoSwitchBitrate[e]){var i=T[e];if(!i)return;var o=(0,l.default)(t).create({abrController:c,streamProcessor:i,currentRequest:n.request,useBufferOccupancyABR:Z(e)}),a=h.shouldAbandonFragment(o);if(a.quality>p.default.NO_CHANGE){var s=i.getFragmentModel();s.getRequests({state:u.default.FRAGMENT_MODEL_LOADING,index:n.request.index})[0]&&(s.abortRequests(),Q(e,r.default.ABANDON_LOAD),j[e].reset(),j[e].push({oldValue:tt(e),newValue:a.quality,confidence:1,reason:a.reason}),$(e,v.getActiveStreamInfo(),a.quality,a.reason),clearTimeout(S),S=setTimeout((function(){Q(e,r.default.ALLOW_LOAD),S=null}),U.get().streaming.abandonLoadTimeout))}}}return c={isPlayingAtTopQuality:function(t){var n=t?t.id:null,e=tt(i.default.AUDIO),r=tt(i.default.VIDEO);return e===V(i.default.AUDIO,n)&&r===V(i.default.VIDEO,n)},updateTopQualityIndex:function(t){if(t){var n=t.representationCount-1;return e=t.type,r=n,m[i=t.streamInfo.id]=m[i]||{},m[i][e]=r,n}var e,i,r},getThroughputHistory:function(){return P},getBitrateList:Y,getQualityForBitrate:J,getTopBitrateInfoFor:function(t){if(t&&T&&T[t]){var n=T[t].getStreamInfo();if(n&&n.id){var e=V(t,n.id),i=Y(T[t].getMediaInfo());return i[e]?i[e]:null}}return null},getMaxAllowedIndexFor:W,getMinAllowedIndexFor:G,getInitialBitrateFor:function(t){if(function(){if(!x||!x.hasOwnProperty("getSavedBitrateSettings"))throw new Error(i.default.MISSING_CONFIG_ERROR)}(),t===i.default.TEXT||t===i.default.FRAGMENTED_TEXT)return NaN;var n=x.getSavedBitrateSettings(t),e=U.get().streaming.abr.initialBitrate[t],r=U.get().streaming.abr.initialRepresentationRatio[t];if(-1===e)if(r>-1){var o=O.getAdaptationForType(0,t).Representation;e=Array.isArray(o)?o[Math.max(Math.round(o.length*r)-1,0)].bandwidth:0}else e=isNaN(n)?t===i.default.VIDEO?1e3:100:n;return e},getQualityFor:tt,getAbandonmentStateFor:function(t){return _[t]?_[t].state:null},setPlaybackQuality:$,checkPlaybackQuality:function(n){if(n&&T&&T[n]){var e=T[n].getStreamInfo(),i=e?e.id:null,o=tt(n),u=(0,l.default)(t).create({abrController:c,streamProcessor:T[n],currentValue:o,switchHistory:j[n],droppedFramesHistory:F,useBufferOccupancyABR:Z(n)});if(F){var a=I.getPlaybackQuality();a&&F.push(A,a)}if(U.get().streaming.abr.autoSwitchBitrate[n]){var s=G(n),f=V(n,i),v=h.getMaxQuality(u),g=v.quality;if(void 0!==s&&(g>p.default.NO_CHANGE?g:o)<s&&(g=s),g>f&&(g=f),j[n].push({oldValue:o,newValue:g}),g>p.default.NO_CHANGE&&g!=o)(_[n].state===r.default.ALLOW_LOAD||g>o)&&X(n,o,g,f,v.reason);else if(U.get().debug.logLevel===N.default.LOG_LEVEL_DEBUG){var m=L.getCurrentBufferLevel(n);d.debug("["+n+"] stay on "+o+"/"+f+" (buffer: "+m+")")}}}},getTopQualityIndexFor:V,setElementSize:nt,setWindowResizeEventCalled:function(t){C=t},createAbrRulesCollection:q,registerStreamType:function(n,e){j[n]=j[n]||(0,g.default)(t).create(),T[n]=e,_[n]=_[n]||{},_[n].state=r.default.ALLOW_LOAD,B[n]=!1,f.on(s.default.LOADING_PROGRESS,et,this),n==i.default.VIDEO&&(f.on(s.default.QUALITY_CHANGE_RENDERED,H,this),F=F||(0,w.default)(t).create(),nt()),f.on(s.default.METRIC_ADDED,K,this),f.on(s.default.PERIOD_SWITCH_COMPLETED,q,this),P=P||(0,M.default)(t).create({settings:U})},unRegisterStreamType:function(t){delete T[t]},setConfig:function(t){t&&(t.streamController&&(v=t.streamController),t.domStorage&&(x=t.domStorage),t.mediaPlayerModel&&(D=t.mediaPlayerModel),t.dashMetrics&&(L=t.dashMetrics),t.adapter&&(O=t.adapter),t.videoModel&&(I=t.videoModel),t.settings&&(U=t.settings))},reset:function(){z(),f.off(s.default.LOADING_PROGRESS,et,this),f.off(s.default.QUALITY_CHANGE_RENDERED,H,this),f.off(s.default.METRIC_ADDED,K,this),f.off(s.default.PERIOD_SWITCH_COMPLETED,q,this),h&&h.reset()}},d=n.getLogger(c),z(),c}S.__dashjs_factory_name="AbrController";var C=f.default.getSingletonFactory(S);C.QUALITY_DEFAULT=0,f.default.updateSingletonFactory(S.__dashjs_factory_name,C),n.default=C})),Qe=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(c),i=a(m),r=a(v),o=a(h),u=a(y);function a(t){return t&&t.__esModule?t:{default:t}}var s="neverReplace",f="alwaysReplace",l="highestBitrate",d="widestRange",p=l;function g(){var t,n=this.context,o=(0,r.default)(n).getInstance(),a=void 0,c=void 0,h=void 0,v=void 0,g=void 0,m=void 0,y=[f,s],w=[l,d];function b(t,n){if(!t||!n)return[];var e=n.id;return c[e]&&c[e][t]?c[e][t].list:[]}function M(t,n){return!t||!n||n&&!c[n.id]?null:c[n.id][t].current}function T(t,n){if(t&&t.streamInfo){var r=t.type,u=t.streamInfo,a=u.id,s=M(r,u);if(c[a]&&c[a][r]&&!E(t,s)&&(c[a][r].current=t,!c[a][r].current||n&&r===e.default.FRAGMENTED_TEXT||o.trigger(i.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:s,newMediaInfo:t,switchMode:g[r]}),!n)){var f=function(t){var n={lang:t.lang,viewpoint:t.viewpoint,roles:t.roles,accessibility:t.accessibility,audioChannelConfiguration:t.audioChannelConfiguration};return n.lang||n.viewpoint||n.role||n.accessibility&&n.accessibility.length>0||n.audioChannelConfiguration&&n.audioChannelConfiguration.length>0?n:null}(t);if(!f||!c[a][r].storeLastSettings)return;f.roles&&(f.role=f.roles[0],delete f.roles),f.accessibility&&(f.accessibility=f.accessibility[0]),f.audioChannelConfiguration&&(f.audioChannelConfiguration=f.audioChannelConfiguration[0]),m.setSavedMediaSettings(r,f)}}}function N(t,n){t&&n&&(h[t]=n)}function _(t){return t?h[t]:null}function S(){return v||p}function C(t){return t===e.default.AUDIO||t===e.default.VIDEO||t===e.default.TEXT||t===e.default.FRAGMENTED_TEXT||t===e.default.IMAGE}function E(t,n){if(!t&&!n)return!0;if(!t||!n)return!1;var e=t.id===n.id,i=t.viewpoint===n.viewpoint,r=t.lang===n.lang,o=t.roles.toString()===n.roles.toString(),u=t.accessibility.toString()===n.accessibility.toString(),a=t.audioChannelConfiguration.toString()===n.audioChannelConfiguration.toString();return e&&i&&r&&o&&u&&a}function k(){c={},h={audio:null,video:null,fragmentedText:null},g={audio:f,video:s}}function O(t,n){var e=!t.lang||n.lang.match(t.lang),i=!t.viewpoint||t.viewpoint===n.viewpoint,r=!t.role||!!n.roles.filter((function(n){return n===t.role}))[0],o=!t.accessibility||!!n.accessibility.filter((function(n){return n===t.accessibility}))[0],u=!t.audioChannelConfiguration||!!n.audioChannelConfiguration.filter((function(n){return n===t.audioChannelConfiguration}))[0];return e&&i&&r&&o&&u}function R(t,n){if(t===e.default.FRAGMENTED_TEXT)return n[0];var i=S(),r=[],o=function(t){var n=0,e=[],i=void 0;return t.forEach((function(t){(i=Math.max.apply(Math,t.bitrateList.map((function(t){return t.bandwidth}))))>n?(n=i,e=[t]):i===n&&e.push(t)})),e},u=function(t){var n=0,e=[],i=void 0;return t.forEach((function(t){(i=t.representationCount)>n?(n=i,e=[t]):i===n&&e.push(t)})),e};switch(i){case l:(r=o(n)).length>1&&(r=u(r));break;case d:(r=u(n)).length>1&&(r=o(n));break;default:a.warn("Track selection mode is not supported: "+i)}return r[0]}return t={checkInitialMediaSettingsForType:function(t,n){var e=_(t),i=b(t,n),r=[];e||N(t,e=m.getSavedMediaSettings(t)),i&&0!==i.length&&(e&&i.forEach((function(t){O(e,t)&&r.push(t)})),0===r.length?T(R(t,i),!0):T(r.length>1?R(t,r):r[0]))},addTrack:function(t){if(t){var n=t.type;if(C(n)){var e=t.streamInfo.id;c[e]||(c[e]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var i=c[e][n].list,r=0,o=i.length;r<o;++r)if(E(i[r],t))return;i.push(t);var u=_(n);u&&O(u,t)&&!M(n,t.streamInfo)&&T(t)}}},getTracksFor:b,getCurrentTrackFor:M,isCurrentTrack:function(t){if(!t)return!1;var n=t.type,e=t.streamInfo.id;return c[e]&&c[e][n]&&E(c[e][n].current,t)},setTrack:T,setInitialSettings:N,getInitialSettings:_,setSwitchMode:function(t,n){-1!==y.indexOf(n)?g[t]=n:a.warn("Track switch mode is not supported: "+n)},getSwitchMode:function(t){return g[t]},setSelectionModeForInitialTrack:function(t){-1!==w.indexOf(t)?v=t:a.warn("Track selection mode is not supported: "+t)},getSelectionModeForInitialTrack:S,isMultiTrackSupportedByType:C,isTracksEqual:E,matchSettings:O,saveTextSettingsDisabled:function(){m.setSavedMediaSettings(e.default.FRAGMENTED_TEXT,null)},setConfig:function(t){t&&t.domStorage&&(m=t.domStorage)},reset:k},a=(0,u.default)(n).getInstance().getLogger(t),k(),t}g.__dashjs_factory_name="MediaController";var w=o.default.getSingletonFactory(g);w.TRACK_SWITCH_MODE_NEVER_REPLACE=s,w.TRACK_SWITCH_MODE_ALWAYS_REPLACE=f,w.TRACK_SELECTION_MODE_HIGHEST_BITRATE=l,w.TRACK_SELECTION_MODE_WIDEST_RANGE=d,w.DEFAULT_INIT_TRACK_SELECTION_MODE=p,o.default.updateSingletonFactory(g.__dashjs_factory_name,w),n.default=w})),Je=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(){var t={};return{save:function(n){var e=n.streamId,i=n.representationId;t[e]=t[e]||{},t[e][i]=n},extract:function(n,e){return t&&t[n]&&t[n][e]?t[n][e]:null},reset:function(){t={}}}}r.__dashjs_factory_name="InitCache",n.default=i.default.getSingletonFactory(r)})),Ye=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=S(c),i=S(d),r=S(T),o=S(Ae),u=S(je),a=S(Xe),s=S(Qe),f=S(v),l=S(m),p=S(h),g=S(y),w=S(Je),M=S(N),_=S(Oe);function S(t){return t&&t.__esModule?t:{default:t}}var C=.5,E=.01,k="BufferController";function O(t){t=t||{};var n=this.context,c=(0,f.default)(n).getInstance(),d=t.errHandler,h=t.fragmentModel,v=t.representationController,p=t.mediaController,m=t.adapter,y=t.textController,T=t.abrController,N=t.playbackController,S=t.streamInfo,O=t.type,R=t.settings,I=void 0,D=void 0,x=void 0,A=void 0,j=void 0,F=void 0,P=void 0,B=void 0,L=void 0,U=void 0,q=void 0,z=void 0,H=void 0,K=void 0,V=void 0,W=void 0,G=void 0,$=void 0,X=void 0,Q=void 0,J=void 0,Y=void 0;function Z(t,e){if(!G||!t)return null;var i=t[0];if(P)try{U=e&&e[O]?(0,o.default)(n).create(P,i,rt.bind(this),e[O]):(0,o.default)(n).create(P,i,rt.bind(this),null),R.get().streaming.useAppendWindow&&U.updateAppendWindow(S),"function"==typeof U.getBuffer().initialize&&U.getBuffer().initialize(O,S,t,h)}catch(t){D.fatal("Caught error on create SourceBuffer: "+t),d.error(new M.default(_.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,_.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+O))}else U=(0,u.default)(n).create(rt.bind(this));return bt(this.getRepresentationInfo(x)),U}function tt(t){t.chunk.streamId===S.id&&t.chunk.mediaInfo.type===O&&(D.info("Init fragment finished loading saving to",O+"'s init cache"),G.save(t.chunk),D.debug("Append Init fragment",O," with representationId:",t.chunk.representationId," and quality:",t.chunk.quality,", data size:",t.chunk.bytes.byteLength),et(t.chunk))}function nt(t){var n=t.chunk;if(n.streamId===S.id&&n.mediaInfo.type===O)if(J){Y=n;var e=U&&U.getAllBufferRanges();e&&e.length>0&&N.getTimeToStreamEnd()>C&&(D.debug("Clearing buffer because track changed - "+(e.end(e.length-1)+.5)),mt([{start:0,end:e.end(e.length-1)+.5,force:!0}]))}else et(n)}function et(t){U.append(t),t.mediaInfo.type===e.default.VIDEO&&Ot(l.default.VIDEO_CHUNK_RECEIVED,{chunk:t})}function it(t){if(t&&t.length>0)for(var n=0,e=t.length;n<e;n++)D.debug("Buffered range: "+t.start(n)+" - "+t.end(n)+", currentTime = ",N.getTime())}function rt(t){if(t.error){if(22===t.error.code&&(W=!0,F=.8*Et(),D.warn("Quota exceeded, Critical Buffer: "+F),F>0)){var n=Math.max(.2*F,1),i=F-n,r=Math.min(R.get().streaming.bufferTimeAtTopQuality,.9*i),o=Math.min(R.get().streaming.bufferTimeAtTopQualityLongForm,.9*i),u={streaming:{bufferToKeep:parseFloat(n.toFixed(5)),bufferTimeAtTopQuality:parseFloat(r.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(o.toFixed(5))}};R.update(u)}22!==t.error.code&&kt()||(D.warn("Clearing playback buffer to overcome quota exceed situation"),Ot(l.default.QUOTA_EXCEEDED,{criticalBufferLevel:F}),mt(gt()))}else{W=!1,(H=t.chunk)&&!isNaN(H.index)&&(B=Math.max(H.index,B),ht());var a=U.getAllBufferRanges();if(H.segmentType===b.HTTPRequest.MEDIA_SEGMENT_TYPE)it(a),st(),function(){if((O===e.default.AUDIO||O===e.default.VIDEO)&&!isNaN($)){var t=N.getTime(),n=lt($,0);if(t!==$||!n){var i=v.getCurrentRepresentation().segmentDuration;(n=lt($,i))&&(Math.abs(t-$)>i?$<=n.end&&(N.seek(Math.max($,n.start),!1,!0),$=NaN):t<n.start&&(N.seek(n.start,!1,!0),$=NaN))}}}();else if(J){var s=N.getTime();D.debug("AppendToBuffer seek target should be "+s),Ot(l.default.SEEK_TARGET,{time:s,mediaType:O,streamId:S.id})}H&&Ot(H.endFragment?l.default.BYTES_APPENDED_END_FRAGMENT:l.default.BYTES_APPENDED,{quality:H.quality,startTime:H.start,index:H.index,bufferedRanges:a,mediaType:O})}}function ot(t){t.streamInfo.id===S.id&&t.mediaType===O&&x!==t.newQuality&&(bt(this.getRepresentationInfo(t.newQuality)),x=t.newQuality)}function ut(t){$=t.seekTime,A&&(X=!0,A=!1,L=Number.POSITIVE_INFINITY),O!==e.default.FRAGMENTED_TEXT?U.waitForUpdateEnd((function(){var t=function(){var t=[],n=U.getAllBufferRanges();if(!n||0===n.length)return t;var e=N.getTime(),i=n.end(n.length-1)+.5,o=h.getRequests({state:r.default.FRAGMENT_MODEL_EXECUTED,time:e,threshold:E})[0];if(o){var u={start:0,end:o.startTime-C},a=h.getRequests({state:r.default.FRAGMENT_MODEL_EXECUTED,time:o.startTime-o.duration/2,threshold:E})[0];a&&a.startTime!=o.startTime&&(u.end=a.startTime),u.start<u.end&&u.end>n.start(0)&&t.push(u);var s={start:o.startTime+o.duration+C,end:i},f=h.getRequests({state:r.default.FRAGMENT_MODEL_EXECUTED,time:o.startTime+o.duration+C,threshold:E})[0];f&&f.startTime!==o.startTime&&(s.start=f.startTime+f.duration+C),s.start<s.end&&s.start<i&&t.push(s)}else D.debug("getAllRangesWithSafetyFactor - No request found in current time position, removing full buffer 0 -",i),t.push({start:0,end:i});return t}();t&&0!==t.length||st(),mt(t)})):st()}function at(){$=NaN}function st(){(!J||O===e.default.FRAGMENTED_TEXT&&y.isTextEnabled())&&dt()}function ft(){vt()}function ct(){$=NaN,vt()}function lt(t,n){var e=U.getAllBufferRanges(),i=0,r=0,o=null,u=null,a=0,s=void 0,f=void 0,c=isNaN(n)?.15:n;if(null!=e){for(f=0,s=e.length;f<s;f++)if(i=e.start(f),r=e.end(f),null===o)a=Math.abs(i-t),(t>=i&&t<r||a<=c)&&(o=i,u=r);else{if(!((a=i-u)<=c))break;u=r}if(null!==o)return{start:o,end:u}}return null}function dt(){var t,n;N&&(t=(isNaN($)?N.getTime():$)||0,j=null===(n=lt(t,undefined))?0:n.end-t,Ot(l.default.BUFFER_LEVEL_UPDATED,{bufferLevel:j}),vt())}function ht(){B>=L-1&&!A&&void 0===U.discharge&&(A=!0,D.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for "+O),Ot(l.default.BUFFERING_COMPLETED))}function vt(){O!==e.default.AUDIO&&O!==e.default.VIDEO||(X&&!A&&j>0&&N&&N.getTimeToStreamEnd()-j<C&&(X=!1,A=!0,D.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED for type "+O),D.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED for type "+O),Ot(l.default.BUFFERING_COMPLETED)),(!R.get().streaming.lowLatencyEnabled&&j<C||0===j)&&!A?pt(i.default.BUFFER_EMPTY):(A||j>=S.manifestInfo.minBufferTime)&&pt(i.default.BUFFER_LOADED))}function pt(t){z===t||t===i.default.BUFFER_EMPTY&&0===N.getTime()||O===e.default.FRAGMENTED_TEXT&&!y.isTextEnabled()||(z=t,Ot(l.default.BUFFER_LEVEL_STATE_CHANGED,{state:t}),Ot(t===i.default.BUFFER_LOADED?l.default.BUFFER_LOADED:l.default.BUFFER_EMPTY),D.debug(t===i.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function gt(){var t=[],n=U.getAllBufferRanges();if(!n||0===n.length)return t;var e=N.getTime(),i=Math.max(0,e-R.get().streaming.bufferToKeep),o=h.getRequests({state:r.default.FRAGMENT_MODEL_EXECUTED,time:e,threshold:E})[0];if(o)i=Math.min(o.startTime,i);else if(0===e&&N.getIsDynamic())return[];if(n.start(0)<=i){for(var u={start:0,end:i},a=0;a<n.length&&n.end(a)<=i;a++)u.end=n.end(a);u.start<u.end&&t.push(u)}return t}function mt(t){t&&U&&0!==t.length&&(Q.push.apply(Q,t),V||yt())}function yt(){if(0===Q.length||!U)return D.debug("Nothing to prune, halt pruning"),Q=[],void(V=!1);var t=U.getBuffer();if(!t||!t.buffered||0===t.buffered.length)return D.debug("SourceBuffer is empty (or does not exist), halt pruning"),Q=[],void(V=!1);var n=Q.shift();D.debug("Removing buffer from:",n.start,"to",n.end),V=!0,N.getTime()<n.end&&(A=!1,B=0),U.remove(n.start,n.end,n.force)}function wt(t){U===t.buffer&&(D.debug("onRemoved buffer from:",t.from,"to",t.to),it(U.getAllBufferRanges()),0===Q.length&&(V=!1),t.unintended&&(D.warn("Detected unintended removal from:",t.from,"to",t.to,"setting index handler time to",t.from),Ot(l.default.SEEK_TARGET,{time:t.from,mediaType:O,streamId:S.id})),V?yt():(J?(J=!1,Y&&et(Y)):dt(),Ot(l.default.BUFFER_CLEARED,{from:t.from,to:t.to,unintended:t.unintended,hasEnoughSpaceToAppend:kt(),quotaExceeded:W})))}function bt(t){t&&void 0!==t.MSETimeOffset&&U&&U.updateTimestampOffset&&U.updateTimestampOffset(t.MSETimeOffset)}function Mt(t){t.sender.getStreamId()===S.id&&t.sender.getType()===O&&(t.error||A||bt(t.currentRepresentation))}function Tt(t){t.request.mediaInfo.streamInfo.id===S.id&&t.request.mediaType===O&&(L=t.request.index,ht())}function Nt(t){if(t.newMediaInfo.streamInfo.id===S.id&&t.newMediaInfo.type===O){var n=U&&U.getAllBufferRanges();n&&(D.info("Track change asked"),p.getSwitchMode(O)===s.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&n&&n.length>0&&N.getTimeToStreamEnd()>C&&(A=!1,L=Number.POSITIVE_INFINITY))}}function _t(){++K*(R.get().streaming.wallclockTimeUpdateInterval/1e3)>=R.get().streaming.bufferPruningInterval&&(K=0,U&&O!==e.default.FRAGMENTED_TEXT&&(A||mt(gt())))}function St(){vt()}function Ct(t,n){P=t,U&&n&&"function"==typeof U.discharge&&(q=U,Z(n))}function Et(){var t,n=U.getAllBufferRanges(),e=0,i=void 0;if(!n)return e;for(i=0,t=n.length;i<t;i++)e+=n.end(i)-n.start(i);return e}function kt(){return Et()<F}function Ot(t,n){var e=n||{};e.sender=I,e.mediaType=O,e.streamId=S.id,c.trigger(t,e)}function Rt(t,n){F=Number.POSITIVE_INFINITY,z=void 0,x=a.default.QUALITY_DEFAULT,L=Number.POSITIVE_INFINITY,B=0,H=null,A=!1,V=!1,W=!1,X=!1,j=0,K=0,Q=[],$=NaN,U&&(t||U.abort(),U.reset(n),U=null),J=!1}return I={getBufferControllerType:function(){return k},getRepresentationInfo:function(t){return m.convertDataToRepresentationInfo(v.getRepresentationForQuality(t))},initialize:function(t){Ct(t),x=T.getQualityFor(O),c.on(l.default.DATA_UPDATE_COMPLETED,Mt,this),c.on(l.default.INIT_FRAGMENT_LOADED,tt,this),c.on(l.default.MEDIA_FRAGMENT_LOADED,nt,this),c.on(l.default.QUALITY_CHANGE_REQUESTED,ot,this),c.on(l.default.STREAM_COMPLETED,Tt,this),c.on(l.default.PLAYBACK_PLAYING,ct,this),c.on(l.default.PLAYBACK_PROGRESS,st,this),c.on(l.default.PLAYBACK_TIME_UPDATED,st,this),c.on(l.default.PLAYBACK_RATE_CHANGED,St,this),c.on(l.default.PLAYBACK_SEEKING,ut,this),c.on(l.default.PLAYBACK_SEEKED,at,this),c.on(l.default.PLAYBACK_STALLED,ft,this),c.on(l.default.WALLCLOCK_TIME_UPDATED,_t,this),c.on(l.default.CURRENT_TRACK_CHANGED,Nt,this,f.default.EVENT_PRIORITY_HIGH),c.on(l.default.SOURCEBUFFER_REMOVE_COMPLETED,wt,this)},createBuffer:Z,dischargePreBuffer:function(){if(U&&q&&"function"==typeof q.discharge){var t=q.getAllBufferRanges();if(t.length>0){for(var n="Beginning "+O+"PreBuffer discharge, adding buffer for:",e=0;e<t.length;e++)n+=" start: "+t.start(e)+", end: "+t.end(e)+";";D.debug(n)}else D.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");for(var i=q.discharge(),r=null,o=0;o<i.length;o++){var u=i[o],a=G.extract(u.streamId,u.representationId);a&&(r!==a&&(U.append(a),r=a),U.append(u))}q.reset(),q=null}},getType:function(){return O},getBuffer:function(){return U},setBuffer:function(t){U=t},getBufferLevel:function(){return j},getRangeAt:lt,setMediaSource:Ct,getMediaSource:function(){return P},appendInitSegment:function(t){var n=G.extract(S.id,t);return!!n&&(D.info("Append Init fragment",O," with representationId:",n.representationId," and quality:",n.quality,", data size:",n.bytes.byteLength),et(n),!0)},replaceBuffer:function(){J=!0},getIsBufferingCompleted:function(){return A},getIsPruningInProgress:function(){return V},reset:function(t,n){c.off(l.default.DATA_UPDATE_COMPLETED,Mt,this),c.off(l.default.INIT_FRAGMENT_LOADED,tt,this),c.off(l.default.MEDIA_FRAGMENT_LOADED,nt,this),c.off(l.default.QUALITY_CHANGE_REQUESTED,ot,this),c.off(l.default.STREAM_COMPLETED,Tt,this),c.off(l.default.PLAYBACK_PLAYING,ct,this),c.off(l.default.PLAYBACK_PROGRESS,st,this),c.off(l.default.PLAYBACK_TIME_UPDATED,st,this),c.off(l.default.PLAYBACK_RATE_CHANGED,St,this),c.off(l.default.PLAYBACK_SEEKING,ut,this),c.off(l.default.PLAYBACK_SEEKED,at,this),c.off(l.default.PLAYBACK_STALLED,ft,this),c.off(l.default.WALLCLOCK_TIME_UPDATED,_t,this),c.off(l.default.CURRENT_TRACK_CHANGED,Nt,this),c.off(l.default.SOURCEBUFFER_REMOVE_COMPLETED,wt,this),Rt(t,n)},updateAppendWindow:function(){U&&!A&&U.updateAppendWindow(S)}},D=(0,g.default)(n).getInstance().getLogger(I),G=(0,w.default)(n).getInstance(),Rt(),I}O.__dashjs_factory_name=k,n.default=p.default.getClassFactory(O)})),Ze=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=d(c),i=d(v),r=d(m),o=d(h),u=d(Je),a=d(Ae),s=d(xe),f=d(N),l=d(Oe);function d(t){return t&&t.__esModule?t:{default:t}}var p="NotFragmentedTextBufferController";function g(t){t=t||{};var n=this.context,o=(0,i.default)(n).getInstance(),c=(0,s.default)(n).getInstance(),d=t.errHandler,h=t.streamInfo,v=t.type,g=t.mimeType,m=t.fragmentModel,y=void 0,w=void 0,b=void 0,M=void 0,T=void 0,N=void 0;function _(t){M=t}function S(t){t.sender.getStreamId()!==h.id||t.sender.getType()!==v||t.error||null===N.extract(h.id,t.currentRepresentation.id)&&(w=!1,o.trigger(r.default.INIT_FRAGMENT_NEEDED,{sender:y,streamId:h.id,mediaType:v,representationId:t.currentRepresentation.id}))}function C(t){t.chunk.streamId===h.id&&t.chunk.mediaInfo.type===v&&t.chunk.bytes&&(N.save(t.chunk),T.append(t.chunk),w=!0,o.trigger(r.default.STREAM_COMPLETED,{request:t.request}))}return y={getBufferControllerType:function(){return p},initialize:function(t){_(t),N=(0,u.default)(n).getInstance()},createBuffer:function(t){var i=t[0];try{if(T=(0,a.default)(n).create(M,i),!b){var r=T.getBuffer();r.hasOwnProperty(e.default.INITIALIZE)&&r.initialize(g,h,t,m),b=!0}return T}catch(t){if(i&&(i.isText||-1!==i.codec.indexOf('codecs="stpp')||-1!==i.codec.indexOf('codecs="wvtt')))try{T=c.getTextSourceBuffer()}catch(t){d.error(new f.default(l.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,l.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+v+" : "+t.message))}else d.error(new f.default(l.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,l.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+v))}},getType:function(){return v},getBuffer:function(){return T},getBufferLevel:function(){return 0},setMediaSource:_,getMediaSource:function(){return M},getIsBufferingCompleted:function(){return w},getIsPruningInProgress:function(){return!1},dischargePreBuffer:function(){},appendInitSegment:function(t){return null!==N.extract(h.id,t)},getRangeAt:function(){return null},reset:function(t){o.off(r.default.DATA_UPDATE_COMPLETED,S,y),o.off(r.default.INIT_FRAGMENT_LOADED,C,y),!t&&T&&(T.abort(),T.reset(),T=null)},updateTimestampOffset:function(t){T.timestampOffset===t||isNaN(t)||(T.timestampOffset=t)}},b=!1,M=null,w=!1,o.on(r.default.DATA_UPDATE_COMPLETED,S,y),o.on(r.default.INIT_FRAGMENT_LOADED,C,y),y}g.__dashjs_factory_name=p,n.default=o.default.getClassFactory(g)})),ti=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=u(c),i=u(h),r=u(Ye),o=u(Ze);function u(t){return t&&t.__esModule?t:{default:t}}function a(t){var n,i=this.context,u=void 0;function a(){return u.getBuffer()}return n={getBufferControllerType:function(){return u.getBufferControllerType()},initialize:function(t,n){return u.initialize(t,n)},createBuffer:function(t,n){return u.createBuffer(t,n)},getType:function(){return u.getType()},getBuffer:a,setBuffer:function(t){u.setBuffer(t)},getBufferLevel:function(){return u.getBufferLevel()},setMediaSource:function(t){u.setMediaSource(t)},getMediaSource:function(){return u.getMediaSource()},getIsBufferingCompleted:function(){return u.getIsBufferingCompleted()},getIsPruningInProgress:function(){return u.getIsPruningInProgress()},dischargePreBuffer:function(){return u.dischargePreBuffer()},appendInitSegment:function(t){u.appendInitSegment(t)},getRangeAt:function(t){return u.getRangeAt(t)},reset:function(t){u.reset(t)},updateTimestampOffset:function(t){var n=a();n.timestampOffset===t||isNaN(t)||(n.timestampOffset=t)},updateAppendWindow:function(){u.updateAppendWindow()}},u=(t=t||{}).type===e.default.FRAGMENTED_TEXT?(0,r.default)(i).create({streamInfo:t.streamInfo,type:t.type,mediaPlayerModel:t.mediaPlayerModel,manifestModel:t.manifestModel,fragmentModel:t.fragmentModel,errHandler:t.errHandler,mediaController:t.mediaController,representationController:t.representationController,adapter:t.adapter,textController:t.textController,abrController:t.abrController,playbackController:t.playbackController,settings:t.settings}):(0,o.default)(i).create({streamInfo:t.streamInfo,type:t.type,mimeType:t.mimeType,fragmentModel:t.fragmentModel,errHandler:t.errHandler}),n}a.__dashjs_factory_name="TextBufferController",n.default=i.default.getClassFactory(a)})),ni=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(c),i=o(h),r=o(d);function o(t){return t&&t.__esModule?t:{default:t}}function u(t){var n=(t=t||{}).dashMetrics,i=t.mediaPlayerModel,o=t.textController,u=t.abrController,a=t.settings;function s(t,s){var f=NaN;if(!t||!s)return f;if(t===e.default.FRAGMENTED_TEXT)if(o.isTextEnabled())if(isNaN(s.fragmentDuration)){var c=n.getCurrentSchedulingInfo(r.default.SCHEDULING_INFO);f=c?c.duration:0}else f=s.fragmentDuration;else f=0;else{var l=s.mediaInfo.streamInfo;f=u.isPlayingAtTopQuality(l)?l.manifestInfo.duration>=a.get().streaming.longFormContentDurationThreshold?a.get().streaming.bufferTimeAtTopQualityLongForm:a.get().streaming.bufferTimeAtTopQuality:i.getStableBufferTime()}return f}return{execute:function(t,e){return!t||!e||n.getCurrentBufferLevel(t)<s(t,e)},getBufferTarget:s}}u.__dashjs_factory_name="BufferLevelRule",n.default=i.default.getClassFactory(u)})),ei=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=p(c),i=p(d),r=p(ni),o=p(T),u=p(v),a=p(m),s=p(h),f=p(y),l=p(Qe);function p(t){return t&&t.__esModule?t:{default:t}}function g(t){t=t||{};var n=this.context,s=(0,u.default)(n).getInstance(),c=t.adapter,d=t.dashMetrics,h=t.mediaPlayerModel,v=t.fragmentModel,p=t.abrController,g=t.playbackController,m=t.textController,y=t.streamId,w=t.type,b=t.mimeType,M=t.mediaController,T=t.bufferController,N=t.settings,_=void 0,S=void 0,C=void 0,E=void 0,k=void 0,O=void 0,R=void 0,I=void 0,D=void 0,x=void 0,A=void 0,j=void 0,F=void 0,P=void 0,B=void 0,L=void 0,U=void 0,q=void 0,z=void 0;function H(){return!1===E}function K(){H()||C&&!T.getIsBufferingCompleted()&&(S.debug("Schedule Controller starts"),E=!1,d.createPlaylistTraceMetrics(C.id,1e3*g.getTime(),g.getPlaybackRate()),G(0))}function V(){E||(S.debug("Schedule Controller stops"),S.debug(w+" Schedule Controller stops"),E=!0,clearTimeout(R))}function W(){if(E||k||g.isPaused()&&!N.get().streaming.scheduleWhilePaused||(w===e.default.FRAGMENTED_TEXT||w===e.default.TEXT)&&!m.isTextEnabled()||T.getIsBufferingCompleted())V();else{!function(){var t=g.getTime(),n=1.5;if(isNaN(C.fragmentDuration)){var e=d.getCurrentSchedulingInfo(C.mediaInfo.type);n=e?1.5*e.duration:1.5}var r=v.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:t+n,threshold:0})[0];if(r&&-1===P.indexOf(r)&&!c.getIsTextTrack(b)){var u=N.get().streaming.fastSwitchEnabled,a=T.getBufferLevel(),s=p.getAbandonmentStateFor(w),f=!M.isCurrentTrack(r.mediaInfo)&&M.getSwitchMode(r.mediaInfo.type)===l.default.TRACK_SWITCH_MODE_NEVER_REPLACE;u&&(f||r.quality<C.quality)&&a>=n&&s!==i.default.ABANDON_LOAD?(X(r),z=!0,S.debug("Reloading outdated fragment at index: ",r.index)):r.quality>C.quality&&!L&&ct(g.getTime()+a)}}();var t=P.length>0;L||isNaN(F)||B||t||function(t,n){j[n]=j[n]||{};var e=p.getTopQualityIndexFor(t,n);return j[n][t]!=e&&(S.info("Top quality "+t+" index has changed from "+j[n][t]+" to "+e),j[n][t]=e,!0)}(w,y)||x.execute(w,C,D)?($(!0),!t&&q&&p.checkPlaybackQuality(w),function(){if(C.quality===F&&!B||L){var t=P.shift();t&&t.isInitializationRequest()?(s.trigger(a.default.INIT_FRAGMENT_NEEDED,{sender:_,streamId:y,mediaType:w,representationId:t.representationId}),q=!1):(s.trigger(a.default.MEDIA_FRAGMENT_NEEDED,{sender:_,streamId:y,mediaType:w,seekTarget:I,replacement:t}),q=!0)}else B?(S.debug("Switch track for "+w+", representation id = "+C.id),(L=M.getSwitchMode(w)===l.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE)&&T.replaceBuffer&&T.replaceBuffer(),B=!1):S.debug("Quality has changed, get init request for representationid = "+C.id),s.trigger(a.default.INIT_FRAGMENT_NEEDED,{sender:_,streamId:y,mediaType:w,representationId:C.id}),F=C.quality,q=!1}()):G(500)}}function G(t){clearTimeout(R),R=setTimeout(W,t)}function $(t){k!==t?k=t:S.debug("isFragmentProcessingInProgress is already equal to",t)}function X(t){P.push(t)}function Q(t){if(g&&v){var n=v.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:g.getTime(),threshold:0})[0];n&&g.getTime()>=n.startTime&&((!A.mediaInfo||n.mediaInfo.type===A.mediaInfo.type&&n.mediaInfo.id!==A.mediaInfo.id)&&t&&s.trigger(a.default.TRACK_CHANGE_RENDERED,{mediaType:w,oldMediaInfo:A.mediaInfo,newMediaInfo:n.mediaInfo}),n.quality===A.quality&&n.adaptationIndex===A.adaptationIndex||!t||s.trigger(a.default.QUALITY_CHANGE_RENDERED,{mediaType:w,oldQuality:A.quality,newQuality:n.quality}),A={mediaInfo:n.mediaInfo,quality:n.quality,adaptationIndex:n.adaptationIndex})}}function J(t){t.request.mediaInfo.streamInfo.id===y&&t.request.mediaType===w&&(V(),$(!1),S.info("Stream "+y+" is complete"))}function Y(t){t.request.mediaInfo.streamInfo.id===y&&t.request.mediaType===w&&(S.info("OnFragmentLoadingCompleted - Url:",t.request?t.request.url:"undefined",t.request.range?", Range:"+t.request.range:""),c.getIsTextTrack(b)&&$(!1),t.error&&t.request.serviceLocation&&!E&&(X(t.request),$(!1),G(0)),L&&(U=t.request))}function Z(){Q(!0)}function tt(t){if(t.streamId===y&&t.mediaType===w)if(L&&!isNaN(t.startTime)&&(L=!1,v.addExecutedRequest(U)),$(!1),z&&!isNaN(t.startTime)){var n=g.getTime(),e=t.startTime+C.fragmentDuration,i=1.5*C.fragmentDuration;G(n+i>=e?0:1e3*(e-(n+i))),z=!1}else G(0)}function nt(t){t.streamId===y&&t.mediaType===w&&(S.info("onFragmentLoadingAbandoned request: "+t.request.url+" has been aborted"),g.isSeeking()||B||(S.info("onFragmentLoadingAbandoned request: "+t.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),X(t.request)),$(!1),G(0))}function et(t){t.sender.getType()===w&&t.sender.getStreamId()}function it(t){w===t.mediaType&&y===t.streamId&&V()}function rt(t){t.streamId===y&&t.mediaType===w&&(L&&N.get().streaming.flushBufferAtTrackSwitch&&g.seek(g.getTime()+.001,!1,!0),t.hasEnoughSpaceToAppend&&t.quotaExceeded&&K())}function ot(t){t.streamId===y&&t.mediaType===w&&(V(),$(!1))}function ut(){v.abortRequests(),V()}function at(){!E&&N.get().streaming.scheduleWhilePaused||K()}function st(t){ct(t.seekTime),lt(0),E&&K();var n=C.DVRWindow&&g?C.DVRWindow.end-g.getTime():NaN;d.updateManifestUpdateInfo({latency:n}),k?v.abortRequests():G(0)}function ft(t){d.updatePlayListTraceMetrics({playbackspeed:t.playbackRate.toString()})}function ct(t){I=t}function lt(t){O=t}function dt(){q=!0,k=!1,O=0,I=NaN,F=NaN,A={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},j={},P=[],E=!0,B=!1,L=!1,U=null,z=!1}return _={initialize:function(t){D=t,x=(0,r.default)(n).create({abrController:p,dashMetrics:d,mediaPlayerModel:h,textController:m,settings:N}),s.on(a.default.DATA_UPDATE_STARTED,et,this),s.on(a.default.FRAGMENT_LOADING_COMPLETED,Y,this),s.on(a.default.STREAM_COMPLETED,J,this),s.on(a.default.BUFFER_CLEARED,rt,this),s.on(a.default.BYTES_APPENDED_END_FRAGMENT,tt,this),s.on(a.default.QUOTA_EXCEEDED,ot,this),s.on(a.default.PLAYBACK_SEEKING,st,this),s.on(a.default.PLAYBACK_STARTED,at,this),s.on(a.default.PLAYBACK_RATE_CHANGED,ft,this),s.on(a.default.PLAYBACK_TIME_UPDATED,Z,this),s.on(a.default.URL_RESOLUTION_FAILED,ut,this),s.on(a.default.FRAGMENT_LOADING_ABANDONED,nt,this),s.on(a.default.BUFFERING_COMPLETED,it,this)},getType:function(){return w},getStreamId:function(){return y},setCurrentRepresentation:function(t){C=t},setSeekTarget:ct,setTimeToLoadDelay:lt,getTimeToLoadDelay:function(){return O},switchTrackAsked:function(){B=!0},isStarted:H,start:K,stop:V,reset:function(){s.off(a.default.DATA_UPDATE_STARTED,et,this),s.off(a.default.FRAGMENT_LOADING_COMPLETED,Y,this),s.off(a.default.STREAM_COMPLETED,J,this),s.off(a.default.BUFFER_CLEARED,rt,this),s.off(a.default.BYTES_APPENDED_END_FRAGMENT,tt,this),s.off(a.default.QUOTA_EXCEEDED,ot,this),s.off(a.default.PLAYBACK_SEEKING,st,this),s.off(a.default.PLAYBACK_STARTED,at,this),s.off(a.default.PLAYBACK_RATE_CHANGED,ft,this),s.off(a.default.PLAYBACK_TIME_UPDATED,Z,this),s.off(a.default.URL_RESOLUTION_FAILED,ut,this),s.off(a.default.FRAGMENT_LOADING_ABANDONED,nt,this),s.off(a.default.BUFFERING_COMPLETED,it,this),V(),Q(!1),dt()},getBufferTarget:function(){return x.getBufferTarget(w,C)},processInitRequest:function(t){t&&($(!0),v.executeRequest(t))},processMediaRequest:function(t){t?(S.debug("Next fragment request url is "+t.url),v.executeRequest(t)):(g.getIsDynamic()&&S.debug("Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling."),$(!1),G(N.get().streaming.lowLatencyEnabled?100:500))}},S=(0,f.default)(n).getInstance().getLogger(_),dt(),_}g.__dashjs_factory_name="ScheduleController",n.default=s.default.getClassFactory(g)})),ii=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(c),i=o(N),r=o(h);function o(t){return t&&t.__esModule?t:{default:t}}function u(t){var n=(t=t||{}).eventBus,r=t.events,o=t.errors,u=t.abrController,a=t.dashMetrics,s=t.playbackController,f=t.timelineConverter,c=t.type,l=t.streamId,d=t.dashConstants,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0;function y(){if(!(u&&a&&s&&f))throw new Error(e.default.MISSING_CONFIG_ERROR)}function w(){return p}function b(){return m}function M(){v=null,p=!0,g=[]}function T(){return c}function N(){y();var t=new Date,n=b(),e=1e3*s.getTime();n&&a.addRepresentationSwitch(n.adaptation.type,t,e,n.id)}function _(t){return null==t||t>=g.length?null:g[t]}function S(t,n){var e;t.segmentAvailabilityRange=f.calcSegmentAvailabilityRange(t,n),t.segmentAvailabilityRange.end<t.segmentAvailabilityRange.start?k(new i.default(o.SEGMENTS_UNAVAILABLE_ERROR_CODE,o.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE,{availabilityDelay:t.segmentAvailabilityRange.start-t.segmentAvailabilityRange.end})):n&&(f.setExpectedLiveEdge(e=t.segmentAvailabilityRange.end),a.updateManifestUpdateInfo({presentationStartTime:e}))}function C(t,e){y();for(var i=0,o=g.length;i<o;i++)S(g[i],t),e&&n.trigger(r.REPRESENTATION_UPDATE_STARTED,{sender:h,representation:g[i]})}function E(){p=!0,n.trigger(r.DATA_UPDATE_STARTED,{sender:h})}function k(t){p=!1;var e={sender:h,data:v,currentRepresentation:m};t&&(e.error=t),n.trigger(r.DATA_UPDATE_COMPLETED,e)}function O(t){if(t.sender.getType()===T()&&t.sender.getStreamInfo().id===l&&w())if(t.error)k(t.error);else{var e=t.sender.getStreamInfo(),f=t.representation,c=a.getCurrentManifestUpdate(),h=!1,v=0,p=void 0;if(f.adaptation.period.mpd.manifest.type===d.DYNAMIC&&!f.adaptation.period.mpd.manifest.ignorePostponeTimePeriod&&s.getStreamController().getStreams().length<=1&&(v=function(t,n){try{var e=s.getStreamController().getActiveStreamInfo(),i=t.segmentAvailabilityRange.start;e&&e.id&&e.id!==n.id&&(i=Math.min(s.getTime(),i));var r=t.segmentAvailabilityRange.end-i;return 1e3*(s.getLiveDelay()-r)}catch(t){return 0}}(f,e)),v>0)return function(t){var e=t;n.trigger(r.AST_IN_FUTURE,{delay:e}),setTimeout((function(){w()||(E(),g.forEach((function(t){t.segmentAvailabilityRange=null})),C(s.getIsDynamic(),!0))}),e)}(v),void k(new i.default(o.SEGMENTS_UPDATE_FAILED_ERROR_CODE,o.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE));if(c){for(var y=0;y<c.representationInfo.length;y++)if((p=c.representationInfo[y]).index===f.index&&p.mediaType===T()){h=!0;break}h||a.addManifestUpdateRepresentationInfo(f,T())}(function(){for(var t=0,n=g.length;t<n;t++){var e=g[t].segmentInfoType;if(null===g[t].segmentAvailabilityRange||!g[t].hasInitialization()||(e===d.SEGMENT_BASE||e===d.BASE_URL)&&!g[t].segments)return!1}return!0})()&&(u.setPlaybackQuality(T(),e,g.indexOf(m)),a.updateManifestUpdateInfo({latency:m.segmentAvailabilityRange.end-s.getTime()}),a.getCurrentRepresentationSwitch(b().adaptation.type)||N(),k())}}function R(t){t.isDynamic&&C(t.isDynamic)}function I(t){t.mediaType===T()&&l===t.streamInfo.id&&(m=_(t.newQuality),N())}function D(t){if(t.newDuration){var n=b();n&&n.adaptation.period&&(n.adaptation.period.duration=t.newDuration)}}return h={getData:function(){return v},isUpdating:w,updateData:function(t,n,i,r){y(),E(),g=n,m=_(r),v=t,i===e.default.VIDEO||i===e.default.AUDIO||i===e.default.FRAGMENTED_TEXT?C(s.getIsDynamic(),!0):k()},updateRepresentation:S,getCurrentRepresentation:b,getRepresentationForQuality:_,getType:T,getStreamId:function(){return l},reset:function(){n.off(r.QUALITY_CHANGE_REQUESTED,I,h),n.off(r.REPRESENTATION_UPDATE_COMPLETED,O,h),n.off(r.WALLCLOCK_TIME_UPDATED,R,h),n.off(r.MANIFEST_VALIDITY_CHANGED,D,h),M()}},M(),n.on(r.QUALITY_CHANGE_REQUESTED,I,h),n.on(r.REPRESENTATION_UPDATE_COMPLETED,O,h),n.on(r.WALLCLOCK_TIME_UPDATED,R,h),n.on(r.MANIFEST_VALIDITY_CHANGED,D,h),h}u.__dashjs_factory_name="RepresentationController",n.default=r.default.getClassFactory(u)})),ri=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(c);function r(t){return t&&t.__esModule?t:{default:t}}function o(t){var n=(t=t||{}).timelineConverter;return{getLiveEdge:function(t){return function(){if(!n||!n.hasOwnProperty("getExpectedLiveEdge"))throw new Error(i.default.MISSING_CONFIG_ERROR)}(),t.DVRWindow?t.DVRWindow.end:0},reset:function(){n=null}}}o.__dashjs_factory_name="LiveEdgeFinder",n.default=e.default.getClassFactory(o)})),oi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null}})),ui=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.unescapeDollarsInTemplate=function(t){return t?t.split("$$").join("$"):t},n.replaceIDForTemplate=function(t,n){if(!n||!t||-1===t.indexOf("$RepresentationID$"))return t;var e=n.toString();return t.split("$RepresentationID$").join(e)},n.replaceTokenForTemplate=o,n.getIndexBasedSegment=function(t,n,e,i){var r,o,s=void 0;s=e.segmentDuration,isNaN(s)&&(s=e.adaptation.period.duration),r=parseFloat((e.adaptation.period.start+i*s).toFixed(5)),o=parseFloat((r+s).toFixed(5));var f=u(e,s,r,t.calcMediaTimeFromPresentationTime(r,e),t.calcAvailabilityStartTimeFromPresentationTime(r,e.adaptation.period.mpd,n),t,o,n,i);return a(t,e,f,n)?f:null},n.getTimeBasedSegment=function(t,n,e,i,r,s,f,c,l,d){var h,v=i/s,p=Math.min(r/s,e.adaptation.period.mpd.maxSegmentDuration),g=void 0;return h=t.calcPresentationTimeFromMediaTime(v,e),a(t,e,g=u(e,p,h,v,e.adaptation.period.mpd.manifest.loadedTime,t,h+p,n,l),n)?(g.replacementTime=d||i,f=o(f,"Number",g.replacementNumber),f=o(f,"Time",g.replacementTime),g.media=f,g.mediaRange=c,g):null};var e,i=(e=oi)&&e.__esModule?e:{default:e};function r(t,n){for(;t.length<n;)t="0"+t;return t}function o(t,n,e){var i=void 0,o=void 0,u=void 0,a=void 0,s=void 0,f=void 0,c=n.length,l="%0".length;if(!t)return t;for(;;){if((i=t.indexOf("$"+n))<0)return t;if((o=t.indexOf("$",i+c))<0)return t;if((u=t.indexOf("%0",i+c))>i&&u<o)switch(a=t.charAt(o-1),s=parseInt(t.substring(u+l,o-1),10),a){case"d":case"i":case"u":f=r(e.toString(),s);break;case"x":f=r(e.toString(16),s);break;case"X":f=r(e.toString(16),s).toUpperCase();break;case"o":f=r(e.toString(8),s);break;default:return t}else f=e;t=t.substring(0,i)+f+t.substring(o+1)}}function u(t,n,e,r,o,u,a,s,f){var c=new i.default;return c.representation=t,c.duration=n,c.presentationStartTime=e,c.mediaStartTime=r,c.availabilityStartTime=o,c.availabilityEndTime=u.calcAvailabilityEndTimeFromPresentationTime(a,t.adaptation.period.mpd,s),c.wallStartTime=u.calcWallTimeForSegment(c,s),c.replacementNumber=c.representation.startNumber+f,c.availabilityIdx=f,c}function a(t,n,e,i){var r=t.getPeriodEnd(n,i),o=t.calcPeriodRelativeTimeFromMpdRelativeTime(n,r);if(t.calcPeriodRelativeTimeFromMpdRelativeTime(n,e.presentationStartTime)>=o){if(!i)return!1;if(n.segmentAvailabilityRange&&e.presentationStartTime>=n.segmentAvailabilityRange.end)return!1}return!0}})),ai=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(c);function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=(t=t||{}).timelineConverter;function r(){if(!e||!e.hasOwnProperty("calcMediaTimeFromPresentationTime")||!e.hasOwnProperty("calcSegmentAvailabilityRange"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function o(t,i){var r,o,u,a=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentTemplate||t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentList,s=a.SegmentURL_asArray,f=0,c=0,l=-1,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0;u=t.timescale;var y=!1;for(h=0,o=(r=a.SegmentTimeline.S_asArray).length;h<o&&!y;h++){if(p=0,(d=r[h]).hasOwnProperty("r")&&(p=d.r),d.hasOwnProperty("t")&&(c=(f=d.t)/u),p<0){if((m=r[h+1])&&m.hasOwnProperty("t"))g=m.t/u;else{var w=t.segmentAvailabilityRange?t.segmentAvailabilityRange.end:e.calcSegmentAvailabilityRange(t,n).end;g=e.calcMediaTimeFromPresentationTime(w,t),t.segmentDuration=d.d/u}p=Math.ceil((g-c)/(d.d/u))-1}for(v=0;v<=p&&!y;v++)(y=i(f,c,a,s,d,u,++l,h))&&(t.segmentDuration=d.d/u,(v<p-1||h<o-1)&&l++),c=(f+=d.d)/u}t.availableSegmentsNumber=l}return{getSegmentByIndex:function(t,i,u){if(r(),!t)return null;var a=null,s=!1;return o(t,(function(i,r,o,f,c,l,d,h){if(s||u<0){var v=o.media,p=c.mediaRange;return f&&(v=f[h].media||"",p=f[h].mediaRange),a=(0,ui.getTimeBasedSegment)(e,n,t,i,c.d,l,v,p,d,c.tManifest),!0}return r>=u-.5*c.d/l&&(s=!0),!1})),a},getSegmentByTime:function(t,i){if(r(),!t)return null;void 0===i&&(i=null);var u=null,a=e.calcMediaTimeFromPresentationTime(i,t);return o(t,(function(i,r,o,s,f,c,l,d){if(a<r+f.d/c){var h=o.media,v=f.mediaRange;return s&&(h=s[d].media||"",v=s[d].mediaRange),u=(0,ui.getTimeBasedSegment)(e,n,t,i,f.d,c,h,v,l,f.tManifest),!0}return!1})),u}}}o.__dashjs_factory_name="TimelineSegmentsGetter";var u=e.default.getClassFactory(o);n.default=u})),si=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(c);function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=(t=t||{}).timelineConverter;function r(){if(!e||!e.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function o(t,i){if(r(),!t)return null;var o=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentTemplate;i=Math.max(i,0);var u=(0,ui.getIndexBasedSegment)(e,n,t,i);if(u){u.replacementTime=(i-1)*t.segmentDuration;var a=o.media;a=(0,ui.replaceTokenForTemplate)(a,"Number",u.replacementNumber),a=(0,ui.replaceTokenForTemplate)(a,"Time",u.replacementTime),u.media=a}var s=t.segmentDuration,f=t.segmentAvailabilityRange;return t.availableSegmentsNumber=isNaN(s)?1:Math.ceil((f.end-f.start)/s),u}return{getSegmentByIndex:o,getSegmentByTime:function(t,n){if(r(),!t)return null;var i=t.segmentDuration;if(isNaN(i))return null;var u=e.calcPeriodRelativeTimeFromMpdRelativeTime(t,n);return o(t,Math.floor(u/i))}}}o.__dashjs_factory_name="TemplateSegmentsGetter";var u=e.default.getClassFactory(o);n.default=u})),fi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(c);function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=(t=t||{}).timelineConverter;function r(){if(!e||!e.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function o(t,i){if(r(),!t)return null;var o=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentList,u=o.SegmentURL_asArray.length,a=t&&!isNaN(t.startNumber)?t.startNumber:1,s=Math.max(a-1,0),f=t.startNumber,c=null;if(i-s<u){var l=o.SegmentURL_asArray[i-s];(c=(0,ui.getIndexBasedSegment)(e,n,t,i))&&(c.replacementTime=(f+i-1)*t.segmentDuration,c.media=l.media?l.media:"",c.mediaRange=l.mediaRange,c.index=i,c.indexRange=l.indexRange)}return t.availableSegmentsNumber=u,c}return{getSegmentByIndex:o,getSegmentByTime:function(t,n){if(r(),!t)return null;var i=t.segmentDuration;if(isNaN(i))return null;var u=e.calcPeriodRelativeTimeFromMpdRelativeTime(t,n);return o(t,Math.floor(u/i))}}}o.__dashjs_factory_name="ListSegmentsGetter";var u=e.default.getClassFactory(o);n.default=u})),ci=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(c);function r(t){return t&&t.__esModule?t:{default:t}}function o(t){var n=(t=t||{}).timelineConverter;function e(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function r(t,n){if(e(),!t)return null;var i=t.segments?t.segments.length:-1,r=void 0;if(n<i&&(r=t.segments[n])&&r.availabilityIdx===n)return r;for(var o=0;o<i;o++)if((r=t.segments[o])&&r.availabilityIdx===n)return r;return null}return{getSegmentByIndex:r,getSegmentByTime:function(t,n){return e(),r(t,function(t,n){if(!t)return-1;var e=t.segments,i=e?e.length:null,r=-1,o=void 0,u=void 0,a=void 0,s=void 0,f=void 0;if(e&&i>0)for(f=0;f<i;f++)if(n+(o=(s=(u=e[f]).duration)/2)>=(a=u.presentationStartTime)&&n-o<a+s){r=u.availabilityIdx;break}return r}(t,n))}}}o.__dashjs_factory_name="SegmentBaseGetter";var u=e.default.getClassFactory(o);n.default=u})),li=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(h),i=a(ai),r=a(si),o=a(fi),u=a(ci);function a(t){return t&&t.__esModule?t:{default:t}}function s(t){var n,e=this.context,a=(t=t||{}).events,s=t.eventBus,f=t.dashConstants,c=void 0;function l(t){return t?t.segments?c[f.SEGMENT_BASE]:c[t.segmentInfoType]:null}return n={initialize:function(n){c[f.SEGMENT_TIMELINE]=(0,i.default)(e).create(t,n),c[f.SEGMENT_TEMPLATE]=(0,r.default)(e).create(t,n),c[f.SEGMENT_LIST]=(0,o.default)(e).create(t,n),c[f.SEGMENT_BASE]=(0,u.default)(e).create(t,n)},update:function(t,n,e,i,r){i||s.trigger(a.SEGMENTBASE_INIT_REQUEST_NEEDED,{mimeType:e,representation:t}),r||s.trigger(a.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{mimeType:e,mediaType:n,representation:t})},getSegmentByIndex:function(t,n,e){var i=l(t);return i?i.getSegmentByIndex(t,n,e):null},getSegmentByTime:function(t,n){var e=l(t);return e?e.getSegmentByTime(t,n):null}},c={},n}s.__dashjs_factory_name="SegmentsController";var f=e.default.getClassFactory(s);n.default=f})),di=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(M),i=o(h),r=o(li);function o(t){return t&&t.__esModule?t:{default:t}}function u(t){var n=this.context,i=(t=t||{}).eventBus,o=t.events,u=t.dashConstants,a=t.urlUtils,s=t.type,f=t.streamInfo,c=t.timelineConverter,l=t.dashMetrics,d=t.baseURLController,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0,M=void 0,T=void 0;function N(){return s}function _(){p=-1,g=null}function S(){_(),m=null,T=null,M=null}function C(t,n,e){var i=d.resolve(e.path),r=void 0,o=void 0;return i&&n!==i.url&&a.isRelative(n)?(r=i.url,o=i.serviceLocation,n&&(r=a.resolve(n,r))):r=n,!a.isRelative(r)&&(t.url=r,t.serviceLocation=o,!0)}function E(t){var n,e,r;t.sender.getType()===N()&&(e=(n=t.representation).hasInitialization(),r=n.hasSegments(),e&&r?i.trigger(o.REPRESENTATION_UPDATE_COMPLETED,{sender:h,representation:n}):T.update(n,N(),M,e,r))}function k(t,n){if(null==n)return null;var i=new e.default,r=n.representation,o=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].bandwidth,u=n.media;return u=(0,ui.replaceTokenForTemplate)(u,"Number",n.replacementNumber),u=(0,ui.replaceTokenForTemplate)(u,"Time",n.replacementTime),u=(0,ui.replaceTokenForTemplate)(u,"Bandwidth",o),u=(0,ui.replaceIDForTemplate)(u,r.id),u=(0,ui.unescapeDollarsInTemplate)(u),i.mediaType=N(),i.type=b.HTTPRequest.MEDIA_SEGMENT_TYPE,i.range=n.mediaRange,i.startTime=n.presentationStartTime,i.duration=n.duration,i.timescale=r.timescale,i.availabilityStartTime=n.availabilityStartTime,i.availabilityEndTime=n.availabilityEndTime,i.wallStartTime=n.wallStartTime,i.quality=r.index,i.index=n.availabilityIdx,i.mediaInfo=t,i.adaptationIndex=r.adaptation.index,i.representationId=r.id,C(i,u,r)?i:void 0}function O(t){var n=!1;if(!t)return n;if(y){if(w)n=!0;else if(g){var e=parseFloat((g.presentationStartTime-t.adaptation.period.start).toFixed(5));n=(g.duration>0?e+1.5*g.duration:e)>=t.adaptation.period.duration}}else p>=t.availableSegmentsNumber&&(n=!0);return n}function R(t){var n=t.representation;n.segments&&i.trigger(o.REPRESENTATION_UPDATE_COMPLETED,{sender:this,representation:n})}function I(t){if(!t.error&&N()===t.mediaType){var n,e=t.segments,r=t.representation,u=[],a=0,s=void 0,f=void 0,d=void 0;for(s=0,n=e?e.length:0;s<n;s++)(d=(0,ui.getTimeBasedSegment)(c,y,r,(f=e[s]).startTime,f.duration,f.timescale,f.media,f.mediaRange,a))&&(u.push(d),d=null,a++);u.length>0&&(r.segmentAvailabilityRange={start:u[0].presentationStartTime,end:u[u.length-1].presentationStartTime},r.availableSegmentsNumber=u.length,r.segments=u,y&&(c.setExpectedLiveEdge(h=u[u.length-1].presentationStartTime-8),l.updateManifestUpdateInfo({presentationStartTime:h}))),r.hasInitialization()&&i.trigger(o.REPRESENTATION_UPDATE_COMPLETED,{sender:this,representation:r})}var h}function D(){v.debug("Dynamic stream complete"),w=!0}return h={initialize:function(t){y=t,w=!1,T.initialize(t)},getType:N,getStreamInfo:function(){return f},getInitRequest:function(t,n){return n?function(t,n,i){var r=new e.default,o=n.adaptation.period,u=o.start;if(r.mediaType=i,r.type=b.HTTPRequest.INIT_SEGMENT_TYPE,r.range=n.range,r.availabilityStartTime=c.calcAvailabilityStartTimeFromPresentationTime(u,o.mpd,y),r.availabilityEndTime=c.calcAvailabilityEndTimeFromPresentationTime(u+o.duration,o.mpd,y),r.quality=n.index,r.mediaInfo=t,r.representationId=n.id,C(r,n.initialization,n))return r.url=(0,ui.replaceTokenForTemplate)(r.url,"Bandwidth",n.bandwidth),r}(t,n,N()):null},getRequestForSegment:k,getSegmentRequestForTime:function(t,n,i,r){var o=null;if(!n||!n.segmentInfoType)return o;var a=p,f=!!r&&r.keepIdx,c=!(!r||!r.ignoreIsFinished);m!==i&&(m=i,v.debug("Getting the request for time : "+i));var l=T.getSegmentByTime(n,i);return l?(g=l,v.debug("Index for time "+i+" is "+(p=l.availabilityIdx)),o=k(t,l)):!c&&O(n)&&((o=new e.default).action=e.default.ACTION_COMPLETE,o.index=p-1,o.mediaType=s,o.mediaInfo=t,v.debug("Signal complete in getSegmentRequestForTime")),f&&a>=0&&(p=n.segmentInfoType===u.SEGMENT_TIMELINE&&y?p:a),o},getNextSegmentRequest:function(t,n){var i=null;if(!n||!n.segmentInfoType)return null;m=null;var r=p+1;v.debug("Getting the next request at index: "+r);var o=T.getSegmentByIndex(n,r,g?g.mediaStartTime:-1);return o||!function(t){return!isFinite(t.adaptation.period.duration)}(n)||w?(o?(i=k(t,o),p=o.availabilityIdx):p=y?r-1:r,o?g=o:O(n)&&((i=new e.default).action=e.default.ACTION_COMPLETE,i.index=p-1,i.mediaType=N(),i.mediaInfo=t,v.debug("Signal complete")),i):(v.debug(N()+" No segment found at index: "+r+". Wait for next loop"),null)},setCurrentIndex:function(t){p=t},getCurrentIndex:function(){return p},isMediaFinished:O,reset:function(){S(),i.off(o.INITIALIZATION_LOADED,R,h),i.off(o.SEGMENTS_LOADED,I,h),i.off(o.REPRESENTATION_UPDATE_STARTED,E,h),i.off(o.DYNAMIC_STREAM_COMPLETED,D,h)},resetIndex:_,setMimeType:function(t){M=t}},v=t.debug.getLogger(h),S(),T=(0,r.default)(n).create(t),i.on(o.INITIALIZATION_LOADED,R,h),i.on(o.SEGMENTS_LOADED,I,h),i.on(o.REPRESENTATION_UPDATE_STARTED,E,h),i.on(o.DYNAMIC_STREAM_COMPLETED,D,h),h}u.__dashjs_factory_name="DashHandler",n.default=i.default.getClassFactory(u)})),hi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(){return{modifyRequestURL:function(t){return t},modifyRequestHeader:function(t){return t}}}r.__dashjs_factory_name="RequestModifier",n.default=i.default.getSingletonFactory(r)})),vi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(){var t=void 0,n=/^[a-z][a-z0-9+\-_.]*:/i,e=/^https?:\/\//i,i=/^https:\/\//i,r=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,o=function(t,n){try{return new window.URL(t,n).toString()}catch(n){return t}},u=function(t,n){var e=a;if(!n)return t;if(!c(t))return t;l(t)&&(e=s),d(t)&&(e=f);var i=e(n),r="/"!==i.charAt(i.length-1)&&"/"!==t.charAt(0)?"/":"";return[i,t].join(r)};function a(t){var n=t.indexOf("/"),e=t.lastIndexOf("/");return-1!==n?e===n+1?t:(-1!==t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),t.substring(0,e+1)):""}function s(t){var n=t.match(r);return n?n[1]:""}function f(t){var e=t.match(n);return e?e[0]:""}function c(t){return!n.test(t)}function l(t){return c(t)&&"/"===t.charAt(0)}function d(t){return 0===t.indexOf("//")}return function(){try{new window.URL("x","http://y"),t=o}catch(t){}finally{t=t||u}}(),{parseBaseUrl:a,parseOrigin:s,parseScheme:f,isRelative:c,isPathAbsolute:l,isSchemeRelative:d,isHTTPURL:function(t){return e.test(t)},isHTTPS:function(t){return i.test(t)},removeHostname:function(t){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(t)[2].substring(1)},resolve:function(n,e){return t(n,e)}}}r.__dashjs_factory_name="DefaultURLUtils",n.default=i.default.getSingletonFactory(r)})),pi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(vi);function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t=void 0,n=[];function e(e,i,r){var o=function(e){var i=void 0;for(i=0;i<n.length;i++)if(n[i].regex.test(e))return n[i].utils;return t}(r||i);return o&&"function"==typeof o[e]?o[e](i,r):t[e](i,r)}return t=(0,i.default)(this.context).getInstance(),{registerUrlRegex:function(t,e){n.push({regex:t,utils:e})},parseBaseUrl:function(t){return e("parseBaseUrl",t)},parseOrigin:function(t){return e("parseOrigin",t)},parseScheme:function(t){return e("parseScheme",t)},isRelative:function(t){return e("isRelative",t)},isPathAbsolute:function(t){return e("isPathAbsolute",t)},isSchemeRelative:function(t){return e("isSchemeRelative",t)},isHTTPURL:function(t){return e("isHTTPURL",t)},isHTTPS:function(t){return e("isHTTPS",t)},removeHostname:function(t){return e("removeHostname",t)},resolve:function(t,n){return e("resolve",t,n)}}}o.__dashjs_factory_name="URLUtils";var u=e.default.getSingletonFactory(o);n.default=u})),gi=o((function(t,n){function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function t(){e(this,t),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};i.INITIAL_PLAYOUT_START_REASON="initial_playout",i.SEEK_START_REASON="seek",i.RESUME_FROM_PAUSE_START_REASON="resume",i.METRICS_COLLECTION_START_REASON="metrics_collection_start";var r=function t(){e(this,t),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};r.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",r.REBUFFERING_REASON="rebuffering",r.USER_REQUEST_STOP_REASON="user_request",r.END_OF_PERIOD_STOP_REASON="end_of_period",r.END_OF_CONTENT_STOP_REASON="end_of_content",r.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",r.FAILURE_STOP_REASON="failure",n.PlayList=i,n.PlayListTrace=r})),mi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=A(c),i=A(l),r=A(d),o=A(T),u=A(Ye),a=A(ti),s=A(ei),f=A(ii),p=A(ri),g=A(h),w=A(v),b=A(m),_=A(di),S=A(Oe),C=A(N),E=A(y),k=A(hi),I=A(pi),D=A(O),x=A(M);function A(t){return t&&t.__esModule?t:{default:t}}function j(t){t=t||{};var n=this.context,c=(0,w.default)(n).getInstance(),l=t.streamInfo,d=t.type,h=t.errHandler,v=t.mimeType,g=t.timelineConverter,m=t.adapter,y=t.manifestModel,M=t.mediaPlayerModel,T=t.fragmentModel,N=t.abrController,O=t.playbackController,A=t.mediaController,j=t.textController,F=t.dashMetrics,P=t.settings,B=t.boxParser,L=void 0,U=void 0,q=void 0,z=void 0,H=void 0,K=void 0,V=void 0,W=void 0,G=void 0,$=void 0,X=void 0,Q=void 0;function J(){H=[],z=null,X=0}function Y(t){t.sender.getType()===rt()&&t.sender.getStreamId()===l.id&&(t.error||V.setCurrentRepresentation(m.convertDataToRepresentationInfo(t.currentRepresentation)),t.error&&t.error.code!==S.default.SEGMENTS_UPDATE_FAILED_ERROR_CODE||O.getStreamController().getActiveStreamInfo().id===l.id&&it())}function Z(t){if(d===t.mediaType&&l.id===t.streamInfo.id){var n=st(t.newQuality);V.setCurrentRepresentation(n),F.pushPlayListTraceMetrics(new Date,gi.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),F.createPlaylistTraceMetrics(n.id,1e3*O.getTime(),O.getPlaybackRate())}}function tt(t){if(t.streamId===l.id&&t.mediaType===d){F.addBufferLevel(d,new Date,1e3*t.bufferLevel);var n=O.getStreamController().getActiveStreamInfo().id;y.getValue().doNotUpdateDVRWindowOnBufferUpdated||l.id!==n||it()}}function nt(t){t.streamId===l.id&&t.mediaType===d&&(F.addBufferState(d,t.state,V.getBufferTarget()),t.state!==r.default.BUFFER_EMPTY||O.isSeeking()||F.pushPlayListTraceMetrics(new Date,gi.PlayListTrace.REBUFFERING_REASON))}function et(t){t.streamId===l.id&&t.mediaType===d&&(T.syncExecutedRequestsWithBufferedRange(K.getBuffer().getAllBufferRanges(),l.duration),t.from>O.getTime()&&(X=t.from,Q=!0))}function it(){var t=l.manifestInfo,n=t.isDynamic,e=g.calcSegmentAvailabilityRange(W.getCurrentRepresentation(),n);F.addDVRInfo(rt(),O.getTime(),t,e)}function rt(){return d}function ot(){return K?K.getBuffer():null}function ut(){return H}function at(){return z}function st(t){var n=void 0;return void 0!==t?((0,R.checkInteger)(t),n=W?W.getRepresentationForQuality(t):null):n=W?W.getCurrentRepresentation():null,m.convertDataToRepresentationInfo(n)}function ft(t){if(t.sender&&t.mediaType===d&&t.streamId===l.id&&(!m.getIsTextTrack(v)||j.isTextEnabled())&&K&&t.representationId&&!K.appendInitSegment(t.representationId)){var n=$?$.getInitRequest(at(),W.getCurrentRepresentation()):null;V.processInitRequest(n)}}function ct(t){if(t.sender&&t.mediaType===d&&t.streamId===l.id){var n=void 0;K.getIsPruningInProgress()||(n=function(t,n){var i=st(),r=!isNaN(t),o=O.getNormalizedTime(),u=r?t:X,a=!1,s=void 0;if(isNaN(u)||rt()===e.default.FRAGMENTED_TEXT&&!j.isTextEnabled())return null;if(K){var f=K.getRangeAt(u),c=K.getRangeAt(o);null===f&&null===c||r||(!f||c&&c.start!=f.start&&c.end!=f.end)&&K.getBuffer().hasDiscontinuitiesAfter(o)&&rt()!==e.default.FRAGMENTED_TEXT&&(T.removeExecutedRequestsAfterTime(c.end),a=!0)}if(n)s=ht(i,u=n.startTime+n.duration/2,{timeThreshold:0,ignoreIsFinished:!0});else{var l=r||Q||a;for(s=ht(i,l?u:void 0,{keepIdx:!l}),Q=!1;s&&s.action!==x.default.ACTION_COMPLETE&&T.isFragmentLoaded(s);)s=ht(i)}return s}(t.seekTarget,t.replacement))&&(V.setSeekTarget(NaN),t.replacement||(isNaN(n.startTime+n.duration)||(X=n.startTime+n.duration),n.delayLoadingTime=(new Date).getTime()+V.getTimeToLoadDelay(),V.setTimeToLoadDelay(0))),V.processMediaRequest(n)}}function lt(t){var e=t.chunk;if(e.streamId===l.id&&e.mediaInfo.type==d){var i=e.bytes,r=e.quality,u=st(r),a=W&&u?W.getRepresentationForQuality(u.quality):null,s=m.getEventsFor(u.mediaInfo),f=m.getEventsFor(u,a);if(s&&s.length>0||f&&f.length>0){var h=function(t,e,i,r){for(var o=Math.max(!e||isNaN(e.startTime)?0:e.startTime,0),u=[],a=[],s=i.concat(r),f=0,c=s.length;f<c;f++)u[s[f].schemeIdUri+"/"+s[f].value]=s[f];for(var l=(0,D.default)(n).getInstance().parse(t).getBoxes("emsg"),d=0,h=l.length;d<h;d++){var v=m.getEvent(l[d],u,o);v&&a.push(v)}return a}(i,T.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,quality:r,index:e.index})[0],s,f);c.trigger(b.default.INBAND_EVENTS,{sender:L,events:h})}}}function dt(t){t.mediaType&&t.mediaType!==d||t.streamId!==l.id||(X=t.time,V.setSeekTarget(t.time))}function ht(t,n,e){var i=null;if($){var r=W&&t?W.getRepresentationForQuality(t.quality):null;i=void 0!==n&&void 0!==e?$.getSegmentRequestForTime(at(),r,n,e):$.getNextSegmentRequest(at(),r)}return i}return L={initialize:function(r,o){$=(0,_.default)(n).create({streamInfo:l,type:d,timelineConverter:g,dashMetrics:F,mediaPlayerModel:M,baseURLController:t.baseURLController,errHandler:h,settings:P,boxParser:B,events:b.default,eventBus:c,errors:S.default,debug:(0,E.default)(n).getInstance(),requestModifier:(0,k.default)(n).getInstance(),dashConstants:i.default,constants:e.default,urlUtils:(0,I.default)(n).getInstance()}),(q=l.manifestInfo.isDynamic)&&(G=(0,p.default)(n).create({timelineConverter:g})),$.initialize(q),N.registerStreamType(d,L),W=(0,f.default)(n).create({streamId:l.id,type:d,abrController:N,dashMetrics:F,playbackController:O,timelineConverter:g,dashConstants:i.default,events:b.default,eventBus:c,errors:S.default}),(K=function(t){return t?t===e.default.VIDEO||t===e.default.AUDIO?(0,u.default)(n).create({streamInfo:l,type:t,mediaPlayerModel:M,manifestModel:y,fragmentModel:T,errHandler:h,mediaController:A,representationController:W,adapter:m,textController:j,abrController:N,playbackController:O,settings:P}):(0,a.default)(n).create({streamInfo:l,type:t,mimeType:v,mediaPlayerModel:M,manifestModel:y,fragmentModel:T,errHandler:h,mediaController:A,representationController:W,adapter:m,textController:j,abrController:N,playbackController:O,settings:P}):(h.error(new C.default(S.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,S.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}(d))&&K.initialize(r),(V=(0,s.default)(n).create({streamId:l.id,type:d,mimeType:v,adapter:m,dashMetrics:F,mediaPlayerModel:M,fragmentModel:T,abrController:N,playbackController:O,textController:j,mediaController:A,bufferController:K,settings:P})).initialize(o),X=0,Q=!1},isUpdating:function(){return!!W&&W.isUpdating()},getType:rt,getBufferController:function(){return K},getFragmentModel:function(){return T},getScheduleController:function(){return V},getRepresentationController:function(){return W},getRepresentationInfo:st,getBufferLevel:function(){return K?K.getBufferLevel():0},isBufferingCompleted:function(){return!!K&&K.getIsBufferingCompleted()},createBuffer:function(t){return ot()||K?K.createBuffer(H,t):null},updateStreamInfo:function(t){l=t,P.get().streaming.useAppendWindow&&K.updateAppendWindow()},getStreamInfo:function(){return l},selectMediaInfo:function(t){t===z||t&&z&&t.type!==z.type||(z=t);var n=m.getRealAdaptation(l,z),i=m.getVoRepresentations(z);if(W){var r=W.getData(),o=N.getTopQualityIndexFor(d,l.id),u=N.getMinAllowedIndexFor(d),a=void 0,s=null;null!==r&&r.id==n.id||d===e.default.FRAGMENTED_TEXT?a=N.getQualityFor(d):(s=N.getThroughputHistory().getAverageThroughput(d)||N.getInitialBitrateFor(d),a=N.getQualityForBitrate(z,s)),void 0!==u&&a<u&&(a=u),a>o&&(a=o),$.setMimeType(z?z.mimeType:null),W.updateData(n,i,d,a)}},addMediaInfo:function(t,n){-1===H.indexOf(t)&&H.push(t),n&&this.selectMediaInfo(t)},getLiveStartTime:function(){if(!q)return NaN;if(!G)return NaN;var t=NaN,n=st(),e=G.getLiveEdge(n);if(isNaN(e))return NaN;var i=function(t,n){try{var e=null,i=O.getLiveDelay(),r=isNaN(l.manifestInfo.DVRWindowSize)?i:l.manifestInfo.DVRWindowSize,o=.1*r,u=void 0;if(!isFinite(r)||ht(n,t-r+o,{ignoreIsFinished:!0}))for(;!e&&i<=r;)(e=ht(n,u=t-i,{ignoreIsFinished:!0}))||(i+=1);return e&&O.setLiveDelay(i,!0),U.debug("live edge: "+t+", live delay: "+i+", live target: "+u),e}catch(t){return null}}(e,n);return i&&(t=P.get().streaming.lowLatencyEnabled?i.duration<M.getLiveDelay()?i.startTime:i.startTime+i.duration-M.getLiveDelay():i.startTime),t},switchTrackAsked:function(){V.switchTrackAsked()},getMediaInfoArr:ut,getMediaInfo:at,getMediaSource:function(){return K.getMediaSource()},setMediaSource:function(t){K.setMediaSource(t,ut())},dischargePreBuffer:function(){K.dischargePreBuffer()},getBuffer:ot,setBuffer:function(t){K.setBuffer(t)},setBufferingTime:function(t){X=t},resetIndexHandler:function(){$&&$.resetIndex()},getInitRequest:function(t){(0,R.checkInteger)(t);var n=W?W.getRepresentationForQuality(t):null;return $?$.getInitRequest(at(),n):null},getFragmentRequest:ht,finalisePlayList:function(t,n){F.pushPlayListTraceMetrics(t,n)},reset:function(t,n){$&&$.reset(),K&&(K.reset(t,n),K=null),V&&(V.reset(),V=null),W&&(W.reset(),W=null),G&&(G.reset(),G=null),N&&N.unRegisterStreamType(d),c.off(b.default.DATA_UPDATE_COMPLETED,Y,L),c.off(b.default.QUALITY_CHANGE_REQUESTED,Z,L),c.off(b.default.INIT_FRAGMENT_NEEDED,ft,L),c.off(b.default.MEDIA_FRAGMENT_NEEDED,ct,L),c.off(b.default.MEDIA_FRAGMENT_LOADED,lt,L),c.off(b.default.BUFFER_LEVEL_UPDATED,tt,L),c.off(b.default.BUFFER_LEVEL_STATE_CHANGED,nt,L),c.off(b.default.BUFFER_CLEARED,et,L),c.off(b.default.SEEK_TARGET,dt,L),J(),d=null,l=null}},U=(0,E.default)(n).getInstance().getLogger(L),J(),c.on(b.default.DATA_UPDATE_COMPLETED,Y,L,w.default.EVENT_PRIORITY_HIGH),c.on(b.default.QUALITY_CHANGE_REQUESTED,Z,L),c.on(b.default.INIT_FRAGMENT_NEEDED,ft,L),c.on(b.default.MEDIA_FRAGMENT_NEEDED,ct,L),c.on(b.default.MEDIA_FRAGMENT_LOADED,lt,L),c.on(b.default.BUFFER_LEVEL_UPDATED,tt,L),c.on(b.default.BUFFER_LEVEL_STATE_CHANGED,nt,L),c.on(b.default.BUFFER_CLEARED,et,L),c.on(b.default.SEEK_TARGET,dt,L),L}j.__dashjs_factory_name="StreamProcessor",n.default=g.default.getClassFactory(j)})),yi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null}})),wi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(t){var n=(t=t||{}).requestModifier;return{load:function(t){var e=new Date,i=t.request,r=new XMLHttpRequest;r.open(t.method,t.url,!0),i.responseType&&(r.responseType=i.responseType),i.range&&r.setRequestHeader("Range","bytes="+i.range),i.requestStartDate||(i.requestStartDate=e),n&&(r=n.modifyRequestHeader(r)),r.withCredentials=t.withCredentials,r.onload=t.onload,r.onloadend=t.onend,r.onerror=t.onerror,r.onprogress=t.progress,r.onabort=t.onabort,r.send(),t.response=r},abort:function(t){var n=t.response;n.onloadend=n.onerror=n.onprogress=void 0,n.abort()}}}r.__dashjs_factory_name="XHRLoader";var o=i.default.getClassFactory(r);n.default=o})),bi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(t){var n=(t=t||{}).requestModifier,e=t.boxParser;function i(t,n){t.reader.read().then(n).catch((function(n){t.onerror&&200===t.response.status&&t.onerror(n)}))}function r(t,n){if((t=t.filter((function(e){return e.bytes>n/4/t.length}))).length>1){var e=0,i=(t[t.length-1].ts-t[0].ts)/t.length;return t.forEach((function(n,r){var o=t[r+1];if(o){var u=o.ts-n.ts;e+=u<i?u:0}})),e}return null}return{load:function(t){var o=new Date,u=t.request,a=new Headers;u.range&&a.append("Range","bytes="+u.range),u.requestStartDate||(u.requestStartDate=o),n&&n.modifyRequestHeader({setRequestHeader:function(t,n){a.append(t,n)}});var s=void 0;"function"==typeof window.AbortController&&(s=new AbortController,t.abortController=s,s.signal.onabort=t.onabort),fetch(t.url,{method:t.method,headers:a,credentials:t.withCredentials?"include":void 0,signal:s?s.signal:void 0}).then((function(n){t.response||(t.response={}),t.response.status=n.status,t.response.statusText=n.statusText,t.response.responseURL=n.url,n.ok||t.onerror();var o="",u=!0,a=!1,s=void 0;try{for(var f,c=n.headers.keys()[Symbol.iterator]();!(u=(f=c.next()).done);u=!0){var l=f.value;o+=l+": "+n.headers.get(l)+"\r\n"}}catch(t){a=!0,s=t}finally{try{!u&&c.return&&c.return()}finally{if(a)throw s}}if(t.response.responseHeaders=o,!n.body)return n.arrayBuffer().then((function(n){t.response.response=n,t.progress({loaded:n.byteLength,total:n.byteLength,stream:!1}),t.onload(),t.onend()}));var d=parseInt(n.headers.get("Content-Length"),10),h=0,v=!1,p=new Uint8Array,g=0;t.reader=n.body.getReader();var m=[];i(t,(function n(o){var u=o.value;if(o.done)return p&&(t.progress({loaded:h,total:isNaN(d)?h:d,lengthComputable:!0,time:r(m,h),stream:!0}),t.response.response=p.buffer),t.onload(),void t.onend();if(u&&u.length>0){p=function(t,n){if(0===t.length)return n;var e=new Uint8Array(t.length+n.length);return e.set(t),e.set(n,t.length),e}(p,u),h+=u.length,m.push({ts:Date.now(),bytes:u.length});var a=e.findLastTopIsoBoxCompleted(["moov","mdat"],p,g);if(a.found){var s=a.lastCompletedOffset+a.size,f=void 0;s===p.length?(f=p,p=new Uint8Array):(f=new Uint8Array(p.subarray(0,s)),p=p.subarray(s)),t.progress({data:f.buffer,lengthComputable:!1,noTrace:!0}),g=0}else g=a.lastCompletedOffset,v||(t.progress({lengthComputable:!1,noTrace:!0}),v=!0)}i(t,n)}))})).catch((function(n){t.onerror&&t.onerror(n)}))},abort:function(t){if(t.abortController)t.abortController.abort();else if(t.reader)try{t.reader.cancel(),t.onabort()}catch(t){}},calculateDownloadedTime:r}}r.__dashjs_factory_name="FetchLoader";var o=i.default.getClassFactory(r);n.default=o})),Mi=o((function(t,n){var e;Object.defineProperty(n,"__esModule",{value:!0});var i=new(function(t){function n(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.AST_IN_FUTURE="astInFuture",t.BUFFER_EMPTY="bufferStalled",t.BUFFER_LOADED="bufferLoaded",t.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",t.ERROR="error",t.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",t.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",t.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",t.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",t.LOG="log",t.MANIFEST_LOADED="manifestLoaded",t.METRICS_CHANGED="metricsChanged",t.METRIC_CHANGED="metricChanged",t.METRIC_ADDED="metricAdded",t.METRIC_UPDATED="metricUpdated",t.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",t.PERIOD_SWITCH_STARTED="periodSwitchStarted",t.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",t.QUALITY_CHANGE_RENDERED="qualityChangeRendered",t.TRACK_CHANGE_RENDERED="trackChangeRendered",t.SOURCE_INITIALIZED="sourceInitialized",t.STREAM_INITIALIZING="streamInitializing",t.STREAM_UPDATED="streamUpdated",t.STREAM_INITIALIZED="streamInitialized",t.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",t.TEXT_TRACKS_ADDED="allTextTracksAdded",t.TEXT_TRACK_ADDED="textTrackAdded",t.TTML_PARSED="ttmlParsed",t.TTML_TO_PARSE="ttmlToParse",t.CAPTION_RENDERED="captionRendered",t.CAPTION_CONTAINER_RESIZE="captionContainerResize",t.CAN_PLAY="canPlay",t.PLAYBACK_ENDED="playbackEnded",t.PLAYBACK_ERROR="playbackError",t.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",t.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",t.PLAYBACK_PAUSED="playbackPaused",t.PLAYBACK_PLAYING="playbackPlaying",t.PLAYBACK_PROGRESS="playbackProgress",t.PLAYBACK_RATE_CHANGED="playbackRateChanged",t.PLAYBACK_SEEKED="playbackSeeked",t.PLAYBACK_SEEKING="playbackSeeking",t.PLAYBACK_SEEK_ASKED="playbackSeekAsked",t.PLAYBACK_STALLED="playbackStalled",t.PLAYBACK_STARTED="playbackStarted",t.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",t.PLAYBACK_WAITING="playbackWaiting",t.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",t.GAP_CAUSED_SEEK_TO_PERIOD_END="gapCausedSeekToPeriodEnd",t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(((e=p)&&e.__esModule?e:{default:e}).default));n.default=i})),Ti=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),r=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,null,[{key:"mixin",value:function(n,i,r){var o=void 0,u={};if(n)for(var a in i)i.hasOwnProperty(a)&&(o=i[a],a in n&&(n[a]===o||a in u&&u[a]===o)||(n[a]="object"===e(n[a])&&null!==n[a]?t.mixin(n[a],o,r):r(o)));return n}},{key:"clone",value:function(n){if(!n||"object"!==(void 0===n?"undefined":e(n)))return n;var i=void 0;if(n instanceof Array){i=[];for(var r=0,o=n.length;r<o;++r)r in n&&i.push(t.clone(n[r]))}else i={};return t.mixin(i,n,t.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(t,n){try{if(!n||0===n.length)return t;var e=new URL(t);return n.forEach((function(t){t.key&&t.value&&e.searchParams.set(t.key,t.value)})),e.href}catch(n){return t}}},{key:"generateUuid",value:function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var e=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==n?e:3&e|8).toString(16)}))}},{key:"generateHashCode",value:function(t){var n=0;if(0===t.length)return n;for(var e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n}}]),t}();n.default=r})),Ni=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=a(h),r=a(Ti),o=a(y),u=a(c);function a(t){return t&&t.__esModule?t:{default:t}}function s(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function f(){var t,n,i={debug:{logLevel:o.default.LOG_LEVEL_WARNING},streaming:{metricsMaxListDepth:1e3,abandonLoadTimeout:1e4,liveDelayFragmentCount:NaN,liveDelay:null,scheduleWhilePaused:!0,fastSwitchEnabled:!1,flushBufferAtTrackSwitch:!1,calcSegmentAvailabilityRangeFromTimeline:!0,bufferPruningInterval:10,bufferToKeep:20,jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,stableBufferTime:12,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,longFormContentDurationThreshold:600,wallclockTimeUpdateInterval:50,lowLatencyEnabled:!1,keepProtectionMediaKeys:!1,useManifestDateHeaderTimeSource:!0,useSuggestedPresentationDelay:!0,useAppendWindow:!0,manifestUpdateRetryInterval:100,liveCatchUpMinDrift:.02,liveCatchUpMaxDrift:0,liveCatchUpPlaybackRate:.5,liveCatchupLatencyThreshold:NaN,lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},retryIntervals:(t={},s(t,b.HTTPRequest.MPD_TYPE,500),s(t,b.HTTPRequest.XLINK_EXPANSION_TYPE,500),s(t,b.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),s(t,b.HTTPRequest.INIT_SEGMENT_TYPE,1e3),s(t,b.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),s(t,b.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),s(t,b.HTTPRequest.OTHER_TYPE,1e3),s(t,"lowLatencyReductionFactor",10),t),retryAttempts:(n={},s(n,b.HTTPRequest.MPD_TYPE,3),s(n,b.HTTPRequest.XLINK_EXPANSION_TYPE,1),s(n,b.HTTPRequest.MEDIA_SEGMENT_TYPE,3),s(n,b.HTTPRequest.INIT_SEGMENT_TYPE,3),s(n,b.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),s(n,b.HTTPRequest.INDEX_SEGMENT_TYPE,3),s(n,b.HTTPRequest.OTHER_TYPE,3),s(n,"lowLatencyMultiplyFactor",5),n),abr:{movingAverageMethod:u.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:u.default.ABR_STRATEGY_DYNAMIC,bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useBufferOccupancyABR:!1,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0}},cmcd:{enabled:!1,sid:null,cid:null,did:null}}},a=r.default.clone(i);function f(t,n,i){for(var o in t)t.hasOwnProperty(o)&&n.hasOwnProperty(o)&&("object"===e(t[o])&&null!==t[o]?f(t[o],n[o],i.slice()+o+"."):n[o]=r.default.clone(t[o]))}return{get:function(){return a},update:function(t){"object"===(void 0===t?"undefined":e(t))&&f(t,a,"")},reset:function(){a=r.default.clone(i)}}}f.__dashjs_factory_name="Settings";var l=i.default.getSingletonFactory(f);n.default=l})),_i=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),r=(e=l)&&e.__esModule?e:{default:e},o=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return i(t,[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==r.default.BASE_URL&&this.segmentInfoType!==r.default.SEGMENT_BASE&&!this.indexRange}}]),t}();n.default=o})),Si=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.period=null,this.index=-1,this.type=null}})),Ci=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};e.DEFAULT_ID="defaultId",n.default=e})),Ei=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN}})),ki=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.schemeIdUri="",this.value=""}})),Oi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN}})),Ri=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function t(n,e,i,r){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=n||"",this.serviceLocation=e||n||"",this.dvb_priority=i||1,this.dvb_weight=r||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};e.DEFAULT_DVB_PRIORITY=1,e.DEFAULT_DVB_WEIGHT=1,n.default=e})),Ii=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""}})),Di=Array.isArray,xi=Object.keys,Ai=Object.prototype.hasOwnProperty,ji=function t(n,e){if(n===e)return!0;if(n&&e&&"object"==typeof n&&"object"==typeof e){var i,r,o,u=Di(n),a=Di(e);if(u&&a){if((r=n.length)!=e.length)return!1;for(i=r;0!=i--;)if(!t(n[i],e[i]))return!1;return!0}if(u!=a)return!1;var s=n instanceof Date,f=e instanceof Date;if(s!=f)return!1;if(s&&f)return n.getTime()==e.getTime();var c=n instanceof RegExp,l=e instanceof RegExp;if(c!=l)return!1;if(c&&l)return n.toString()==e.toString();var d=xi(n);if((r=d.length)!==xi(e).length)return!1;for(i=r;0!=i--;)if(!Ai.call(e,d[i]))return!1;for(i=r;0!=i--;)if(!t(n[o=d[i]],e[o]))return!1;return!0}return n!=n&&e!=e},Fi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(ji);function r(t){return t&&t.__esModule?t:{default:t}}function o(){return{areEqual:function(t,n){return(0,i.default)(t,n)}}}o.__dashjs_factory_name="ObjectUtils",n.default=e.default.getSingletonFactory(o)})),Pi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}})),Bi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.THUMBNAILS_SCHEME_ID_URIS=void 0;var e=v(c),i=v(l),r=v(h),o=v(Pi),u=v(pi),a=v(m),s=v(O),f=v(wi),d=v(di);function v(t){return t&&t.__esModule?t:{default:t}}var p=n.THUMBNAILS_SCHEME_ID_URIS=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function g(t){var n,r=this.context,c=t.adapter,l=t.baseURLController,h=t.streamInfo,v=t.timelineConverter,g=t.debug,m=t.eventBus,y=t.events,w=t.dashConstants,b=(0,u.default)(r).getInstance(),M=void 0,T=void 0,N=void 0,_=void 0,S=void 0,C=void 0;function E(){O(),S=(0,f.default)(r).create({}),C=(0,s.default)(r).getInstance(),(T=(0,d.default)(r).create({timelineConverter:v,baseURLController:l,debug:g,eventBus:m,events:y,dashConstants:w,urlUtils:b})).initialize(!!c&&c.getIsDynamic()),function(){if(h&&c&&(_=c.getMediaInfoForType(h,e.default.IMAGE))){var t=c.getVoRepresentations(_);t&&t.length>0&&t.forEach((function(t){(t.segmentInfoType===i.default.SEGMENT_TEMPLATE&&t.segmentDuration>0&&t.media||t.segmentInfoType===i.default.SEGMENT_TIMELINE)&&k(t),t.segmentInfoType===i.default.SEGMENT_BASE&&k(t,!0)})),M.length>0&&(M.sort((function(t,n){return t.bitrate-n.bitrate})),N=M.length-1)}}()}function k(t,n){var i=new o.default;i.id=t.id,i.bitrate=t.bandwidth,i.width=t.width,i.height=t.height,i.tilesHor=1,i.tilesVert=1,t.essentialProperties&&t.essentialProperties.forEach((function(t){if(p.indexOf(t.schemeIdUri)>=0&&t.value){var n=t.value.split("x");2!==n.length||isNaN(n[0])||isNaN(n[1])||(i.tilesHor=parseInt(n[0],10),i.tilesVert=parseInt(n[1],10))}})),n?m.trigger(a.default.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{mimeType:_.mimeType,mediaType:e.default.IMAGE,representation:t,callback:function(t,n){var e=[];t=function(t,n){var e,i=[],r=0,o=void 0,u=void 0,a=void 0;for(o=0,e=t.length;o<e;o++)u=t[o],(a=(0,ui.getTimeBasedSegment)(v,c.getIsDynamic(),n,u.startTime,u.duration,u.timescale,u.media,u.mediaRange,r))&&(i.push(a),a=null,r++);return i}(t,n),i.segmentDuration=t[0].duration,i.readThumbnail=function(i,r){var o=null;e.some((function(t){if(t.start<=i&&t.end>i)return o=t.url,!0})),o?r(o):t.some((function(t){if(t.mediaStartTime<=i&&t.mediaStartTime+t.duration>i){var o=l.resolve(n.path);return S.load({method:"get",url:o.url,request:{range:t.mediaRange,responseType:"arraybuffer"},onload:function(n){var i=C.getSamplesInfo(n.target.response),o=new Blob([n.target.response.slice(i.sampleList[0].offset,i.sampleList[0].offset+i.sampleList[0].size)],{type:"image/jpeg"}),u=window.URL.createObjectURL(o);e.push({start:t.mediaStartTime,end:t.mediaStartTime+t.duration,url:u}),r&&r(u)}}),!0}}))}}}):(i.startNumber=t.startNumber,i.segmentDuration=t.segmentDuration,i.timescale=t.timescale,i.templateUrl=function(t){var n=b.isRelative(t.media)?b.resolve(t.media,l.resolve(t.path).url):t.media;return n?(0,ui.replaceIDForTemplate)(n,t.id):""}(t)),i.tilesHor>0&&i.tilesVert>0&&(i.widthPerTile=i.width/i.tilesHor,i.heightPerTile=i.height/i.tilesVert,M.push(i))}function O(){M=[],N=-1,_=null}return n={initialize:E,getTracks:function(){return M},reset:O,setTrackByIndex:function(t){M&&0!==M.length&&(t>=M.length&&(t=M.length-1),N=t)},getCurrentTrack:function(){return N<0?null:M[N]},getCurrentTrackIndex:function(){return N},getThumbnailRequestForTime:function(t){for(var n=void 0,e=c.getVoRepresentations(_),i=0;i<e.length;i++)if(M[N].id===e[i].id){n=e[i];break}return T.getSegmentRequestForTime(_,n,t)}},E(),n}g.__dashjs_factory_name="ThumbnailTracks",n.default=r.default.getClassFactory(g)})),Li=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=T(c),i=T(l),r=T(_i),o=T(Si),u=T(Ci),a=T(Ei),s=T(ki),f=T(Oi),d=T(Ri),v=T(Ii),p=T(Fi),g=T(pi),m=T(h),w=T(y),b=T(N),M=T(Oe);function T(t){return t&&t.__esModule?t:{default:t}}function _(){var t,n=void 0,c=void 0,l=void 0,h=this.context,m=(0,g.default)(h).getInstance(),y=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function T(t,n){var r=void 0,o=void 0,u=void 0,a=void 0,s=void 0,f=void 0,c=!1,l=!1;if(!t)throw new Error("adaptation is not defined");if(!n)throw new Error("type is not defined");if(t.hasOwnProperty("ContentComponent_asArray")&&(a=t.ContentComponent_asArray),s=n!==e.default.TEXT?new RegExp(n):new RegExp("(vtt|ttml)"),t.Representation_asArray&&t.Representation_asArray.length&&t.Representation_asArray.length>0){var d=R(t.Representation_asArray[0]);if(d&&d.length>0&&Bi.THUMBNAILS_SCHEME_ID_URIS.indexOf(d[0].schemeIdUri)>=0)return n===e.default.IMAGE;if(t.Representation_asArray[0].hasOwnProperty(i.default.CODECS)&&(0===(f=t.Representation_asArray[0].codecs).search(e.default.STPP)||0===f.search(e.default.WVTT)))return n===e.default.FRAGMENTED_TEXT}if(a){if(a.length>1)return n===e.default.MUXED;a[0]&&a[0].contentType===n&&(c=!0,l=!0)}if(t.hasOwnProperty(i.default.MIME_TYPE)&&(c=s.test(t.mimeType),l=!0),!l)for(r=0,o=t.Representation_asArray&&t.Representation_asArray.length?t.Representation_asArray.length:0;!l&&r<o;)(u=t.Representation_asArray[r]).hasOwnProperty(i.default.MIME_TYPE)&&(c=s.test(u.mimeType),l=!0),r++;return c}function N(t){return T(t,e.default.VIDEO)}function _(t){return T(t,e.default.FRAGMENTED_TEXT)}function S(t){return T(t,e.default.IMAGE)}function C(t){return"text/vtt"===t||"application/ttml+xml"===t}function E(t){return t&&Array.isArray(t.Representation_asArray)&&t.Representation_asArray.sort((function(t,n){return t.bandwidth-n.bandwidth})),t}function k(t,n){return t&&t.Period_asArray&&y(n)&&t.Period_asArray[n]?t.Period_asArray[n].AdaptationSet_asArray:[]}function O(t){var n=!1;return t&&t.hasOwnProperty("type")&&(n=t.type===i.default.DYNAMIC),n}function R(t){return t&&t.EssentialProperty_asArray&&t.EssentialProperty_asArray.length?t.EssentialProperty_asArray.map((function(t){return{schemeIdUri:t.schemeIdUri,value:t.value}})):null}function I(t,n){if(!t)throw new Error("Period cannot be null or undefined");var e=u.default.DEFAULT_ID+"_"+n;return t.hasOwnProperty(i.default.ID)&&t.id.length>0&&"__proto__"!==t.id&&(e=t.id),e}function D(t,n){var r=[],o=void 0;if(!t)return r;for(o=0;o<t.length;o++){var u=new v.default;if(u.timescale=1,u.representation=n,!t[o].hasOwnProperty(e.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");u.schemeIdUri=t[o].schemeIdUri,t[o].hasOwnProperty(i.default.TIMESCALE)&&(u.timescale=t[o].timescale),t[o].hasOwnProperty(i.default.VALUE)&&(u.value=t[o].value),r.push(u)}return r}function x(t){var n=[],e=!1;return(t.BaseURL_asArray||[t.baseUri]).some((function(r){if(r){var o=new d.default,u=r.__text||r;return m.isRelative(u)&&(e=!0,t.baseUri&&(u=m.resolve(u,t.baseUri))),o.url=u,o.serviceLocation=r.hasOwnProperty(i.default.SERVICE_LOCATION)&&r.serviceLocation.length?r.serviceLocation:u,r.hasOwnProperty(i.default.DVB_PRIORITY)&&(o.dvb_priority=r[i.default.DVB_PRIORITY]),r.hasOwnProperty(i.default.DVB_WEIGHT)&&(o.dvb_weight=r[i.default.DVB_WEIGHT]),r.hasOwnProperty(i.default.AVAILABILITY_TIME_OFFSET)&&(o.availabilityTimeOffset=r[i.default.AVAILABILITY_TIME_OFFSET]),r.hasOwnProperty(i.default.AVAILABILITY_TIME_COMPLETE)&&(o.availabilityTimeComplete="false"!==r[i.default.AVAILABILITY_TIME_COMPLETE]),n.push(o),e}})),n}return t={getIsTypeOf:T,getIsTextTrack:C,getLanguageForAdaptation:function(t){var n="";return t&&t.hasOwnProperty(i.default.LANG)&&(n=t.lang.replace(/[^A-Za-z0-9-]/g,"")),n},getViewpointForAdaptation:function(t){return t&&t.hasOwnProperty(i.default.VIEWPOINT)?t.Viewpoint:null},getRolesForAdaptation:function(t){return t&&t.hasOwnProperty(i.default.ROLE_ASARRAY)?t.Role_asArray:[]},getAccessibilityForAdaptation:function(t){return t&&t.hasOwnProperty(i.default.ACCESSIBILITY_ASARRAY)?t.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(t){return t&&t.hasOwnProperty(i.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?t.AudioChannelConfiguration_asArray:[]},getAudioChannelConfigurationForRepresentation:function(t){return t&&t.hasOwnProperty(i.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?t.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(t,n,e){var i=k(n,e);return i.length>0&&y(t)?i[t]:null},getIndexForAdaptation:function(t,n,e){if(!t)return-1;for(var i=k(n,e),r=0;r<i.length;r++)if((0,p.default)(h).getInstance().areEqual(i[r],t))return r;return-1},getAdaptationForId:function(t,n,e){var r,o=k(n,e),u=void 0;for(u=0,r=o.length;u<r;u++)if(o[u].hasOwnProperty(i.default.ID)&&o[u].id===t)return o[u];return null},getAdaptationsForType:function(t,n,e){var i,r=k(t,n),o=void 0,u=[];for(o=0,i=r.length;o<i;o++)T(r[o],e)&&u.push(E(r[o]));return u},getCodec:function(t,n,e){var i=null;if(t&&t.Representation_asArray&&t.Representation_asArray.length>0){var r=y(n)&&n>=0&&n<t.Representation_asArray.length?t.Representation_asArray[n]:t.Representation_asArray[0];r&&(i=r.mimeType+';codecs="'+r.codecs+'"',e&&void 0!==r.width&&(i+=';width="'+r.width+'";height="'+r.height+'"'))}return i&&(i=i.replace(/\sprofiles=[^;]*/g,"")),i},getMimeType:function(t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0?t.Representation_asArray[0].mimeType:null},getKID:function(t){return t&&t.hasOwnProperty(i.default.CENC_DEFAULT_KID)?t[i.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(t){if(!t||!Array.isArray(t.Label_asArray))return[];for(var n=[],e=0;e<t.Label_asArray.length;e++)n.push({lang:t.Label_asArray[e].lang,text:t.Label_asArray[e].__text||t.Label_asArray[e]});return n},getContentProtectionData:function(t){return t&&t.hasOwnProperty(i.default.CONTENTPROTECTION_ASARRAY)&&0!==t.ContentProtection_asArray.length?t.ContentProtection_asArray:null},getIsDynamic:O,hasProfile:function(t,n){var e=!1;return t&&t.profiles&&t.profiles.length>0&&(e=-1!==t.profiles.indexOf(n)),e},getDuration:function(t){return t&&t.hasOwnProperty(i.default.MEDIA_PRESENTATION_DURATION)?t.mediaPresentationDuration:t&&"dynamic"==t.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(t){return t&&t.bandwidth?t.bandwidth:NaN},getManifestUpdatePeriod:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=NaN;return t&&t.hasOwnProperty(i.default.MINIMUM_UPDATE_PERIOD)&&(e=t.minimumUpdatePeriod),isNaN(e)?e:Math.max(e-n,1)},getRepresentationCount:function(t){return t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray.length:0},getBitrateListForAdaptation:function(t){var n=E(t);return(n&&Array.isArray(n.Representation_asArray)?n.Representation_asArray:[]).map((function(t){return{bandwidth:t.bandwidth,width:t.width||0,height:t.height||0,scanType:t.scanType||null,id:t.id||null}}))},getRepresentationFor:function(t,n){return n&&n.Representation_asArray&&n.Representation_asArray.length>0&&y(t)?n.Representation_asArray[t]:null},getRepresentationsForAdaptation:function(t){var n,e,o,u,a=[],s=function(t){if(t&&t.period&&y(t.period.index)){var n=t.period.mpd.manifest.Period_asArray[t.period.index];if(n&&n.AdaptationSet_asArray&&y(t.index))return E(n.AdaptationSet_asArray[t.index])}}(t),f=void 0,c=void 0;if(s&&s.Representation_asArray){if(t&&t.period&&y(t.period.index)){var l=x(t.period.mpd.manifest);l&&(c=l[0])}for(var d=0,h=s.Representation_asArray.length;d<h;++d){var v=s.Representation_asArray[d],p=new r.default;if(p.index=d,p.adaptation=t,v.hasOwnProperty(i.default.ID)&&(p.id=v.id),v.hasOwnProperty(i.default.CODECS)&&(p.codecs=v.codecs),v.hasOwnProperty(i.default.CODEC_PRIVATE_DATA)&&(p.codecPrivateData=v.codecPrivateData),v.hasOwnProperty(i.default.BANDWITH)&&(p.bandwidth=v.bandwidth),v.hasOwnProperty(i.default.WIDTH)&&(p.width=v.width),v.hasOwnProperty(i.default.HEIGHT)&&(p.height=v.height),v.hasOwnProperty(i.default.SCAN_TYPE)&&(p.scanType=v.scanType),v.hasOwnProperty(i.default.MAX_PLAYOUT_RATE)&&(p.maxPlayoutRate=v.maxPlayoutRate),v.hasOwnProperty(i.default.SEGMENT_BASE)?(f=v.SegmentBase,p.segmentInfoType=i.default.SEGMENT_BASE):v.hasOwnProperty(i.default.SEGMENT_LIST)?p.segmentInfoType=(f=v.SegmentList).hasOwnProperty(i.default.SEGMENT_TIMELINE)?i.default.SEGMENT_TIMELINE:i.default.SEGMENT_LIST:v.hasOwnProperty(i.default.SEGMENT_TEMPLATE)?(p.segmentInfoType=(f=v.SegmentTemplate).hasOwnProperty(i.default.SEGMENT_TIMELINE)?i.default.SEGMENT_TIMELINE:i.default.SEGMENT_TEMPLATE,f.hasOwnProperty(i.default.INITIALIZATION_MINUS)&&(p.initialization=f.initialization.split("$Bandwidth$").join(v.bandwidth).split("$RepresentationID$").join(v.id))):p.segmentInfoType=i.default.BASE_URL,p.essentialProperties=R(v),f){if(f.hasOwnProperty(i.default.INITIALIZATION)){var g=f.Initialization;g.hasOwnProperty(i.default.SOURCE_URL)&&(p.initialization=g.sourceURL),g.hasOwnProperty(i.default.RANGE)&&(p.range=g.range)}else v.hasOwnProperty(i.default.MIME_TYPE)&&C(v.mimeType)&&(p.range=0);f.hasOwnProperty(i.default.TIMESCALE)&&(p.timescale=f.timescale),f.hasOwnProperty(i.default.DURATION)?p.segmentDuration=f.duration/p.timescale:v.hasOwnProperty(i.default.SEGMENT_TEMPLATE)&&(f=v.SegmentTemplate).hasOwnProperty(i.default.SEGMENT_TIMELINE)&&(p.segmentDuration=(o=void 0,void 0,u=(e=f.SegmentTimeline).S_asArray[1],((o=e.S_asArray[0]).hasOwnProperty("d")?o.d:u.t-o.t)/p.timescale)),f.hasOwnProperty(i.default.MEDIA)&&(p.media=f.media),f.hasOwnProperty(i.default.START_NUMBER)&&(p.startNumber=f.startNumber),f.hasOwnProperty(i.default.INDEX_RANGE)&&(p.indexRange=f.indexRange),f.hasOwnProperty(i.default.PRESENTATION_TIME_OFFSET)&&(p.presentationTimeOffset=f.presentationTimeOffset/p.timescale),f.hasOwnProperty(i.default.AVAILABILITY_TIME_OFFSET)?p.availabilityTimeOffset=f.availabilityTimeOffset:c&&void 0!==c.availabilityTimeOffset&&(p.availabilityTimeOffset=c.availabilityTimeOffset),f.hasOwnProperty(i.default.AVAILABILITY_TIME_COMPLETE)?p.availabilityTimeComplete="false"!==f.availabilityTimeComplete:c&&void 0!==c.availabilityTimeComplete&&(p.availabilityTimeComplete=c.availabilityTimeComplete)}p.MSETimeOffset=(n=p).adaptation.period.start-n.presentationTimeOffset,p.path=[t.period.index,t.index,d],a.push(p)}}return a},getAdaptationsForPeriod:function(t){var n=t&&y(t.index)?t.mpd.manifest.Period_asArray[t.index]:null,r=[],u=void 0,a=void 0,s=void 0;if(n&&n.AdaptationSet_asArray)for(s=0;s<n.AdaptationSet_asArray.length;s++)a=n.AdaptationSet_asArray[s],u=new o.default,a.hasOwnProperty(i.default.ID)&&(u.id=a.id),u.index=s,u.period=t,u.type=T(a,e.default.MUXED)?e.default.MUXED:T(a,e.default.AUDIO)?e.default.AUDIO:N(a)?e.default.VIDEO:_(a)?e.default.FRAGMENTED_TEXT:S(a)?e.default.IMAGE:e.default.TEXT,r.push(u);return r},getRegularPeriods:function(t){var r,o=!!t&&O(t.manifest),a=[],s=null,f=null,l=null,d=null,h=void 0;for(h=0,r=t&&t.manifest&&t.manifest.Period_asArray?t.manifest.Period_asArray.length:0;h<r;h++)(f=t.manifest.Period_asArray[h]).hasOwnProperty(i.default.START)?(d=new u.default).start=f.start:null!==s&&s.hasOwnProperty(i.default.DURATION)&&null!==l?(d=new u.default).start=parseFloat((l.start+l.duration).toFixed(5)):0!==h||o||((d=new u.default).start=0),null!==l&&isNaN(l.duration)&&(null!==d?l.duration=parseFloat((d.start-l.start).toFixed(5)):n.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==d&&(d.id=I(f,h),d.index=h,d.mpd=t,f.hasOwnProperty(i.default.DURATION)&&(d.duration=f.duration),a.push(d),s=f,l=d),f=null,d=null;return 0===a.length||null!==l&&isNaN(l.duration)&&(l.duration=parseFloat((function(t){!function(){if(!c||!c.hasOwnProperty("error"))throw new Error(e.default.MISSING_CONFIG_ERROR)}();var n=O(t.mpd.manifest),i=void 0;return t.mpd.manifest.mediaPresentationDuration?i=t.mpd.manifest.mediaPresentationDuration:t.duration?i=t.duration:n?i=Number.POSITIVE_INFINITY:c.error(new b.default(M.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",t)),i}(l)-l.start).toFixed(5))),a},getMpd:function(t){var n=new a.default;return t&&(n.manifest=t,t.hasOwnProperty(i.default.AVAILABILITY_START_TIME)?n.availabilityStartTime=new Date(t.availabilityStartTime.getTime()):t.loadedTime&&(n.availabilityStartTime=new Date(t.loadedTime.getTime())),t.hasOwnProperty(i.default.AVAILABILITY_END_TIME)&&(n.availabilityEndTime=new Date(t.availabilityEndTime.getTime())),t.hasOwnProperty(i.default.MINIMUM_UPDATE_PERIOD)&&(n.minimumUpdatePeriod=t.minimumUpdatePeriod),t.hasOwnProperty(i.default.MEDIA_PRESENTATION_DURATION)&&(n.mediaPresentationDuration=t.mediaPresentationDuration),t.hasOwnProperty(i.default.SUGGESTED_PRESENTATION_DELAY)&&(n.suggestedPresentationDelay=t.suggestedPresentationDelay),t.hasOwnProperty(i.default.TIMESHIFT_BUFFER_DEPTH)&&(n.timeShiftBufferDepth=t.timeShiftBufferDepth),t.hasOwnProperty(i.default.MAX_SEGMENT_DURATION)&&(n.maxSegmentDuration=t.maxSegmentDuration)),n},getEventsForPeriod:function(t){var n=t&&t.mpd&&t.mpd.manifest?t.mpd.manifest:null,r=n?n.Period_asArray:null,o=r&&t&&y(t.index)?r[t.index].EventStream_asArray:null,u=[],a=void 0,s=void 0;if(o)for(a=0;a<o.length;a++){var c=new v.default;if(c.period=t,c.timescale=1,!o[a].hasOwnProperty(e.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(c.schemeIdUri=o[a].schemeIdUri,o[a].hasOwnProperty(i.default.TIMESCALE)&&(c.timescale=o[a].timescale),o[a].hasOwnProperty(i.default.VALUE)&&(c.value=o[a].value),s=0;o[a].Event_asArray&&s<o[a].Event_asArray.length;s++){var d=new f.default;d.presentationTime=0,d.eventStream=c,o[a].Event_asArray[s].hasOwnProperty(i.default.PRESENTATION_TIME)&&(d.presentationTime=o[a].Event_asArray[s].presentationTime,d.calculatedPresentationTime=d.presentationTime+t.start*c.timescale+(c.presentationTimeOffset?c.presentationTimeOffset*c.timescale:0)),o[a].Event_asArray[s].hasOwnProperty(i.default.DURATION)&&(d.duration=o[a].Event_asArray[s].duration),o[a].Event_asArray[s].hasOwnProperty(i.default.ID)&&(d.id=o[a].Event_asArray[s].id),d.messageData=o[a].Event_asArray[s].Signal&&o[a].Event_asArray[s].Signal.Binary?l.decodeArray(o[a].Event_asArray[s].Signal.Binary.toString()):o[a].Event_asArray[s].messageData||o[a].Event_asArray[s].__text,u.push(d)}}return u},getEventStreamForAdaptationSet:function(t,n){var e=void 0,i=void 0,r=void 0;return t&&t.Period_asArray&&n&&n.period&&y(n.period.index)&&(i=t.Period_asArray[n.period.index])&&i.AdaptationSet_asArray&&y(n.index)&&(r=i.AdaptationSet_asArray[n.index])&&(e=r.InbandEventStream_asArray),D(e,null)},getEventStreamForRepresentation:function(t,n){var e=void 0,i=void 0,r=void 0,o=void 0;return t&&t.Period_asArray&&n&&n.adaptation&&n.adaptation.period&&y(n.adaptation.period.index)&&(i=t.Period_asArray[n.adaptation.period.index])&&i.AdaptationSet_asArray&&y(n.adaptation.index)&&(r=i.AdaptationSet_asArray[n.adaptation.index])&&r.Representation_asArray&&y(n.index)&&(o=r.Representation_asArray[n.index])&&(e=o.InbandEventStream_asArray),D(e,n)},getUTCTimingSources:function(t){var n=O(t),r=!!t&&t.hasOwnProperty(i.default.AVAILABILITY_START_TIME),o=t?t.UTCTiming_asArray:null,u=[];return(n||r)&&o&&o.forEach((function(t){var n=new s.default;t.hasOwnProperty(e.default.SCHEME_ID_URI)&&(n.schemeIdUri=t.schemeIdUri,t.hasOwnProperty(i.default.VALUE)&&(n.value=t.value.toString(),u.push(n)))})),u},getBaseURLsFromElement:x,getRepresentationSortFunction:function(){return function(t,n){return t.bandwidth-n.bandwidth}},getLocation:function(t){if(t&&t.hasOwnProperty(e.default.LOCATION))return t.Location=t.Location_asArray[0],t.Location},getSuggestedPresentationDelay:function(t){return t&&t.hasOwnProperty(i.default.SUGGESTED_PRESENTATION_DELAY)?t.suggestedPresentationDelay:null},getAvailabilityStartTime:function(t){return t&&t.hasOwnProperty(i.default.AVAILABILITY_START_TIME)&&null!==t.availabilityStartTime?t.availabilityStartTime.getTime():null},getServiceDescriptions:function(t){var n=[];if(t&&t.hasOwnProperty(i.default.SERVICE_DESCRIPTION)){var r=!0,o=!1,u=void 0;try{for(var a,s=t.ServiceDescription_asArray[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var f=a.value,c=void 0,l=void 0,d=void 0,h=void 0;for(var v in f)f.hasOwnProperty(v)&&(v===i.default.ID?c=f[v]:v===i.default.SERVICE_DESCRIPTION_SCOPE?l=f[v].schemeIdUri:v===i.default.SERVICE_DESCRIPTION_LATENCY?d={target:f[v].target,max:f[v].max,min:f[v].min}:v===i.default.SERVICE_DESCRIPTION_PLAYBACK_RATE&&(h={max:f[v].max,min:f[v].min}));l===e.default.SERVICE_DESCRIPTION_LL_SCHEME&&(d||h)&&n.push({id:c,schemeIdUri:l,latency:d,playbackRate:h})}}catch(t){o=!0,u=t}finally{try{!r&&s.return&&s.return()}finally{if(o)throw u}}}return n},getSupplementalPropperties:function(t){var n={};if(t&&t.hasOwnProperty(i.default.SUPPLEMENTAL_PROPERTY)){var r=!0,o=!1,u=void 0;try{for(var a,s=t.SupplementalProperty_asArray[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var f=a.value;f.hasOwnProperty(e.default.SCHEME_ID_URI)&&f.hasOwnProperty(i.default.VALUE)&&(n[f[e.default.SCHEME_ID_URI]]=f[i.default.VALUE])}}catch(t){o=!0,u=t}finally{try{!r&&s.return&&s.return()}finally{if(o)throw u}}}return n},setConfig:function(t){t&&(t.errHandler&&(c=t.errHandler),t.BASE64&&(l=t.BASE64))}},n=(0,w.default)(h).getInstance().getLogger(t),t}_.__dashjs_factory_name="DashManifestModel",n.default=m.default.getSingletonFactory(_)})),Ui=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getVersionString=function(){return"3.1.3"}})),qi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(v),i=f(Mi),r=f(h),o=f(y),u=f(Ni),a=f(Li),s=f(Ti);function f(t){return t&&t.__esModule?t:{default:t}}var c="dash.js-v"+(0,Ui.getVersionString)();function l(){var t=void 0,n=void 0,r=void 0,f=void 0,l=void 0,d=void 0,h=this.context,v=(0,e.default)(h).getInstance(),p=(0,u.default)(h).getInstance();function g(){r={pr:1,nor:null,st:null,sf:null,sid:""+s.default.generateUuid(),bs:{audio:1,video:1},cid:null,did:""+c}}function m(){var t={v:1};return t.sid=p.get().streaming.cmcd.sid?p.get().streaming.cmcd.sid:r.sid,t.cid=p.get().streaming.cmcd.cid?p.get().streaming.cmcd.cid:r.cid,t.did=p.get().streaming.cmcd.did?p.get().streaming.cmcd.did:r.did,t.sid='"'+t.sid+'"',t.cid='"'+t.cid+'"',t.did='"'+t.did+'"',isNaN(r.pr)||1===r.pr||null===r.pr||(t.pr=r.pr),r.st&&(t.st=r.st),r.sf&&(t.sf=r.sf),t}function y(t){try{r.pr=t.playbackRate}catch(t){}}function w(n){try{var e=t.getIsDynamic(n.data),i=n.protocol&&"MSS"===n.protocol?"s":"d";r.st=e?"l":"v",r.sf=""+i}catch(t){}}function M(t){try{if(t.state&&t.mediaType){var n=null;switch(t.state){case i.default.BUFFER_LOADED:n=null;break;case i.default.BUFFER_EMPTY:d.isSeeking()&&(n=2),n=4}r.bs[t.mediaType]=n}}catch(t){}}return n={getQueryParameter:function(t){try{return p.get().streaming.cmcd&&p.get().streaming.cmcd.enabled?{key:"Common-Media-Client-Data",value:function(t){try{if(!t)return null;var n=Object.keys(t),e=n.length;return n.reduce((function(n,i,r){return n+=i+"="+t[i],r<e-1&&(n+=","),n}),"")}catch(t){return null}}(function(t){try{return t.type===b.HTTPRequest.MPD_TYPE?(function(t){try{r.cid=""+s.default.generateHashCode(t.url)}catch(t){}}(t),(n=m()).ot="m",n):t.type===b.HTTPRequest.MEDIA_SEGMENT_TYPE?function(t){var n=m(),e=function(t){try{return parseInt(t.mediaInfo.bitrateList[t.quality].bandwidth/1e3)}catch(t){return null}}(t),i=function(t){try{return isNaN(t.duration)?null:Math.round(1e3*t.duration)}catch(t){return null}}(t),o="video"===t.mediaType?"v":"audio"===t.mediaType?"a":"fragmentedText"===t.mediaType?"c":null,u=function(t){try{return Math.round(f.getThroughputHistory().getSafeAverageThroughput(t))}catch(t){return null}}(t.mediaType),a=function(t){try{var n=r.pr,e=l.getCurrentBufferLevel(t);return isNaN(n)||isNaN(e)?null:parseInt(e/n*1e3)}catch(t){return null}}(t.mediaType),s=function(t){try{var n=t.mediaType;return null!==r.bs[n]?r.bs[n]:l.getCurrentBufferLevel(n)<t.duration?3:null}catch(t){}}(t);return e&&(n.br=e),o&&(n.ot=o),isNaN(i)||(n.d=i),isNaN(u)||(n.mtp=u),isNaN(a)||(n.dl=a),isNaN(s)||null===s||(n.bs=s),n}(t):t.type===b.HTTPRequest.INIT_SEGMENT_TYPE?function(){var t=m();return t.ot="i",t}():null}catch(t){return null}var n}(t))}:null}catch(t){return null}},setConfig:function(t){t&&(t.abrController&&(f=t.abrController),t.dashMetrics&&(l=t.dashMetrics),t.playbackController&&(d=t.playbackController))},reset:function(){v.off(i.default.PLAYBACK_RATE_CHANGED,y,this),v.off(i.default.MANIFEST_LOADED,w,this),v.off(i.default.BUFFER_LEVEL_STATE_CHANGED,M,n),g()},initialize:function(){v.on(i.default.PLAYBACK_RATE_CHANGED,y,n),v.on(i.default.MANIFEST_LOADED,w,n),v.on(i.default.BUFFER_LEVEL_STATE_CHANGED,M,n)}},(0,o.default)(h).getInstance().getLogger(n),t=(0,a.default)(h).getInstance(),g(),n}l.__dashjs_factory_name="CmcdModel",n.default=r.default.getSingletonFactory(l)})),zi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=s(wi),i=s(bi),r=s(h),o=s(N),u=s(qi),a=s(Ti);function s(t){return t&&t.__esModule?t:{default:t}}function f(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function c(t){var n,r,s=this.context,c=(t=t||{}).errHandler,l=t.dashMetrics,d=t.mediaPlayerModel,h=t.requestModifier,v=t.boxParser,p=t.useFetch||!1,g=t.errors,m=void 0,y=void 0,w=void 0,M=void 0,T=void 0;function N(t,n){var r=t.request,u=[],f=!0,g=!0,_=new Date,S=_,C=0,E=void 0;if(!h||!l||!c)throw new Error("config object is not correct or missing");var k=function(t){g=!1,r.requestStartDate=_,r.requestEndDate=new Date,r.firstByteDate=r.firstByteDate||_,r.checkExistenceOnly||(l.addHttpRequest(r,E.response?E.response.responseURL:null,E.response?E.response.status:null,E.response&&E.response.getAllResponseHeaders?E.response.getAllResponseHeaders():E.response?E.response.responseHeaders:[],t?u:null),r.type===b.HTTPRequest.MPD_TYPE&&l.addManifestUpdate(r.type,r.requestStartDate,r.requestEndDate))},O=function(){if(-1!==m.indexOf(E)&&(m.splice(m.indexOf(E),1),g))if(k(!1),n>0){n--;var e={config:t};w.push(e),e.timeout=setTimeout((function(){-1!==w.indexOf(e)&&(w.splice(w.indexOf(e),1),N(t,n))}),d.getRetryIntervalsForType(r.type))}else c.error(new o.default(M[r.type],r.url+" is not available",{request:r,response:E.response})),t.error&&t.error(r,"error",E.response.statusText),t.complete&&t.complete(r,E.response.statusText)},R=void 0;R=p&&window.fetch&&"arraybuffer"===r.responseType&&r.type===b.HTTPRequest.MEDIA_SEGMENT_TYPE?(0,i.default)(s).create({requestModifier:h,boxParser:v}):(0,e.default)(s).create({requestModifier:h});var I=h.modifyRequestURL(r.url),D=function(t){try{var n=[],e=T.getQueryParameter(t);return e&&n.push(e),n}catch(t){return[]}}(r);I=a.default.addAditionalQueryParameterToUrl(I,D);var x=r.checkExistenceOnly?b.HTTPRequest.HEAD:b.HTTPRequest.GET,A=d.getXHRWithCredentialsForType(r.type);E={url:I,method:x,withCredentials:A,request:r,onload:function(){E.response.status>=200&&E.response.status<=299&&(k(!0),t.success&&t.success(E.response.response,E.response.statusText,E.response.responseURL),t.complete&&t.complete(r,E.response.statusText))},onend:O,onerror:O,progress:function(n){var e=new Date;f&&(f=!1,(!n.lengthComputable||n.lengthComputable&&n.total!==n.loaded)&&(r.firstByteDate=e)),n.lengthComputable&&(r.bytesLoaded=n.loaded,r.bytesTotal=n.total),n.noTrace||(u.push({s:S,d:n.time?n.time:e.getTime()-S.getTime(),b:[n.loaded?n.loaded-C:0]}),S=e,C=n.loaded),t.progress&&n&&t.progress(n)},onabort:function(){t.abort&&t.abort(r)},loader:R};var j=(new Date).getTime();if(isNaN(r.delayLoadingTime)||j>=r.delayLoadingTime)m.push(E),R.load(E);else{var F={httpRequest:E};y.push(F),F.delayTimeout=setTimeout((function(){if(-1!==y.indexOf(F)){y.splice(y.indexOf(F),1);try{_=new Date,S=_,m.push(F.httpRequest),R.load(F.httpRequest)}catch(t){F.httpRequest.onerror()}}}),r.delayLoadingTime-j)}}return n={load:function(t){t.request?N(t,d.getRetryAttemptsForType(t.request.type)):t.error&&t.error(t.request,"error")},abort:function(){w.forEach((function(t){clearTimeout(t.timeout),t.config.request&&t.config.abort&&t.config.abort(t.config.request)})),w=[],y.forEach((function(t){return clearTimeout(t.delayTimeout)})),y=[],m.forEach((function(t){t.onloadend=t.onerror=t.onprogress=void 0,t.loader.abort(t)})),m=[]}},m=[],y=[],w=[],T=(0,u.default)(s).getInstance(),f(r={},b.HTTPRequest.MPD_TYPE,g.DOWNLOAD_ERROR_ID_MANIFEST_CODE),f(r,b.HTTPRequest.XLINK_EXPANSION_TYPE,g.DOWNLOAD_ERROR_ID_XLINK_CODE),f(r,b.HTTPRequest.INIT_SEGMENT_TYPE,g.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),f(r,b.HTTPRequest.MEDIA_SEGMENT_TYPE,g.DOWNLOAD_ERROR_ID_CONTENT_CODE),f(r,b.HTTPRequest.INDEX_SEGMENT_TYPE,g.DOWNLOAD_ERROR_ID_CONTENT_CODE),f(r,b.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,g.DOWNLOAD_ERROR_ID_CONTENT_CODE),f(r,b.HTTPRequest.OTHER_TYPE,g.DOWNLOAD_ERROR_ID_CONTENT_CODE),M=r,n}c.__dashjs_factory_name="HTTPLoader";var l=r.default.getClassFactory(c);n.default=l})),Hi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(zi);function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t=void 0;function n(){t={}}function e(){n()}return e(),{getLoader:function(n){for(var e in t)if(t.hasOwnProperty(e)&&n.startsWith(e))return t[e];return i.default},registerLoader:function(n,e){t[n]=e},unregisterLoader:function(n){t[n]&&delete t[n]},unregisterAllLoader:n,reset:e}}o.__dashjs_factory_name="SchemeLoaderFactory";var u=e.default.getSingletonFactory(o);n.default=u})),Ki=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(Hi);function r(t){return t&&t.__esModule?t:{default:t}}function o(t){t=t||{};var n=this.context,e=void 0,r=void 0;return e=(0,i.default)(n).getInstance(),{load:function(i){var o=e.getLoader(i&&i.request?i.request.url:null);(r=o(n).create({errHandler:t.errHandler,mediaPlayerModel:t.mediaPlayerModel,requestModifier:t.requestModifier,useFetch:t.useFetch||null,dashMetrics:t.dashMetrics,boxParser:t.boxParser?t.boxParser:null,constants:t.constants?t.constants:null,dashConstants:t.dashConstants?t.dashConstants:null,urlUtils:t.urlUtils?t.urlUtils:null,errors:t.errors})).load(i)},abort:function(){r&&r.abort()}}}o.__dashjs_factory_name="URLLoader";var u=e.default.getClassFactory(o);n.default=u})),Vi=o((function(t,n){var e;Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function n(t){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.checkForExistenceOnly=!0,e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(((e=M)&&e.__esModule?e:{default:e}).default);n.default=i})),Wi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(c),i=a(Ki),r=a(Vi),o=a(N),u=a(h);function a(t){return t&&t.__esModule?t:{default:t}}function s(t){var n=(t=t||{}).eventBus,u=t.events,a=t.urlUtils,s=t.errors,f=void 0,c=void 0;return f={checkForExistence:function(t){var e=function(e){n.trigger(u.CHECK_FOR_EXISTENCE_COMPLETED,{request:t,exists:e})};if(t){var i=new r.default(t.url);c.load({request:i,success:function(){e(!0)},error:function(){e(!1)}})}else e(!1)},load:function(t){var e=function(e,i){n.trigger(u.LOADING_COMPLETED,{request:t,response:e||null,error:i||null,sender:f})};t?c.load({request:t,progress:function(e){n.trigger(u.LOADING_PROGRESS,{request:t,stream:e.stream}),e.data&&n.trigger(u.LOADING_DATA_PROGRESS,{request:t,response:e.data||null,error:null,sender:f})},success:function(t){e(t)},error:function(t,n,i){e(void 0,new o.default(s.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,i,n))},abort:function(t){t&&n.trigger(u.LOADING_ABANDONED,{request:t,mediaType:t.mediaType,sender:f})}}):e(void 0,new o.default(s.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,s.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){c&&c.abort()},reset:function(){c&&(c.abort(),c=null)}},c=(0,i.default)(this.context).create({errHandler:t.errHandler,errors:s,dashMetrics:t.dashMetrics,mediaPlayerModel:t.mediaPlayerModel,requestModifier:t.requestModifier,useFetch:t.settings.get().streaming.lowLatencyEnabled,urlUtils:a,constants:e.default,boxParser:t.boxParser,dashConstants:t.dashConstants}),f}s.__dashjs_factory_name="FragmentLoader",n.default=u.default.getClassFactory(s)})),Gi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=p(c),i=p(yi),r=p(T),o=p(Wi),u=p(hi),a=p(v),s=p(m),f=p(Oe),l=p(h),d=p(y);function p(t){return t&&t.__esModule?t:{default:t}}function g(t){t=t||{};var n,c=this.context,l=(0,a.default)(c).getInstance(),h=t.errHandler,v=t.mediaPlayerModel,p=t.dashMetrics,g=(0,d.default)(c).getInstance(),m=void 0,y=void 0,w=void 0;function b(){for(var t in y)y[t].reset();y={}}function M(t){if(t.sender){var n=t.request,r=t.response,o=n.isInitializationRequest(),u=n.mediaInfo.streamInfo;if(!u||u.id===w)if(t.error&&(t.request.mediaType!==e.default.AUDIO&&t.request.mediaType!==e.default.VIDEO&&t.request.mediaType!==e.default.FRAGMENTED_TEXT||l.trigger(s.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:t.request.serviceLocation})),r&&u){var a=function(t,n,e,r){var o=new i.default;return o.streamId=e,o.mediaInfo=n.mediaInfo,o.segmentType=n.type,o.start=n.startTime,o.duration=n.duration,o.end=o.start+o.duration,o.bytes=t,o.index=n.index,o.quality=n.quality,o.representationId=n.representationId,o.endFragment=r,o}(r,n,u.id,t.type!==s.default.FRAGMENT_LOADING_PROGRESS);l.trigger(o?s.default.INIT_FRAGMENT_LOADED:s.default.MEDIA_FRAGMENT_LOADED,{chunk:a,request:n})}else m.warn("No "+n.mediaType+" bytes to push or stream is inactive.")}}return m=g.getLogger(n={getModel:function(n,e){var i=y[e];return i||(i=(0,r.default)(c).create({streamId:n,dashMetrics:p,fragmentLoader:(0,o.default)(c).create({dashMetrics:p,mediaPlayerModel:v,errHandler:h,requestModifier:(0,u.default)(c).getInstance(),settings:t.settings,boxParser:t.boxParser,eventBus:l,events:s.default,errors:f.default,dashConstants:t.dashConstants,urlUtils:t.urlUtils}),debug:g,eventBus:l,events:s.default}),y[e]=i),i},setStreamId:function(t){w=t},reset:function(){l.off(s.default.FRAGMENT_LOADING_COMPLETED,M,this),l.off(s.default.FRAGMENT_LOADING_PROGRESS,M,this),b()}}),b(),l.on(s.default.FRAGMENT_LOADING_COMPLETED,M,n),l.on(s.default.FRAGMENT_LOADING_PROGRESS,M,n),n}g.__dashjs_factory_name="FragmentController",n.default=l.default.getClassFactory(g)})),$i=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null}})),Xi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(h),i=a(c),r=a($i),o=a(Bi),u=a(Ke);function a(t){return t&&t.__esModule?t:{default:t}}function s(t){var n,e=this.context,a=void 0;function s(){a&&a.reset()}return n={provide:function(t,n){if("function"==typeof n){var e=a.getCurrentTrack(),i=void 0;if(!e||e.segmentDuration<=0||null==t)n(null);else{isNaN(e.segmentDuration)&&(i=a.getThumbnailRequestForTime(t))&&(e.segmentDuration=i.duration);var o=Math.floor(t%e.segmentDuration*e.tilesHor*e.tilesVert/e.segmentDuration),u=new r.default;if(u.width=Math.floor(e.widthPerTile),u.height=Math.floor(e.heightPerTile),u.x=Math.floor(o%e.tilesHor)*e.widthPerTile,u.y=Math.floor(o/e.tilesHor)*e.heightPerTile,"readThumbnail"in e)return e.readThumbnail(t,(function(t){u.url=t,n(u)}));if(i)u.url=i.url,e.segmentDuration=NaN;else{var s=Math.floor(t/e.segmentDuration);u.url=function(t,n){var e=n+t.startNumber,i=(0,ui.replaceTokenForTemplate)(t.templateUrl,"Number",e);return i=(0,ui.replaceTokenForTemplate)(i,"Time",(e-1)*t.segmentDuration),i=(0,ui.replaceTokenForTemplate)(i,"Bandwidth",t.bandwidth),(0,ui.unescapeDollarsInTemplate)(i)}(e,s)}n(u)}}},setTrackByIndex:function(t){a.setTrackByIndex(t)},getCurrentTrackIndex:function(){return a.getCurrentTrackIndex()},getBitrateList:function(){var t=a.getTracks(),n=0;return t.map((function(t){var e=new u.default;return e.mediaType=i.default.IMAGE,e.qualityIndex=n++,e.bitrate=t.bitrate,e.width=t.width,e.height=t.height,e}))},reset:s},s(),a=(0,o.default)(e).create({streamInfo:t.streamInfo,adapter:t.adapter,baseURLController:t.baseURLController,timelineConverter:t.timelineConverter,debug:t.debug,eventBus:t.eventBus,events:t.events,dashConstants:t.dashConstants}),n}s.__dashjs_factory_name="ThumbnailController",n.default=e.default.getClassFactory(s)})),Qi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=M(c),i=M(l),r=M(mi),o=M(Gi),u=M(Xi),a=M(v),s=M(m),f=M(y),d=M(Oe),p=M(h),g=M(N),w=M(O),b=M(pi);function M(t){return t&&t.__esModule?t:{default:t}}function T(t){t=t||{};var n=this.context,c=(0,a.default)(n).getInstance(),l=(0,b.default)(n).getInstance(),h=t.manifestModel,v=t.mediaPlayerModel,p=t.manifestUpdater,m=t.adapter,y=t.capabilities,M=t.errHandler,T=t.timelineConverter,N=t.dashMetrics,_=t.abrController,S=t.playbackController,C=t.eventController,E=t.mediaController,k=t.textController,O=t.videoModel,R=t.settings,I=void 0,D=void 0,x=void 0,A=void 0,j=void 0,F=void 0,P=void 0,B=void 0,L=void 0,U=void 0,q=void 0,z=void 0,H=void 0,K=void 0,V=void 0,W=void 0,G=void 0,$=void 0,X=void 0,Q=void 0,J=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function Y(t){for(var n=A?A.length:0,e=0;e<n;e++)A[e].getFragmentModel().removeExecutedRequestsBeforeTime(et()+nt()),A[e].reset(!1,t);A=[],F=!1,P=!1,_t(!1),c.off(s.default.CURRENT_TRACK_CHANGED,ft,I)}function Z(){Y(),x=null,j=!1,B=!1,L=!1,U={},q=!1,G=!1,X=!1}function tt(){S&&S.pause(),H&&(H.reset(),H=null),Z(),c.off(s.default.DATA_UPDATE_COMPLETED,gt,I),c.off(s.default.BUFFERING_COMPLETED,pt,I),c.off(s.default.INBAND_EVENTS,mt,I),z&&(c.off(s.default.KEY_ERROR,at,I),c.off(s.default.SERVER_CERTIFICATE_UPDATED,at,I),c.off(s.default.LICENSE_REQUEST_COMPLETE,at,I),c.off(s.default.KEY_SYSTEM_SELECTED,at,I),c.off(s.default.KEY_SESSION_CREATED,at,I),c.off(s.default.KEY_STATUSES_CHANGED,at,I)),_t(!1)}function nt(){return x?x.duration:NaN}function et(){return x?x.start:NaN}function it(){if(!x.manifestInfo.isDynamic)return NaN;for(var t=0;t<A.length;t++)if(A[t].getType()===e.default.AUDIO||A[t].getType()===e.default.VIDEO)return A[t].getLiveStartTime();return NaN}function rt(){return x?x.id:null}function ot(){return x}function ut(){if(!(O&&_&&_.hasOwnProperty("getBitrateList")&&m&&m.hasOwnProperty("getAllMediaInfoForType")&&m.hasOwnProperty("getEventsFor")))throw new Error(e.default.MISSING_CONFIG_ERROR)}function at(t){t.error&&(M.error(t.error),D.fatal(t.error.message),tt())}function st(t){var n,i=t?t.type:null,r=void 0;if(i===e.default.MUXED)return D.fatal(r="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines"),M.error(new g.default(d.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,r,h.getValue())),!1;if(i===e.default.TEXT||i===e.default.FRAGMENTED_TEXT||i===e.default.EMBEDDED_TEXT||i===e.default.IMAGE)return!0;if(D.debug(i+" codec: "+(n=t.codec)),t.contentProtection&&!y.supportsEncryptedMedia())M.error(new g.default(d.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,d.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE));else if(!y.supportsCodec(n))return D.error(r=i+"Codec ("+n+") is not supported."),!1;return!0}function ft(t){if(x&&t.newMediaInfo.streamInfo.id===x.id){var n=t.newMediaInfo,i=h.getValue();m.setCurrentMediaInfo(x.id,n.type,n);var r=yt(n);if(r){var o=S.getTime();D.info("Stream -  Process track changed at current time "+o),D.debug("Stream -  Update stream controller"),i.refreshManifestOnSwitchTrack?(D.debug("Stream -  Refreshing manifest for switch track"),Q=t,p.refreshManifest()):(r.selectMediaInfo(n),n.type!==e.default.FRAGMENTED_TEXT?(_.updateTopQualityIndex(n),r.switchTrackAsked(),r.getFragmentModel().abortRequests()):(r.getScheduleController().setSeekTarget(o),r.setBufferingTime(o),r.resetIndexHandler()))}}}function ct(o,a){var f,l=m.getAllMediaInfoForType(x,o),d=null;if(l&&0!==l.length){o===e.default.VIDEO&&(B=!0),o===e.default.AUDIO&&(L=!0);for(var p=0,g=l.length;p<g;p++)if(d=l[p],o===e.default.EMBEDDED_TEXT)k.addEmbeddedTrack(d);else{if(!st(d))continue;E.addTrack(d)}o!==e.default.EMBEDDED_TEXT&&0!==E.getTracksFor(o,x).length&&(o!==e.default.IMAGE?(E.checkInitialMediaSettingsForType(o,x),f=E.getCurrentTrackFor(o,x),c.trigger(s.default.STREAM_INITIALIZING,{streamInfo:x,mediaInfo:d}),function(i,o,u){var a=H.getModel(rt(),i?i.type:null),s=(0,r.default)(n).create({streamInfo:x,type:i?i.type:null,mimeType:i?i.mimeType:null,timelineConverter:T,adapter:m,manifestModel:h,mediaPlayerModel:v,fragmentModel:a,dashMetrics:t.dashMetrics,baseURLController:t.baseURLController,abrController:_,playbackController:S,mediaController:E,textController:k,errHandler:M,settings:R,boxParser:W});if(s.initialize(u,B),_.updateTopQualityIndex(i),A.push(s),!i||i.type!==e.default.TEXT&&i.type!==e.default.FRAGMENTED_TEXT)s.addMediaInfo(i,!0);else{for(var f=void 0,c=0;c<o.length;c++)o[c].index===i.index&&(f=c),s.addMediaInfo(o[c]);s.selectMediaInfo(o[f])}}(f,l,a)):K=(0,u.default)(n).create({streamInfo:x,adapter:m,baseURLController:t.baseURLController,timelineConverter:t.timelineConverter,debug:$,eventBus:c,events:s.default,dashConstants:i.default}))}else D.info("No "+o+" data.")}function lt(){if(C){var t=m.getEventsFor(x);C.addInlineEvents(t)}}function dt(t){var n=m.getAdaptationForType(x?x.index:null,t,x);n&&Array.isArray(n.Representation_asArray)&&(n.Representation_asArray=n.Representation_asArray.filter((function(t,e){if(0===e)return!0;var i=m.getCodec(n,e,!0);return!!y.supportsCodec(i)||(D.error("[Stream] codec not supported: "+i),!1)})))}function ht(){for(var t=A.length,n=U.audio||U.video?new g.default(d.default.DATA_UPDATE_FAILED_ERROR_CODE,d.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,i=0;i<t;i++)if(A[i].isUpdating()||q)return;if(P){if(z)for(var r=0;r<t&&A[r];r++)A[r].getType()!==e.default.AUDIO&&A[r].getType()!==e.default.VIDEO&&A[r].getType()!==e.default.FRAGMENTED_TEXT||z.initializeForMedia(A[r].getMediaInfo());n?M.error(n):j||(j=!0,T.setTimeSyncCompleted(!0),c.trigger(s.default.STREAM_INITIALIZED,{streamInfo:x,liveStartTime:V?NaN:it()}));for(var o=0;o<t&&A[o];o++)A[o].getScheduleController().start()}}function vt(t){for(var n={},e=0,i=A.length;e<i;e++){var r=A[e].createBuffer(t);r&&(n[A[e].getType()]=r.getBuffer())}return n}function pt(t){if(t.streamId===x.id){var n=wt(),i=n.length;if(0!==i){for(var r=0;r<i;r++)if(!n[r].isBufferingCompleted()&&(n[r].getType()===e.default.AUDIO||n[r].getType()===e.default.VIDEO))return void D.warn("onBufferingCompleted - One streamProcessor has finished but",n[r].getType(),"one is not buffering completed");D.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),c.trigger(s.default.STREAM_BUFFERING_COMPLETED,{streamInfo:x})}else D.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}}function gt(t){x&&t.sender.getStreamId()===x.id&&(U[t.sender.getType()]=t.error,ht())}function mt(t){x&&t.sender.getStreamInfo().id===x.id&&(C&&C.addInbandEvents(t.events))}function yt(t){return t?wt().filter((function(n){return n.getType()===t.type}))[0]:null}function wt(){for(var t=[],n=void 0,i=void 0,r=0;r<A.length;r++)(n=(i=A[r]).getType())!==e.default.AUDIO&&n!==e.default.VIDEO&&n!==e.default.FRAGMENTED_TEXT&&n!==e.default.TEXT||t.push(i);return t}function bt(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return!1;var i=t.getStreamInfo(),r=e?e.getStreamInfo():ot();if(!i||!r)return!1;var o=m.getAdaptationForType(i.index,n,i),u=m.getAdaptationForType(r.index,n,r);return o&&u?!(!Mt(u)&&Mt(o)):!o&&!u}function Mt(t){return!!t&&!!(t.ContentProtection||t.Representation&&t.Representation.length>0&&t.Representation[0].ContentProtection)}function Tt(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t||!t.hasOwnProperty("getStreamInfo"))return!1;var i=t.getStreamInfo(),r=e?e.getStreamInfo():ot();if(!i||!r)return!1;var o=m.getAdaptationForType(i.index,n,i),u=m.getAdaptationForType(r.index,n,r);if(!o||!u)return!o&&!u;var a=o&&u&&o.mimeType===u.mimeType,s=u.Representation_asArray.map((function(t){return t.codecs})),f=o.Representation_asArray.map((function(t){return t.codecs})),c=f.some((function(t){return s.indexOf(t)>-1})),l=f.some((function(t){return s.some((function(n){return Nt(n,t)}))}));return c||l&&a}function Nt(t,n){for(var e=t.split(".")[0],i=0===n.indexOf(e),r=void 0,o=0;o<J.length;o++)if(J[o].codec===e){r=J[o];break}return r?i||r.compatibleCodecs.some((function(t){return 0===n.indexOf(t)})):i}function _t(t){V=t}function St(){return V}return I={initialize:function(t,n){x=t,t&&H.setStreamId(t.id),(z=n)&&(c.on(s.default.KEY_ERROR,at,I),c.on(s.default.SERVER_CERTIFICATE_UPDATED,at,I),c.on(s.default.LICENSE_REQUEST_COMPLETE,at,I),c.on(s.default.KEY_SYSTEM_SELECTED,at,I),c.on(s.default.KEY_SESSION_CREATED,at,I),c.on(s.default.KEY_STATUSES_CHANGED,at,I)),c.trigger(s.default.STREAM_UPDATED,{streamInfo:x})},activate:function(t,n){if(!F){var i=void 0;return c.on(s.default.CURRENT_TRACK_CHANGED,ft,I),St()?(function(){if(q=!0,ut(),dt(e.default.VIDEO),dt(e.default.AUDIO),P=!0,q=!1,0===A.length){var t="No streams to play.";M.error(new g.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,t,h.getValue())),D.debug(t)}else ht()}(),i=n):i=function(t,n){ut();var i=O.getElement();lt(),q=!0,dt(e.default.VIDEO),dt(e.default.AUDIO),(!i||i&&/^VIDEO$/i.test(i.nodeName))&&ct(e.default.VIDEO,t),ct(e.default.AUDIO,t),ct(e.default.TEXT,t),ct(e.default.FRAGMENTED_TEXT,t),ct(e.default.EMBEDDED_TEXT,t),ct(e.default.MUXED,t),ct(e.default.IMAGE,t);var r=vt(n);if(P=!0,q=!1,0===A.length){var o="No streams to play.";M.error(new g.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,o,h.getValue())),D.fatal(o)}else ht();return r}(t,n),F=!0,i}return n},deactivate:Y,isActive:function(){return F},getDuration:nt,getStartTime:et,getId:rt,getStreamInfo:ot,getHasAudioTrack:function(){return L},getHasVideoTrack:function(){return B},preload:function(t,n){if(!St()){lt(),ct(e.default.VIDEO,t),ct(e.default.AUDIO,t),ct(e.default.TEXT,t),ct(e.default.FRAGMENTED_TEXT,t),ct(e.default.EMBEDDED_TEXT,t),ct(e.default.MUXED,t),ct(e.default.IMAGE,t),vt(n),c.on(s.default.CURRENT_TRACK_CHANGED,ft,I);for(var i=0;i<A.length&&A[i];i++)A[i].getScheduleController().start();_t(!0)}},getThumbnailController:function(){return K},getBitrateListFor:function(t){if(ut(),t===e.default.IMAGE)return K?K.getBitrateList():[];var n=function(t){for(var n=null,e=0;e<A.length;e++)if((n=A[e]).getType()===t)return n.getMediaInfo();return null}(t);return _.getBitrateList(n)},updateData:function(t){D.info("Manifest updated... updating data system wide."),F=!1,q=!0,c.trigger(s.default.STREAM_UPDATED,{streamInfo:x=t}),C&&lt(),dt(e.default.VIDEO),dt(e.default.AUDIO);for(var n=0,i=A.length;n<i;n++){var r=A[n];r.updateStreamInfo(x);var o=m.getMediaInfoForType(x,r.getType());_.updateTopQualityIndex(o),r.addMediaInfo(o,!0)}if(Q&&Q.newMediaInfo.type!==e.default.FRAGMENTED_TEXT){var u=yt(Q.oldMediaInfo);if(!u)return;u.switchTrackAsked(),Q=void 0}q=!1,ht()},reset:tt,getProcessors:wt,setMediaSource:function(t){for(var n=0;n<A.length;)st(A[n].getMediaInfo())?(A[n].setMediaSource(t),n++):(A[n].reset(),A.splice(n,1));for(var e=0;e<A.length;e++)A[e].dischargePreBuffer();if(0===A.length){var i="No streams to play.";M.error(new g.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,i+"nostreams",h.getValue())),D.fatal(i)}},isMediaCodecCompatible:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Tt(t,e.default.VIDEO,n)&&Tt(t,e.default.AUDIO,n)},isProtectionCompatible:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return bt(t,e.default.VIDEO,n)&&bt(t,e.default.AUDIO,n)},getPreloaded:St,getPreloadingScheduled:function(){return G},setPreloadingScheduled:function(t){G=t},getIsEndedEventSignaled:function(){return X},setIsEndedEventSignaled:function(t){X=t}},$=(0,f.default)(n).getInstance(),D=$.getLogger(I),Z(),W=(0,w.default)(n).getInstance(),H=(0,o.default)(n).create({mediaPlayerModel:v,dashMetrics:N,errHandler:M,settings:R,boxParser:W,dashConstants:i.default,urlUtils:l}),c.on(s.default.BUFFERING_COMPLETED,pt,I),c.on(s.default.DATA_UPDATE_COMPLETED,gt,I),c.on(s.default.INBAND_EVENTS,mt,I),I}T.__dashjs_factory_name="Stream",n.default=p.default.getClassFactory(T)})),Ji=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=s(v),i=s(m),r=s(h),o=s(y),u=s(Oe),a=s(l);function s(t){return t&&t.__esModule?t:{default:t}}function f(){var t,n=this.context,r=(0,e.default)(n).getInstance(),s=void 0,f=void 0,c=void 0,l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0;function y(){f=NaN,d=!1,l=!0,w()}function w(){null!==c&&(clearTimeout(c),c=null)}function b(t){w(),isNaN(t)&&!isNaN(f)&&(t=1e3*f),isNaN(t)||(s.debug("Refresh manifest in "+t+" milliseconds."),c=setTimeout(N,t))}function M(){d=!0;var t=v.getValue(),n=t.url,e=p.getLocation(t);e&&(n=e),h.load(n)}function T(t){if(v.getValue()&&v.getValue().type===a.default.DYNAMIC&&t.type===a.default.STATIC)r.trigger(i.default.DYNAMIC_STREAM_COMPLETED);else{v.setValue(t);var n=new Date,e=(n.getTime()-t.loadedTime.getTime())/1e3;1e3*(f=p.getManifestUpdatePeriod(t,e))>2147483647&&(f=2147483.647),r.trigger(i.default.MANIFEST_UPDATED,{manifest:t}),s.info("Manifest has been refreshed at "+n+"["+n.getTime()/1e3+"] "),l||b()}}function N(){l||(d?b(m.get().streaming.manifestUpdateRetryInterval):M())}function _(t){t.error?t.error.code===u.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&g.error(t.error):T(t.manifest)}function S(){l=!1,b()}function C(){(l=!m.get().streaming.scheduleWhilePaused)&&w()}function E(){d=!1}return t={initialize:function(){y(),r.on(i.default.STREAMS_COMPOSED,E,this),r.on(i.default.PLAYBACK_STARTED,S,this),r.on(i.default.PLAYBACK_PAUSED,C,this),r.on(i.default.INTERNAL_MANIFEST_LOADED,_,this)},setManifest:function(t){T(t)},refreshManifest:M,setConfig:function(t){t&&(t.manifestModel&&(v=t.manifestModel),t.adapter&&(p=t.adapter),t.manifestLoader&&(h=t.manifestLoader),t.errHandler&&(g=t.errHandler),t.settings&&(m=t.settings))},reset:function(){r.off(i.default.PLAYBACK_STARTED,S,this),r.off(i.default.PLAYBACK_PAUSED,C,this),r.off(i.default.STREAMS_COMPOSED,E,this),r.off(i.default.INTERNAL_MANIFEST_LOADED,_,this),y()}},s=(0,o.default)(n).getInstance().getLogger(t),t}f.__dashjs_factory_name="ManifestUpdater",n.default=r.default.getClassFactory(f)})),Yi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(N),i=f(v),r=f(m),o=f(Oe),u=f(h),a=f(y),s=f(pi);function f(t){return t&&t.__esModule?t:{default:t}}function c(){var t,n=this.context,u=(0,i.default)(n).getInstance(),f=(0,s.default)(n).getInstance(),c=void 0,l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0;function m(t){d=t}function y(t){l=t}function w(t){var n=Date.parse(t);return isNaN(n)&&(n=function(t){var n=void 0,e=void 0,i=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(t);return n=Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10),i[6]&&(parseInt(i[6],10)||0),i[7]&&1e3*parseFloat(i[7])||0),i[9]&&i[10]&&(e=60*parseInt(i[9],10)+parseInt(i[10],10),n+=("+"===i[8]?-1:1)*e*60*1e3),new Date(n).getTime()}(t)),n}function M(t){return Date.parse(t)}function T(t){return Date.parse(t)}function N(t,n,e){e()}function _(t,n,e){var i=w(t);isNaN(i)?e():n(i)}function S(t,n,e,i,r){var o,u,a=!1,s=new XMLHttpRequest,c=r?b.HTTPRequest.HEAD:b.HTTPRequest.GET,l=n.match(/\S+/g);if(n=l.shift(),o=function(){a||(a=!0,l.length?S(t,l.join(" "),e,i,r):i())},u=function(){var n=void 0,i=void 0;200===s.status&&(n=r?s.getResponseHeader("Date"):s.response,i=t(n),isNaN(i)||(e(i),a=!0))},f.isRelative(n)){var d=g.resolve();d&&(n=f.resolve(n,d.url))}s.open(c,n),s.timeout=5e3,s.onload=u,s.onloadend=o,s.send()}function C(t,n,e){S(T,t,n,e,!0)}function E(t,n,i){m(!1),u.trigger(r.default.TIME_SYNCHRONIZATION_COMPLETED,{time:n,offset:i,error:t?new e.default(o.default.TIME_SYNC_FAILED_ERROR_CODE,o.default.TIME_SYNC_FAILED_ERROR_MESSAGE):null})}function k(t,n){var e=n||0,i=t[e],r=function(t,n){var e,i,r=!t||!n;r&&h?(i=null!==(e=p.getLatestMPDRequestHeaderValueByID("Date"))?new Date(e).getTime():Number.NaN,isNaN(i)?E(!0):(y(i-(new Date).getTime()),E(!1,i/1e3,l))):E(r,t,n)};m(!0),i?v.hasOwnProperty(i.schemeIdUri)?v[i.schemeIdUri](i.value,(function(t){var n=(new Date).getTime(),e=function(t,n){return t-n}(t,n);y(e),c.info("Local time: "+new Date(n)),c.info("Server time: "+new Date(t)),c.info("Server Time - Local Time (ms): "+e),r(t,e)}),(function(){k(t,e+1)})):k(t,e+1):(y(0),r())}return t={initialize:function(t,n){h=n,l=0,d=!1,v={"urn:mpeg:dash:utc:http-head:2014":C,"urn:mpeg:dash:utc:http-xsdate:2014":S.bind(null,w),"urn:mpeg:dash:utc:http-iso:2014":S.bind(null,M),"urn:mpeg:dash:utc:direct:2014":_,"urn:mpeg:dash:utc:http-head:2012":C,"urn:mpeg:dash:utc:http-xsdate:2012":S.bind(null,w),"urn:mpeg:dash:utc:http-iso:2012":S.bind(null,M),"urn:mpeg:dash:utc:direct:2012":_,"urn:mpeg:dash:utc:http-ntp:2014":N,"urn:mpeg:dash:utc:ntp:2014":N,"urn:mpeg:dash:utc:sntp:2014":N},d||k(t)},getOffsetToDeviceTimeMs:function(){return l},setConfig:function(t){t&&(t.dashMetrics&&(p=t.dashMetrics),t.baseURLController&&(g=t.baseURLController))},reset:function(){m(!1)}},c=(0,a.default)(n).getInstance().getLogger(t),t}c.__dashjs_factory_name="TimeSyncController";var l=u.default.getSingletonFactory(c);l.HTTP_TIMEOUT_MS=5e3,u.default.updateSingletonFactory(c.__dashjs_factory_name,l),n.default=l})),Zi=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(y);function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t,n=void 0;return t={createMediaSource:function(){var t="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:t?new WebKitMediaSource:null},attachMediaSource:function(t,n){var e=window.URL.createObjectURL(t);return n.setSource(e),e},detachMediaSource:function(t){t.setSource(null)},setDuration:function(t,n){return t.duration!=n&&(t.duration=n),t.duration},setSeekable:function(t,n,e){t&&"function"==typeof t.setLiveSeekableRange&&"function"==typeof t.clearLiveSeekableRange&&"open"===t.readyState&&n>=0&&n<e&&(t.clearLiveSeekableRange(),t.setLiveSeekableRange(n,e))},signalEndOfStream:function(t){if(t&&"open"===t.readyState){for(var e=t.sourceBuffers,i=0;i<e.length;i++){if(e[i].updating)return;if(0===e[i].buffered.length)return}n.info("call to mediaSource endOfStream"),t.endOfStream()}}},n=(0,i.default)(this.context).getInstance().getLogger(t),t}o.__dashjs_factory_name="MediaSourceController",n.default=e.default.getSingletonFactory(o)})),tr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(h),i=a(y),r=a(v),o=a(m),u=a(wi);function a(t){return t&&t.__esModule?t:{default:t}}function s(){var t,n="urn:mpeg:dash:event:2012",e=this.context,a=(0,r.default)(e).getInstance(),s=void 0,f=void 0,c=void 0,l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0;function y(){if(!v||!p)throw new Error("setConfig function has to be called previously")}function w(){m=!1,f={},c={},l={},d=null,g=!1,h=Date.now()/1e3}function b(t){try{if(1==t.eventStream.value){var n,e=t.eventStream.timescale||1,i=t.calculatedPresentationTime/e;s.info("Manifest validity changed: Valid until: "+i+"; remaining duration: "+(n=4294967295==t.calculatedPresentationTime?NaN:(t.calculatedPresentationTime+t.duration)/e)),a.trigger(o.default.MANIFEST_VALIDITY_CHANGED,{id:t.id,validUntil:i,newDuration:n,newManifestValidAfter:NaN})}}catch(t){}}function M(){try{if(!g){var t=p.getTime(),n=t-h;n=h>0?Math.max(0,n):0,T(c,n,t),T(f,n,t),function(){try{if(l)for(var t=p.getTime(),n=Object.keys(l),e=0;e<n.length;e++){var i=n[e],r=l[i];null!==r&&(r.duration+r.calculatedPresentationTime)/r.eventStream.timescale<t&&(s.debug("Remove Event "+i+" at time "+t),r=null,delete l[i])}}catch(t){}}(),h=t}g=!1}catch(t){g=!1}}function T(t,n,e){try{if(t)for(var i=Object.keys(t),r=0;r<i.length;r++){var o=i[r],u=t[o];if(void 0!==u){var a=u.calculatedPresentationTime/u.eventStream.timescale;a<=e&&a+n>=e?C(o,u,t):(N(e,n,a)||_(u))&&(s.debug("Deleting event "+o+" as it is expired or invalid"),delete t[o])}}}catch(t){}}function N(t,n,e){try{return t-n>e}catch(t){return!1}}function _(t){try{return t.calculatedPresentationTime/1e3>t.eventStream.period.start+t.eventStream.period.duration}catch(t){return!1}}function S(t){try{var n=Object.keys(t),e=p.getTime();if(!n||0===n.length)return;var i=t[n[0]].eventStream&&t[n[0]].eventStream.period&&!isNaN(t[n[0]].eventStream.period.duration)?t[n[0]].eventStream.period.duration:NaN,r=t[n[0]].eventStream&&t[n[0]].eventStream.period&&!isNaN(t[n[0]].eventStream.period.start)?t[n[0]].eventStream.period.start:NaN;if(isNaN(i)||isNaN(r))return;n.forEach((function(n){var i=t[n];Math.abs(i.calculatedPresentationTime/i.eventStream.timescale-e)<300&&C(n,i,t)}))}catch(t){}}function C(t,i,r){try{var o=p.getTime();i.duration>0&&(l[t]=i),i.eventStream.schemeIdUri===n&&1==i.eventStream.value?0===i.duration&&0===i.presentationTimeDelta||(s.debug("Starting manifest refresh event "+t+" at "+o),function(){try{y(),v.refreshManifest()}catch(t){}}()):"urn:mpeg:dash:event:callback:2015"===i.eventStream.schemeIdUri&&1==i.eventStream.value?(s.debug("Starting callback event "+t+" at "+o),function(t){try{(0,u.default)(e).create({}).load({method:"get",url:t,request:{responseType:"arraybuffer"}})}catch(t){throw t}}(i.messageData)):(s.debug("Starting event "+t+" at "+o),a.trigger(i.eventStream.schemeIdUri,{event:i})),delete r[t]}catch(t){}}return t={addInlineEvents:function(t){try{if(y(),t)for(var n=0;n<t.length;n++){var e=t[n];f[e.id]=e,s.debug("Add inline event with id "+e.id)}s.debug("Added "+t.length+" inline events")}catch(t){throw t}},addInbandEvents:function(t){try{y();for(var e=0;e<t.length;e++){var i=t[e];i.id in c?s.debug("Repeated event with id "+i.id):(i.eventStream.schemeIdUri===n&&void 0===c[i.id]&&b(i),c[i.id]=i,s.debug("Add inband event with id "+i.id))}M()}catch(t){throw t}},start:function(){try{y(),s.debug("Start Event Controller"),m||isNaN(100)||(m=!0,d=setInterval(M,100))}catch(t){throw t}},setConfig:function(t){try{if(!t)return;t.manifestUpdater&&(v=t.manifestUpdater),t.playbackController&&(p=t.playbackController)}catch(t){throw t}},reset:function(){(function(){try{null!==d&&m&&(clearInterval(d),d=null,m=!1,function(){try{S(c),S(f)}catch(t){}}())}catch(t){throw t}})(),w()}},s=(0,i.default)(e).getInstance().getLogger(t),w(),t}s.__dashjs_factory_name="EventController",n.default=e.default.getSingletonFactory(s)})),nr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=S(c),i=S(d),r=S(Qi),o=S(Ji),u=S(v),a=S(m),s=S(h),f=S(y),l=S(Je),p=S(pi),g=S(Mi),w=S(Yi),b=S(Zi),M=S(N),T=S(Oe),_=S(tr);function S(t){return t&&t.__esModule?t:{default:t}}function C(){var t,n=this.context,s=(0,u.default)(n).getInstance(),c=void 0,d=void 0,h=void 0,v=void 0,m=void 0,y=void 0,N=void 0,S=void 0,C=void 0,E=void 0,k=void 0,O=void 0,R=void 0,I=void 0,D=void 0,x=void 0,A=void 0,j=void 0,F=void 0,P=void 0,B=void 0,L=void 0,U=void 0,q=void 0,z=void 0,H=void 0,K=void 0,V=void 0,W=void 0,G=void 0,$=void 0,X=void 0,Q=void 0,J=void 0,Y=void 0,Z=void 0,tt=void 0,nt=void 0;function et(){if(Nt()){var t=V.getPlaybackQuality();t&&N.addDroppedFrames(t)}}function it(t){var n=lt(t.seekTime);n===P&&Z&&Z.length>0&&Z.forEach((function(t){t.deactivate(!0)})),n&&n!==P?(St(gi.PlayListTrace.END_OF_PERIOD_STOP_REASON),pt(n,P,t.seekTime)):St(gi.PlayListTrace.USER_REQUEST_STOP_REASON),Ct(gi.PlayList.SEEK_START_REASON)}function rt(t){var n=vt();St(gi.PlayListTrace.END_OF_PERIOD_STOP_REASON),pt(n,P,t.seekTime),Ct(gi.PlayList.SEEK_START_REASON)}function ot(){c.debug("[onPlaybackStarted]"),X?(X=!1,Ct(gi.PlayList.INITIAL_PLAYOUT_START_REASON)):$&&($=!1,Ct(gi.PlayList.RESUME_FROM_PAUSE_START_REASON))}function ut(t){c.debug("[onPlaybackPaused]"),t.ended||($=!0,St(gi.PlayListTrace.USER_REQUEST_STOP_REASON))}function at(){Q&&(clearInterval(Q),Q=null)}function st(t){try{if(!t)return!1;var n=t.getProcessors().filter((function(t){return t.getType()===e.default.AUDIO||t.getType()===e.default.VIDEO}));if(!n||0===n.length)return!1;var i=n.filter((function(t){return!t.isBufferingCompleted()}));return i&&0===i.length}catch(t){return!1}}function ft(){var t=kt().isLast;K&&t&&(c.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),S.signalEndOfStream(K))}function ct(t,n){try{return n.isProtectionCompatible(t,n)&&(tt||n.isMediaCodecCompatible(t,n))&&!function(t){try{var n=t.getStreamInfo(),i=y.getAdaptationForType(n.index,e.default.FRAGMENTED_TEXT,n);return!!i&&(-1!==i.codecs.indexOf("stpp")||-1!==i.codecs.indexOf("wvtt"))}catch(t){return!1}}(t)}catch(t){return!1}}function lt(t){if(isNaN(t))return null;var n=0,e=null,i=F.length;i>0&&(n+=F[0].getStartTime());for(var r=0;r<i;r++)if(e=F[r],t<(n=parseFloat((n+e.getDuration()).toFixed(5))))return e;return null}function dt(){return P?P.getProcessors():[]}function ht(t){if(!P.getIsEndedEventSignaled()){P.setIsEndedEventSignaled(!0);var n=vt();n?(c.debug("StreamController onEnded, found next stream with id "+n.getStreamInfo().id),pt(n,P,NaN)):(c.debug("StreamController no next stream found"),P.setIsEndedEventSignaled(!1)),St(n?gi.PlayListTrace.END_OF_PERIOD_STOP_REASON:gi.PlayListTrace.END_OF_CONTENT_STOP_REASON)}t&&t.isLast&&at()}function vt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=t||P||null;if(n){for(var e=n.getStreamInfo().start,i=n.getStreamInfo().duration,r=parseFloat((e+i).toFixed(5)),o=0,u=-1,a=NaN;o<F.length;){var s=F[o],f=s.getStreamInfo().start-r;f>=0&&(isNaN(a)||f<a)&&(a=f,u=o),o+=1}return u>=0?F[u]:null}return null}function pt(t,n,e){if(!(q||!t||n===t&&t.isActive())){q=!0,s.trigger(a.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:n?n.getStreamInfo():null,toStreamInfo:t.getStreamInfo()});var i=!1;n&&(i=ct(t,n),n.deactivate(i)),e=isNaN(e)?!i&&n?t.getStreamInfo().start:NaN:e,c.info("Switch to stream "+t.getId()+". Seektime is "+e+", current playback time is "+W.getTime()),c.info("Seamless period switch is set to "+i),P=t,Z=Z.filter((function(t){return t.getId()!==P.getId()})),W.initialize(kt(),!!n,e),V.getElement()?gt(e,null===n,!1,i):mt(e,i)}}function gt(t,n,e,i){var r=void 0;function o(){K&&"open"===K.readyState&&(c.debug("MediaSource is open!"),window.URL.revokeObjectURL(r),K.removeEventListener("sourceopen",o),K.removeEventListener("webkitsourceopen",o),yt(),n||s.trigger(a.default.SOURCE_INITIALIZED),e?P.setMediaSource(K):mt(t,i))}K?i?(mt(t,i),n||s.trigger(a.default.SOURCE_INITIALIZED)):(S.detachMediaSource(V),K.addEventListener("sourceopen",o,!1),K.addEventListener("webkitsourceopen",o,!1),r=S.attachMediaSource(K,V),c.debug("MediaSource attached to element.  Waiting on open...")):((K=S.createMediaSource()).addEventListener("sourceopen",o,!1),K.addEventListener("webkitsourceopen",o,!1),r=S.attachMediaSource(K,V),c.debug("MediaSource attached to element.  Waiting on open..."))}function mt(t,n){if(Y=P.activate(K,n?Y:void 0)){var e=Object.keys(Y);e.length>0&&Y[e[0]].changeType&&(tt=!0)}X||isNaN(t)||(t===W.getTime()?s.trigger(a.default.SEEK_TARGET,{time:t,streamId:P.getId()}):W.seek(t)),!U&&X||W.play(),q=!1,s.trigger(a.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:kt()})}function yt(t){var n=t||kt().manifestInfo.duration;if(n&&!isNaN(n)){var e=S.setDuration(K,n);c.debug("Duration successfully set to: "+e)}}function wt(t){for(var n=0,e=F.length;n<e;n++)if(F[n].getId()===t.id)return F[n];return null}function bt(){try{var t=y.getStreamsInfo();if(0===t.length)throw new Error("There are no streams");N.updateManifestUpdateInfo({currentTime:W.getTime(),buffered:V.getBufferRange(),presentationStartTime:t[0].start,clientTimeOffset:j.getClientTimeOffset()}),F.length>0&&(F=F.filter((function(n){var e=t.filter((function(t){return t.id===n.getId()})).length>0||n.getId()===P.getId();return e||c.debug("Removing stream "+n.getId()),e})));for(var i=0,o=t.length;i<o;i++){var u=t[i],f=wt(u);f?f.updateData(u):(f=(0,r.default)(n).create({manifestModel:m,mediaPlayerModel:G,dashMetrics:N,manifestUpdater:h,adapter:y,timelineConverter:j,capabilities:d,errHandler:A,baseURLController:E,abrController:k,playbackController:W,eventController:R,mediaController:O,textController:I,videoModel:V,settings:nt}),F.push(f),f.initialize(u,B)),N.addManifestUpdateStreamInfo(u)}if(!P){if(y.getIsDynamic()&&F.length){var l=t[0].manifestInfo,v=function(t,n){try{var i=NaN;if(n&&!isNaN(n.maxFragmentDuration)&&isFinite(n.maxFragmentDuration))return n.maxFragmentDuration;if(t&&1===t.length){var r=t[0],o=[e.default.VIDEO,e.default.AUDIO,e.default.FRAGMENTED_TEXT].reduce((function(t,n){var e=y.getMediaInfoForType(r,n);return e&&t.push(e),t}),[]).reduce((function(t,n){var e=y.getVoRepresentations(n);return e&&e.length>0&&e.forEach((function(n){n&&t.push(n)})),t}),[]).reduce((function(t,n){var e=y.convertDataToRepresentationInfo(n);return e&&e.fragmentDuration&&!isNaN(e.fragmentDuration)&&t.push(e.fragmentDuration),t}),[]);i=Math.max.apply(Math,function(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}(o))}return isFinite(i)?i:NaN}catch(t){return NaN}}(t,l);W.computeAndSetLiveDelay(v,l.DVRWindowSize,l.minBufferTime)}var p=null;!(p=lt(W.getStartTimeFromUriParameters(t[0].start,y.getIsDynamic())))&&y.getIsDynamic()&&F.length&&(c.debug("Dynamic stream: Trying to find the correct starting period"),p=function(){try{return lt(j.calcPresentationTimeFromWallTime(new Date,y.getRegularPeriods()[0])-W.getLiveDelay())}catch(t){return null}}()),pt(null!==p?p:F[0],null,NaN),Q||(Q=setInterval((function(){!q&&W.getTimeToStreamEnd()<=0&&s.trigger(a.default.PLAYBACK_ENDED,{isLast:kt().isLast})}),200)),J||(J=setInterval((function(){!function(){if(P&&st(P))for(var t=function(t){try{var n=t||P||null;if(n){var e=n.getStreamInfo().start;return F.filter((function(t){return t.getStreamInfo().start>e}))}}catch(t){return[]}}(P),n=0,i=function(){var i=t[n],r=0===n?P:t[n-1];if(!i.getPreloadingScheduled()&&st(r)&&K){var o=!0;[e.default.VIDEO,e.default.AUDIO].forEach((function(t){var n=y.getMediaInfoForType(i.getStreamInfo(),t);y.getVoRepresentations(n).forEach((function(t){var n=j.calcSegmentAvailabilityRange(t,!0);n.end<n.start&&(o=!1)}))})),o&&function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;K&&!t.getPreloaded()&&ct(t,n)&&(t.setPreloadingScheduled(!0),c.info("[onStreamCanLoadNext] Preloading next stream with id "+t.getId()),t.preload(K,Y),Z.push(t),t.getProcessors().forEach((function(n){n.setBufferingTime(t.getStartTime())})))}(i,r)}n+=1};n<t.length;)i()}()}),500))}s.trigger(a.default.STREAMS_COMPOSED)}catch(t){A.error(new M.default(T.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,t.message+"nostreamscomposed",m.getValue())),H=!0,Dt()}}function Mt(){var t=m.getValue();B&&(s.trigger(a.default.PROTECTION_CREATED,{controller:B,manifest:t}),B.setMediaElement(V.getElement()),L&&B.setProtectionData(L)),bt()}function Tt(t){if(t.error)H=!0,Dt();else{var n=t.manifest;y.updatePeriods(n);var e=y.getUTCTimingSources(),i=y.getIsDynamic()?e.concat(G.getUTCTimingSources()):e,r=x.isHTTPS(t.manifest.url);i.forEach((function(t){t.value.replace(/.*?:\/\//g,"")===G.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(t.value=t.value.replace(r?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),r?"https://":"http://"),c.debug("Matching default timing source protocol to manifest protocol: ",t.value))})),E.initialize(n),C.setConfig({dashMetrics:N,baseURLController:E}),C.initialize(i,nt.get().streaming.useManifestDateHeaderTimeSource)}}function Nt(){return!!P&&P.getHasVideoTrack()}function _t(){return!!P&&P.getHasAudioTrack()}function St(t,n){n=n||new Date,dt().forEach((function(e){e.finalisePlayList(n,t)})),N.addPlayList()}function Ct(t){N.createPlaylistMetrics(1e3*W.getTime(),t)}function Et(t){if(t.error){var n="";switch(t.error.code){case 1:n="MEDIA_ERR_ABORTED";break;case 2:n="MEDIA_ERR_NETWORK";break;case 3:n="MEDIA_ERR_DECODE";break;case 4:n="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:n="MEDIA_ERR_ENCRYPTED";break;default:n="UNKNOWN"}z=!0,t.error.message&&(n+=" ("+t.error.message+")"),t.error.msExtendedCode&&(n+=" (0x"+(t.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),c.fatal("Video Element Error: "+n),t.error&&c.fatal(t.error),A.error(new M.default(t.error.code,n)),Dt()}}function kt(){return P?P.getStreamInfo():null}function Ot(){if(!(v&&v.hasOwnProperty("load")&&j&&j.hasOwnProperty("initialize")&&j.hasOwnProperty("reset")&&j.hasOwnProperty("getClientTimeOffset")&&m&&A&&N&&W))throw new Error(e.default.MISSING_CONFIG_ERROR)}function Rt(t){isNaN(t.newDuration)||yt(t.newDuration)}function It(){F=[],B=null,q=!1,P=null,z=!1,H=!1,X=!0,$=!1,U=!0,Q=null,J=null,Z=[]}function Dt(){Ot(),C.reset(),St(z||H?gi.PlayListTrace.FAILURE_STOP_REASON:gi.PlayListTrace.USER_REQUEST_STOP_REASON);for(var t=0,n=F?F.length:0;t<n;t++)F[t].reset(z);!function(){s.off(a.default.PLAYBACK_TIME_UPDATED,et,this),s.off(a.default.PLAYBACK_SEEKING,it,this),s.off(a.default.GAP_CAUSED_SEEK_TO_PERIOD_END,rt,this),s.off(a.default.PLAYBACK_ERROR,Et,this),s.off(a.default.PLAYBACK_STARTED,ot,this),s.off(a.default.PLAYBACK_PAUSED,ut,this),s.off(a.default.PLAYBACK_ENDED,ht,this),s.off(a.default.MANIFEST_UPDATED,Tt,this),s.off(a.default.STREAM_BUFFERING_COMPLETED,ft,this),s.off(a.default.MANIFEST_VALIDITY_CHANGED,Rt,this),s.off(a.default.TIME_SYNCHRONIZATION_COMPLETED,Mt,this),s.off(g.default.METRIC_ADDED,xt,this)}(),E.reset(),h.reset(),R.reset(),N.clearAllCurrentMetrics(),m.setValue(null),v.reset(),j.reset(),D.reset(),K&&(S.detachMediaSource(V),K=null),V=null,B&&(B.setMediaElement(null),B=null,L=null,m.getValue()&&s.trigger(a.default.PROTECTION_DESTROYED,{data:m.getValue().url})),at(),clearInterval(J),J=null,s.trigger(a.default.STREAM_TEARDOWN_COMPLETE),It()}function xt(t){if(t.metric===i.default.DVR_INFO){var n=_t()?e.default.AUDIO:e.default.VIDEO;t.mediaType===n&&S.setSeekable(K,t.value.range.start,t.value.range.end)}}return t={initialize:function(t,e){Ot(),U=t,L=e,j.initialize(),(h=(0,o.default)(n).create()).setConfig({manifestModel:m,adapter:y,manifestLoader:v,errHandler:A,settings:nt}),h.initialize(),(R=(0,_.default)(n).getInstance()).setConfig({manifestUpdater:h,playbackController:W}),R.start(),function(){s.on(a.default.PLAYBACK_TIME_UPDATED,et,this),s.on(a.default.PLAYBACK_SEEKING,it,this),s.on(a.default.GAP_CAUSED_SEEK_TO_PERIOD_END,rt,this),s.on(a.default.PLAYBACK_ERROR,Et,this),s.on(a.default.PLAYBACK_STARTED,ot,this),s.on(a.default.PLAYBACK_PAUSED,ut,this),s.on(a.default.PLAYBACK_ENDED,ht,this),s.on(a.default.MANIFEST_UPDATED,Tt,this),s.on(a.default.STREAM_BUFFERING_COMPLETED,ft,this),s.on(a.default.MANIFEST_VALIDITY_CHANGED,Rt,this),s.on(a.default.TIME_SYNCHRONIZATION_COMPLETED,Mt,this),s.on(g.default.METRIC_ADDED,xt,this)}()},getActiveStreamInfo:kt,hasVideoTrack:Nt,hasAudioTrack:_t,switchToVideoElement:function(t){P&&(W.initialize(kt()),gt(t,!1,!0,!1))},getStreamById:function(t){return F.filter((function(n){return n.getId()===t}))[0]},getStreamForTime:lt,getTimeRelativeToStreamId:function(t,n){for(var e=null,i=0,r=0,o=null,u=0;u<F.length;u++){if(r=(e=F[u]).getStartTime(),o=e.getDuration(),Number.isFinite(r)&&(i=r),e.getId()===n)return t-i;Number.isFinite(o)&&(i+=o)}return null},load:function(t){Ot(),v.load(t)},loadWithManifest:function(t){!function(){if(!h||!h.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),h.setManifest(t)},getActiveStreamProcessors:dt,setConfig:function(t){t&&(t.capabilities&&(d=t.capabilities),t.manifestLoader&&(v=t.manifestLoader),t.manifestModel&&(m=t.manifestModel),t.mediaPlayerModel&&(G=t.mediaPlayerModel),t.protectionController&&(B=t.protectionController),t.adapter&&(y=t.adapter),t.dashMetrics&&(N=t.dashMetrics),t.errHandler&&(A=t.errHandler),t.timelineConverter&&(j=t.timelineConverter),t.videoModel&&(V=t.videoModel),t.playbackController&&(W=t.playbackController),t.abrController&&(k=t.abrController),t.mediaController&&(O=t.mediaController),t.textController&&(I=t.textController),t.settings&&(nt=t.settings),t.baseURLController&&(E=t.baseURLController))},setProtectionData:function(t){L=t},getIsStreamSwitchInProgress:function(){return q},getHasMediaOrIntialisationError:function(){return z||H},hasStreamFinishedBuffering:st,getStreams:function(){return F},getActiveStream:function(){return P},reset:Dt},c=(0,f.default)(n).getInstance().getLogger(t),C=(0,w.default)(n).getInstance(),S=(0,b.default)(n).getInstance(),D=(0,l.default)(n).getInstance(),x=(0,p.default)(n).getInstance(),It(),t}C.__dashjs_factory_name="StreamController",n.default=s.default.getSingletonFactory(C)})),er=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=u(h),i=u(y),r=u(m),o=u(v);function u(t){return t&&t.__esModule?t:{default:t}}function a(){var t,n=this.context,e=(0,o.default)(n).getInstance(),u=void 0,a=void 0,s=void 0,f=void 0,c=void 0,l=void 0,d=void 0,h=void 0,v=void 0;function p(){v.debug("Stopping the gap controller"),f&&(clearInterval(f),f=null),function(){e.off(r.default.WALLCLOCK_TIME_UPDATED,y,this),e.off(r.default.BYTES_APPENDED_END_FRAGMENT,g,this)}(),f=null,c=NaN,s=0}function g(){f||function(){try{f||(v.debug("Starting the gap controller"),f=setInterval((function(){m()&&b(l.getTime())}),100))}catch(t){}}()}function m(){return a.get().streaming.jumpGaps&&d.getActiveStreamProcessors().length>0&&(!l.isSeeking()||d.hasStreamFinishedBuffering(d.getActiveStream()))&&!l.isPaused()&&!d.getIsStreamSwitchInProgress()&&!d.getHasMediaOrIntialisationError()}function y(){if(m()&&++s>=10){var t=l.getTime();u===t?b(t,!0):(u=t,c=NaN),s=0}}function w(t){try{var n=h.getBufferRange();if(!n||n.length<=1&&t>0)return null;for(var e=null,i=0;!e&&i<n.length;){var r=i>0?n.end(i-1):0;t<n.start(i)&&r-t<.1&&(e=n.start(i)),i+=1}return e}catch(t){return null}}function b(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=a.get().streaming.smallGapLimit,o=a.get().streaming.jumpLargeGaps,u=null,s=NaN,f=!1;if((u=w(t))&&u>0){var h=u-t;h>0&&(h<=i||o)&&(s=u)}var p=l.getTimeToStreamEnd();isNaN(s)&&n&&isFinite(p)&&!isNaN(p)&&(p<i||d.hasStreamFinishedBuffering(d.getActiveStream()))&&(s=parseFloat(l.getStreamEndTime().toFixed(5)),f=!0),s>0&&c!==s&&(f?(v.warn("Jumping to end of stream because of gap from "+t+" to "+s+". Gap duration: "+(s-t)),e.trigger(r.default.GAP_CAUSED_SEEK_TO_PERIOD_END,{seekTime:s})):(v.warn("Jumping gap from "+t+" to "+s+". Gap duration: "+(s-t)),l.seek(s,!0,!0)),c=s)}return t={reset:p,setConfig:function(t){t&&(t.settings&&(a=t.settings),t.playbackController&&(l=t.playbackController),t.streamController&&(d=t.streamController),t.videoModel&&(h=t.videoModel))},initialize:function(){!function(){e.on(r.default.WALLCLOCK_TIME_UPDATED,y,this),e.on(r.default.BYTES_APPENDED_END_FRAGMENT,g,this)}()}},v=(0,i.default)(n).getInstance().getLogger(t),p(),t}a.__dashjs_factory_name="GapController",n.default=e.default.getSingletonFactory(a)})),ir=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(Fi),i=r(h);function r(t){return t&&t.__esModule?t:{default:t}}var o=NaN,u=function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.data={baseUrls:n||null,selectedIdx:e||o},this.children=[]};function a(){var t,n=void 0,i=void 0,r=(0,e.default)(this.context).getInstance();function a(t,n,e){var a=i.getBaseURLsFromElement(e);t[n]?r.areEqual(a,t[n].data.baseUrls)||(t[n].data.baseUrls=a,t[n].data.selectedIdx=o):t[n]=new u(a)}function s(t,e){var i=e||n;t(i.data),i.children&&i.children.forEach((function(n){return s(t,n)}))}function f(){n=new u}return t={reset:f,update:function(t){!function(t){!function(){if(!i||!i.hasOwnProperty("getBaseURLsFromElement")||!i.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var e=i.getBaseURLsFromElement(t);r.areEqual(e,n.data.baseUrls)||(n.data.baseUrls=e,n.data.selectedIdx=o),t&&t.Period_asArray&&t.Period_asArray.forEach((function(t,e){a(n.children,e,t),t.AdaptationSet_asArray&&t.AdaptationSet_asArray.forEach((function(t,r){a(n.children[e].children,r,t),t.Representation_asArray&&t.Representation_asArray.sort(i.getRepresentationSortFunction()).forEach((function(t,i){a(n.children[e].children[r].children,i,t)}))}))}))}(t)},getForPath:function(t){var e=n,i=[e.data];return t&&t.forEach((function(t){(e=e.children[t])&&i.push(e.data)})),i.filter((function(t){return t.baseUrls.length}))},invalidateSelectedIndexes:function(t){s((function(n){isNaN(n.selectedIdx)||t===n.baseUrls[n.selectedIdx].serviceLocation&&(n.selectedIdx=o)}))},setConfig:function(t){t.adapter&&(i=t.adapter)}},f(),t}a.__dashjs_factory_name="BaseURLTreeModel",n.default=i.default.getClassFactory(a)})),rr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(h),i=r(v);function r(t){return t&&t.__esModule?t:{default:t}}function o(t){t=t||{};var n=[],e=(0,i.default)(this.context).getInstance(),r=t.updateEventName,o=t.addBlacklistEventName;function u(t){-1===n.indexOf(t)&&(n.push(t),e.trigger(r,{entry:t}))}function a(t){u(t.entry)}return function(){o&&e.on(o,a,this)}(),{add:u,contains:function(t){return!!(n.length&&t&&t.length)&&-1!==n.indexOf(t)},reset:function(){n=[]}}}o.__dashjs_factory_name="BlackListController",n.default=e.default.getClassFactory(o)})),or=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(t){var n=(t=t||{}).blacklistController;return{select:function(t){return t&&function(t){var n=0,e=[],i=0,r=void 0,o=void 0;if((o=t.sort((function(t,n){var e=t.dvb_priority-n.dvb_priority;return isNaN(e)?0:e})).filter((function(t,n,e){return!n||e[0].dvb_priority&&t.dvb_priority&&e[0].dvb_priority===t.dvb_priority}))).length)return o.length>1&&(o.forEach((function(t){e.push(n+=t.dvb_weight)})),r=Math.floor(Math.random()*(n-1)),e.every((function(t,n){return i=n,!(r<t)}))),o[i]}((e=[],t.filter((function(t){return!n.contains(t.serviceLocation)||(t.dvb_priority&&e.push(t.dvb_priority),!1)})).filter((function(t){return!e.length||!t.dvb_priority||-1===e.indexOf(t.dvb_priority)}))));var e}}}r.__dashjs_factory_name="DVBSelector",n.default=i.default.getClassFactory(r)})),ur=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(t){var n=(t=t||{}).blacklistController;return{select:function(t){var e=0,i=void 0;return t&&t.some((function(t,i){return e=i,!n.contains(t.serviceLocation)}))&&(i=t[e]),i}}}r.__dashjs_factory_name="BasicSelector",n.default=i.default.getClassFactory(r)})),ar=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=c(Oe),i=c(v),r=c(m),o=c(rr),u=c(or),a=c(ur),s=c(h),f=c(N);function c(t){return t&&t.__esModule?t:{default:t}}function l(){var t,n=this.context,s=(0,i.default)(n).getInstance(),c=void 0,l=void 0,d=void 0,h=void 0;function v(){c.reset()}return t={chooseSelector:function(t){(0,R.checkParameterType)(t,"boolean"),h=t?d:l},select:function(t){if(t){var n=t.baseUrls,i=t.selectedIdx;if(!isNaN(i))return n[i];var o=h.select(n);return o?(t.selectedIdx=n.indexOf(o),o):(s.trigger(r.default.URL_RESOLUTION_FAILED,{error:new f.default(e.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,e.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(h===l&&v()))}},reset:v,setConfig:function(t){t.selector&&(h=t.selector)}},c=(0,o.default)(n).create({updateEventName:r.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:r.default.SERVICE_LOCATION_BLACKLIST_ADD}),l=(0,a.default)(n).create({blacklistController:c}),d=(0,u.default)(n).create({blacklistController:c}),h=l,t}l.__dashjs_factory_name="BaseURLSelector",n.default=s.default.getClassFactory(l)})),sr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(ir),i=f(ar),r=f(pi),o=f(Ri),u=f(h),a=f(v),s=f(m);function f(t){return t&&t.__esModule?t:{default:t}}function c(){var t,n=void 0,u=this.context,f=(0,a.default)(u).getInstance(),c=(0,r.default)(u).getInstance(),l=void 0,d=void 0;return t={reset:function(){l.reset(),d.reset()},initialize:function(t){var e;l.setConfig({adapter:n}),l.update(e=t),d.chooseSelector(n.getIsDVB(e))},resolve:function(t){var n=l.getForPath(t).reduce((function(t,n){var e=d.select(n);return e?(c.isRelative(e.url)?t.url=c.resolve(e.url,t.url):(t.url=e.url,t.serviceLocation=e.serviceLocation),t.availabilityTimeOffset=e.availabilityTimeOffset,t.availabilityTimeComplete=e.availabilityTimeComplete,t):new o.default}),new o.default);if(!c.isRelative(n.url))return n},setConfig:function(t){t.baseURLTreeModel&&(l=t.baseURLTreeModel),t.baseURLSelector&&(d=t.baseURLSelector),t.adapter&&(n=t.adapter)}},l=(0,e.default)(u).create(),d=(0,i.default)(u).create(),f.on(s.default.SERVICE_LOCATION_BLACKLIST_CHANGED,(function(t){l.invalidateSelectedIndexes(t.entry)}),t),t}c.__dashjs_factory_name="BaseURLController",n.default=u.default.getClassFactory(c)})),fr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=i(c);function i(t){return t&&t.__esModule?t:{default:t}}var r=function(t){function n(t,i){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var r=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return r.url=t||null,r.type=i||null,r.mediaType=e.default.STREAM,r.responseType="",r}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(i(M).default);n.default=r})),cr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(N),i=f(Ki),r=f(fr),o=f(v),u=f(m),a=f(h),s=f(Oe);function f(t){return t&&t.__esModule?t:{default:t}}function c(t){t=t||{};var n=this.context,a=(0,o.default)(n).getInstance(),f=(0,i.default)(n).create({errHandler:t.errHandler,dashMetrics:t.dashMetrics,mediaPlayerModel:t.mediaPlayerModel,requestModifier:t.requestModifier,useFetch:t.settings?t.settings.get().streaming.lowLatencyEnabled:null,errors:s.default});return{load:function(t,n,i){var o=function(r,o){n.resolved=!0,n.resolvedContent=r||null,a.trigger(u.default.XLINK_ELEMENT_LOADED,{element:n,resolveObject:i,error:r||o?null:new e.default(s.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,s.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+t)})};if("urn:mpeg:dash:resolve-to-zero:2013"===t)o(null,!0);else{var c=new r.default(t,b.HTTPRequest.XLINK_EXPANSION_TYPE);f.load({request:c,success:function(t){o(t)},error:function(){o(null)}})}},reset:function(){f&&(f.abort(),f=null)}}}c.__dashjs_factory_name="XlinkLoader",n.default=a.default.getClassFactory(c)})),lr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){void 0===(t=t||{}).escapeMode&&(t.escapeMode=!0),void 0===t.attributePrefix&&(t.attributePrefix="_"),t.arrayAccessForm=t.arrayAccessForm||"none",t.emptyNodeForm=t.emptyNodeForm||"text",void 0===t.enableToStringFunc&&(t.enableToStringFunc=!0),t.arrayAccessFormPaths=t.arrayAccessFormPaths||[],void 0===t.skipEmptyTextNodesForObj&&(t.skipEmptyTextNodesForObj=!0),void 0===t.stripWhitespaces&&(t.stripWhitespaces=!0),t.datetimeAccessFormPaths=t.datetimeAccessFormPaths||[],void 0===t.useDoubleQuotes&&(t.useDoubleQuotes=!1),t.xmlElementsFilter=t.xmlElementsFilter||[],t.jsonPropertiesFilter=t.jsonPropertiesFilter||[],void 0===t.keepCData&&(t.keepCData=!1),void 0===t.ignoreRoot&&(t.ignoreRoot=!1);function n(t){var n=t.localName;return null==n&&(n=t.baseName),null!=n&&""!=n||(n=t.nodeName),n}function e(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):t}function i(t,n,e,i){for(var r=0;r<t.length;r++){var o=t[r];if("string"==typeof o){if(o==i)break}else if(o instanceof RegExp){if(o.test(i))break}else if("function"==typeof o&&o(n,e,i))break}return r!=t.length}function r(n,e,r){switch(t.arrayAccessForm){case"property":n[e+"_asArray"]=n[e]instanceof Array?n[e]:[n[e]]}!(n[e]instanceof Array)&&t.arrayAccessFormPaths.length>0&&i(t.arrayAccessFormPaths,n,e,r)&&(n[e]=[n[e]])}function o(t){var n=t.split(/[-T:+Z]/g),e=new Date(n[0],n[1]-1,n[2]),i=n[5].split(".");if(e.setHours(n[3],n[4],i[0]),i.length>1&&e.setMilliseconds(i[1]),n[6]&&n[7]){var r=60*n[6]+Number(n[7]);r=0+("-"==(/\d\d-\d\d:\d\d$/.test(t)?"-":"+")?-1*r:r),e.setMinutes(e.getMinutes()-r-e.getTimezoneOffset())}else-1!==t.indexOf("Z",t.length-1)&&(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())));return e}function u(n,e,r,o){return!(1==e&&t.xmlElementsFilter.length>0)||i(t.xmlElementsFilter,n,r,o)}function a(e,s){if(9==e.nodeType){for(var f=new Object,c=e.childNodes,l=0;l<c.length;l++)1==(h=c[l]).nodeType&&(t.ignoreRoot?f=a(h):(f={})[v=n(h)]=a(h));return f}if(1==e.nodeType){(f=new Object).__cnt=0;var d=[];for(c=e.childNodes,l=0;l<c.length;l++){var h,v=n(h=c[l]);if(8!=h.nodeType){var p=s+"."+v;if(u(f,h.nodeType,v,p))if(f.__cnt++,null==f[v]){var g=a(h,p);("#text"!=v||/[^\s]/.test(g))&&((m={})[v]=g,d.push(m)),f[v]=g,r(f,v,p)}else{var m;null!=f[v]&&(f[v]instanceof Array||(f[v]=[f[v]],r(f,v,p))),g=a(h,p),("#text"!=v||/[^\s]/.test(g))&&((m={})[v]=g,d.push(m)),f[v][f[v].length]=g}}}f.__children=d;for(var y=n(e),w=0;w<e.attributes.length;w++){var b=e.attributes[w];f.__cnt++;for(var M=b.value,T=0,N=t.matchers.length;T<N;T++){var _=t.matchers[T];_.test(b,y)&&(M=_.converter(b.value))}f[t.attributePrefix+b.name]=M}var S=function(t){return t.prefix}(e);return null!=S&&""!=S&&(f.__cnt++,f.__prefix=S),null!=f["#text"]&&(f.__text=f["#text"],f.__text instanceof Array&&(f.__text=f.__text.join("\n")),t.stripWhitespaces&&(f.__text=f.__text.trim()),delete f["#text"],"property"==t.arrayAccessForm&&delete f["#text_asArray"],f.__text=function(n,e,r){if(t.datetimeAccessFormPaths.length>0){var u=r.split(".#")[0];return i(t.datetimeAccessFormPaths,n,e,u)?o(n):n}return n}(f.__text,v,s+"."+v)),null!=f["#cdata-section"]&&(f.__cdata=f["#cdata-section"],delete f["#cdata-section"],"property"==t.arrayAccessForm&&delete f["#cdata-section_asArray"]),0==f.__cnt&&"text"==t.emptyNodeForm?f="":1==f.__cnt&&null!=f.__text?f=f.__text:1!=f.__cnt||null==f.__cdata||t.keepCData?f.__cnt>1&&null!=f.__text&&t.skipEmptyTextNodesForObj&&(t.stripWhitespaces&&""==f.__text||""==f.__text.trim())&&delete f.__text:f=f.__cdata,delete f.__cnt,!t.enableToStringFunc||null==f.__text&&null==f.__cdata||(f.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),f}if(3==e.nodeType||4==e.nodeType)return e.nodeValue}function s(n,i,r,o){var u="<"+(null!=n&&null!=n.__prefix?n.__prefix+":":"")+i;if(null!=r)for(var a=0;a<r.length;a++){var s=r[a],f=n[s];t.escapeMode&&(f=e(f)),u+=" "+s.substr(t.attributePrefix.length)+"=",u+=t.useDoubleQuotes?'"'+f+'"':"'"+f+"'"}return u+(o?"/>":">")}function f(t,n){return"</"+(null!=t.__prefix?t.__prefix+":":"")+n+">"}function c(n,e){return"property"==t.arrayAccessForm&&-1!==(i=e.toString()).indexOf("_asArray",i.length-"_asArray".length)||0==e.toString().indexOf(t.attributePrefix)||0==e.toString().indexOf("__")||n[e]instanceof Function;var i}function l(t){var n=0;if(t instanceof Object)for(var e in t)c(t,e)||n++;return n}function d(n,e,r){return 0==t.jsonPropertiesFilter.length||""==r||i(t.jsonPropertiesFilter,n,e,r)}function h(n){var e=[];if(n instanceof Object)for(var i in n)-1==i.toString().indexOf("__")&&0==i.toString().indexOf(t.attributePrefix)&&e.push(i);return e}function v(n){var i="";return n instanceof Object?i+=function(n){var i="";return null!=n.__cdata&&(i+="<![CDATA["+n.__cdata+"]]>"),null!=n.__text&&(i+=t.escapeMode?e(n.__text):n.__text),i}(n):null!=n&&(i+=t.escapeMode?e(n):n),i}function p(t,n){return""===t?n:t+"."+n}function g(t,n,e,i){var r="";if(0==t.length)r+=s(t,n,e,!0);else for(var o=0;o<t.length;o++)r+=s(t[o],n,h(t[o]),!1),r+=m(t[o],p(i,n)),r+=f(t[o],n);return r}function m(t,n){var e="";if(l(t)>0)for(var i in t)if(!c(t,i)&&(""==n||d(t,i,p(n,i)))){var r=t[i],o=h(r);null==r||null==r?e+=s(r,i,o,!0):r instanceof Object?r instanceof Array?e+=g(r,i,o,n):r instanceof Date?(e+=s(r,i,o,!1),e+=r.toISOString(),e+=f(r,i)):l(r)>0||null!=r.__text||null!=r.__cdata?(e+=s(r,i,o,!1),e+=m(r,p(n,i)),e+=f(r,i)):e+=s(r,i,o,!0):(e+=s(r,i,o,!1),e+=v(r),e+=f(r,i))}return e+v(t)}this.parseXmlString=function(t){if(void 0===t)return null;var n;if(window.DOMParser){var e=new window.DOMParser;try{(n=e.parseFromString(t,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(n=null)}catch(t){n=null}}else 0==t.indexOf("<?")&&(t=t.substr(t.indexOf("?>")+2)),(n=new ActiveXObject("Microsoft.XMLDOM")).async="false",n.loadXML(t);return n},this.asArray=function(t){return void 0===t||null==t?[]:t instanceof Array?t:[t]},this.toXmlDateTime=function(t){return t instanceof Date?t.toISOString():"number"==typeof t?new Date(t).toISOString():null},this.asDateTime=function(t){return"string"==typeof t?o(t):t},this.xml2json=function(t){return a(t)},this.xml_str2json=function(t){var n=this.parseXmlString(t);return null!=n?this.xml2json(n):null},this.json2xml_str=function(t){return m(t,"")},this.json2xml=function(t){var n=this.json2xml_str(t);return this.parseXmlString(n)},this.getVersion=function(){return"1.2.0"}}})),dr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(cr),i=f(v),r=f(m),o=f(h),u=f(lr),a=f(pi),s=f(l);function f(t){return t&&t.__esModule?t:{default:t}}var c="onLoad";function d(t){t=t||{};var n=this.context,o=(0,i.default)(n).getInstance(),f=(0,a.default)(n).getInstance(),l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0;function m(t,n,e){var i={},r=void 0,o=void 0;i.elements=t,i.type=n,i.resolveType=e,0===i.elements.length&&w(i);for(var u=0;u<i.elements.length;u++)o=f.isHTTPURL((r=i.elements[u]).url)?r.url:r.originalContent.BaseURL+r.url,g.load(o,r,i)}function y(t){var n,e=void 0,i="";if(n=t.resolveObject,(e=t.element).resolvedContent){var r=0;0===e.resolvedContent.indexOf("<?xml")&&(r=e.resolvedContent.indexOf("?>")+2),i=e.resolvedContent.substr(0,r)+"<response>"+e.resolvedContent.substr(r)+"</response>",e.resolvedContent=p.xml_str2json(i)}(function(t){var n=void 0;for(n=0;n<t.elements.length;n++)if(!1===t.elements[n].resolved)return!1;return!0})(n)&&w(n)}function w(t){var n=[],e=void 0,i=void 0;if(function(t){var n=[],e=void 0,i=void 0,r=void 0,o=void 0,u=void 0;for(r=t.elements.length-1;r>=0;r--){if(i=(e=t.elements[r]).type+"_asArray",e.resolvedContent){if(e.resolvedContent)for(o=0;o<e.resolvedContent[i].length;o++)n.push(e.resolvedContent[i][o])}else delete e.originalContent["xlink:actuate"],delete e.originalContent["xlink:href"],n.push(e.originalContent);for(e.parentElement[i].splice(e.index,1),u=0;u<n.length;u++)e.parentElement[i].splice(e.index+u,0,n[u]);n=[]}t.elements.length>0&&h.run(v)}(t),"onActuate"===t.resolveType&&o.trigger(r.default.XLINK_READY,{manifest:v}),t.resolveType===c)switch(t.type){case s.default.PERIOD:for(e=0;e<v[s.default.PERIOD+"_asArray"].length;e++)(i=v[s.default.PERIOD+"_asArray"][e]).hasOwnProperty(s.default.ADAPTATION_SET+"_asArray")&&(n=n.concat(b(i[s.default.ADAPTATION_SET+"_asArray"],i,s.default.ADAPTATION_SET,c))),i.hasOwnProperty(s.default.EVENT_STREAM+"_asArray")&&(n=n.concat(b(i[s.default.EVENT_STREAM+"_asArray"],i,s.default.EVENT_STREAM,c)));m(n,s.default.ADAPTATION_SET,c);break;case s.default.ADAPTATION_SET:o.trigger(r.default.XLINK_READY,{manifest:v})}}function b(t,n,e,i){var r=[],o=void 0,u=void 0,a=void 0;for(u=t.length-1;u>=0;u--)(o=t[u]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===o["xlink:href"]&&t.splice(u,1);for(u=0;u<t.length;u++)(o=t[u]).hasOwnProperty("xlink:href")&&o.hasOwnProperty("xlink:actuate")&&o["xlink:actuate"]===i&&(a=M(o["xlink:href"],n,e,u,i,o),r.push(a));return r}function M(t,n,e,i,r,o){return{url:t,parentElement:n,type:e,index:i,resolveType:r,originalContent:o,resolvedContent:null,resolved:!1}}return l={resolveManifestOnLoad:function(t){p=new u.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:d}),m(b((v=t).Period_asArray,v,s.default.PERIOD,c),s.default.PERIOD,c)},setMatchers:function(t){t&&(d=t)},setIron:function(t){t&&(h=t)},reset:function(){o.off(r.default.XLINK_ELEMENT_LOADED,y,l),g&&(g.reset(),g=null)}},o.on(r.default.XLINK_ELEMENT_LOADED,y,l),g=(0,e.default)(n).create({errHandler:t.errHandler,dashMetrics:t.dashMetrics,mediaPlayerModel:t.mediaPlayerModel,requestModifier:t.requestModifier,settings:t.settings}),l}d.__dashjs_factory_name="XlinkController",n.default=o.default.getClassFactory(d)})),hr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=(e=h)&&e.__esModule?e:{default:e};function o(t){function n(t,n){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}function e(t,e,r){for(var o=0,u=t.length;o<u;++o){var a=t[o];if(e[a.name])if(r[a.name]){if(a.merge){var s=e[a.name],f=r[a.name];"object"===(void 0===s?"undefined":i(s))&&"object"===(void 0===f?"undefined":i(f))?n(s,f):r[a.name]=s+f}}else r[a.name]=e[a.name]}}function r(t,n){for(var i=0,o=t.children.length;i<o;++i){var u=t.children[i],a=n[u.name+"_asArray"];if(a)for(var s=0,f=a.length;s<f;++s){var c=a[s];e(t.properties,n,c),r(u,c)}}}return{run:function(n){if(null===n||"object"!==(void 0===n?"undefined":i(n)))return n;if("period"in t)for(var e=t.period,o=n.Period_asArray,u=0,a=o.length;u<a;++u){var s=o[u];if(r(e,s),"adaptationset"in t){var f=s.AdaptationSet_asArray;if(f)for(var c=t.adaptationset,l=0,d=f.length;l<d;++l)r(c,f[l])}}return n}}}o.__dashjs_factory_name="ObjectIron";var u=r.default.getClassFactory(o);n.default=u})),vr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._test=n,this._converter=e}return e(t,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),t}();n.default=i})),pr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(vr),i=r(l);function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var u=function(t){function n(){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,(function(t,n){var e,r=(o(e={},i.default.MPD,[i.default.ID,i.default.PROFILES]),o(e,i.default.PERIOD,[i.default.ID]),o(e,i.default.BASE_URL,[i.default.SERVICE_LOCATION,i.default.BYTE_RANGE]),o(e,i.default.SEGMENT_BASE,[i.default.INDEX_RANGE]),o(e,i.default.INITIALIZATION,[i.default.RANGE]),o(e,i.default.REPRESENTATION_INDEX,[i.default.RANGE]),o(e,i.default.SEGMENT_LIST,[i.default.INDEX_RANGE]),o(e,i.default.BITSTREAM_SWITCHING,[i.default.RANGE]),o(e,i.default.SEGMENT_URL,[i.default.MEDIA_RANGE,i.default.INDEX_RANGE]),o(e,i.default.SEGMENT_TEMPLATE,[i.default.INDEX_RANGE,i.default.MEDIA,i.default.INDEX,i.default.INITIALIZATION_MINUS,i.default.BITSTREAM_SWITCHING_MINUS]),o(e,i.default.ASSET_IDENTIFIER,[i.default.VALUE,i.default.ID]),o(e,i.default.EVENT_STREAM,[i.default.VALUE]),o(e,i.default.ADAPTATION_SET,[i.default.PROFILES,i.default.MIME_TYPE,i.default.SEGMENT_PROFILES,i.default.CODECS,i.default.CONTENT_TYPE]),o(e,i.default.FRAME_PACKING,[i.default.VALUE,i.default.ID]),o(e,i.default.AUDIO_CHANNEL_CONFIGURATION,[i.default.VALUE,i.default.ID]),o(e,i.default.CONTENT_PROTECTION,[i.default.VALUE,i.default.ID]),o(e,i.default.ESSENTIAL_PROPERTY,[i.default.VALUE,i.default.ID]),o(e,i.default.SUPPLEMENTAL_PROPERTY,[i.default.VALUE,i.default.ID]),o(e,i.default.INBAND_EVENT_STREAM,[i.default.VALUE,i.default.ID]),o(e,i.default.ACCESSIBILITY,[i.default.VALUE,i.default.ID]),o(e,i.default.ROLE,[i.default.VALUE,i.default.ID]),o(e,i.default.RATING,[i.default.VALUE,i.default.ID]),o(e,i.default.VIEWPOINT,[i.default.VALUE,i.default.ID]),o(e,i.default.CONTENT_COMPONENT,[i.default.CONTENT_TYPE]),o(e,i.default.REPRESENTATION,[i.default.ID,i.default.DEPENDENCY_ID,i.default.MEDIA_STREAM_STRUCTURE_ID]),o(e,i.default.SUBSET,[i.default.ID]),o(e,i.default.METRICS,[i.default.METRICS_MINUS]),o(e,i.default.REPORTING,[i.default.VALUE,i.default.ID]),e);if(r.hasOwnProperty(n)){var u=r[n];return void 0!==u&&u.indexOf(t.name)>=0}return!1}),(function(t){return String(t)})))}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(e.default);n.default=u})),gr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(vr),i=o(c),r=o(l);function o(t){return t&&t.__esModule?t:{default:t}}var u=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,a=function(t){function n(){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,(function(t){for(var n=[r.default.MIN_BUFFER_TIME,r.default.MEDIA_PRESENTATION_DURATION,r.default.MINIMUM_UPDATE_PERIOD,r.default.TIMESHIFT_BUFFER_DEPTH,r.default.MAX_SEGMENT_DURATION,r.default.MAX_SUBSEGMENT_DURATION,r.default.SUGGESTED_PRESENTATION_DELAY,r.default.START,i.default.START_TIME,r.default.DURATION],e=n.length,o=0;o<e;o++)if(t.nodeName===n[o])return u.test(t.value);return!1}),(function(t){var n=u.exec(t),e=31536e3*parseFloat(n[3]||0)+2592e3*parseFloat(n[5]||0)+86400*parseFloat(n[7]||0)+3600*parseFloat(n[9]||0)+60*parseFloat(n[11]||0)+parseFloat(n[13]||0);return void 0!==n[1]&&(e=-e),e})))}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(e.default);n.default=a})),mr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=vr)&&e.__esModule?e:{default:e},r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,o=function(t){function n(){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,(function(t){return r.test(t.value)}),(function(t){var n=r.exec(t),e=void 0;if(e=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&1e3*parseFloat(n[7])||0),n[9]&&n[10]){var i=60*parseInt(n[9],10)+parseInt(n[10],10);e+=("+"===n[8]?-1:1)*i*60*1e3}return new Date(e)})))}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(i.default);n.default=o})),yr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=vr)&&e.__esModule?e:{default:e},r=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,o=function(t){function n(){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,(function(t){return r.test(t.value)}),(function(t){return parseFloat(t)})))}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(i.default);n.default=o})),wr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(n){var e;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=n,this._merge=(e=n)&&e.length&&e.charAt(0)===e.charAt(0).toUpperCase()}return e(t,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),t}();n.default=i})),br=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),r=(e=wr)&&e.__esModule?e:{default:e},o=function(){function t(n,e,i){var o=this;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=n||"",this._properties=[],this._children=i||[],Array.isArray(e)&&e.forEach((function(t){o._properties.push(new r.default(t))}))}return i(t,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),t}();n.default=o})),Mr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(br),i=r(l);function r(t){return t&&t.__esModule?t:{default:t}}var o=function(t){function n(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=[i.default.PROFILES,i.default.WIDTH,i.default.HEIGHT,i.default.SAR,i.default.FRAMERATE,i.default.AUDIO_SAMPLING_RATE,i.default.MIME_TYPE,i.default.SEGMENT_PROFILES,i.default.CODECS,i.default.MAXIMUM_SAP_PERIOD,i.default.START_WITH_SAP,i.default.MAX_PLAYOUT_RATE,i.default.CODING_DEPENDENCY,i.default.SCAN_TYPE,i.default.FRAME_PACKING,i.default.AUDIO_CHANNEL_CONFIGURATION,i.default.CONTENT_PROTECTION,i.default.ESSENTIAL_PROPERTY,i.default.SUPPLEMENTAL_PROPERTY,i.default.INBAND_EVENT_STREAM];return function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,i.default.ADAPTATION_SET,t,[new e.default(i.default.REPRESENTATION,t,[new e.default(i.default.SUB_REPRESENTATION,t)])]))}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(e.default);n.default=o})),Tr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(br),i=r(l);function r(t){return t&&t.__esModule?t:{default:t}}var o=function(t){function n(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=[i.default.SEGMENT_BASE,i.default.SEGMENT_TEMPLATE,i.default.SEGMENT_LIST];return function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,i.default.PERIOD,t,[new e.default(i.default.ADAPTATION_SET,t,[new e.default(i.default.REPRESENTATION,t)])]))}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(e.default);n.default=o})),Nr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=l(h),i=l(hr),r=l(lr),o=l(pr),u=l(gr),a=l(mr),s=l(yr),f=l(Mr),c=l(Tr);function l(t){return t&&t.__esModule?t:{default:t}}function d(t){var n,e=this.context,l=void 0,d=void 0,h=void 0,v=void 0;return n={parse:function(t){var n=void 0,e=window.performance.now();if(!(n=h.xml_str2json(t)))throw new Error("parsing the manifest failed");var i=window.performance.now();v.run(n);var r=window.performance.now();return l.info("Parsing complete: ( xml2json: "+(i-e).toPrecision(3)+"ms, objectiron: "+(r-i).toPrecision(3)+"ms, total: "+((r-e)/1e3).toPrecision(3)+"s)"),n.protocol="DASH",n},getMatchers:function(){return d},getIron:function(){return v}},l=(t=t||{}).debug.getLogger(n),d=[new u.default,new a.default,new s.default,new o.default],h=new r.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!0,matchers:d}),v=(0,i.default)(e).create({adaptationset:new f.default,period:new c.default}),n}d.__dashjs_factory_name="DashParser",n.default=e.default.getClassFactory(d)})),_r=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=w(c),i=w(l),r=w(dr),o=w(Ki),u=w(pi),a=w(fr),s=w(N),f=w(v),d=w(m),p=w(Oe),g=w(h),y=w(Nr);function w(t){return t&&t.__esModule?t:{default:t}}function M(t){var n=this.context,c=(t=t||{}).debug,l=(0,f.default)(n).getInstance(),h=(0,u.default)(n).getInstance(),v=void 0,g=void 0,m=void 0,w=void 0,M=void 0,T=t.mssHandler,N=t.errHandler;function _(t){l.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:t.manifest})}return v={load:function(t){var i=new a.default(t,b.HTTPRequest.MPD_TYPE);m.load({request:i,success:function(i,r,o){if(w){var u=void 0,a=void 0,f=void 0;if(o&&o!==t?(a=h.parseBaseUrl(o),u=o):(h.isRelative(t)&&(t=h.resolve(t,window.location.href)),a=h.parseBaseUrl(t)),null===M&&(M=function(t){var e=null;return t.indexOf("SmoothStreamingMedia")>-1?(T&&(e=T.createMssParser(),T.registerEvents()),e):t.indexOf("MPD")>-1?(0,y.default)(n).create({debug:c}):e}(i)),null!==M){w.setMatchers(M.getMatchers()),w.setIron(M.getIron());try{f=M.parse(i)}catch(n){return void l.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new s.default(p.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,p.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+t)})}f?(f.url=u||t,f.originalUrl||(f.originalUrl=f.url),f.hasOwnProperty(e.default.LOCATION)&&(a=h.parseBaseUrl(f.Location_asArray[0]),g.debug("BaseURI set by Location to: "+a)),f.baseUri=a,f.loadedTime=new Date,w.resolveManifestOnLoad(f),l.trigger(d.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:i})):l.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new s.default(p.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,p.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+t)})}else l.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new s.default(p.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,p.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+t)})}},error:function(n,e,i){l.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new s.default(p.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,p.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+(t+", ")+i)})}})},reset:function(){l.off(d.default.XLINK_READY,_,v),w&&(w.reset(),w=null),m&&(m.abort(),m=null),T&&T.reset()}},g=c.getLogger(v),l.on(d.default.XLINK_READY,_,v),m=(0,o.default)(n).create({errHandler:t.errHandler,dashMetrics:t.dashMetrics,mediaPlayerModel:t.mediaPlayerModel,requestModifier:t.requestModifier,useFetch:t.settings.get().streaming.lowLatencyEnabled,urlUtils:h,constants:e.default,dashConstants:i.default,errors:p.default}),w=(0,r.default)(n).create({errHandler:N,dashMetrics:t.dashMetrics,mediaPlayerModel:t.mediaPlayerModel,requestModifier:t.requestModifier,settings:t.settings}),M=null,v}M.__dashjs_factory_name="ManifestLoader";var T=g.default.getClassFactory(M);n.default=T})),Sr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(v),i=o(m),r=o(h);function o(t){return t&&t.__esModule?t:{default:t}}function u(){var t=(0,e.default)(this.context).getInstance();return{error:function(n){t.trigger(i.default.ERROR,{error:n})}}}u.__dashjs_factory_name="ErrorHandler",n.default=r.default.getSingletonFactory(u)})),Cr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(){var t,n=void 0;return t={supportsMediaSource:function(){var t="WebKitMediaSource"in window,n="MediaSource"in window;return t||n},supportsEncryptedMedia:function(){return n},supportsCodec:function(t){return!(!("MediaSource"in window)||!MediaSource.isTypeSupported(t))||!(!("WebKitMediaSource"in window)||!WebKitMediaSource.isTypeSupported(t))},setEncryptedMediaSupported:function(t){n=t}},n=!1,t}r.__dashjs_factory_name="Capabilities",n.default=i.default.getSingletonFactory(r)})),Er=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null}})),kr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(Er),i=r(h);function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t=void 0;return{initialize:function(n){if(t=new e.default,!n)return null;var i=n.indexOf("#");if(-1!==i)for(var r=n.substr(i+1).split("&"),o=0,u=r.length;o<u;++o){var a=r[o],s=a.indexOf("=");if(-1!==s){var f=a.substring(0,s);t.hasOwnProperty(f)&&(t[f]=a.substr(s+1))}}},getURIFragmentData:function(){return t}}}o.__dashjs_factory_name="URIFragmentModel",n.default=i.default.getSingletonFactory(o)})),Or=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(v),i=o(m),r=o(h);function o(t){return t&&t.__esModule?t:{default:t}}function u(){var t=(0,e.default)(this.context).getInstance(),n=void 0;return{getValue:function(){return n},setValue:function(e){n=e,e&&t.trigger(i.default.MANIFEST_LOADED,{data:e})}}}u.__dashjs_factory_name="ManifestModel",n.default=r.default.getSingletonFactory(u)})),Rr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(ki),i=a(h),r=a(c),o=a(He),u=a(Ni);function a(t){return t&&t.__esModule?t:{default:t}}function s(){var t,n=void 0,i=void 0,a=void 0,s={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso&ms"},f=(0,u.default)(this.context).getInstance();function c(t){var n=void 0;for(n=0;n<a.length;n++)if(a[n].rulename===t)return n;return-1}function l(){return f.get().streaming.lowLatencyEnabled?f.get().streaming.liveDelay||3:f.get().streaming.liveDelay}function d(t,i){h(t,i);var r=new e.default;r.schemeIdUri=t,r.value=i,n.push(r)}function h(t,e){(0,R.checkParameterType)(t,"string"),(0,R.checkParameterType)(e,"string"),n.forEach((function(i,r){i.schemeIdUri===t&&i.value===e&&n.splice(r,1)}))}return t={getABRCustomRules:function(){return a},addABRCustomRule:function(t,n,e){if("string"!=typeof t||t!==o.default.ABANDON_FRAGMENT_RULES&&t!==o.default.QUALITY_SWITCH_RULES||"string"!=typeof n)throw r.default.BAD_ARGUMENT_ERROR;var i=c(n);-1===i?a.push({type:t,rulename:n,rule:e}):(a[i].type=t,a[i].rule=e)},removeABRCustomRule:function(t){if(t){var n=c(t);-1!==n&&a.splice(n,1)}else a=[]},getStableBufferTime:function(){if(f.get().streaming.lowLatencyEnabled)return.6*l();var t=f.get().streaming.stableBufferTime;return t>-1?t:f.get().streaming.fastSwitchEnabled?20:12},getRetryAttemptsForType:function(t){var n=isNaN(f.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:f.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return f.get().streaming.lowLatencyEnabled?f.get().streaming.retryAttempts[t]*n:f.get().streaming.retryAttempts[t]},getRetryIntervalsForType:function(t){var n=isNaN(f.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:f.get().streaming.retryIntervals.lowLatencyReductionFactor;return f.get().streaming.lowLatencyEnabled?f.get().streaming.retryIntervals[t]/n:f.get().streaming.retryIntervals[t]},getLiveDelay:l,getLiveCatchupLatencyThreshold:function(){try{var t=f.get().streaming.liveCatchupLatencyThreshold,n=l();if(null!==t&&!isNaN(t))return Math.max(t,n);var e=f.get().streaming.liveCatchUpMinDrift,i=!isNaN(n)&&n?isNaN(e)?l():f.get().streaming.liveCatchUpMinDrift+l():NaN;return i&&!isNaN(i)?2*i:NaN}catch(t){return NaN}},addUTCTimingSource:d,removeUTCTimingSource:h,getUTCTimingSources:function(){return n},clearDefaultUTCTimingSources:function(){n=[]},restoreDefaultUTCTimingSources:function(){d(s.scheme,s.value)},setXHRWithCredentialsForType:function t(n,e){n?i[n]=!!e:Object.keys(i).forEach((function(n){t(n,e)}))},getXHRWithCredentialsForType:function(t){var n=i[t];return void 0===n?i.default:n},getDefaultUtcTimingSource:function(){return s},reset:function(){}},n=[],i={default:!1},a=[],t}s.__dashjs_factory_name="MediaPlayerModel",n.default=i.default.getSingletonFactory(s)})),Ir=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=u(h),i=u(v),r=u(m),o=u(y);function u(t){return t&&t.__esModule?t:{default:t}}function a(){var t,n=void 0,e=void 0,u=void 0,a=void 0,s=this.context,f=(0,i.default)(s).getInstance(),c=[];function l(){e&&(e.playbackRate=a||1,e.removeEventListener("canplay",l))}function d(t){e&&(e.readyState<=2&&t>0?e.addEventListener("canplay",l):e.playbackRate=t)}function h(){return c.length>0}function v(t){var n=c.indexOf(t),i=void 0;null!==t&&(-1!==n&&c.splice(n,1),e&&!1===h()&&0===e.playbackRate&&(d(a||1),e.paused||((i=document.createEvent("Event")).initEvent("playing",!0,!1),e.dispatchEvent(i))))}function p(){if(e&&h()&&0===e.playbackRate){var t=document.createEvent("Event");t.initEvent("waiting",!0,!1),e.dispatchEvent(t)}}function g(){return e?e.buffered:null}function m(t,n,i,r,o){if(e)for(var u=0;u<e.textTracks.length;u++)if(e.textTracks[u].kind===t&&(!n||e.textTracks[u].label==n)&&e.textTracks[u].language===i&&e.textTracks[u].isTTML===r&&e.textTracks[u].isEmbedded===o)return e.textTracks[u];return null}return t={initialize:function(){f.on(r.default.PLAYBACK_PLAYING,p,this)},setCurrentTime:function(t,n){if(e){if(e.currentTime==t)return;try{t=n?function(t){var n=g(),e=t,i=9999999999;if(n)for(var r=0;r<n.length;r++){var o=n.start(r),u=n.end(r),a=Math.abs(o-t),s=Math.abs(u-t);if(t>=o&&t<=u)return t;a<i&&(i=a,e=o),s<i&&(i=s,e=u)}return e}(t):t,e.currentTime=t}catch(n){0===e.readyState&&n.code===n.INVALID_STATE_ERR&&setTimeout((function(){e.currentTime=t}),400)}}},play:function(){if(e){e.autoplay=!0;var t=e.play();t&&t.catch&&"undefined"!=typeof Promise&&t.catch((function(t){"NotAllowedError"===t.name&&f.trigger(r.default.PLAYBACK_NOT_ALLOWED),n.warn("Caught pending play exception - continuing ("+t+")")}))}},isPaused:function(){return e?e.paused:null},pause:function(){e&&(e.pause(),e.autoplay=!1)},isStalled:h,isSeeking:function(){return e?e.seeking:null},getTime:function(){return e?e.currentTime:null},getPlaybackRate:function(){return e?e.playbackRate:null},setPlaybackRate:d,getPlayedRanges:function(){return e?e.played:null},getEnded:function(){return e?e.ended:null},setStallState:function(t,n){!function(t,n){n?function(t){var n=void 0;null===t||e.seeking||-1!==c.indexOf(t)||(c.push(t),e&&1===c.length&&((n=document.createEvent("Event")).initEvent("waiting",!0,!1),a=e.playbackRate,d(0),e.dispatchEvent(n)))}(t):v(t)}(t,n)},getElement:function(){return e},setElement:function(t){if(!(null==t||t&&/^(VIDEO|AUDIO)$/i.test(t.nodeName)))throw"element is not video or audio DOM type!";(e=t)&&(e.preload="auto")},setSource:function(t){e&&(t?e.src=t:(e.removeAttribute("src"),e.load()))},getSource:function(){return e?e.src:null},getTTMLRenderingDiv:function(){return u},setTTMLRenderingDiv:function(t){(u=t).style.position="absolute",u.style.display="flex",u.style.overflow="hidden",u.style.pointerEvents="none",u.style.top=0,u.style.left=0},getPlaybackQuality:function(){if(!e)return null;var t="webkitDroppedFrameCount"in e&&"webkitDecodedFrameCount"in e,n=null;return"getVideoPlaybackQuality"in e?n=e.getVideoPlaybackQuality():t&&(n={droppedVideoFrames:e.webkitDroppedFrameCount,totalVideoFrames:e.webkitDroppedFrameCount+e.webkitDecodedFrameCount,creationTime:new Date}),n},addEventListener:function(t,n){e&&e.addEventListener(t,n)},removeEventListener:function(t,n){e&&e.removeEventListener(t,n)},getReadyState:function(){return e?e.readyState:NaN},getBufferRange:g,getClientWidth:function(){return e?e.clientWidth:NaN},getClientHeight:function(){return e?e.clientHeight:NaN},getTextTracks:function(){return e?e.textTracks:[]},getTextTrack:m,addTextTrack:function(t,n,i,r,o){if(!e)return null;var u=m(t,n,i,r,o);return u||((u=e.addTextTrack(t,n,i)).isEmbedded=o,u.isTTML=r),u},appendChild:function(t){e&&(e.appendChild(t),void 0!==t.isTTML&&(e.textTracks[e.textTracks.length-1].isTTML=t.isTTML,e.textTracks[e.textTracks.length-1].isEmbedded=t.isEmbedded))},removeChild:function(t){e&&e.removeChild(t)},getVideoWidth:function(){return e?e.videoWidth:NaN},getVideoHeight:function(){return e?e.videoHeight:NaN},getVideoRelativeOffsetTop:function(){var t=e.parentNode.host||e.parentNode;return t?e.getBoundingClientRect().top-t.parentNode.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){var t=e.parentNode.host||e.parentNode;return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:NaN},reset:function(){f.off(r.default.PLAYBACK_PLAYING,p,this)}},n=(0,o.default)(s).getInstance().getLogger(t),t}a.__dashjs_factory_name="VideoModel",n.default=e.default.getSingletonFactory(a)})),Dr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(h),i=o(y),r=o(c);function o(t){return t&&t.__esModule?t:{default:t}}var u=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],a="dashjs_?_bitrate",s="dashjs_?_settings",f="localStorage",l="lastBitrate",d="lastMediaSettings";function v(t){var n,e=(t=t||{}).settings,o=void 0,c=void 0;function h(t){if(void 0!==c)return c;c=!1;var n=void 0;try{"undefined"!=typeof window&&(n=window[t])}catch(t){return o.warn("DOMStorage access denied: "+t.message),c}if(!n||t!==f&&"sessionStorage"!==t)return c;try{n.setItem("1","1"),n.removeItem("1"),c=!0}catch(t){o.warn("DOMStorage is supported, but cannot be used: "+t.message)}return c}function v(){var t=6e5;return Math.round((new Date).getTime()/t)*t}function p(t,n){return h(t)&&e.get().streaming[n+"CachingInfo"].enabled}function g(){if(!e)throw new Error(r.default.MISSING_CONFIG_ERROR)}return n={getSavedBitrateSettings:function(t){var n=NaN;if(g(),p(f,l)){var i=a.replace(/\?/,t);try{var r=JSON.parse(localStorage.getItem(i))||{},u=(new Date).getTime()-parseInt(r.timestamp,10)>=e.get().streaming.lastBitrateCachingInfo.ttl||!1,s=parseFloat(r.bitrate);isNaN(s)||u?u&&localStorage.removeItem(i):(n=s,o.debug("Last saved bitrate for "+t+" was "+s))}catch(t){return null}}return n},setSavedBitrateSettings:function(t,n){if(p(f,l)&&n){var e=a.replace(/\?/,t);try{localStorage.setItem(e,JSON.stringify({bitrate:n.toFixed(3),timestamp:v()}))}catch(t){o.error(t.message)}}},getSavedMediaSettings:function(t){var n=null;if(g(),p(f,d)){var i=s.replace(/\?/,t);try{var r=JSON.parse(localStorage.getItem(i))||{},o=(new Date).getTime()-parseInt(r.timestamp,10)>=e.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;n=r.settings,o&&(localStorage.removeItem(i),n=null)}catch(t){return null}}return n},setSavedMediaSettings:function(t,n){if(p(f,d)){var e=s.replace(/\?/,t);try{localStorage.setItem(e,JSON.stringify({settings:n,timestamp:v()}))}catch(t){o.error(t.message)}}}},o=(0,i.default)(this.context).getInstance().getLogger(n),h(f)&&u.forEach((function(t){var n=localStorage.getItem(t.oldKey);if(n){localStorage.removeItem(t.oldKey);try{localStorage.setItem(t.newKey,n)}catch(t){o.error(t.message)}}})),n}v.__dashjs_factory_name="DOMStorage";var p=e.default.getSingletonFactory(v);n.default=p})),xr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(oi),i=a(N),r=a(h),o=a(M),u=a(Ki);function a(t){return t&&t.__esModule?t:{default:t}}function s(){var t=this.context,n=void 0,r=void 0,a=void 0,s=void 0,f=void 0,c=void 0,l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0,b=void 0;function M(){if(!b||!b.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function T(t){if(t.url){var n=new o.default;return n.setInfo(t),n}}function N(t,n,e){p.trigger(v.SEGMENTS_LOADED,t?{segments:t,representation:n,mediaType:e}:{segments:null,representation:n,mediaType:e,error:new i.default(g.SEGMENT_BASE_LOADER_ERROR_CODE,g.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}return n={setConfig:function(t){t.baseURLController&&(b=t.baseURLController),t.dashMetrics&&(c=t.dashMetrics),t.mediaPlayerModel&&(d=t.mediaPlayerModel),t.errHandler&&(a=t.errHandler),t.settings&&(l=t.settings),t.boxParser&&(s=t.boxParser),t.events&&(v=t.events),t.eventBus&&(p=t.eventBus),t.debug&&(r=t.debug.getLogger(n)),t.requestModifier&&(f=t.requestModifier),t.errors&&(g=t.errors),t.urlUtils&&(w=t.urlUtils),t.constants&&(m=t.constants),t.dashConstants&&(y=t.dashConstants)},initialize:function(){h=(0,u.default)(t).create({errHandler:a,dashMetrics:c,mediaPlayerModel:d,requestModifier:f,useFetch:l?l.get().streaming.lowLatencyEnabled:null,boxParser:s,errors:g,urlUtils:w,constants:m,dashConstants:y})},loadInitialization:function t(n,e){M();var i=null,o=n?b.resolve(n.path):null,u=e||{init:!0,url:o?o.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:n&&n.adaptation?n.adaptation.type:null};r.debug("Start searching for initialization.");var a=T(u);h.load({request:a,success:function(e){u.bytesLoaded=u.range.end,(i=s.findInitRange(e))?(n.range=i,p.trigger(v.INITIALIZATION_LOADED,{representation:n})):(u.range.end=u.bytesLoaded+u.bytesToLoad,t(n,u))},error:function(){p.trigger(v.INITIALIZATION_LOADED,{representation:n})}}),r.debug("Perform init search: "+u.url)},loadSegments:function t(n,i,o,u,a){if(M(),o&&(void 0===o.start||void 0===o.end)){var f=o?o.toString().split("-"):null;o=f?{start:parseFloat(f[0]),end:parseFloat(f[1])}:null}u=u||N;var c=null,l=null,d=!!o,v=n?b.resolve(n.path):null,p={init:!1,url:v?v.url:void 0,range:d?o:{start:0,end:1500},searching:!d,bytesLoaded:a?a.bytesLoaded:0,bytesToLoad:1500,mediaType:n&&n.adaptation?n.adaptation.type:null},g=T(p);h.load({request:g,success:function(o){var a=p.bytesToLoad,f=o.byteLength;if(p.bytesLoaded=p.range.end-p.range.start,c=s.parse(o),(l=c.getBox("sidx"))&&l.isComplete){var d=l.references,h=void 0,v=void 0;if(null!=d&&d.length>0&&(h=1===d[0].reference_type),h){r.debug("Initiate multiple SIDX load."),p.range.end=p.range.start+l.size;var g=void 0,m=void 0,y=void 0,w=void 0,b=[],M=0,T=(l.offset||p.range.start)+l.size,N=function(t){t?(b=b.concat(t),++M>=m&&(b.sort((function(t,n){return t.startTime-n.startTime<0?-1:0})),u(b,n,i))):u(null,n,i)};for(g=0,m=d.length;g<m;g++)y=T,w=T+d[g].referenced_size-1,T+=d[g].referenced_size,t(n,null,{start:y,end:w},N,p)}else r.debug("Parsing segments from SIDX. representation "+n.adaptation.type+" - id: "+n.id+" for range : "+p.range.start+" - "+p.range.end),v=function(t,n){for(var i=t.references,r=i.length,o=t.timescale,u=t.earliest_presentation_time,a=n.range.start+t.offset+t.first_offset+t.size,s=[],f=void 0,c=void 0,l=void 0,d=0;d<r;d++)c=i[d].subsegment_duration,l=i[d].referenced_size,(f=new e.default).duration=c,f.startTime=u,f.timescale=o,f.mediaRange=a+"-"+(a+l-1),s.push(f),u+=c,a+=l;return s}(l,p),u(v,n,i)}else{if(l)p.range.start=l.offset||p.range.start,p.range.end=p.range.start+(l.size||a);else{if(f<p.bytesLoaded)return void u(null,n,i);var _=c.getLastBox();_&&_.size?(p.range.start=_.offset+_.size,p.range.end=p.range.start+a):p.range.end+=a}t(n,i,p.range,u,p)}},error:function(){u(null,n,i)}}),r.debug("Perform SIDX load: "+p.url+" with range : "+p.range.start+" - "+p.range.end)},reset:function(){h.abort(),h=null,a=null,s=null,f=null}}}s.__dashjs_factory_name="SegmentBaseLoader",n.default=r.default.getSingletonFactory(s)})),Ar=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=h)&&e.__esModule?e:{default:e};function r(t){t=t||{};var n=void 0,e=new DataView(t.data),i=0;function r(t,n){var r=!0,o=0;if(void 0===n&&(n=!1),t.tag>16777215?(e.getUint32(i)!==t.tag&&(r=!1),o=4):t.tag>65535?(256*e.getUint16(i)+e.getUint8(i+2)!==t.tag&&(r=!1),o=3):t.tag>255?(e.getUint16(i)!==t.tag&&(r=!1),o=2):(e.getUint8(i)!==t.tag&&(r=!1),o=1),!r&&t.required&&!n)throw new Error("required tag not found");return r&&(i+=o),r}function o(t){var n=1,r=128,o=-1,u=0,a=e.getUint8(i),s=0;for(s=0;s<8;s+=1){if((a&r)===r){u=void 0===t?a&~r:a,o=s;break}r>>=1}for(s=0;s<o;s+=1,n+=1)u=u<<8|255&e.getUint8(i+n);return i+=n,u}return n={getPos:function(){return i},setPos:function(t){i=t},consumeTag:r,consumeTagAndSize:function(t,n){var e=r(t,n);return e&&o(),e},parseTag:function(t){var e;return r(t),e=o(),n[t.parse](e)},skipOverElement:function(t,n){var e=r(t,n),u=void 0;return e&&(u=o(),i+=u),e},getMatroskaCodedNum:o,getMatroskaFloat:function(t){var n=void 0;switch(t){case 4:n=e.getFloat32(i),i+=4;break;case 8:n=e.getFloat64(i),i+=8}return n},getMatroskaUint:function(t){for(var n=0,r=0;r<t;r+=1)n<<=8,n|=255&e.getUint8(i+r);return i+=t,n},moreData:function(){return i<e.byteLength}}}r.__dashjs_factory_name="EBMLParser",n.default=i.default.getClassFactory(r)})),jr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(Ar),i=f(c),r=f(h),o=f(oi),u=f(M),a=f(Ki),s=f(N);function f(t){return t&&t.__esModule?t:{default:t}}function l(){var t=this.context,n=void 0,r=void 0,f=void 0,c=void 0,l=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0;function b(){if(!w||!w.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function M(t,n,e){g.trigger(m.SEGMENTS_LOADED,t?{segments:t,representation:n,mediaType:e}:{segments:null,representation:n,mediaType:e,error:new s.default(y.SEGMENT_BASE_LOADER_ERROR_CODE,y.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function T(t){var n=new u.default;return n.setInfo(t),n}return n={setConfig:function(t){if(!(t.baseURLController&&t.dashMetrics&&t.mediaPlayerModel&&t.errHandler))throw new Error(i.default.MISSING_CONFIG_ERROR);w=t.baseURLController,d=t.dashMetrics,h=t.mediaPlayerModel,c=t.errHandler,p=t.settings,m=t.events,g=t.eventBus,y=t.errors,r=t.debug.getLogger(n),l=t.requestModifier},initialize:function(){v=(0,a.default)(t).create({errHandler:c,dashMetrics:d,mediaPlayerModel:h,requestModifier:l,useFetch:p?p.get().streaming.lowLatencyEnabled:null,errors:y})},loadInitialization:function(t,n){b();var e=null,i=t?w.resolve(t.path):null,o=t?t.range.split("-"):null,u=n||{range:{start:o?parseFloat(o[0]):null,end:o?parseFloat(o[1]):null},request:e,url:i?i.url:void 0,init:!0,mediaType:t&&t.adaptation?t.adaptation.type:null};r.info("Start loading initialization."),e=T(u),v.load({request:e,success:function(){g.trigger(m.INITIALIZATION_LOADED,{representation:t})},error:function(){g.trigger(m.INITIALIZATION_LOADED,{representation:t})}}),r.debug("Perform init load: "+u.url)},loadSegments:function(n,i,u,a){b();var s=null,c=n?w.resolve(n.path):null,l=c?c.url:void 0;a=a||M,s=T({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:s,url:l,init:!1,mediaType:n&&n.adaptation?n.adaptation.type:null}),r.debug("Parsing ebml header"),v.load({request:s,success:function(s){!function(n,i,u,a){if(n&&0!==n.byteLength){var s,c=(0,e.default)(t).create({data:n}),l=void 0,d=void 0,h=void 0,p=u?u.split("-"):null,g=null,m={url:i,range:{start:p?parseFloat(p[0]):null,end:p?parseFloat(p[1]):null},request:g};for(r.debug("Parse EBML header: "+m.url),c.skipOverElement(f.EBML),c.consumeTag(f.Segment),h=c.getMatroskaCodedNum(),h+=c.getPos(),s=c.getPos();c.moreData()&&!c.consumeTagAndSize(f.Segment.Info,!0);)if(!(c.skipOverElement(f.Segment.SeekHead,!0)||c.skipOverElement(f.Segment.Tracks,!0)||c.skipOverElement(f.Segment.Cues,!0)||c.skipOverElement(f.Void,!0)))throw new Error("no valid top level element found");for(;void 0===l;){var y=c.getMatroskaCodedNum(!0),w=c.getMatroskaCodedNum();switch(y){case f.Segment.Info.Duration.tag:l=c[f.Segment.Info.Duration.parse](w);break;default:c.setPos(c.getPos()+w)}}g=T(m),v.load({request:g,success:function(n){d=function(n,i,u,a){var s,c,l=void 0,d=void 0,h=void 0;for(l=[],h=0,c=(s=function(n){var i=[],r=(0,e.default)(t).create({data:n}),o=void 0,u=void 0;for(r.consumeTagAndSize(f.Segment.Cues);r.moreData()&&r.consumeTagAndSize(f.Segment.Cues.CuePoint,!0);){for((o={}).CueTime=r.parseTag(f.Segment.Cues.CuePoint.CueTime),o.CueTracks=[];r.moreData()&&r.consumeTag(f.Segment.Cues.CuePoint.CueTrackPositions,!0);){var a=r.getMatroskaCodedNum(),s=r.getPos();if((u={}).Track=r.parseTag(f.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===u.Track)throw new Error("Cue track cannot be 0");u.ClusterPosition=r.parseTag(f.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),o.CueTracks.push(u),r.setPos(s+a)}if(0===o.CueTracks.length)throw new Error("Mandatory cuetrack not found");i.push(o)}if(0===i.length)throw new Error("mandatory cuepoint not found");return i}(n)).length;h<c;h+=1)(d=new o.default).duration=h<s.length-1?s[h+1].CueTime-s[h].CueTime:a-s[h].CueTime,d.startTime=s[h].CueTime,d.timescale=1e3,d.mediaRange=s[h].CueTracks[0].ClusterPosition+i+"-"+(h<s.length-1?s[h+1].CueTracks[0].ClusterPosition+i-1:u-1),l.push(d);return r.debug("Parsed cues: "+l.length+" cues."),l}(n,s,h,l),a(d)},error:function(){r.error("Download Error: Cues "+m.url),a(null)}}),r.debug("Perform cues load: "+m.url+" bytes="+m.range.start+"-"+m.range.end)}else a(null)}(s,l,u,(function(t){a(t,n,i)}))},error:function(){a(null,n,i)}})},reset:function(){c=null,l=null}},f={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},n}l.__dashjs_factory_name="WebmSegmentBaseLoader",n.default=r.default.getSingletonFactory(l)})),Fr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(h),i=o(xr),r=o(jr);function o(t){return t&&t.__esModule?t:{default:t}}function u(t){var n=this.context,e=(t=t||{}).eventBus,o=t.events,u=t.dashMetrics,a=t.mediaPlayerModel,s=t.errHandler,f=t.baseURLController,c=t.debug,l=t.boxParser,d=t.requestModifier,h=t.errors,v=void 0,p=void 0,g=void 0;function m(t){return"webm"===(t?t.split("/")[1]:"").toLowerCase()}function y(t){m(t.mimeType)?g.loadInitialization(t.representation):p.loadInitialization(t.representation)}function w(t){m(t.mimeType)?g.loadSegments(t.representation,t.mediaType,t.representation?t.representation.indexRange:null,t.callback):p.loadSegments(t.representation,t.mediaType,t.representation?t.representation.indexRange:null,t.callback)}return v={initialize:function(){e.on(o.SEGMENTBASE_INIT_REQUEST_NEEDED,y,v),e.on(o.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,w,v),p.initialize(),g.initialize()},reset:function(){e.off(o.SEGMENTBASE_INIT_REQUEST_NEEDED,y,v),e.off(o.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,w,v)}},p=(0,i.default)(n).getInstance(),g=(0,r.default)(n).getInstance(),p.setConfig({baseURLController:f,dashMetrics:u,mediaPlayerModel:a,errHandler:s,eventBus:e,events:o,errors:h,debug:c,boxParser:l,requestModifier:d}),g.setConfig({baseURLController:f,dashMetrics:u,mediaPlayerModel:a,errHandler:s,eventBus:e,events:o,errors:h,debug:c,requestModifier:d}),v}u.__dashjs_factory_name="SegmentBaseController";var a=e.default.getSingletonFactory(u);n.default=a})),Pr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null}})),Br=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null}return e(t,[{key:"isMediaInfoEqual",value:function(t){if(!t)return!1;var n=this.id===t.id,e=this.viewpoint===t.viewpoint,i=this.lang===t.lang,r=this.roles.toString()===t.roles.toString(),o=this.accessibility.toString()===t.accessibility.toString(),u=this.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&e&&i&&r&&o&&u}}]),t}();n.default=i})),Lr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0}})),Ur=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null}})),qr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=c(l),i=c(Pr),r=c(Br),o=c(Lr),u=c(Ur),a=c(Oi),s=c(h),f=c(Li);function c(t){return t&&t.__esModule?t:{default:t}}function d(){var t,n=void 0,s=void 0,c=void 0,l=void 0,d=void 0,h=void 0;function v(t,i,r){var o=n.getAdaptationsForType(s[0].mpd.manifest,t,i);if(!o||0===o.length)return null;if(o.length>1&&r){var u=p(r,i);if(l[r.id]&&l[r.id][i])for(var a=0,f=o.length;a<f;a++)if(l[r.id][i].isMediaInfoEqual(u[a]))return o[a];for(var c=0,d=o.length;c<d;c++)if(n.getRolesForAdaptation(o[c]).filter((function(t){return t.value===e.default.MAIN}))[0])return o[c]}return o[0]}function p(t,e,i){var r,o=s,u=i,a=[],f=void 0,l=void 0,h=void 0,v=void 0,p=void 0;if(u)S(),o=g(u);else{if(!(s.length>0))return a;u=s[0].mpd.manifest}var m=M(t,o);m&&(p=m.id);var y=n.getAdaptationsForType(u,t?t.index:null,e!==d.EMBEDDED_TEXT?e:d.VIDEO);if(!y||0===y.length)return a;for(c[p]=c[p]||n.getAdaptationsForPeriod(m),h=0,r=y.length;h<r;h++)if(l=n.getIndexForAdaptation(y[h],u,t.index),f=T(c[p][l]),e===d.EMBEDDED_TEXT){var w=f.accessibility.length;for(v=0;v<w;v++)if(f){var b=f.accessibility[v];if(0===b.indexOf("cea-608:")){var _=b.substring(8).split(";");if("CC"===_[0].substring(0,2))for(v=0;v<_.length;v++)f||(f=T.call(this,c[p][l])),N(f,_[v].substring(0,3),_[v].substring(4)),a.push(f),f=null;else for(v=0;v<_.length;v++)f||(f=T.call(this,c[p][l])),N(f,"CC"+(v+1),_[v]),a.push(f),f=null}else 0===b.indexOf("cea-608")&&(N(f,d.CC1,"eng"),a.push(f),f=null)}}else e===d.IMAGE?(f.type=d.IMAGE,a.push(f),f=null):f&&a.push(f);return a}function g(t){var e=m(t);return n.getRegularPeriods(e)}function m(t){var e=w(t);return n.getMpd(e)}function y(){s=[],c={},l={}}function w(t){return t||(s.length>0?s[0].mpd.manifest:null)}function b(t){return t&&t.streamInfo&&void 0!==t.streamInfo.id&&c[t.streamInfo.id]?c[t.streamInfo.id][t.index]:null}function M(t,n){for(var e=n.length,i=0;i<e;i++){var r=n[i];if(t&&t.id===r.id)return r}return null}function T(t){if(!t)return null;var e,i=new r.default,o=t.period.mpd.manifest.Period_asArray[t.period.index].AdaptationSet_asArray[t.index];return i.id=t.id,i.index=t.index,i.type=t.type,i.streamInfo=_(t.period),i.representationCount=n.getRepresentationCount(o),i.labels=n.getLabelsForAdaptation(o),i.lang=n.getLanguageForAdaptation(o),e=n.getViewpointForAdaptation(o),i.viewpoint=e?e.value:void 0,i.accessibility=n.getAccessibilityForAdaptation(o).map((function(t){var n=t.value,e=n;return t.schemeIdUri&&t.schemeIdUri.search("cea-608")>=0&&void 0!==h&&(e=n?"cea-608:"+n:"cea-608",i.embeddedCaptions=!0),e})),i.audioChannelConfiguration=n.getAudioChannelConfigurationForAdaptation(o).map((function(t){return t.value})),0===i.audioChannelConfiguration.length&&Array.isArray(o.Representation_asArray)&&o.Representation_asArray.length>0&&(i.audioChannelConfiguration=n.getAudioChannelConfigurationForRepresentation(o.Representation_asArray[0]).map((function(t){return t.value}))),i.roles=n.getRolesForAdaptation(o).map((function(t){return t.value})),i.codec=n.getCodec(o),i.mimeType=n.getMimeType(o),i.contentProtection=n.getContentProtectionData(o),i.bitrateList=n.getBitrateListForAdaptation(o),i.contentProtection&&i.contentProtection.forEach((function(t){t.KID=n.getKID(t)})),i.isText=n.getIsTextTrack(i.mimeType),i.supplementalProperties=n.getSupplementalPropperties(o),i}function N(t,n,e){t.id=n,t.index=100+parseInt(n.substring(2,3)),t.type=d.EMBEDDED_TEXT,t.codec="cea-608-in-SEI",t.isText=!0,t.isEmbedded=!0,t.lang=e,t.roles=["caption"]}function _(t){var e,i,r=new o.default;return r.id=t.id,r.index=t.index,r.start=t.start,r.duration=t.duration,r.manifestInfo=(e=t.mpd,(i=new u.default).DVRWindowSize=e.timeShiftBufferDepth,i.loadedTime=e.manifest.loadedTime,i.availableFrom=e.availabilityStartTime,i.minBufferTime=e.manifest.minBufferTime,i.maxFragmentDuration=e.maxSegmentDuration,i.duration=n.getDuration(e.manifest),i.isDynamic=n.getIsDynamic(e.manifest),i.serviceDescriptions=n.getServiceDescriptions(e.manifest),i.protocol=e.manifest.protocol,i),r.isLast=1===t.mpd.manifest.Period_asArray.length||Math.abs(r.start+r.duration-r.manifestInfo.duration)<1,r}function S(){if(!d)throw new Error("setConfig function has to be called previously")}function C(t){return s.length>0?s[0].mpd.manifest.Period_asArray[t]:null}function E(t,n,e){var i=void 0,r=void 0,o=void 0,u=void 0,a=void 0;if(t)for(i=t.AdaptationSet_asArray,u=0;u<i.length;u+=1)for(o=i[u].Representation_asArray,a=0;a<o.length;a+=1)if(n===(r=o[a]).id)return e?a:r;return null}return t={getBandwidthForRepresentation:function(t,n){var e;return(e=E(C(n),t))?e.bandwidth:null},getIndexForRepresentation:function(t,n){return function(t,n){var e=E(t,n,!0);return null!==e?e:-1}(C(n),t)},getMaxIndexForBufferType:function(t,e){return function(t,e){var i,r=void 0,o=void 0,u=void 0;if(!t||!e)return-1;for(i=t.AdaptationSet_asArray,u=0;u<i.length;u+=1)if(o=(r=i[u]).Representation_asArray,n.getIsTypeOf(r,e))return o.length;return-1}(C(e),t)},convertDataToRepresentationInfo:function(t){if(t){var e=new i.default,r=n.getRepresentationFor(t.index,t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index]);return e.id=t.id,e.quality=t.index,e.bandwidth=n.getBandwidth(r),e.DVRWindow=t.segmentAvailabilityRange,e.fragmentDuration=t.segmentDuration||(t.segments&&t.segments.length>0?t.segments[0].duration:NaN),e.MSETimeOffset=t.MSETimeOffset,e.mediaInfo=T(t.adaptation),e}return null},getDataForMedia:b,getStreamsInfo:function(t,n){var e=[],i=s;if(t&&(S(),i=g(t)),i.length>0){(!n||n>i.length)&&(n=i.length);for(var r=0;r<n;r++)e.push(_(i[r]))}return e},getMediaInfoForType:function(t,e){if(0===s.length||!t)return null;var i=M(t,s);if(!i)return null;var r=i.id;c[r]=c[r]||n.getAdaptationsForPeriod(i);var o=v(t.index,e,t);if(!o)return null;var u=n.getIndexForAdaptation(o,s[0].mpd.manifest,t.index);return T(c[r][u])},getAllMediaInfoForType:p,getAdaptationForType:v,getRealAdaptation:function(t,e){var i,r=void 0,o=M(t,s);return i=e?e.id:null,s.length>0&&o&&(r=i?n.getAdaptationForId(i,s[0].mpd.manifest,o.index):n.getAdaptationForIndex(e?e.index:null,s[0].mpd.manifest,o.index)),r},getVoRepresentations:function(t){var e=b(t);return n.getRepresentationsForAdaptation(e)},getEventsFor:function(t,e){var u=[];if(s.length>0){var a=s[0].mpd.manifest;t instanceof o.default?u=n.getEventsForPeriod(M(t,s)):t instanceof r.default?u=n.getEventStreamForAdaptationSet(a,b(t)):t instanceof i.default&&(u=n.getEventStreamForRepresentation(a,e))}return u},getEvent:function(t,n,e){if(!t||!n)return null;var i=new a.default,r=t.scheme_id_uri,o=t.value,u=t.timescale,s=void 0,f=void 0;0===t.version?f=e*u+(s=t.presentation_time_delta):(s=0,f=t.presentation_time_delta);var c=t.event_duration,l=t.id,d=t.message_data;return n[r+"/"+o]?(i.eventStream=n[r+"/"+o],i.eventStream.value=o,i.eventStream.timescale=u,i.duration=c,i.id=l,i.calculatedPresentationTime=f,i.messageData=d,i.presentationTimeDelta=s,i):null},getMpd:m,setConfig:function(t){t&&(t.constants&&(d=t.constants),t.cea608parser&&(h=t.cea608parser),t.errHandler&&n.setConfig({errHandler:t.errHandler}),t.BASE64&&n.setConfig({BASE64:t.BASE64}))},updatePeriods:function(t){if(!t)return null;S(),s=g(t),c={}},getIsTextTrack:function(t){return n.getIsTextTrack(t)},getUTCTimingSources:function(){var t=w();return n.getUTCTimingSources(t)},getSuggestedPresentationDelay:function(){return n.getSuggestedPresentationDelay(s.length>0?s[0].mpd:null)},getAvailabilityStartTime:function(t){var e=m(t);return n.getAvailabilityStartTime(e)},getIsDynamic:function(t){var e=w(t);return n.getIsDynamic(e)},getDuration:function(t){var e=w(t);return n.getDuration(e)},getRegularPeriods:g,getLocation:function(t){return n.getLocation(t)},getManifestUpdatePeriod:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n.getManifestUpdatePeriod(t,e)},getIsDVB:function(t){return n.hasProfile(t,"urn:dvb:dash:profile:dvb-dash:2014")},getBaseURLsFromElement:function(t){return n.getBaseURLsFromElement(t)},getRepresentationSortFunction:function(){return n.getRepresentationSortFunction()},getCodec:function(t,e,i){return n.getCodec(t,e,i)},getVoAdaptations:function(){return c},getVoPeriods:function(){return s},getPeriodById:function(t){if(!t||0===s.length)return null;var n=s.filter((function(n){return n.id===t}));return n&&n.length>0?n[0]:null},setCurrentMediaInfo:function(t,n,e){l[t]=l[t]||{},l[t][n]=l[t][n]||{},l[t][n]=e},reset:y},n=(0,f.default)(this.context).getInstance(),y(),t}d.__dashjs_factory_name="DashAdapter",n.default=s.default.getSingletonFactory(d)})),zr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,null,[{key:"round10",value:function(t,n){return function(t,n,e){return void 0===e||0==+e?Math.round(n):(e=+e,null===(n=+n)||isNaN(n)||"number"!=typeof e||e%1!=0?NaN:(n=n.toString().split("e"),+((n=(n=Math.round(+(n[0]+"e"+(n[1]?+n[1]-e:-e)))).toString().split("e"))[0]+"e"+(n[1]?+n[1]+e:e))))}(0,t,n)}}]),t}();n.default=i})),Hr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]}})),Kr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.t=null,this.mt=null,this.to=null,this.lto=null}})),Vr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.t=null,this.level=null}})),Wr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=d)&&e.__esModule?e:{default:e};n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=null,this.state=i.default.BUFFER_EMPTY}})),Gr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.time=null,this.range=null,this.manifestInfo=null}})),$r=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.time=null,this.droppedFrames=null}})),Xr=o((function(t,n){function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.ManifestUpdate=function t(){e(this,t),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},n.ManifestUpdateStreamInfo=function t(){e(this,t),this.id=null,this.index=null,this.start=null,this.duration=null},n.ManifestUpdateRepresentationInfo=function t(){e(this,t),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}})),Qr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null}})),Jr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.loadingRequests=[],this.executedRequests=[]}})),Yr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=M(c),i=M(d),r=M(Hr),o=M(Kr),u=M(Vr),a=M(Wr),s=M(Gr),f=M($r),l=M(Qr),p=M(v),g=M(Jr),y=M(m),w=M(h);function M(t){return t&&t.__esModule?t:{default:t}}function T(t){var n,c=(t=t||{}).settings,d=(0,p.default)(this.context).getInstance(),h=void 0;function v(){d.trigger(y.default.METRICS_CHANGED)}function m(t){d.trigger(y.default.METRIC_CHANGED,{mediaType:t}),v()}function w(t,n,e){d.trigger(y.default.METRIC_UPDATED,{mediaType:t,metric:n,value:e}),m(t)}function M(t,n,e){d.trigger(y.default.METRIC_ADDED,{mediaType:t,metric:n,value:e}),m(t)}function T(t,n){var e=null;return t?(h.hasOwnProperty(t)?e=h[t]:n||(e=new r.default,h[t]=e),e):e}function N(t,n,e){var i=T(t);null!==i&&(i[n].push(e),i[n].length>c.get().streaming.metricsMaxListDepth&&i[n].shift())}function _(t,n,e){N(t,n,e),M(t,n,e)}return n={clearCurrentMetricsForType:function(t){delete h[t],m(t)},clearAllCurrentMetrics:function(){h={},v()},getMetricsFor:T,addHttpRequest:function t(n,e,r,o,u,a,s,f,c,l,d,h,v,p,g){var m=new b.HTTPRequest;a&&a!==o&&(t(n,null,r,o,u,null,null,f,c,null,null,null,v,null,null),m.actualurl=a),m.tcpid=e,m.type=r,m.url=o,m.range=f,m.trequest=c,m.tresponse=l,m.responsecode=h,m._tfinish=d,m._stream=n,m._mediaduration=v,m._quality=u,m._responseHeaders=p,m._serviceLocation=s,g?g.forEach((function(t){!function(t,n,e,i){var r=new b.HTTPRequestTrace;r.s=n,r.d=e,r.b=i,t.trace.push(r),t.interval||(t.interval=0),t.interval+=e}(m,t.s,t.d,t.b)})):(delete m.interval,delete m.trace),_(n,i.default.HTTP_REQUEST,m)},addRepresentationSwitch:function(t,n,e,r,u){var a=new o.default;a.t=n,a.mt=e,a.to=r,u?a.lto=u:delete a.lto,_(t,i.default.TRACK_SWITCH,a)},addBufferLevel:function(t,n,e){var r=new u.default;r.t=n,r.level=e,_(t,i.default.BUFFER_LEVEL,r)},addBufferState:function(t,n,e){var r=new a.default;r.target=e,r.state=n,_(t,i.default.BUFFER_STATE,r)},addDVRInfo:function(t,n,e,r){var o=new s.default;o.time=n,o.range=r,o.manifestInfo=e,_(t,i.default.DVR_INFO,o)},addDroppedFrames:function(t,n){var e=new f.default,r=T(t).DroppedFrames;n&&(e.time=n.creationTime,e.droppedFrames=n.droppedVideoFrames,r.length>0&&r[r.length-1]==e||_(t,i.default.DROPPED_FRAMES,e))},addSchedulingInfo:function(t,n,e,r,o,u,a,s,f){var c=new l.default;c.mediaType=t,c.t=n,c.type=e,c.startTime=r,c.availabilityStartTime=o,c.duration=u,c.quality=a,c.range=s,c.state=f,_(t,i.default.SCHEDULING_INFO,c)},addRequestsQueue:function(t,n,e){var r=new g.default;r.loadingRequests=n,r.executedRequests=e,T(t).RequestsQueue=r,M(t,i.default.REQUESTS_QUEUE,r)},addManifestUpdate:function(t,n,r,o,u,a,s,f,c,l){var d=new Xr.ManifestUpdate;d.mediaType=t,d.type=n,d.requestTime=r,d.fetchTime=o,d.availabilityStartTime=u,d.presentationStartTime=a,d.clientTimeOffset=s,d.currentTime=f,d.buffered=c,d.latency=l,N(e.default.STREAM,i.default.MANIFEST_UPDATE,d),M(t,i.default.MANIFEST_UPDATE,d)},updateManifestUpdateInfo:function(t,n){if(t){for(var e in n)t[e]=n[e];w(t.mediaType,i.default.MANIFEST_UPDATE,t)}},addManifestUpdateStreamInfo:function(t,n,e,r,o){if(t){var u=new Xr.ManifestUpdateStreamInfo;u.id=n,u.index=e,u.start=r,u.duration=o,t.streamInfo.push(u),w(t.mediaType,i.default.MANIFEST_UPDATE_STREAM_INFO,t)}},addManifestUpdateRepresentationInfo:function(t,n,e,r,o,u,a,s){if(t&&t.representationInfo){var f=new Xr.ManifestUpdateRepresentationInfo;f.id=n,f.index=e,f.streamIndex=r,f.mediaType=o,f.startNumber=a,f.fragmentInfoType=s,f.presentationTimeOffset=u,t.representationInfo.push(f),w(t.mediaType,i.default.MANIFEST_UPDATE_TRACK_INFO,t)}},addPlayList:function(t){t.trace&&Array.isArray(t.trace)?t.trace.forEach((function(t){t.hasOwnProperty("subreplevel")&&!t.subreplevel&&delete t.subreplevel})):delete t.trace,_(e.default.STREAM,i.default.PLAY_LIST,t)},addDVBErrors:function(t){_(e.default.STREAM,i.default.DVB_ERRORS,t)}},h={},n}T.__dashjs_factory_name="MetricsModel",n.default=w.default.getSingletonFactory(T)})),Zr=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(c),i=a(h),r=a(d),o=a(zr),u=a(Yr);function a(t){return t&&t.__esModule?t:{default:t}}function s(t){var n,i=void 0,a=void 0,s=void 0,f=(t=t||{}).metricsModel;function c(t){var n=f.getMetricsFor(t,!0);if(!n)return null;var e=n.HttpList,i=null,r=void 0;if(!e||e.length<=0)return null;for(r=e.length-1;r>=0;){if(e[r].responsecode){i=e[r];break}r--}return i}function l(t){var n=f.getMetricsFor(t,!0);return n&&n.HttpList?n.HttpList:[]}function d(t,n){if(!t)return null;var e=t[n];return e&&0!==e.length?e[e.length-1]:null}function h(t){var n={};if(!t)return n;for(var e=t.trim().split("\r\n"),i=0,r=e.length;i<r;i++){var o=e[i],u=o.indexOf(": ");u>0&&(n[o.substring(0,u)]=o.substring(u+2))}return n}return n={getCurrentRepresentationSwitch:function(t){return d(f.getMetricsFor(t,!0),r.default.TRACK_SWITCH)},getCurrentBufferState:function(t){return d(f.getMetricsFor(t,!0),r.default.BUFFER_STATE)},getCurrentBufferLevel:function(t){var n=d(f.getMetricsFor(t,!0),r.default.BUFFER_LEVEL);return n?o.default.round10(n.level/1e3,-3):0},getCurrentHttpRequest:c,getHttpRequests:l,getCurrentDroppedFrames:function(){return d(f.getMetricsFor(e.default.VIDEO,!0),r.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(t){return d(f.getMetricsFor(t,!0),r.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(t){return d(t?f.getMetricsFor(t,!0):f.getMetricsFor(e.default.VIDEO,!0)||f.getMetricsFor(e.default.AUDIO,!0),r.default.DVR_INFO)},getCurrentManifestUpdate:function(){return d(f.getMetricsFor(e.default.STREAM),r.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(t,n){var e={},i=c(t);return i&&(e=h(i._responseHeaders)),void 0===e[n]?null:e[n]},getLatestMPDRequestHeaderValueByID:function(t){var n,i={},r=void 0,o=void 0;for(o=(n=l(e.default.STREAM)).length-1;o>=0;o--)if((r=n[o]).type===b.HTTPRequest.MPD_TYPE){i=h(r._responseHeaders);break}return void 0===i[t]?null:i[t]},addRepresentationSwitch:function(t,n,e,i,r){f.addRepresentationSwitch(t,n,e,i,r)},addDVRInfo:function(t,n,e,i){f.addDVRInfo(t,n,e,i)},updateManifestUpdateInfo:function(t){var n=this.getCurrentManifestUpdate();f.updateManifestUpdateInfo(n,t)},addManifestUpdateStreamInfo:function(t){if(t){var n=this.getCurrentManifestUpdate();f.addManifestUpdateStreamInfo(n,t.id,t.index,t.start,t.duration)}},addManifestUpdateRepresentationInfo:function(t,n){if(t){var e=this.getCurrentManifestUpdate();f.addManifestUpdateRepresentationInfo(e,t.id,t.index,t.streamIndex,n,t.presentationTimeOffset,t.startNumber,t.fragmentInfoType)}},addManifestUpdate:function(t){f.addManifestUpdate(e.default.STREAM,t.type,t.requestStartDate,t.requestEndDate)},addHttpRequest:function(t,n,e,i,r){f.addHttpRequest(t.mediaType,null,t.type,t.url,t.quality,n,t.serviceLocation||null,t.range||null,t.requestStartDate,t.firstByteDate,t.requestEndDate,e,t.duration,i,r)},addSchedulingInfo:function(t,n){f.addSchedulingInfo(t.mediaType,new Date,t.type,t.startTime,t.availabilityStartTime,t.duration,t.quality,t.range,n)},addRequestsQueue:function(t,n,e){f.addRequestsQueue(t,n,e)},addBufferLevel:function(t,n,e){f.addBufferLevel(t,n,e)},addBufferState:function(t,n,e){f.addBufferState(t,n,e)},addDroppedFrames:function(t){f.addDroppedFrames(e.default.VIDEO,t)},addPlayList:function(){s&&(f.addPlayList(s),s=null)},addDVBErrors:function(t){f.addDVBErrors(t)},createPlaylistMetrics:function(t,n){(s=new gi.PlayList).start=new Date,s.mstart=t,s.starttype=n},createPlaylistTraceMetrics:function(t,n,e){!0===i&&(i=!1,(a=new gi.PlayListTrace).representationid=t,a.start=new Date,a.mstart=n,a.playbackspeed=null!==e?e.toString():null)},updatePlayListTraceMetrics:function(t){if(a)for(var n in a)a[n]=t[n]},pushPlayListTraceMetrics:function(t,n){if(!1===i&&s&&a&&a.start){var e=a.start,r=t.getTime()-e.getTime();a.duration=r,a.stopreason=n,s.trace.push(a),i=!0}},clearAllCurrentMetrics:function(){f.clearAllCurrentMetrics()}},f=f||(0,u.default)(this.context).getInstance({settings:t.settings}),i=!0,a=null,s=null,n}s.__dashjs_factory_name="DashMetrics",n.default=i.default.getSingletonFactory(s)})),to=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=s(v),i=s(m),r=s(h),o=s(l),u=s(Li),a=s(Ni);function s(t){return t&&t.__esModule?t:{default:t}}function f(){var t,n=this.context,r=(0,e.default)(n).getInstance(),s=(0,a.default)(n).getInstance(),f=void 0,c=void 0,l=void 0,d=void 0;function h(t){c=t}function v(t,n,e,i){return i?e&&n.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(n.availabilityStartTime.getTime()+1e3*(t+n.timeShiftBufferDepth)):n.availabilityEndTime:e?new Date(n.availabilityStartTime.getTime()+1e3*(t-c)):n.availabilityStartTime}function p(t,n){return(t.getTime()-n.mpd.availabilityStartTime.getTime()+1e3*c)/1e3}function g(t,n){return t+(n.adaptation.period.start-n.presentationTimeOffset)}function m(t){l||void 0!==t.offset&&(h(t.offset/1e3),l=!0)}function y(){c=0,l=!1,d=NaN}function w(){r.off(i.default.TIME_SYNCHRONIZATION_COMPLETED,m,this),y()}return t={initialize:function(){y(),r.on(i.default.TIME_SYNCHRONIZATION_COMPLETED,m,this)},isTimeSyncCompleted:function(){return l},setTimeSyncCompleted:function(t){l=t},getClientTimeOffset:function(){return c},setClientTimeOffset:h,getExpectedLiveEdge:function(){return d},setExpectedLiveEdge:function(t){d=t},calcAvailabilityStartTimeFromPresentationTime:function(t,n,e){return v.call(this,t,n,e)},calcAvailabilityEndTimeFromPresentationTime:function(t,n,e){return v.call(this,t,n,e,!0)},calcPresentationTimeFromWallTime:p,calcPresentationTimeFromMediaTime:g,calcPeriodRelativeTimeFromMpdRelativeTime:function(t,n){return n-t.adaptation.period.start},calcMediaTimeFromPresentationTime:function(t,n){return t-n.adaptation.period.start+n.presentationTimeOffset},calcSegmentAvailabilityRange:function(t,n){var e=t.adaptation.period,i={start:e.start,end:e.start+e.duration};if(!n)return i;if(!l&&t.segmentAvailabilityRange)return t.segmentAvailabilityRange;var r=t.segmentDuration||(t.segments&&t.segments.length?t.segments[t.segments.length-1].duration:0);if(t.segmentInfoType===o.default.SEGMENT_TIMELINE&&s.get().streaming.calcSegmentAvailabilityRangeFromTimeline)return function(t){var n,e=f.getRepresentationFor(t.index,t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index]),i=e.SegmentTemplate.timescale,r=e.SegmentTemplate.SegmentTimeline.S_asArray,o={start:0,end:0},u=0,a=void 0,s=void 0,c=void 0;for(o.start=g(r[0].t/i,t),c=0,n=r.length;c<n;c++)s=0,(a=r[c]).hasOwnProperty("r")&&(s=a.r),u+=a.d/i*(1+s);return o.end=o.start+u,o}(t);var u=p(new Date,e),a=e.start+e.duration;i.start=Math.max(u-e.mpd.timeShiftBufferDepth,e.start);var c=void 0!==t.availabilityTimeOffset&&t.availabilityTimeOffset<r?r-t.availabilityTimeOffset:r;return i.end=u>=a&&u-c<a?a:u-c,i},getPeriodEnd:function(t,n){var e=t.adaptation.period;if(!n)return e.start+e.duration;if(!l&&t.segmentAvailabilityRange)return t.segmentAvailabilityRange;var i=t.segmentDuration||(t.segments&&t.segments.length?t.segments[t.segments.length-1].duration:0),r=p(new Date,e);return Math.min(r-(void 0!==t.availabilityTimeOffset&&t.availabilityTimeOffset<i?i-t.availabilityTimeOffset:i),e.start+e.duration)},calcWallTimeForSegment:function(t,n){var e=void 0,i=void 0;return n&&(e=t.presentationStartTime+t.representation.adaptation.period.mpd.suggestedPresentationDelay,i=new Date(t.availabilityStartTime.getTime()+1e3*e)),i},reset:w},f=(0,u.default)(n).getInstance(),w(),t}f.__dashjs_factory_name="TimelineConverter",n.default=r.default.getSingletonFactory(f)})),no=o((function(t,n){var e,i,r,o,u,f=function(t){for(var n=[],e=0;e<t.length;++e){var i=t.charCodeAt(e);i<128?n.push(i):i<2048?(n.push(192|i>>6),n.push(128|63&i)):i<65536?(n.push(224|i>>12),n.push(128|63&i>>6),n.push(128|63&i)):(n.push(240|i>>18),n.push(128|63&i>>12),n.push(128|63&i>>6),n.push(128|63&i))}return n},c=function(t){for(var n=[],e=0;e<t.length;){var i=t[e++];i<128||(i<224?(i=(31&i)<<6,i|=63&t[e++]):i<240?(i=(15&i)<<12,i|=(63&t[e++])<<6,i|=63&t[e++]):(i=(7&i)<<18,i|=(63&t[e++])<<12,i|=(63&t[e++])<<6,i|=63&t[e++])),n.push(String.fromCharCode(i))}return n.join("")},l={};e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=function(t){for(var n=0,i=[],r=0|t.length/3;0<r--;){var o=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,i.push(e.charAt(63&o>>18)),i.push(e.charAt(63&o>>12)),i.push(e.charAt(63&o>>6)),i.push(e.charAt(63&o))}return 2==t.length-n?(i.push(e.charAt(63&(o=(t[n]<<16)+(t[n+1]<<8))>>18)),i.push(e.charAt(63&o>>12)),i.push(e.charAt(63&o>>6)),i.push("=")):1==t.length-n&&(i.push(e.charAt(63&(o=t[n]<<16)>>18)),i.push(e.charAt(63&o>>12)),i.push("==")),i.join("")},r=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),o=function(t){for(var n=0,e=[],i=0|t.length/4;0<i--;){var o=(r[t.charCodeAt(n)]<<18)+(r[t.charCodeAt(n+1)]<<12)+(r[t.charCodeAt(n+2)]<<6)+r[t.charCodeAt(n+3)];e.push(255&o>>16),e.push(255&o>>8),e.push(255&o),n+=4}return e&&("="==t.charAt(n-2)?(e.pop(),e.pop()):"="==t.charAt(n-1)&&e.pop()),e},u={encode:function(t){for(var n=[],e=0;e<t.length;++e)n.push(t.charCodeAt(e));return n},decode:function(){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}},l.decodeArray=function(t){var n=o(t);return new Uint8Array(n)},l.encodeASCII=function(t){var n=u.encode(t);return i(n)},l.decodeASCII=function(t){var n=o(t);return u.decode(n)},l.encode=function(t){var n=f(t);return i(n)},l.decode=function(t){var n=o(t);return c(n)},n.decode=l.decode,n.decodeArray=l.decodeArray,n.encode=l.encode,n.encodeASCII=l.encodeASCII})),eo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=et(f),i=et(c),r=et(l),o=et(d),u=et(w),a=et(nr),s=et(er),p=et(Qe),g=et(sr),M=et(_r),T=et(Sr),_=et(Cr),S=et(Ce),C=et(hi),k=et(xe),I=et(kr),D=et(Or),x=et(Rr),A=et(Xe),j=et(Hi),F=et(Ir),P=et(qi),B=et(Dr),L=et(y),U=et(Oe),q=et(v),z=et(m),H=et(Mi),K=et(h),V=et(Ni),W=et(Fr),G=et(qr),$=et(Zr),X=et(to),Q=et(no),J=et(E),Y=et(N),Z=et(Ji),tt=et(pi),nt=et(O);function et(t){return t&&t.__esModule?t:{default:t}}function it(){var t,n="You must first call initialize() and set a source before calling this method",f="You must first call initialize() and set a valid source and view before calling this method",c="You must first call attachView() to set the video element before calling this method",l="You must first call attachSource() with a valid source before calling this method",d="MediaPlayer not initialized!",h=this.context,v=(0,q.default)(h).getInstance(),m=(0,V.default)(h).getInstance(),y=(0,L.default)(h).getInstance({settings:m}),w=void 0,N=void 0,E=void 0,O=void 0,et=void 0,it=void 0,rt=void 0,ot=void 0,ut=void 0,at=void 0,st=void 0,ft=void 0,ct=void 0,lt=void 0,dt=void 0,ht=void 0,vt=void 0,pt=void 0,gt=void 0,mt=void 0,yt=void 0,wt=void 0,bt=void 0,Mt=void 0,Tt=void 0,Nt=void 0,_t=void 0,St=void 0,Ct=void 0,Et=void 0,kt=void 0;function Ot(){return!!N&&!!_t.getElement()}function Rt(){return(0,Ui.getVersionString)()}function It(){if(!it)throw f;return bt.isPaused()}function Dt(t){var n=Mt.getCurrentDVRInfo();if(!n)return 0;var e=bt.getLiveDelay(),i=n.range.start+t;return i>n.range.end-e&&(i=n.range.end-e),i}function xt(t){if(!it)throw f;var n=Bt().currentTime;if(void 0!==t)n=yt.getTimeRelativeToStreamId(n,t);else if(bt.getIsDynamic()){var e=Mt.getCurrentDVRInfo();n=null===e?0:At()-(e.range.end-e.time)}return n}function At(){if(!it)throw f;var t=Bt().duration;if(bt.getIsDynamic()){var n,e=Mt.getCurrentDVRInfo();if(!e)return 0;t=(n=e.range.end-e.range.start)<e.manifestInfo.DVRWindowSize?n:e.manifestInfo.DVRWindowSize}return t}function jt(t){(0,R.checkParameterType)(t,"boolean"),rt=t}function Ft(){vt.restoreDefaultUTCTimingSources()}function Pt(){return Mt}function Bt(){if(!_t.getElement())throw c;return _t.getElement()}function Lt(t){if(!O)throw d;_t.setElement(t),t&&(Vt(),function(){if(!ct){var t=dashjs.MetricsReporting;if("function"==typeof t){var n=t(h).create();ct=n.createMetricsReporting({debug:y,eventBus:v,mediaElement:Bt(),adapter:ht,dashMetrics:Mt,events:z.default,constants:i.default,metricsConstants:o.default})}}}(),function(){if(!lt){var t=dashjs.MssHandler;"function"==typeof t&&(U.default.extend(t.errors),lt=t(h).create({eventBus:v,mediaPlayerModel:vt,dashMetrics:Mt,manifestModel:Tt,playbackController:bt,streamController:yt,protectionController:ft,baseURLController:gt,errHandler:pt,events:z.default,constants:i.default,debug:y,initSegmentType:b.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:Q.default,ISOBoxer:J.default,settings:m}))}}(),yt&&yt.switchToVideoElement()),it&&Ht(),$t()}function Ut(t){if(!et)throw n;var e=yt.getActiveStreamInfo();return st.getTracksFor(t,e)}function qt(t){if(!O)throw d;"string"==typeof t&&Ct.initialize(t),N=t,(et||it)&&Ht(),Ot()&&$t()}function zt(){if(!et)throw n;var t=yt.getActiveStreamInfo();return t?yt.getStreamById(t.id):null}function Ht(){it=!1,et=!1,ht.reset(),yt.reset(),wt.reset(),bt.reset(),ot.reset(),st.reset(),St.reset(),ft&&(m.get().streaming.keepProtectionMediaKeys?ft.stop():(ft.reset(),ft=null,Vt())),Nt.reset()}function Kt(){return(0,M.default)(h).create({debug:y,errHandler:pt,dashMetrics:Mt,mediaPlayerModel:vt,requestModifier:(0,C.default)(h).getInstance(),mssHandler:lt,settings:m})}function Vt(){if(ft)return ft;var t=dashjs.Protection;if("function"==typeof t){var n=t(h).create();return z.default.extend(t.events),H.default.extend(t.events,{publicOnly:!0}),U.default.extend(t.errors),mt||(mt=(0,_.default)(h).getInstance()),ft=n.createProtectionSystem({debug:y,errHandler:pt,videoModel:_t,capabilities:mt,eventBus:v,events:z.default,BASE64:Q.default,constants:i.default})}return null}function Wt(){if(!O)throw d;if(dt)return dt;var t=dashjs.OfflineController;if("function"==typeof t){z.default.extend(t.events),H.default.extend(t.events,{publicOnly:!0}),U.default.extend(t.errors);var n=Kt(),e=(0,Z.default)(h).create();return e.setConfig({manifestModel:Tt,adapter:ht,manifestLoader:n,errHandler:pt}),dt=t(h).create({debug:y,manifestUpdater:e,baseURLController:gt,manifestLoader:n,manifestModel:Tt,mediaPlayerModel:vt,abrController:ot,playbackController:bt,adapter:ht,errHandler:pt,dashMetrics:Mt,timelineConverter:at,schemeLoaderFactory:ut,eventBus:v,events:z.default,errors:U.default,constants:i.default,settings:m,dashConstants:r.default,urlUtils:(0,tt.default)(h).getInstance()})}return null}function Gt(t){var n=Mt.getCurrentDVRInfo();return n?t+(n.manifestInfo.availableFrom.getTime()/1e3+n.range.start):0}function $t(){var t;dt&&dt.resetRecords(),!et&&N&&(et=!0,w.info("Streaming Initialized"),t=Kt(),yt||(yt=(0,a.default)(h).getInstance()),st.setConfig({domStorage:Et}),yt.setConfig({capabilities:mt,manifestLoader:t,manifestModel:Tt,mediaPlayerModel:vt,protectionController:ft,adapter:ht,dashMetrics:Mt,errHandler:pt,timelineConverter:at,videoModel:_t,playbackController:bt,abrController:ot,mediaController:st,textController:St,settings:m,baseURLController:gt}),wt.setConfig({settings:m,playbackController:bt,streamController:yt,videoModel:_t,timelineConverter:at,adapter:ht}),bt.setConfig({streamController:yt,dashMetrics:Mt,mediaPlayerModel:vt,adapter:ht,videoModel:_t,timelineConverter:at,uriFragmentModel:Ct,settings:m}),ot.setConfig({streamController:yt,domStorage:Et,mediaPlayerModel:vt,dashMetrics:Mt,adapter:ht,videoModel:_t,settings:m}),ot.createAbrRulesCollection(),St.setConfig({errHandler:pt,manifestModel:Tt,adapter:ht,mediaController:st,streamController:yt,videoModel:_t}),Nt.setConfig({abrController:ot,dashMetrics:Mt,playbackController:bt}),yt.initialize(rt,E),wt.initialize(),Nt.initialize(),"string"==typeof N?yt.load(N):yt.loadWithManifest(N)),!it&&Ot()&&(it=!0,w.info("Playback Initialized"))}return t={initialize:function(t,n,r){mt||(mt=(0,_.default)(h).getInstance()),pt=(0,T.default)(h).getInstance(),mt.supportsMediaSource()?O||(O=!0,at=(0,X.default)(h).getInstance(),ot||(ot=(0,A.default)(h).getInstance()).setConfig({settings:m}),ut||(ut=(0,j.default)(h).getInstance()),bt||(bt=(0,u.default)(h).getInstance()),st||(st=(0,p.default)(h).getInstance()),yt||(yt=(0,a.default)(h).getInstance()),wt||(wt=(0,s.default)(h).getInstance()),ht=(0,G.default)(h).getInstance(),Tt=(0,D.default)(h).getInstance(),Nt=(0,P.default)(h).getInstance(),Mt=(0,$.default)(h).getInstance({settings:m}),St=(0,k.default)(h).getInstance(),Et=(0,B.default)(h).getInstance({settings:m}),ht.setConfig({constants:i.default,cea608parser:e.default,errHandler:pt,BASE64:Q.default}),gt||(gt=(0,g.default)(h).create()),gt.setConfig({adapter:ht}),(kt=(0,W.default)(h).getInstance({dashMetrics:Mt,mediaPlayerModel:vt,errHandler:pt,baseURLController:gt,events:z.default,eventBus:v,debug:y,boxParser:(0,nt.default)(h).getInstance(),requestModifier:(0,C.default)(h).getInstance(),errors:U.default})).initialize(),Ft(),jt(void 0===r||r),Wt(),t&&Lt(t),n&&qt(n),w.info("[dash.js "+Rt()+"] MediaPlayer has been initialized")):pt.error(new Y.default(U.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,U.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(t){t&&(t.capabilities&&(mt=t.capabilities),t.streamController&&(yt=t.streamController),t.gapController&&(wt=t.gapController),t.playbackController&&(bt=t.playbackController),t.mediaPlayerModel&&(vt=t.mediaPlayerModel),t.abrController&&(ot=t.abrController),t.schemeLoaderFactory&&(ut=t.schemeLoaderFactory),t.mediaController&&(st=t.mediaController),t.settings&&(m=t.settings))},on:function(t,n,e){v.on(t,n,e)},off:function(t,n,e){v.off(t,n,e)},extend:function(t,n,e){K.default.extend(t,n,e,h)},attachView:Lt,attachSource:qt,isReady:Ot,preload:function(){if(_t.getElement()||et)return!1;if(!N)throw l;$t()},play:function(){if(!it)throw f;(!rt||It()&&it)&&bt.play()},isPaused:It,pause:function(){if(!it)throw f;bt.pause()},isSeeking:function(){if(!it)throw f;return bt.isSeeking()},isDynamic:function(){if(!it)throw f;return bt.getIsDynamic()},seek:function(t){if(!it)throw f;if((0,R.checkParameterType)(t,"number"),isNaN(t))throw i.default.BAD_ARGUMENT_ERROR;var n=bt.getIsDynamic()?Dt(t):t;bt.seek(n)},setPlaybackRate:function(t){Bt().playbackRate=t},getPlaybackRate:function(){return Bt().playbackRate},setMute:function(t){(0,R.checkParameterType)(t,"boolean"),Bt().muted=t},isMuted:function(){return Bt().muted},setVolume:function(t){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw i.default.BAD_ARGUMENT_ERROR;Bt().volume=t},getVolume:function(){return Bt().volume},time:xt,duration:At,timeAsUTC:function(){if(!it)throw f;return xt()<0?NaN:Gt(xt())},durationAsUTC:function(){if(!it)throw f;return Gt(At())},getActiveStream:zt,getDVRWindowSize:function(){var t=Mt.getCurrentDVRInfo();return t?t.manifestInfo.DVRWindowSize:0},getDVRSeekOffset:Dt,convertToTimeCode:function(t){t=Math.max(t,0);var n=Math.floor(t/3600),e=Math.floor(t%3600/60),i=Math.floor(t%3600%60);return(0===n?"":n<10?"0"+n.toString()+":":n.toString()+":")+(e<10?"0"+e.toString():e.toString())+":"+(i<10?"0"+i.toString():i.toString())},formatUTC:function(t,n,e){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=new Date(1e3*t),o=r.toLocaleDateString(n),u=r.toLocaleTimeString(n,{hour12:e});return i?u+" "+o:u},getVersion:Rt,getDebug:function(){return y},getBufferLength:function(t){var n=[i.default.VIDEO,i.default.AUDIO,i.default.FRAGMENTED_TEXT];if(t)return-1!==n.indexOf(t)?Pt().getCurrentBufferLevel(t)||NaN:(w.warn("getBufferLength requested for invalid type"),NaN);var e=n.map((function(t){return Ut(t).length>0?Pt().getCurrentBufferLevel(t):Number.MAX_VALUE})).reduce((function(t,n){return Math.min(t,n)}));return e===Number.MAX_VALUE?NaN:e},getTTMLRenderingDiv:function(){return _t?_t.getTTMLRenderingDiv():null},getVideoElement:Bt,getSource:function(){if(!N)throw l;return N},getCurrentLiveLatency:function(){if(!O)throw d;return it?bt.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(t){if(!et)throw n;return ot.getTopBitrateInfoFor(t)},setAutoPlay:jt,getAutoPlay:function(){return rt},getDashMetrics:Pt,getQualityFor:function(t){if(!et)throw n;if(t===i.default.IMAGE){var e=zt();if(!e)return-1;var r=e.getThumbnailController();return r?r.getCurrentTrackIndex():-1}return ot.getQualityFor(t)},setQualityFor:function(t,e){if(!et)throw n;if(t===i.default.IMAGE){var r=zt();if(!r)return;var o=r.getThumbnailController();o&&o.setTrackByIndex(e)}ot.setPlaybackQuality(t,yt.getActiveStreamInfo(),e)},updatePortalSize:function(){ot.setElementSize(),ot.setWindowResizeEventCalled(!0)},setTextDefaultLanguage:function(t){w.warn('setTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use setInitialMediaSettingsFor("fragmentedText", { lang: lang }) instead'),void 0===St&&(St=(0,k.default)(h).getInstance()),St.setTextDefaultLanguage(t)},getTextDefaultLanguage:function(){return w.warn('getTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use getInitialMediaSettingsFor("fragmentedText").lang instead'),void 0===St&&(St=(0,k.default)(h).getInstance()),St.getTextDefaultLanguage()},setTextDefaultEnabled:function(t){void 0===St&&(St=(0,k.default)(h).getInstance()),St.setTextDefaultEnabled(t)},getTextDefaultEnabled:function(){return void 0===St&&(St=(0,k.default)(h).getInstance()),St.getTextDefaultEnabled()},enableText:function(t){void 0===St&&(St=(0,k.default)(h).getInstance()),St.enableText(t)},enableForcedTextStreaming:function(t){void 0===St&&(St=(0,k.default)(h).getInstance()),St.enableForcedTextStreaming(t)},isTextEnabled:function(){return void 0===St&&(St=(0,k.default)(h).getInstance()),St.isTextEnabled()},setTextTrack:function(t){if(!it)throw f;void 0===St&&(St=(0,k.default)(h).getInstance()),St.setTextTrack(t)},getBitrateInfoListFor:function(t){if(!et)throw n;var e=zt();return e?e.getBitrateListFor(t):[]},getStreamsFromManifest:function(t){if(!et)throw n;return ht.getStreamsInfo(t)},getTracksFor:Ut,getTracksForTypeFromManifest:function(t,e,i){if(!et)throw n;return(i=i||ht.getStreamsInfo(e,1)[0])?ht.getAllMediaInfoForType(i,t,e):[]},getCurrentTrackFor:function(t){if(!et)throw n;var e=yt.getActiveStreamInfo();return st.getCurrentTrackFor(t,e)},setInitialMediaSettingsFor:function(t,n){if(!O)throw d;st.setInitialSettings(t,n),t===i.default.FRAGMENTED_TEXT&&St.setInitialSettings(n)},getInitialMediaSettingsFor:function(t){if(!O)throw d;return st.getInitialSettings(t)},setCurrentTrack:function(t){if(!et)throw n;st.setTrack(t)},getTrackSwitchModeFor:function(t){if(!O)throw d;return st.getSwitchMode(t)},setTrackSwitchModeFor:function(t,n){if(!O)throw d;st.setSwitchMode(t,n)},setSelectionModeForInitialTrack:function(t){if(!O)throw d;st.setSelectionModeForInitialTrack(t)},getSelectionModeForInitialTrack:function(){if(!O)throw d;return st.getSelectionModeForInitialTrack()},addABRCustomRule:function(t,n,e){vt.addABRCustomRule(t,n,e)},removeABRCustomRule:function(t){vt.removeABRCustomRule(t)},removeAllABRCustomRule:function(){vt.removeABRCustomRule()},getAverageThroughput:function(t){var n=ot.getThroughputHistory();return n?n.getAverageThroughput(t):0},retrieveManifest:function(t,n){var e=Kt(),i=this;v.on(z.default.INTERNAL_MANIFEST_LOADED,(function t(r){r.error?n(null,r.error):n(r.manifest),v.off(z.default.INTERNAL_MANIFEST_LOADED,t,i),e.reset()}),i),Ct.initialize(t),e.load(t)},addUTCTimingSource:function(t,n){vt.addUTCTimingSource(t,n)},removeUTCTimingSource:function(t,n){vt.removeUTCTimingSource(t,n)},clearDefaultUTCTimingSources:function(){vt.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:Ft,setXHRWithCredentialsForType:function(t,n){vt.setXHRWithCredentialsForType(t,n)},getXHRWithCredentialsForType:function(t){return vt.getXHRWithCredentialsForType(t)},getProtectionController:function(){return Vt()},attachProtectionController:function(t){ft=t},setProtectionData:function(t){E=t,yt&&yt.setProtectionData(E)},displayCaptionsOnTop:function(t){var n=(0,S.default)(h).getInstance();n.setConfig({videoModel:_t}),n.initialize(),n.setDisplayCConTop(t)},attachTTMLRenderingDiv:function(t){if(!_t.getElement())throw c;_t.setTTMLRenderingDiv(t)},getCurrentTextTrackIndex:function(){var t=NaN;return St&&(t=St.getCurrentTrackIdx()),t},provideThumbnail:function(t,n){if("function"==typeof n)if(t<0)n(null);else{var e=bt.getIsDynamic()?Dt(t):t,i=yt.getStreamForTime(e);if(null!==i){var r=i.getThumbnailController();if(r){var o=yt.getTimeRelativeToStreamId(e,i.getId());return r.provide(o,n)}n(null)}else n(null)}},getDashAdapter:function(){return ht},getOfflineController:function(){return Wt()},getSettings:function(){return m.get()},updateSettings:function(t){m.update(t)},resetSettings:function(){m.reset()},reset:function(){qt(null),Lt(null),E=null,ft&&(ft.reset(),ft=null),ct&&(ct.reset(),ct=null),kt.reset(),m.reset(),dt&&(dt.reset(),dt=null)}},w=y.getLogger(t),O=!1,it=!1,et=!1,rt=!0,ft=null,dt=null,E=null,ht=null,kt=null,z.default.extend(H.default),vt=(0,x.default)(h).getInstance(),_t=(0,F.default)(h).getInstance(),Ct=(0,I.default)(h).getInstance(),t}it.__dashjs_factory_name="MediaPlayer";var rt=K.default.getClassFactory(it);rt.events=H.default,rt.errors=U.default,K.default.updateClassFactory(it.__dashjs_factory_name,rt),n.default=rt})),io=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Debug=n.FactoryMaker=n.MediaPlayer=void 0;var e=u(eo),i=u(h),o=u(y);function u(t){return t&&t.__esModule?t:{default:t}}var a="undefined"!=typeof window&&window||r,s=a.dashjs;s||(s=a.dashjs={}),s.MediaPlayer=e.default,s.FactoryMaker=i.default,s.Debug=o.default,s.Version=(0,Ui.getVersionString)(),n.default=s,n.MediaPlayer=e.default,n.FactoryMaker=i.default,n.Debug=o.default})),ro=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};e.SSL_CONNECTION_FAILED_PREFIX="SSL",e.DNS_RESOLUTION_FAILED="C00",e.HOST_UNREACHABLE="C01",e.CONNECTION_REFUSED="C02",e.CONNECTION_ERROR="C03",e.CORRUPT_MEDIA_ISOBMFF="M00",e.CORRUPT_MEDIA_OTHER="M01",e.BASE_URL_CHANGED="F00",e.BECAME_REPORTER="S00",n.default=e})),oo=o((function(t,n){var e;Object.defineProperty(n,"__esModule",{value:!0});var i=new(function(t){function n(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",t.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(((e=p)&&e.__esModule?e:{default:e}).default));n.default=i})),uo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(ro),i=r(oo);function r(t){return t&&t.__esModule?t:{default:t}}function o(t){var n=void 0,r=void 0,o=(t=t||{}).eventBus,u=t.dashMetrics,a=t.metricsConstants,s=t.events;function f(t){var n=new e.default;if(r){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.mpdurl||(n.mpdurl=r.originalUrl||r.url),n.terror||(n.terror=new Date),u.addDVBErrors(n)}}function c(t){t.error||(r=t.manifest)}function l(t){f({errorcode:e.default.BASE_URL_CHANGED,servicelocation:t.entry})}function d(){f({errorcode:e.default.BECAME_REPORTER})}function h(t){switch(t.metric){case a.HTTP_REQUEST:(0===(n=t.value).responsecode||n.responsecode>=400||n.responsecode<100||n.responsecode>=600)&&f({errorcode:n.responsecode||e.default.CONNECTION_ERROR,url:n.url,terror:n.tresponse,servicelocation:n._serviceLocation})}var n}function v(t){var n=void 0;switch(t.error?t.error.code:0){case MediaError.MEDIA_ERR_NETWORK:n=e.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:n=e.default.CORRUPT_MEDIA_OTHER;break;default:return}f({errorcode:n})}function p(){o.on(s.MANIFEST_UPDATED,c,n),o.on(s.SERVICE_LOCATION_BLACKLIST_CHANGED,l,n),o.on(s.METRIC_ADDED,h,n),o.on(s.METRIC_UPDATED,h,n),o.on(s.PLAYBACK_ERROR,v,n),o.on(i.default.BECAME_REPORTING_PLAYER,d,n)}return n={initialise:p,reset:function(){o.off(s.MANIFEST_UPDATED,c,n),o.off(s.SERVICE_LOCATION_BLACKLIST_CHANGED,l,n),o.off(s.METRIC_ADDED,h,n),o.off(s.METRIC_UPDATED,h,n),o.off(s.PLAYBACK_ERROR,v,n),o.off(i.default.BECAME_REPORTING_PLAYER,d,n)}},p(),n}o.__dashjs_factory_name="DVBErrorsTranslator",n.default=dashjs.FactoryMaker.getSingletonFactory(o)})),ao=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=I)&&e.__esModule?e:{default:e};function r(t){var n,e=!1,r=void 0,o=(t=t||{}).mediaElement;return n={initialize:function(t){t&&t.length&&(t.forEach((function(t){var n=t.starttime;r.add(n,n+t.duration)})),e=!!t[0]._useWallClockTime)},reset:function(){r.clear()},isEnabled:function(){var t,n=r.length;if(!n)return!0;t=e?(new Date).getTime()/1e3:o.currentTime;for(var i=0;i<n;i+=1){var u=r.start(i),a=r.end(i);if(u<=t&&t<a)return!0}return!1}},r=(0,i.default)(this.context).create(),n}r.__dashjs_factory_name="RangeController",n.default=dashjs.FactoryMaker.getClassFactory(r)})),so=o((function(t,n){function e(){return{serialise:function t(n){var e=[],i=[],r=void 0,o=void 0;for(r in n)if(n.hasOwnProperty(r)&&0!==r.indexOf("_")){if(null==(o=n[r])&&(o=""),Array.isArray(o)){if(!o.length)continue;i=[],o.forEach((function(n){var e="Object"!==Object.prototype.toString.call(n).slice(8,-1);i.push(e?n:t(n))})),o=i.map(encodeURIComponent).join(",")}else"string"==typeof o?o=encodeURIComponent(o):o instanceof Date?o=o.toISOString():"number"==typeof o&&(o=Math.round(o));e.push(r+"="+o)}return e.join("&")}}}Object.defineProperty(n,"__esModule",{value:!0}),e.__dashjs_factory_name="MetricSerialiser",n.default=dashjs.FactoryMaker.getSingletonFactory(e)})),fo=o((function(t,n){function e(){var t,n=window.crypto||window.msCrypto,e=Uint32Array,i=Math.pow(2,8*e.BYTES_PER_ELEMENT)-1,r=void 0,o=void 0;function u(){n&&(r||(r=new e(10)),n.getRandomValues(r),o=0)}return t={random:function(t,e){var a=void 0;return t||(t=0),e||(e=1),n?(o===r.length&&u(),a=r[o]/i,o+=1):a=Math.random(),a*(e-t)+t}},u(),t}Object.defineProperty(n,"__esModule",{value:!0}),e.__dashjs_factory_name="RNG",n.default=dashjs.FactoryMaker.getSingletonFactory(e)})),co=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(so),i=r(fo);function r(t){return t&&t.__esModule?t:{default:t}}function o(t){var n,r=this.context,o=void 0,u=void 0,a=void 0,s=void 0,f=void 0,c=void 0,l=[],d=(t=t||{}).metricsConstants;function h(){a=!1,s=!1,f=null,c=null}return n={report:function(t,n){Array.isArray(n)||(n=[n]),s&&c.isEnabled()&&n.forEach((function(n){var e=o.serialise(n);t!==d.DVB_ERRORS&&(e="metricname="+t+"&"+e),function(t,n,e){var i=new XMLHttpRequest,r=function(){var t=l.indexOf(i);-1!==t&&(l.splice(t,1),!(i.status>=200&&i.status<300)&&(e&&e()))};l.push(i);try{i.open("GET",t),i.onloadend=r,i.onerror=r,i.send()}catch(t){i.onerror()}}(e=f+"?"+e,0,(function(){s=!1}))}))},initialize:function(t,n){var e=void 0;if(c=n,!(f=t["dvb:reportingUrl"]))throw new Error("required parameter missing (dvb:reportingUrl)");a||((e=t["dvb:probability"]||t["dvb:priority"]||0)&&(1e3===e||e/1e3>=u.random())&&(s=!0),a=!0)},reset:function(){h()}},o=(0,e.default)(r).getInstance(),u=(0,i.default)(r).getInstance(),h(),n}o.__dashjs_factory_name="DVBReporting",n.default=dashjs.FactoryMaker.getClassFactory(o)})),lo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=co)&&e.__esModule?e:{default:e};function r(t){var n={"urn:dvb:dash:reporting:2014":i.default},e=this.context,r=void 0,o=(t=t||{}).debug?t.debug.getLogger(r):{},u=t.metricsConstants;return{create:function(t,i){var r=void 0;try{(r=n[t.schemeIdUri](e).create({metricsConstants:u})).initialize(t,i)}catch(n){r=null,o.error("ReportingFactory: could not create Reporting with schemeIdUri "+t.schemeIdUri+" ("+n.message+")")}return r},register:function(t,e){n[t]=e},unregister:function(t){delete n[t]}}}r.__dashjs_factory_name="ReportingFactory",n.default=dashjs.FactoryMaker.getSingletonFactory(r)})),ho=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=lo)&&e.__esModule?e:{default:e};function r(t){var n=[],e=(0,i.default)(this.context).getInstance(t);return{initialize:function(t,i){t.some((function(t){var r=e.create(t,i);if(r)return n.push(r),!0}))},reset:function(){n.forEach((function(t){return t.reset()})),n=[]},report:function(t,e){n.forEach((function(n){return n.report(t,e)}))}}}r.__dashjs_factory_name="ReportingController",n.default=dashjs.FactoryMaker.getClassFactory(r)})),vo=o((function(t,n){function e(){return{reconstructFullMetricName:function(t,n,e){var i=t;return n&&(i+="("+n,e&&e.length&&(i+=","+e),i+=")"),i},validateN:function(t){if(!t)throw new Error("missing n");if(isNaN(t))throw new Error("n is NaN");if(t<0)throw new Error("n must be positive");return t}}}Object.defineProperty(n,"__esModule",{value:!0}),e.__dashjs_factory_name="HandlerHelpers",n.default=dashjs.FactoryMaker.getSingletonFactory(e)})),po=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=vo)&&e.__esModule?e:{default:e};function r(t){t=t||{};var n=void 0,e=void 0,r=void 0,o=void 0,u=void 0,a=(0,i.default)(this.context).getInstance(),s=[],f=t.metricsConstants;function c(){var t=function(){try{return Object.keys(s).map((function(t){return s[t]})).reduce((function(t,n){return t.level<n.level?t:n}))}catch(t){return}}();t&&u!==t.t&&(u=t.t,n.report(r,t))}return{initialize:function(t,i,u){i&&(e=a.validateN(u),n=i,r=a.reconstructFullMetricName(t,u),o=setInterval(c,e))},reset:function(){clearInterval(o),o=null,e=0,n=null,u=null},handleNewMetric:function(t,n,e){t===f.BUFFER_LEVEL&&(s[e]=n)}}}r.__dashjs_factory_name="BufferLevelHandler",n.default=dashjs.FactoryMaker.getClassFactory(r)})),go=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=oo)&&e.__esModule?e:{default:e};n.default=dashjs.FactoryMaker.getClassFactory((function(t){var n=void 0,e=(t=t||{}).eventBus,r=t.metricsConstants;function o(){e.off(i.default.METRICS_INITIALISATION_COMPLETE,o,this),e.trigger(i.default.BECAME_REPORTING_PLAYER)}return{initialize:function(t,r){r&&(n=r,e.on(i.default.METRICS_INITIALISATION_COMPLETE,o,this))},reset:function(){n=null},handleNewMetric:function(t,e){t===r.DVB_ERRORS&&n&&n.report(t,e)}}}))})),mo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=vo)&&e.__esModule?e:{default:e};function r(t){t=t||{};var n=void 0,e=void 0,r=void 0,o=void 0,u=void 0,a=[],s=(0,i.default)(this.context).getInstance(),f=t.metricsConstants;function c(){a.length&&n&&n.report(o,a),a=[]}return{initialize:function(t,i,a,f){i&&(e=s.validateN(a),n=i,f&&f.length&&(r=f),o=s.reconstructFullMetricName(t,a,f),u=setInterval(c,e))},reset:function(){clearInterval(u),u=null,e=null,r=null,a=[],n=null},handleNewMetric:function(t,n){t===f.HTTP_REQUEST&&(r&&r!==n.type||a.push(n))}}}r.__dashjs_factory_name="HttpListHandler",n.default=dashjs.FactoryMaker.getClassFactory(r)})),yo=o((function(t,n){function e(){var t=void 0,n=void 0;return{initialize:function(e,i){t=e,n=i},reset:function(){n=null,t=void 0},handleNewMetric:function(e,i){e===t&&n&&n.report(t,i)}}}Object.defineProperty(n,"__esModule",{value:!0}),e.__dashjs_factory_name="GenericMetricHandler",n.default=dashjs.FactoryMaker.getClassFactory(e)})),wo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=u(po),i=u(go),r=u(mo),o=u(yo);function u(t){return t&&t.__esModule?t:{default:t}}function a(t){var n=void 0,u=(t=t||{}).debug?t.debug.getLogger(n):{},a=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,s=this.context,f={BufferLevel:e.default,DVBErrors:i.default,HttpList:r.default,PlayList:o.default,RepSwitchList:o.default,TcpList:o.default};return{create:function(n,e){var i,r=n.match(a);if(r){try{(i=f[r[1]](s).create({eventBus:t.eventBus,metricsConstants:t.metricsConstants})).initialize(r[1],e,r[3],r[5])}catch(t){i=null,u.error("MetricsHandlerFactory: Could not create handler for type "+r[1]+" with args "+r[3]+", "+r[5]+" ("+t.message+")")}return i}},register:function(t,n){f[t]=n},unregister:function(t){delete f[t]}}}a.__dashjs_factory_name="MetricsHandlerFactory",n.default=dashjs.FactoryMaker.getSingletonFactory(a)})),bo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=wo)&&e.__esModule?e:{default:e};function r(t){var n=[],e=void 0,r=(t=t||{}).eventBus,o=t.events,u=(0,i.default)(this.context).getInstance({debug:t.debug,eventBus:t.eventBus,metricsConstants:t.metricsConstants});function a(t){n.forEach((function(n){n.handleNewMetric(t.metric,t.value,t.mediaType)}))}return e={initialize:function(t,i){t.split(",").forEach((function(t,e,r){var o;if(-1!==t.indexOf("(")&&-1===t.indexOf(")")){var a=r[e+1];a&&-1===a.indexOf("(")&&-1!==a.indexOf(")")&&(t+=","+a,delete r[e+1])}(o=u.create(t,i))&&n.push(o)})),r.on(o.METRIC_ADDED,a,e),r.on(o.METRIC_UPDATED,a,e)},reset:function(){r.off(o.METRIC_ADDED,a,e),r.off(o.METRIC_UPDATED,a,e),n.forEach((function(t){return t.reset()})),n=[]}}}r.__dashjs_factory_name="MetricsHandlersController",n.default=dashjs.FactoryMaker.getClassFactory(r)})),Mo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(ao),i=o(ho),r=o(bo);function o(t){return t&&t.__esModule?t:{default:t}}function u(t){t=t||{};var n=void 0,o=void 0,u=void 0,a=this.context;function s(){n&&n.reset(),o&&o.reset(),u&&u.reset()}return{initialize:function(f){try{(u=(0,e.default)(a).create({mediaElement:t.mediaElement})).initialize(f.Range),(o=(0,i.default)(a).create({debug:t.debug,metricsConstants:t.metricsConstants})).initialize(f.Reporting,u),(n=(0,r.default)(a).create({debug:t.debug,eventBus:t.eventBus,metricsConstants:t.metricsConstants,events:t.events})).initialize(f.metrics,o)}catch(t){throw s(),t}},reset:s}}u.__dashjs_factory_name="MetricsController",n.default=dashjs.FactoryMaker.getClassFactory(u)})),To=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.metrics="",this.Range=[],this.Reporting=[]}})),No=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1}})),_o=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.schemeIdUri="",this.value=""}})),So=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(To),i=o(No),r=o(_o);function o(t){return t&&t.__esModule?t:{default:t}}function u(t){var n=(t=t||{}).adapter,o=t.constants;return{getMetrics:function(t){var u=[];return t&&t.Metrics_asArray&&t.Metrics_asArray.forEach((function(a){var s=new e.default,f=n.getIsDynamic(t);a.hasOwnProperty("metrics")&&(s.metrics=a.metrics,a.Range_asArray&&a.Range_asArray.forEach((function(e){var r=new i.default;r.starttime=function(t,e,i){var r=void 0,u=void 0,a=0;return e?a=n.getAvailabilityStartTime(t)/1e3:(r=n.getRegularPeriods(t)).length&&(a=r[0].start),u=a,i&&i.hasOwnProperty(o.START_TIME)&&(u+=i.starttime),u}(t,f,e),r.duration=e.hasOwnProperty("duration")?e.duration:n.getDuration(t),r._useWallClockTime=f,s.Range.push(r)})),a.Reporting_asArray&&(a.Reporting_asArray.forEach((function(t){var n=new r.default;if(t.hasOwnProperty(o.SCHEME_ID_URI)){for(var e in n.schemeIdUri=t.schemeIdUri,t)t.hasOwnProperty(e)&&(n[e]=t[e]);s.Reporting.push(n)}})),u.push(s)))})),u}}}u.__dashjs_factory_name="ManifestParsing",n.default=dashjs.FactoryMaker.getSingletonFactory(u)})),Co=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=o(Mo),i=o(So),r=o(oo);function o(t){return t&&t.__esModule?t:{default:t}}function u(t){var n={},o=this.context,u=(t=t||{}).eventBus,a=t.events;function s(a){if(!a.error){var s=Object.keys(n);(0,i.default)(o).getInstance({adapter:t.adapter,constants:t.constants}).getMetrics(a.manifest).forEach((function(i){var r=JSON.stringify(i);if(n.hasOwnProperty(r))s.splice(r,1);else try{var u=(0,e.default)(o).create(t);u.initialize(i),n[r]=u}catch(t){}})),s.forEach((function(t){n[t].reset(),delete n[t]})),u.trigger(r.default.METRICS_INITIALISATION_COMPLETE)}}function f(){Object.keys(n).forEach((function(t){n[t].reset()})),n={}}return u.on(a.MANIFEST_UPDATED,s),u.on(a.STREAM_TEARDOWN_COMPLETE,f),{reset:function(){u.off(a.MANIFEST_UPDATED,s),u.off(a.STREAM_TEARDOWN_COMPLETE,f)}}}u.__dashjs_factory_name="MetricsCollectionController",n.default=dashjs.FactoryMaker.getClassFactory(u)})),Eo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=a(uo),i=a(oo),r=a(Co),o=a(wo),u=a(lo);function a(t){return t&&t.__esModule?t:{default:t}}function s(){var t=this.context;return{createMetricsReporting:function(n){return(0,e.default)(t).getInstance({eventBus:n.eventBus,dashMetrics:n.dashMetrics,metricsConstants:n.metricsConstants,events:n.events}),(0,r.default)(t).create(n)},getReportingFactory:function(){return(0,u.default)(t).getInstance()},getMetricsHandlerFactory:function(){return(0,o.default)(t).getInstance()}}}s.__dashjs_factory_name="MetricsReporting";var f=dashjs.FactoryMaker.getClassFactory(s);f.events=i.default,dashjs.FactoryMaker.updateClassFactory(s.__dashjs_factory_name,f),n.default=f})),ko=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,null,[{key:"findCencContentProtection",value:function(t){for(var n=null,e=0;e<t.length;++e){var i=t[e];"urn:mpeg:dash:mp4protection:2011"!==i.schemeIdUri.toLowerCase()||"cenc"!==i.value.toLowerCase()&&"cbcs"!==i.value.toLowerCase()||(n=i)}return n}},{key:"getPSSHData",value:function(t){var n=8,e=new DataView(t),i=e.getUint8(n);return n+=20,i>0&&(n+=4+16*e.getUint32(n)),t.slice(n+=4)}},{key:"getPSSHForKeySystem",value:function(n,e){var i=t.parsePSSHList(e);return n&&i.hasOwnProperty(n.uuid.toLowerCase())?i[n.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(t,n){return"pssh"in t?(t.pssh.__text=t.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),n.decodeArray(t.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(t){if(null==t)return[];for(var n=new DataView(t.buffer||t),e={},i=0;;){var r,o,u=void 0,a=i;if(i>=n.buffer.byteLength)break;if(r=i+n.getUint32(i),1886614376===n.getUint32(i+=4))if(0===(o=n.getUint8(i+=4))||1===o){i++,i+=3,u="";var s=void 0,f=void 0;for(s=0;s<4;s++)u+=1===(f=n.getUint8(i+s).toString(16)).length?"0"+f:f;for(i+=4,u+="-",s=0;s<2;s++)u+=1===(f=n.getUint8(i+s).toString(16)).length?"0"+f:f;for(i+=2,u+="-",s=0;s<2;s++)u+=1===(f=n.getUint8(i+s).toString(16)).length?"0"+f:f;for(i+=2,u+="-",s=0;s<2;s++)u+=1===(f=n.getUint8(i+s).toString(16)).length?"0"+f:f;for(i+=2,u+="-",s=0;s<6;s++)u+=1===(f=n.getUint8(i+s).toString(16)).length?"0"+f:f;i+=6,u=u.toLowerCase(),n.getUint32(i),i+=4,e[u]=n.buffer.slice(a,r),i=r}else i=r;else i=r}return e}}]),t}();n.default=i})),Oo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.contentType=n,this.robustness=e}})),Ro=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(n,e,i,r,o){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.initDataTypes=["cenc"],n&&n.length&&(this.audioCapabilities=n),e&&e.length&&(this.videoCapabilities=e),this.distinctiveIdentifier=i,this.persistentState=r,this.sessionTypes=o}})),Io=o((function(t,n){var e;Object.defineProperty(n,"__esModule",{value:!0});var i=new(function(t){function n(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.MEDIA_KEYERR_CODE=100,t.MEDIA_KEYERR_UNKNOWN_CODE=101,t.MEDIA_KEYERR_CLIENT_CODE=102,t.MEDIA_KEYERR_SERVICE_CODE=103,t.MEDIA_KEYERR_OUTPUT_CODE=104,t.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,t.MEDIA_KEYERR_DOMAIN_CODE=106,t.MEDIA_KEY_MESSAGE_ERROR_CODE=107,t.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,t.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,t.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,t.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,t.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,t.KEY_SESSION_CREATED_ERROR_CODE=113,t.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,t.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",t.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",t.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",t.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",t.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",t.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",t.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",t.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",t.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",t.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",t.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",t.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",t.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",t.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(((e=ke)&&e.__esModule?e:{default:e}).default));n.default=i})),Do=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=s(ko),r=s(Oo),o=s(Ro),u=s(Io),a=s(N);function s(t){return t&&t.__esModule?t:{default:t}}function f(t){var n,s=(t=t||{}).protectionKeyController,f=t.protectionModel,c=t.eventBus,l=t.events,d=t.BASE64,h=t.constants,v=[],p=void 0,g=void 0,m=void 0,y=void 0,w=void 0,b=void 0,M=void 0;function T(){if(!(c&&c.hasOwnProperty("on")&&s&&s.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function N(t,n){var e=i.default.getPSSHForKeySystem(M,t),r=C(M);if(e){for(var o=f.getAllInitData(),d=0;d<o.length;d++)if(s.initDataEquals(e,o[d]))return void p.warn("DRM: Ignoring initData because we have already seen it!");try{f.createKeySession(e,r,k(M),n)}catch(t){c.trigger(l.KEY_SESSION_CREATED,{data:null,error:new a.default(u.default.KEY_SESSION_CREATED_ERROR_CODE,u.default.KEY_SESSION_CREATED_ERROR_MESSAGE+t.message)})}}else t?f.createKeySession(t,r,k(M),n):c.trigger(l.KEY_SESSION_CREATED,{data:null,error:new a.default(u.default.KEY_SESSION_CREATED_ERROR_CODE,u.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(M?M.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function _(t,n){T(),f.loadKeySession(t,n,k(M))}function S(t){T(),t?(f.setMediaElement(t),c.on(l.NEED_KEY,A,this)):null===t&&(f.setMediaElement(t),c.off(l.NEED_KEY,A,this))}function C(t){var n=null;if(t){var e=t.systemString;y&&(n=e in y?y[e]:null)}return n}function E(t){var n=C(t),e=[],i=[],u=n&&n.audioRobustness&&n.audioRobustness.length>0?n.audioRobustness:b,a=n&&n.videoRobustness&&n.videoRobustness.length>0?n.videoRobustness:b,s=k(t),f=n&&n.distinctiveIdentifier?n.distinctiveIdentifier:"optional",c=n&&n.persistentState?n.persistentState:"temporary"===s?"optional":"required";return m.forEach((function(t){t.type===h.AUDIO?e.push(new r.default(t.codec,u)):t.type===h.VIDEO&&i.push(new r.default(t.codec,a))})),new o.default(e,i,f,c,[s])}function k(t){var n=C(t);return n&&n.sessionType?n.sessionType:w}function O(t,n){var e=this,i=[];t=t.sort((function(n,e){return(y&&y[n.ks.systemString]&&y[n.ks.systemString].priority>=0?y[n.ks.systemString].priority:t.length)-(y&&y[e.ks.systemString]&&y[e.ks.systemString].priority>=0?y[e.ks.systemString].priority:t.length)}));var r=void 0;if(M)for(r=0;r<t.length&&(M!==t[r].ks||"break"!=(i.push({ks:t[r].ks,configs:[E(M)]}),c.on(l.KEY_SYSTEM_ACCESS_COMPLETE,(function i(o){if(c.off(l.KEY_SYSTEM_ACCESS_COMPLETE,i,e),o.error)n||c.trigger(l.KEY_SYSTEM_SELECTED,{error:new a.default(u.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,u.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+o.error)});else{p.info("DRM: KeySystem Access Granted"),c.trigger(l.KEY_SYSTEM_SELECTED,{data:o.data});var f=C(M);if(s.isClearKey(M)&&f&&f.hasOwnProperty("clearkeys")){var d={kids:Object.keys(f.clearkeys)};t[r].initData=(new TextEncoder).encode(JSON.stringify(d))}t[r].sessionId?_(t[r].sessionId,t[r].initData):t[r].initData&&N(t[r].initData,t[r].cdmData)}}),e),f.requestKeySystemAccess(i),"break"));r++);else if(void 0===M){M=null,g.push(t);for(var o=0;o<t.length;o++)i.push({ks:t[o].ks,configs:[E(t[o].ks)]});var h=void 0,v=function t(i){c.off(l.KEY_SYSTEM_ACCESS_COMPLETE,t,e),i.error?(M=void 0,c.off(l.INTERNAL_KEY_SYSTEM_SELECTED,m,e),n||c.trigger(l.KEY_SYSTEM_SELECTED,{data:null,error:new a.default(u.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,u.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+i.error)})):(p.info("DRM: KeySystem Access Granted ("+(h=i.data).keySystem.systemString+")!  Selecting key system..."),f.selectKeySystem(h))},m=function t(i){if(c.off(l.INTERNAL_KEY_SYSTEM_SELECTED,t,e),c.off(l.KEY_SYSTEM_ACCESS_COMPLETE,v,e),i.error)M=void 0,n||c.trigger(l.KEY_SYSTEM_SELECTED,{data:null,error:new a.default(u.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,u.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+i.error)});else{if(!f)return;M=f.getKeySystem(),c.trigger(l.KEY_SYSTEM_SELECTED,{data:h});var o=C(M);o&&o.serverCertificate&&o.serverCertificate.length>0&&f.setServerCertificate(d.decodeArray(o.serverCertificate).buffer);for(var p=0;p<g.length;p++)for(r=0;r<g[p].length;r++)if(M===g[p][r].ks){if(s.isClearKey(M)&&o&&o.hasOwnProperty("clearkeys")){var m={kids:Object.keys(o.clearkeys)};g[p][r].initData=(new TextEncoder).encode(JSON.stringify(m))}g[p][r].sessionId?_(g[p][r].sessionId,g[p][r].initData):null!==g[p][r].initData&&N(g[p][r].initData,g[p][r].cdmData);break}}};c.on(l.INTERNAL_KEY_SYSTEM_SELECTED,m,e),c.on(l.KEY_SYSTEM_ACCESS_COMPLETE,v,e),f.requestKeySystemAccess(i)}else g.push(t)}function R(t,n){c.trigger(l.LICENSE_REQUEST_COMPLETE,{data:t,error:n})}function I(t){t.error?c.trigger(l.KEY_STATUSES_CHANGED,{data:null,error:t.error}):p.debug("DRM: key status = "+t.status)}function D(t){p.debug("DRM: onKeyMessage");var n=t.data;c.trigger(l.KEY_MESSAGE,{data:n});var r=n.messageType?n.messageType:"license-request",o=n.message,d=n.sessionToken,h=C(M),v=M?M.systemString:null,g=s.getLicenseServer(M,h,r),y={sessionToken:d,messageType:r};if(o&&0!==o.byteLength){if(!g)return p.debug("DRM: License server request not required for this message (type = "+t.data.messageType+").  Session ID = "+d.getSessionID()),void R(y);if(s.isClearKey(M)){var w=s.processClearKeyLicenseRequest(M,h,o);if(w)return p.debug("DRM: ClearKey license request handled by application!"),R(y),void f.updateKeySession(d,w)}var b=null;if(h&&h.serverURL){var T=h.serverURL;"string"==typeof T&&""!==T?b=T:"object"===(void 0===T?"undefined":e(T))&&T.hasOwnProperty(r)&&(b=T[r])}else if(h&&h.laURL&&""!==h.laURL)b=h.laURL;else if(s.isClearKey(M))b=M.getLicenseServerUrlFromMediaInfo(m);else{var N=i.default.getPSSHData(d.initData);(b=M.getLicenseServerURLFromInitData(N))||(b=t.data.laURL)}if(b=g.getServerURLFromMessage(b,o,r)){var _={},S=!1,E=function(t){if(t)for(var n in t)"authorization"===n.toLowerCase()&&(S=!0),_[n]=t[n]};h&&E(h.httpRequestHeaders),E(M.getRequestHeadersFromMessage(o)),h&&"boolean"==typeof h.withCredentials&&(S=h.withCredentials);var k=function(t,n,e,i){var r=t.response?g.getErrorResponse(t.response,e,i):"NONE";R(n,new a.default(u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+e+' update, XHR complete. status is "'+t.statusText+'" ('+t.status+"), readyState is "+t.readyState+".  Response is "+r))},O=M.getLicenseRequestFromMessage(o),I=g.getHTTPMethod(r),D=g.getResponseType(v,r),A=h&&!isNaN(h.httpTimeout)?h.httpTimeout:8e3;x(b,_,I,D,S,O,3,A,(function(t){if(f)if(200===t.status){var n=g.getLicenseMessage(t.response,v,r);null!==n?(R(y),f.updateKeySession(d,n)):k(t,y,v,r)}else k(t,y,v,r)}),(function(t){R(y,new a.default(u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+v+' update, XHR aborted. status is "'+t.statusText+'" ('+t.status+"), readyState is "+t.readyState))}),(function(t){R(y,new a.default(u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+v+' update, XHR error. status is "'+t.statusText+'" ('+t.status+"), readyState is "+t.readyState))}))}else R(y,new a.default(u.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}else R(y,new a.default(u.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function x(t,n,e,i,r,o,u,a,s,f,c){var l=new XMLHttpRequest;for(var d in l.open(e,t,!0),l.responseType=i,l.withCredentials=r,a>0&&(l.timeout=a),n)l.setRequestHeader(d,n[d]);var h=function(){u--,setTimeout((function(){x(t,n,e,i,r,o,u,a,s,f,c)}),1e3)};l.onload=function(){200===this.status||u<=0?s(this):(p.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+u),h())},l.ontimeout=l.onerror=function(){u<=0?c(this):(p.warn("License request network request failed . Retrying it... Pending retries: "+u),h())},l.onabort=function(){f(this)},l.send(o)}function A(t,n){if(p.debug("DRM: onNeedKey"),"cenc"===t.key.initDataType)if(0===m.length&&(p.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(n=void 0===n?1:n+1)<5))v.push(setTimeout((function(){A(t,n)}),500));else{var e=t.key.initData;if(ArrayBuffer.isView(e)&&(e=e.buffer),M){var r=i.default.getPSSHForKeySystem(M,e);if(r)for(var o=f.getAllInitData(),u=0;u<o.length;u++)if(s.initDataEquals(r,o[u]))return void p.warn("DRM: Ignoring initData because we have already seen it!")}p.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(e)));var a=s.getSupportedKeySystems(e,y);0!==a.length?O(a,!1):p.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!")}else p.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+t.key.initDataType)}return p=t.debug.getLogger(n={initializeForMedia:function(t){if(!t)throw new Error("mediaInfo can not be null or undefined");T(),c.on(l.INTERNAL_KEY_MESSAGE,D,this),c.on(l.INTERNAL_KEY_STATUS_CHANGED,I,this),m.push(t);var n=s.getSupportedKeySystemsFromContentProtection(t.contentProtection);n&&n.length>0&&O(n,!0)},createKeySession:N,loadKeySession:_,removeKeySession:function(t){T(),f.removeKeySession(t)},closeKeySession:function(t){T(),f.closeKeySession(t)},setServerCertificate:function(t){T(),f.setServerCertificate(t)},setMediaElement:S,setSessionType:function(t){w=t},setRobustnessLevel:function(t){b=t},setProtectionData:function(t){y=t,s.setProtectionData(t)},getSupportedKeySystemsFromContentProtection:function(t){return T(),s.getSupportedKeySystemsFromContentProtection(t)},getKeySystems:function(){return s?s.getKeySystems():[]},setKeySystems:function(t){s&&s.setKeySystems(t)},stop:function(){f&&f.stop()},reset:function(){T(),c.off(l.INTERNAL_KEY_MESSAGE,D,this),c.off(l.INTERNAL_KEY_STATUS_CHANGED,I,this),S(null),M=void 0,f&&(f.reset(),f=null),v.forEach((function(t){return clearTimeout(t)})),v=[],m=[]}}),g=[],m=[],w="temporary",b="",n}f.__dashjs_factory_name="ProtectionController",n.default=dashjs.FactoryMaker.getClassFactory(f)})),xo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.keyID=n,this.key=e}})),Ao=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=function(){function t(n,e){if(function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),e&&"persistent"!==e&&"temporary"!==e)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=n,this.type=e}return e(t,[{key:"toJWK",value:function(){var t=void 0,n=this.keyPairs.length,e={keys:[]};for(t=0;t<n;t++)e.keys.push({kty:"oct",alg:"A128KW",kid:this.keyPairs[t].keyID,k:this.keyPairs[t].key});this.type&&(e.type=this.type);var i=JSON.stringify(e),r=i.length,o=new ArrayBuffer(r),u=new Uint8Array(o);for(t=0;t<r;t++)u[t]=i.charCodeAt(t);return o}}]),t}();n.default=i})),jo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),i=new(function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()}return e(t,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready"}}]),t}());n.default=i})),Fo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=u(xo),i=u(Ao),r=u(ko),o=u(jo);function u(t){return t&&t.__esModule?t:{default:t}}var a="e2719d58-a985-b3c9-781a-b030af78d30e",s=o.default.CLEARKEY_KEYSTEM_STRING,f="urn:uuid:"+a;function c(t){var n=(t=t||{}).BASE64,o={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]};return{uuid:a,schemeIdURI:f,systemString:s,getInitData:function(t,e){try{var i=r.default.parseInitDataFromContentProtection(t,n);if(!i&&e){var o={kids:[function(t){try{var n=t.replace(/-/g,"");return(n=btoa(n.match(/\w{2}/g).map((function(t){return String.fromCharCode(parseInt(t,16))})).join(""))).replace(/=/g,"")}catch(t){return null}}(e["cenc:default_KID"])]};i=(new TextEncoder).encode(JSON.stringify(o))}return i}catch(t){return null}},getRequestHeadersFromMessage:function(){return{"Content-Type":"application/json"}},getLicenseRequestFromMessage:function(t){return JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t)))},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getLicenseServerUrlFromMediaInfo:function(t){try{if(!t||0===t.length)return null;for(var n=0,e=null;n<t.length&&!e;){var i=t[n];if(i&&i.contentProtection&&i.contentProtection.length>0){var r=i.contentProtection.filter((function(t){return t.schemeIdUri&&t.schemeIdUri===f}));if(r&&r.length>0)for(var u=0;u<r.length&&!e;){for(var a=r[u],s=0;s<o.attributes.length&&!e;){for(var c=0,l=o.attributes[s];c<o.prefixes.length&&!e;)a[l]&&a[l].__prefix&&a[l].__prefix===o.prefixes[c]&&a[l].__text&&(e=a[l].__text),c+=1;s+=1}u+=1}}n+=1}return e}catch(t){return null}},getClearKeysFromProtectionData:function(t,n){var r=null;if(t){for(var o=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(n))),u=[],a=0;a<o.kids.length;a++){var s=o.kids[a],f=t.clearkeys&&t.clearkeys.hasOwnProperty(s)?t.clearkeys[s]:null;if(!f)throw new Error("DRM: ClearKey keyID ("+s+") is not known!");u.push(new e.default(s,f))}r=new i.default(u)}return r}}}c.__dashjs_factory_name="KeySystemClearKey",n.default=dashjs.FactoryMaker.getSingletonFactory(c)})),Po=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=u(xo),i=u(Ao),r=u(ko),o=u(jo);function u(t){return t&&t.__esModule?t:{default:t}}var a=o.default.CLEARKEY_KEYSTEM_STRING;function s(t){var n=void 0,o=t.BASE64,u=t.debug.getLogger(n);return{uuid:"1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",schemeIdURI:"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString:a,getInitData:function(t){return r.default.parseInitDataFromContentProtection(t,o)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(t){return new Uint8Array(t)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(t,n){var r=null;if(t){for(var o=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(n))),a=[],s=0;s<o.kids.length;s++){var f=o.kids[s],c=t.clearkeys&&t.clearkeys.hasOwnProperty(f)?t.clearkeys[f]:null;if(!c)throw new Error("DRM: ClearKey keyID ("+f+") is not known!");a.push(new e.default(f,c))}r=new i.default(a),u.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return r}}}s.__dashjs_factory_name="KeySystemW3CClearKey",n.default=dashjs.FactoryMaker.getSingletonFactory(s)})),Bo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(ko),i=r(jo);function r(t){return t&&t.__esModule?t:{default:t}}var o=i.default.WIDEVINE_KEYSTEM_STRING;function u(t){var n=null,i=(t=t||{}).BASE64;return{uuid:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",schemeIdURI:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString:o,init:function(t){t&&(n=t)},getInitData:function(t){return e.default.parseInitDataFromContentProtection(t,i)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(t){return new Uint8Array(t)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(t){return n&&n.sessionId?n.sessionId:t&&t.sessionId?t.sessionId:null}}}u.__dashjs_factory_name="KeySystemWidevine",n.default=dashjs.FactoryMaker.getSingletonFactory(u)})),Lo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(ko),i=r(jo);function r(t){return t&&t.__esModule?t:{default:t}}var o=i.default.PLAYREADY_KEYSTEM_STRING,u=void 0;function a(t){var n="utf-16",i=(t=t||{}).BASE64;function r(){if(!i||!i.hasOwnProperty("decodeArray")||!i.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:"9a04f079-9840-4286-ab92-e65be0885f95",schemeIdURI:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",systemString:o,getInitData:function(t){var n,o,u,a=new Uint8Array([112,115,115,104,0,0,0,0]),s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),f=0,c=null,l=void 0,d=void 0;if(r(),!t)return null;if("pssh"in t)return e.default.parseInitDataFromContentProtection(t,i);if("pro"in t)c=i.decodeArray(t.pro.__text);else{if(!("prheader"in t))return null;c=i.decodeArray(t.prheader.__text)}return o=4+a.length+s.length+4+(n=c.length),u=new ArrayBuffer(o),l=new Uint8Array(u),(d=new DataView(u)).setUint32(f,o),l.set(a,f+=4),l.set(s,f+=a.length),d.setUint32(f+=s.length,n),l.set(c,f+=4),f+=n,l.buffer},getRequestHeadersFromMessage:function(t){var e,i=void 0,r={},o=new DOMParser,u="utf-16"===n?new Uint16Array(t):new Uint8Array(t);e=String.fromCharCode.apply(null,u);for(var a=(i=o.parseFromString(e,"application/xml")).getElementsByTagName("name"),s=i.getElementsByTagName("value"),f=0;f<a.length;f++)r[a[f].childNodes[0].nodeValue]=s[f].childNodes[0].nodeValue;return r.hasOwnProperty("Content")&&(r["Content-Type"]=r.Content,delete r.Content),r.hasOwnProperty("Content-Type")||(r["Content-Type"]="text/xml; charset=utf-8"),r},getLicenseRequestFromMessage:function(t){var e=null,o=new DOMParser,u="utf-16"===n?new Uint16Array(t):new Uint8Array(t);r();var a=String.fromCharCode.apply(null,u),s=o.parseFromString(a,"application/xml");if(!s.getElementsByTagName("PlayReadyKeyMessage")[0])return t;var f=s.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return f&&(e=i.decode(f)),e},getLicenseServerURLFromInitData:function(t){if(t)for(var n=new DataView(t),e=n.getUint16(4,!0),i=6,r=new DOMParser,o=0;o<e;o++){var u=n.getUint16(i,!0),a=n.getUint16(i+=2,!0);if(i+=2,1===u){var s=t.slice(i,i+a),f=String.fromCharCode.apply(null,new Uint16Array(s)),c=r.parseFromString(f,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var l=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(l)return l}if(c.getElementsByTagName("LUI_URL")[0]){var d=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(d)return d}}else i+=a}return null},getCDMData:function(){var t=void 0,n=void 0,e=void 0,o=void 0;if(r(),u&&u.cdmData){for(t=[],o=0;o<u.cdmData.length;++o)t.push(u.cdmData.charCodeAt(o)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=i.encode(t),n='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",t),e=[],o=0;o<n.length;++o)e.push(n.charCodeAt(o)),e.push(0);return new Uint8Array(e).buffer}return null},getSessionId:function(t){return u&&u.sessionId?u.sessionId:t&&t.sessionId?t.sessionId:null},setPlayReadyMessageFormat:function(t){if("utf-8"!==t&&"utf-16"!==t)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');n=t},init:function(t){t&&(u=t)}}}a.__dashjs_factory_name="KeySystemPlayReady",n.default=dashjs.FactoryMaker.getSingletonFactory(a)})),Uo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=jo)&&e.__esModule?e:{default:e};function r(t){var n=(t=t||{}).BASE64,e={};return e[i.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(t){return n.decodeArray(t.license)},getErrorResponse:function(t){return t}},e[i.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(t){return t},getErrorResponse:function(t){return String.fromCharCode.apply(null,new Uint8Array(t))}},{getServerURLFromMessage:function(t){return t},getHTTPMethod:function(){return"POST"},getResponseType:function(t){return e[t].responseType},getLicenseMessage:function(t,i){return function(){if(!n||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),e[i].getLicenseMessage(t)},getErrorResponse:function(t,n){return e[n].getErrorResponse(t)}}}r.__dashjs_factory_name="DRMToday",n.default=dashjs.FactoryMaker.getSingletonFactory(r)})),qo=o((function(t,n){function e(){var t="http://schemas.xmlsoap.org/soap/envelope/";function n(t){var n=String.fromCharCode.apply(null,new Uint8Array(t));return decodeURIComponent(escape(n))}function e(e){if(window.DOMParser){var i=n(e),r=(new window.DOMParser).parseFromString(i,"text/xml"),o=r?r.getElementsByTagNameNS(t,"Envelope")[0]:null,u=o?o.getElementsByTagNameNS(t,"Body")[0]:null;if(u&&u.getElementsByTagNameNS(t,"Fault")[0])return null}return e}function i(e){var i="",r="",o="",u=-1,a=-1;if(window.DOMParser){var s=n(e),f=(new window.DOMParser).parseFromString(s,"text/xml"),c=f?f.getElementsByTagNameNS(t,"Envelope")[0]:null,l=c?c.getElementsByTagNameNS(t,"Body")[0]:null,d=l?l.getElementsByTagNameNS(t,"Fault")[0]:null,h=d?d.getElementsByTagName("detail")[0]:null,v=h?h.getElementsByTagName("Exception")[0]:null,p=null;if(null===d)return s;i=(p=d.getElementsByTagName("faultstring")[0].firstChild)?p.nodeValue:null,null!==v&&(r=(p=v.getElementsByTagName("StatusCode")[0])?p.firstChild.nodeValue:null,u=(o=(p=v.getElementsByTagName("Message")[0])?p.firstChild.nodeValue:null)?o.lastIndexOf("[")+1:-1,a=o?o.indexOf("]"):-1,o=o?o.substring(u,a):"")}var g="code: "+r+", name: "+i;return o&&(g+=", message: "+o),g}return{getServerURLFromMessage:function(t){return t},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(t){return e.call(this,t)},getErrorResponse:function(t){return i.call(this,t)}}}Object.defineProperty(n,"__esModule",{value:!0}),e.__dashjs_factory_name="PlayReady",n.default=dashjs.FactoryMaker.getSingletonFactory(e)})),zo=o((function(t,n){function e(){return{getServerURLFromMessage:function(t){return t},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(t){return t},getErrorResponse:function(t){return String.fromCharCode.apply(null,new Uint8Array(t))}}}Object.defineProperty(n,"__esModule",{value:!0}),e.__dashjs_factory_name="Widevine",n.default=dashjs.FactoryMaker.getSingletonFactory(e)})),Ho=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=r(xo),i=r(Ao);function r(t){return t&&t.__esModule?t:{default:t}}function o(){return{getServerURLFromMessage:function(t){return t},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"json"},getLicenseMessage:function(t){if(!t.hasOwnProperty("keys"))return null;for(var n=[],r=0;r<t.keys.length;r++){var o=t.keys[r],u=o.kid.replace(/=/g,""),a=o.k.replace(/=/g,"");n.push(new e.default(u,a))}return new i.default(n)},getErrorResponse:function(t){return String.fromCharCode.apply(null,new Uint8Array(t))}}}o.__dashjs_factory_name="ClearKey",n.default=dashjs.FactoryMaker.getSingletonFactory(o)})),Ko=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=d(ko),i=d(Fo),r=d(Po),o=d(Bo),u=d(Lo),a=d(Uo),s=d(qo),f=d(zo),c=d(Ho),l=d(jo);function d(t){return t&&t.__esModule?t:{default:t}}function h(){var t=this.context,n=void 0,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0;return n={initialize:function(){v=[];var n=void 0;n=(0,u.default)(t).getInstance({BASE64:p}),v.push(n),n=(0,o.default)(t).getInstance({BASE64:p}),v.push(n),n=(0,i.default)(t).getInstance({BASE64:p}),v.push(n),g=n,n=(0,r.default)(t).getInstance({BASE64:p,debug:d}),v.push(n),m=n},setProtectionData:function(t){for(var n,e,i=0;i<v.length;i++){var r=v[i];r.hasOwnProperty("init")&&r.init((n=r.systemString,e=void 0,e=null,t&&(e=n in t?t[n]:null),e))}},isClearKey:function(t){return t===g||t===m},initDataEquals:function(t,n){if(t.byteLength===n.byteLength){for(var e=new Uint8Array(t),i=new Uint8Array(n),r=0;r<e.length;r++)if(e[r]!==i[r])return!1;return!0}return!1},getKeySystems:function(){return v},setKeySystems:function(t){v=t},getKeySystemBySystemString:function(t){for(var n=0;n<v.length;n++)if(v[n].systemString===t)return v[n];return null},getSupportedKeySystemsFromContentProtection:function(t){var n=void 0,i=void 0,r=void 0,o=void 0,u=[];if(t){var a=e.default.findCencContentProtection(t);for(r=0;r<v.length;++r)for(i=v[r],o=0;o<t.length;++o)if((n=t[o]).schemeIdUri.toLowerCase()===i.schemeIdURI){var s=i.getInitData(n,a);u.push({ks:v[r],initData:s,cdmData:i.getCDMData(),sessionId:i.getSessionId(n)})}}return u},getSupportedKeySystems:function(t,n){for(var i=[],r=e.default.parsePSSHList(t),o=void 0,u=0;u<v.length;++u)(o=v[u]).uuid in r&&(!n||o.systemString in n)&&i.push({ks:o,initData:r[o.uuid],cdmData:o.getCDMData(),sessionId:o.getSessionId()});return i},getLicenseServer:function(n,e,i){if("license-release"===i||"individualization-request"===i)return null;var r=null;return e&&e.hasOwnProperty("drmtoday")?r=(0,a.default)(t).getInstance({BASE64:p}):n.systemString===l.default.WIDEVINE_KEYSTEM_STRING?r=(0,f.default)(t).getInstance():n.systemString===l.default.PLAYREADY_KEYSTEM_STRING?r=(0,s.default)(t).getInstance():n.systemString===l.default.CLEARKEY_KEYSTEM_STRING&&(r=(0,c.default)(t).getInstance()),r},processClearKeyLicenseRequest:function(t,n,e){try{return t.getClearKeysFromProtectionData(n,e)}catch(t){return h.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(t){t&&(t.debug&&(h=(d=t.debug).getLogger(n)),t.BASE64&&(p=t.BASE64))}}}h.__dashjs_factory_name="ProtectionKeyController",n.default=dashjs.FactoryMaker.getSingletonFactory(h)})),Vo=o((function(t,n){var e;Object.defineProperty(n,"__esModule",{value:!0});var i=new(function(t){function n(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.INTERNAL_KEY_MESSAGE="internalKeyMessage",t.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",t.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",t.KEY_ADDED="public_keyAdded",t.KEY_ERROR="public_keyError",t.KEY_MESSAGE="public_keyMessage",t.KEY_SESSION_CLOSED="public_keySessionClosed",t.KEY_SESSION_CREATED="public_keySessionCreated",t.KEY_SESSION_REMOVED="public_keySessionRemoved",t.KEY_STATUSES_CHANGED="public_keyStatusesChanged",t.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",t.KEY_SYSTEM_SELECTED="public_keySystemSelected",t.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",t.NEED_KEY="needkey",t.PROTECTION_CREATED="public_protectioncreated",t.PROTECTION_DESTROYED="public_protectiondestroyed",t.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",t.TEARDOWN_COMPLETE="protectionTeardownComplete",t.VIDEO_ELEMENT_SELECTED="videoElementSelected",t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(n,t),n}(((e=p)&&e.__esModule?e:{default:e}).default));n.default=i})),Wo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.initData=n,this.initDataType=e}})),Go=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(n,e,i,r){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.sessionToken=n,this.message=e,this.defaultURL=i,this.messageType=r||"license-request"}})),$o=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.keySystem=n,this.ksConfiguration=e}})),Xo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(Ko),i=f(Wo),r=f(Io),o=f(N),u=f(Go),a=f($o),s=f(jo);function f(t){return t&&t.__esModule?t:{default:t}}function c(t){var n,f=this.context,c=(t=t||{}).eventBus,l=t.events,d=void 0,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0;function w(t,n){void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess?function(n){var e=t[n].ks,i=t[n].configs,r=e.systemString;r===s.default.PLAYREADY_KEYSTEM_STRING&&"required"===i[0].persistentState&&(r+=".recommendation"),navigator.requestMediaKeySystemAccess(r,i).then((function(t){var n="function"==typeof t.getConfiguration?t.getConfiguration():null,i=new a.default(e,n);i.mksa=t,c.trigger(l.KEY_SYSTEM_ACCESS_COMPLETE,{data:i})})).catch((function(e){++n<t.length?w(t,n):c.trigger(l.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! "+e.message})}))}(n):c.trigger(l.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Insecure origins are not allowed"})}function b(t){var n=t.session;return n.removeEventListener("keystatuseschange",t),n.removeEventListener("message",t),n.close()}function M(t){for(var n=0;n<g.length;n++)if(g[n]===t){g.splice(n,1);break}}function T(t){var n=void 0,e=void 0;return t&&t.length>0&&(t[0]&&("string"==typeof t[0]?n=t[0]:e=t[0]),t[1]&&("string"==typeof t[1]?n=t[1]:e=t[1])),{status:n,keyId:e}}function N(t,n,e,i){var a={session:t,initData:n,sessionId:i,handleEvent:function(t){switch(t.type){case"keystatuseschange":c.trigger(l.KEY_STATUSES_CHANGED,{data:this}),t.target.keyStatuses.forEach((function(){var t=T(arguments);switch(t.status){case"expired":c.trigger(l.INTERNAL_KEY_STATUS_CHANGED,{error:new o.default(r.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,r.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:c.trigger(l.INTERNAL_KEY_STATUS_CHANGED,t)}}));break;case"message":var n=ArrayBuffer.isView(t.message)?t.message.buffer:t.message;c.trigger(l.INTERNAL_KEY_MESSAGE,{data:new u.default(this,n,void 0,t.messageType)})}},getSessionID:function(){return t.sessionId},getExpirationTime:function(){return t.expiration},getKeyStatuses:function(){return t.keyStatuses},getUsable:function(){var n=!1;return t.keyStatuses.forEach((function(){var t=T(arguments);"usable"===t.status&&(n=!0)})),n},getSessionType:function(){return e}};return t.addEventListener("keystatuseschange",a),t.addEventListener("message",a),t.closed.then((function(){M(a),d.debug("DRM: Session closed.  SessionID = "+a.getSessionID()),c.trigger(l.KEY_SESSION_CLOSED,{data:a.getSessionID()})})),g.push(a),a}return n={getAllInitData:function(){for(var t=[],n=0;n<g.length;n++)g[n].initData&&t.push(g[n].initData);return t},requestKeySystemAccess:function(t){w(t,0)},getKeySystem:function(){return h},selectKeySystem:function(t){t.mksa.createMediaKeys().then((function(n){h=t.keySystem,p=n,v?v.setMediaKeys(p).then((function(){c.trigger(l.INTERNAL_KEY_SYSTEM_SELECTED)})):c.trigger(l.INTERNAL_KEY_SYSTEM_SELECTED)})).catch((function(){c.trigger(l.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+t.keySystem.systemString+")! Could not create MediaKeys -- TODO"})}))},setMediaElement:function(t){v!==t&&(v&&(v.removeEventListener("encrypted",m),v.setMediaKeys&&v.setMediaKeys(null)),(v=t)&&(v.addEventListener("encrypted",m),v.setMediaKeys&&p&&v.setMediaKeys(p)))},setServerCertificate:function(t){if(!h||!p)throw new Error("Can not set server certificate until you have selected a key system");p.setServerCertificate(t).then((function(){d.info("DRM: License server certificate successfully updated."),c.trigger(l.SERVER_CERTIFICATE_UPDATED)})).catch((function(t){c.trigger(l.SERVER_CERTIFICATE_UPDATED,{error:new o.default(r.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,r.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+t.name)})}))},createKeySession:function(t,n,e){if(!h||!p)throw new Error("Can not create sessions until you have selected a key system");var i=p.createSession(e),u=N(i,t,e),a=this.getKeySystem();i.generateRequest(a.systemString===s.default.CLEARKEY_KEYSTEM_STRING&&(t||n&&n.clearkeys)?"keyids":"cenc",t).then((function(){d.debug("DRM: Session created.  SessionID = "+u.getSessionID()),c.trigger(l.KEY_SESSION_CREATED,{data:u})})).catch((function(t){M(u),c.trigger(l.KEY_SESSION_CREATED,{data:null,error:new o.default(r.default.KEY_SESSION_CREATED_ERROR_CODE,r.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+t.name)})}))},updateKeySession:function(t,n){var e=t.session;y.isClearKey(h)&&(n=n.toJWK()),e.update(n).catch((function(n){c.trigger(l.KEY_ERROR,{data:new o.default(r.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+n.name,t)})}))},loadKeySession:function(t,n,e){if(!h||!p)throw new Error("Can not load sessions until you have selected a key system");for(var i=0;i<g.length;i++)if(t===g[i].sessionId)return void d.warn("DRM: Ignoring session ID because we have already seen it!");var u=p.createSession(e),a=N(u,n,e,t);u.load(t).then((function(n){n?(d.debug("DRM: Session loaded.  SessionID = "+a.getSessionID()),c.trigger(l.KEY_SESSION_CREATED,{data:a})):(M(a),c.trigger(l.KEY_SESSION_CREATED,{data:null,error:new o.default(r.default.KEY_SESSION_CREATED_ERROR_CODE,r.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+t+")")}))})).catch((function(n){M(a),c.trigger(l.KEY_SESSION_CREATED,{data:null,error:new o.default(r.default.KEY_SESSION_CREATED_ERROR_CODE,r.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+t+")! "+n.name)})}))},removeKeySession:function(t){t.session.remove().then((function(){d.debug("DRM: Session removed.  SessionID = "+t.getSessionID()),c.trigger(l.KEY_SESSION_REMOVED,{data:t.getSessionID()})}),(function(n){c.trigger(l.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+t.getSessionID()+"). "+n.name})}))},closeKeySession:function(t){b(t).catch((function(n){M(t),c.trigger(l.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+t.getSessionID()+") "+n.name})}))},stop:function(){for(var t=void 0,n=0;n<g.length;n++)(t=g[n]).getUsable()||b(t).catch((function(){M(t)}))},reset:function(){var t=g.length,n=void 0;0!==t?function(){for(var e=function(t){M(t),0===g.length&&(v?(v.removeEventListener("encrypted",m),v.setMediaKeys(null).then((function(){c.trigger(l.TEARDOWN_COMPLETE)}))):c.trigger(l.TEARDOWN_COMPLETE))},i=0;i<t;i++)!function(t){n.session.closed.then((function(){e(t)})),b(n).catch((function(){e(t)}))}(n=g[i])}():c.trigger(l.TEARDOWN_COMPLETE)}},d=t.debug.getLogger(n),h=null,v=null,p=null,g=[],y=(0,e.default)(f).getInstance(),m={handleEvent:function(t){switch(t.type){case"encrypted":if(t.initData){var n=ArrayBuffer.isView(t.initData)?t.initData.buffer:t.initData;c.trigger(l.NEED_KEY,{key:new i.default(n,t.initDataType)})}}}},n}c.__dashjs_factory_name="ProtectionModel_21Jan2015",n.default=dashjs.FactoryMaker.getClassFactory(c)})),Qo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(Ko),i=f(Wo),r=f(N),o=f(Io),u=f(Go),a=f(Ro),s=f($o);function f(t){return t&&t.__esModule?t:{default:t}}function c(t){var n,f=this.context,c=(t=t||{}).eventBus,l=t.events,d=t.api,h=void 0,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0,b=void 0;function M(){try{for(var t=0;t<y.length;t++)T(y[t]);v&&v.removeEventListener(d.needkey,w),c.trigger(l.TEARDOWN_COMPLETE)}catch(t){c.trigger(l.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+t.message})}}function T(t){var n=t.session;n.removeEventListener(d.error,t),n.removeEventListener(d.message,t),n.removeEventListener(d.ready,t),n.removeEventListener(d.close,t);for(var e=0;e<y.length;e++)if(y[e]===t){y.splice(e,1);break}n[d.release]()}function N(){var t=null,n=function(){v.removeEventListener("loadedmetadata",t),v[d.setMediaKeys](g),c.trigger(l.VIDEO_ELEMENT_SELECTED)};v.readyState>=1?n():(t=n.bind(this),v.addEventListener("loadedmetadata",t))}return n={getAllInitData:function(){for(var t=[],n=0;n<y.length;n++)t.push(y[n].initData);return t},requestKeySystemAccess:function(t){for(var n=!1,e=0;e<t.length;e++)for(var i=t[e].ks.systemString,r=t[e].configs,o=null,u=null,f=0;f<r.length;f++){var h=r[f].audioCapabilities,v=r[f].videoCapabilities;if(h&&0!==h.length){o=[];for(var p=0;p<h.length;p++)window[d.MediaKeys].isTypeSupported(i,h[p].contentType)&&o.push(h[p])}if(v&&0!==v.length){u=[];for(var g=0;g<v.length;g++)window[d.MediaKeys].isTypeSupported(i,v[g].contentType)&&u.push(v[g])}if(!(!o&&!u||o&&0===o.length||u&&0===u.length)){n=!0;var m=new a.default(o,u),y=b.getKeySystemBySystemString(i);c.trigger(l.KEY_SYSTEM_ACCESS_COMPLETE,{data:new s.default(y,m)});break}}n||c.trigger(l.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return p},selectKeySystem:function(t){try{g=t.mediaKeys=new window[d.MediaKeys](t.keySystem.systemString),p=t.keySystem,m=t,v&&N(),c.trigger(l.INTERNAL_KEY_SYSTEM_SELECTED)}catch(t){c.trigger(l.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+p.systemString+")! Could not create MediaKeys -- TODO"})}},setMediaElement:function(t){v!==t&&(v&&v.removeEventListener(d.needkey,w),(v=t)&&(v.addEventListener(d.needkey,w),g&&N()))},createKeySession:function(t,n,e,i){if(!p||!g||!m)throw new Error("Can not create sessions until you have selected a key system");var a=null;if(m.ksConfiguration.videoCapabilities&&m.ksConfiguration.videoCapabilities.length>0&&(a=m.ksConfiguration.videoCapabilities[0]),null===a&&m.ksConfiguration.audioCapabilities&&m.ksConfiguration.audioCapabilities.length>0&&(a=m.ksConfiguration.audioCapabilities[0]),null===a)throw new Error("Can not create sessions for unknown content types.");var s=g.createSession(a.contentType,new Uint8Array(t),i?new Uint8Array(i):null),f=function(t,n){return{session:t,initData:n,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(t){switch(t.type){case d.error:c.trigger(l.KEY_ERROR,{data:new r.default(o.default.MEDIA_KEYERR_CODE,"KeyError",this)});break;case d.message:var n=ArrayBuffer.isView(t.message)?t.message.buffer:t.message;c.trigger(l.INTERNAL_KEY_MESSAGE,{data:new u.default(this,n,t.destinationURL)});break;case d.ready:h.debug("DRM: Key added."),c.trigger(l.KEY_ADDED);break;case d.close:h.debug("DRM: Session closed.  SessionID = "+this.getSessionID()),c.trigger(l.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}(s,t);s.addEventListener(d.error,f),s.addEventListener(d.message,f),s.addEventListener(d.ready,f),s.addEventListener(d.close,f),y.push(f),h.debug("DRM: Session created.  SessionID = "+f.getSessionID()),c.trigger(l.KEY_SESSION_CREATED,{data:f})},updateKeySession:function(t,n){var e=t.session;b.isClearKey(p)?e.update(new Uint8Array(n.toJWK())):e.update(new Uint8Array(n))},closeKeySession:T,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:M,reset:M},h=t.debug.getLogger(n),v=null,p=null,g=null,m=null,y=[],b=(0,e.default)(f).getInstance(),w={handleEvent:function(t){switch(t.type){case d.needkey:if(t.initData){var n=ArrayBuffer.isView(t.initData)?t.initData.buffer:t.initData;c.trigger(l.NEED_KEY,{key:new i.default(n,"cenc")})}}}},n}c.__dashjs_factory_name="ProtectionModel_3Feb2014",n.default=dashjs.FactoryMaker.getClassFactory(c)})),Jo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(Ko),i=f(Wo),r=f(N),o=f(Go),u=f(Ro),a=f($o),s=f(Io);function f(t){return t&&t.__esModule?t:{default:t}}function c(t){var n,f=this.context,c=(t=t||{}).eventBus,l=t.events,d=t.api,h=t.errHandler,v=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0,b=void 0,M=void 0;function T(){p&&S();for(var t=0;t<w.length;t++)N(w[t]);c.trigger(l.TEARDOWN_COMPLETE)}function N(t){try{p[d.cancelKeyRequest](g.systemString,t.sessionID)}catch(n){c.trigger(l.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+t.sessionID+") "+n.message})}}function _(t,n){if(n&&t){for(var e=t.length,i=0;i<e;i++)if(t[i].sessionID==n)return t[i];return null}return null}function S(){p.removeEventListener(d.keyerror,M),p.removeEventListener(d.needkey,M),p.removeEventListener(d.keymessage,M),p.removeEventListener(d.keyadded,M)}return v=t.debug.getLogger(n={getAllInitData:function(){for(var t=[],n=0;n<y.length;n++)t.push(y[n].initData);for(var e=0;e<w.length;e++)t.push(w[e].initData);return t},requestKeySystemAccess:function(t){var n=p;n||(n=document.createElement("video"));for(var e=!1,i=0;i<t.length;i++)for(var r=t[i].ks.systemString,o=t[i].configs,s=null,f=0;f<o.length;f++){var d=o[f].videoCapabilities;if(d&&0!==d.length){s=[];for(var h=0;h<d.length;h++)""!==n.canPlayType(d[h].contentType,r)&&s.push(d[h])}if(s&&(!s||0!==s.length)){e=!0;var v=new u.default(null,s),g=m.getKeySystemBySystemString(r);c.trigger(l.KEY_SYSTEM_ACCESS_COMPLETE,{data:new a.default(g,v)});break}}e||c.trigger(l.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return g},selectKeySystem:function(t){g=t.keySystem,c.trigger(l.INTERNAL_KEY_SYSTEM_SELECTED)},setMediaElement:function(t){if(p!==t){if(p){S();for(var n=0;n<w.length;n++)N(w[n]);w=[]}(p=t)&&(p.addEventListener(d.keyerror,M),p.addEventListener(d.needkey,M),p.addEventListener(d.keymessage,M),p.addEventListener(d.keyadded,M),c.trigger(l.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(t){if(!g)throw new Error("Can not create sessions until you have selected a key system");if(b||0===w.length){var n={sessionID:null,initData:t,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return y.push(n),p[d.generateKeyRequest](g.systemString,new Uint8Array(t)),n}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(t,n){var e=t.sessionID;if(m.isClearKey(g))for(var i=0;i<n.keyPairs.length;i++)p[d.addKey](g.systemString,n.keyPairs[i].key,n.keyPairs[i].keyID,e);else p[d.addKey](g.systemString,new Uint8Array(n),new Uint8Array(t.initData),e)},closeKeySession:N,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:T,reset:T}),p=null,g=null,y=[],w=[],m=(0,e.default)(f).getInstance(),M={handleEvent:function(t){var n=null;switch(t.type){case d.needkey:var e=ArrayBuffer.isView(t.initData)?t.initData.buffer:t.initData;c.trigger(l.NEED_KEY,{key:new i.default(e,"cenc")});break;case d.keyerror:if((n=_(w,t.sessionId))||(n=_(y,t.sessionId)),n){var u=s.default.MEDIA_KEYERR_CODE,a="";switch(t.errorCode.code){case 1:u=s.default.MEDIA_KEYERR_UNKNOWN_CODE,a+="MEDIA_KEYERR_UNKNOWN - "+s.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:u=s.default.MEDIA_KEYERR_CLIENT_CODE,a+="MEDIA_KEYERR_CLIENT - "+s.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:u=s.default.MEDIA_KEYERR_SERVICE_CODE,a+="MEDIA_KEYERR_SERVICE - "+s.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:u=s.default.MEDIA_KEYERR_OUTPUT_CODE,a+="MEDIA_KEYERR_OUTPUT - "+s.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:u=s.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,a+="MEDIA_KEYERR_HARDWARECHANGE - "+s.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:u=s.default.MEDIA_KEYERR_DOMAIN_CODE,a+="MEDIA_KEYERR_DOMAIN - "+s.default.MEDIA_KEYERR_DOMAIN_MESSAGE}c.trigger(l.KEY_ERROR,{data:new r.default(u,a+="  System Code = "+t.systemCode,n)})}else v.error("No session token found for key error");break;case d.keyadded:(n=_(w,t.sessionId))||(n=_(y,t.sessionId)),n?(v.debug("DRM: Key added."),c.trigger(l.KEY_ADDED,{data:n})):v.debug("No session token found for key added");break;case d.keymessage:if((b=null!=t.sessionId)?!(n=_(w,t.sessionId))&&y.length>0&&(n=y.shift(),w.push(n),n.sessionID=t.sessionId,c.trigger(l.KEY_SESSION_CREATED,{data:n})):y.length>0&&(n=y.shift(),w.push(n),0!==y.length&&h.error(new r.default(s.default.MEDIA_KEY_MESSAGE_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),n){var f=ArrayBuffer.isView(t.message)?t.message.buffer:t.message;n.keyMessage=f,c.trigger(l.INTERNAL_KEY_MESSAGE,{data:new o.default(n,f,t.defaultURL)})}else v.warn("No session token found for key message")}}},n}c.__dashjs_factory_name="ProtectionModel_01b",n.default=dashjs.FactoryMaker.getClassFactory(c)})),Yo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=f(Do),i=f(Ko),r=f(Vo),o=f(Io),u=f(Xo),a=f(Qo),s=f(Jo);function f(t){return t&&t.__esModule?t:{default:t}}var c=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],l=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function d(){var t=void 0,n=this.context;function r(t,n){for(var e=0;e<n.length;e++){var i=n[e];if("function"==typeof t[i[Object.keys(i)[0]]])return i}return null}return t={createProtectionSystem:function(o){var f=null,d=(0,i.default)(n).getInstance();d.setConfig({debug:o.debug,BASE64:o.BASE64}),d.initialize();var h=function(e){var i=e.debug,o=i.getLogger(t),f=e.eventBus,d=e.errHandler,h=e.videoModel?e.videoModel.getElement():null;return h&&void 0===h.onencrypted||h&&void 0===h.mediaKeys?r(h,l)?(o.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,a.default)(n).create({debug:i,eventBus:f,events:e.events,api:r(h,l)})):r(h,c)?(o.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,s.default)(n).create({debug:i,eventBus:f,errHandler:d,events:e.events,api:r(h,c)})):(o.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(o.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,u.default)(n).create({debug:i,eventBus:f,events:e.events}))}(o);return!f&&h&&(f=(0,e.default)(n).create({protectionModel:h,protectionKeyController:d,eventBus:o.eventBus,debug:o.debug,events:o.events,BASE64:o.BASE64,constants:o.constants}),o.capabilities.setEncryptedMediaSupported(!0)),f}}}d.__dashjs_factory_name="Protection";var h=dashjs.FactoryMaker.getClassFactory(d);h.events=r.default,h.errors=o.default,dashjs.FactoryMaker.updateClassFactory(d.__dashjs_factory_name,h),n.default=h})),Zo=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e,i=(e=eo)&&e.__esModule?e:{default:e},r=function(){var t=void 0;function n(n,e,r){if(!n||!/^VIDEO$/i.test(n.nodeName))return null;if(n._dashjs_player)return n._dashjs_player;var o=void 0,u=n.id||n.name||"video element";if(!(e=e||[].slice.call(n.querySelectorAll("source")).filter((function(t){return"application/dash+xml"==t.type}))[0])&&n.src)(e=document.createElement("source")).src=n.src;else if(!e&&!n.src)return null;return(o=(0,i.default)(r=r||{}).create()).initialize(n,e.src,n.autoplay),t||(t=o.getDebug().getLogger()),t.debug("Converted "+u+" to dash.js player and added content: "+e.src),n._dashjs_player=o,o}function e(t){return/^VIDEO$/i.test(t.nodeName)?t:e(t.parentNode)}return{create:n,createAll:function(t,i){var r=[];t=t||"[data-dashjs-player]";for(var o=(i=i||document).querySelectorAll(t),u=0;u<o.length;u++){var a=n(o[u],null);r.push(a)}for(var s=i.querySelectorAll('source[type="application/dash+xml"]'),f=0;f<s.length;f++){var c=n(e(s[f]),null);r.push(c)}return r}}}(),o=void 0;!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?r.createAll():o=window.setInterval((function(){window.dashjs&&(window.clearInterval(o),r.createAll())}),500):window.addEventListener("load",(function t(){window.removeEventListener("load",t),r.createAll()}))),n.default=r})),tu=o((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Debug=n.MediaPlayerFactory=n.MetricsReporting=n.Protection=n.MediaPlayer=void 0;var e=u(Eo),i=u(Yo),r=u(Zo),o=u(y);function u(t){return t&&t.__esModule?t:{default:t}}dashjs.Protection=i.default,dashjs.MetricsReporting=e.default,dashjs.MediaPlayerFactory=r.default,dashjs.Debug=o.default,n.default=dashjs,n.MediaPlayer=io.MediaPlayer,n.Protection=i.default,n.MetricsReporting=e.default,n.MediaPlayerFactory=r.default,n.Debug=o.default}));const nu=class{constructor(n){t(this,n)}connectedCallback(){}componentDidLoad(){console.log(this.element),tu.MediaPlayer().create().initialize(this.element.shadowRoot.querySelector("#myMainVideoPlayer"),"https://dash.akamaized.net/akamai/bbb_30fps/bbb_30fps.mpd",!0)}render(){return n(e,null,n("slot",null,n("video",{controls:!0,width:"400",height:"200",id:"myMainVideoPlayer"})))}get element(){return i(this)}};nu.style=":host{display:block}";const eu=class{constructor(n){t(this,n)}render(){return n(e,null,n("dashjs-player",null),n("duet-input",{label:"Your name",placeholder:"John Doe"}),n("slot",null,"Reference ui"))}};eu.style=":host{display:block}";export{nu as dashjs_player,eu as dashjs_reference_ui}